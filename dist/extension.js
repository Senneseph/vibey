"use strict";var S$=Object.create;var mi=Object.defineProperty;var P$=Object.getOwnPropertyDescriptor;var E$=Object.getOwnPropertyNames;var T$=Object.getPrototypeOf,z$=Object.prototype.hasOwnProperty;var v=(t,e)=>()=>(e||t((e={exports:{}}).exports,e),e.exports),hi=(t,e)=>{for(var r in e)mi(t,r,{get:e[r],enumerable:!0})},Rf=(t,e,r,n)=>{if(e&&typeof e=="object"||typeof e=="function")for(let s of E$(e))!z$.call(t,s)&&s!==r&&mi(t,s,{get:()=>e[s],enumerable:!(n=P$(e,s))||n.enumerable});return t};var ve=(t,e,r)=>(r=t!=null?S$(T$(t)):{},Rf(e||!t||!t.__esModule?mi(r,"default",{value:t,enumerable:!0}):r,t)),C$=t=>Rf(mi({},"__esModule",{value:!0}),t);var lo=v(ae=>{"use strict";Object.defineProperty(ae,"__esModule",{value:!0});ae.regexpCode=ae.getEsmExportName=ae.getProperty=ae.safeStringify=ae.stringify=ae.strConcat=ae.addCodeArg=ae.str=ae._=ae.nil=ae._Code=ae.Name=ae.IDENTIFIER=ae._CodeOrName=void 0;var co=class{};ae._CodeOrName=co;ae.IDENTIFIER=/^[a-z$_][a-z$_0-9]*$/i;var bn=class extends co{constructor(e){if(super(),!ae.IDENTIFIER.test(e))throw new Error("CodeGen: name must be a valid identifier");this.str=e}toString(){return this.str}emptyStr(){return!1}get names(){return{[this.str]:1}}};ae.Name=bn;var xt=class extends co{constructor(e){super(),this._items=typeof e=="string"?[e]:e}toString(){return this.str}emptyStr(){if(this._items.length>1)return!1;let e=this._items[0];return e===""||e==='""'}get str(){var e;return(e=this._str)!==null&&e!==void 0?e:this._str=this._items.reduce((r,n)=>`${r}${n}`,"")}get names(){var e;return(e=this._names)!==null&&e!==void 0?e:this._names=this._items.reduce((r,n)=>(n instanceof bn&&(r[n.str]=(r[n.str]||0)+1),r),{})}};ae._Code=xt;ae.nil=new xt("");function zy(t,...e){let r=[t[0]],n=0;for(;n<e.length;)Qu(r,e[n]),r.push(t[++n]);return new xt(r)}ae._=zy;var Yu=new xt("+");function Cy(t,...e){let r=[uo(t[0])],n=0;for(;n<e.length;)r.push(Yu),Qu(r,e[n]),r.push(Yu,uo(t[++n]));return HP(r),new xt(r)}ae.str=Cy;function Qu(t,e){e instanceof xt?t.push(...e._items):e instanceof bn?t.push(e):t.push(GP(e))}ae.addCodeArg=Qu;function HP(t){let e=1;for(;e<t.length-1;){if(t[e]===Yu){let r=KP(t[e-1],t[e+1]);if(r!==void 0){t.splice(e-1,3,r);continue}t[e++]="+"}e++}}function KP(t,e){if(e==='""')return t;if(t==='""')return e;if(typeof t=="string")return e instanceof bn||t[t.length-1]!=='"'?void 0:typeof e!="string"?`${t.slice(0,-1)}${e}"`:e[0]==='"'?t.slice(0,-1)+e.slice(1):void 0;if(typeof e=="string"&&e[0]==='"'&&!(t instanceof bn))return`"${t}${e.slice(1)}`}function BP(t,e){return e.emptyStr()?t:t.emptyStr()?e:Cy`${t}${e}`}ae.strConcat=BP;function GP(t){return typeof t=="number"||typeof t=="boolean"||t===null?t:uo(Array.isArray(t)?t.join(","):t)}function WP(t){return new xt(uo(t))}ae.stringify=WP;function uo(t){return JSON.stringify(t).replace(/\u2028/g,"\\u2028").replace(/\u2029/g,"\\u2029")}ae.safeStringify=uo;function JP(t){return typeof t=="string"&&ae.IDENTIFIER.test(t)?new xt(`.${t}`):zy`[${t}]`}ae.getProperty=JP;function YP(t){if(typeof t=="string"&&ae.IDENTIFIER.test(t))return new xt(`${t}`);throw new Error(`CodeGen: invalid export name: ${t}, use explicit $id name mapping`)}ae.getEsmExportName=YP;function QP(t){return new xt(t.toString())}ae.regexpCode=QP});var tl=v(lt=>{"use strict";Object.defineProperty(lt,"__esModule",{value:!0});lt.ValueScope=lt.ValueScopeName=lt.Scope=lt.varKinds=lt.UsedValueState=void 0;var ut=lo(),Xu=class extends Error{constructor(e){super(`CodeGen: "code" for ${e} not defined`),this.value=e.value}},ia;(function(t){t[t.Started=0]="Started",t[t.Completed=1]="Completed"})(ia||(lt.UsedValueState=ia={}));lt.varKinds={const:new ut.Name("const"),let:new ut.Name("let"),var:new ut.Name("var")};var aa=class{constructor({prefixes:e,parent:r}={}){this._names={},this._prefixes=e,this._parent=r}toName(e){return e instanceof ut.Name?e:this.name(e)}name(e){return new ut.Name(this._newName(e))}_newName(e){let r=this._names[e]||this._nameGroup(e);return`${e}${r.index++}`}_nameGroup(e){var r,n;if(!((n=(r=this._parent)===null||r===void 0?void 0:r._prefixes)===null||n===void 0)&&n.has(e)||this._prefixes&&!this._prefixes.has(e))throw new Error(`CodeGen: prefix "${e}" is not allowed in this scope`);return this._names[e]={prefix:e,index:0}}};lt.Scope=aa;var ca=class extends ut.Name{constructor(e,r){super(r),this.prefix=e}setValue(e,{property:r,itemIndex:n}){this.value=e,this.scopePath=(0,ut._)`.${new ut.Name(r)}[${n}]`}};lt.ValueScopeName=ca;var XP=(0,ut._)`\n`,el=class extends aa{constructor(e){super(e),this._values={},this._scope=e.scope,this.opts={...e,_n:e.lines?XP:ut.nil}}get(){return this._scope}name(e){return new ca(e,this._newName(e))}value(e,r){var n;if(r.ref===void 0)throw new Error("CodeGen: ref must be passed in value");let s=this.toName(e),{prefix:o}=s,i=(n=r.key)!==null&&n!==void 0?n:r.ref,a=this._values[o];if(a){let l=a.get(i);if(l)return l}else a=this._values[o]=new Map;a.set(i,s);let c=this._scope[o]||(this._scope[o]=[]),u=c.length;return c[u]=r.ref,s.setValue(r,{property:o,itemIndex:u}),s}getValue(e,r){let n=this._values[e];if(n)return n.get(r)}scopeRefs(e,r=this._values){return this._reduceValues(r,n=>{if(n.scopePath===void 0)throw new Error(`CodeGen: name "${n}" has no value`);return(0,ut._)`${e}${n.scopePath}`})}scopeCode(e=this._values,r,n){return this._reduceValues(e,s=>{if(s.value===void 0)throw new Error(`CodeGen: name "${s}" has no value`);return s.value.code},r,n)}_reduceValues(e,r,n={},s){let o=ut.nil;for(let i in e){let a=e[i];if(!a)continue;let c=n[i]=n[i]||new Map;a.forEach(u=>{if(c.has(u))return;c.set(u,ia.Started);let l=r(u);if(l){let d=this.opts.es5?lt.varKinds.var:lt.varKinds.const;o=(0,ut._)`${o}${d} ${u} = ${l};${this.opts._n}`}else if(l=s?.(u))o=(0,ut._)`${o}${l}${this.opts._n}`;else throw new Xu(u);c.set(u,ia.Completed)})}return o}};lt.ValueScope=el});var Q=v(J=>{"use strict";Object.defineProperty(J,"__esModule",{value:!0});J.or=J.and=J.not=J.CodeGen=J.operators=J.varKinds=J.ValueScopeName=J.ValueScope=J.Scope=J.Name=J.regexpCode=J.stringify=J.getProperty=J.nil=J.strConcat=J.str=J._=void 0;var ne=lo(),Nt=tl(),Or=lo();Object.defineProperty(J,"_",{enumerable:!0,get:function(){return Or._}});Object.defineProperty(J,"str",{enumerable:!0,get:function(){return Or.str}});Object.defineProperty(J,"strConcat",{enumerable:!0,get:function(){return Or.strConcat}});Object.defineProperty(J,"nil",{enumerable:!0,get:function(){return Or.nil}});Object.defineProperty(J,"getProperty",{enumerable:!0,get:function(){return Or.getProperty}});Object.defineProperty(J,"stringify",{enumerable:!0,get:function(){return Or.stringify}});Object.defineProperty(J,"regexpCode",{enumerable:!0,get:function(){return Or.regexpCode}});Object.defineProperty(J,"Name",{enumerable:!0,get:function(){return Or.Name}});var pa=tl();Object.defineProperty(J,"Scope",{enumerable:!0,get:function(){return pa.Scope}});Object.defineProperty(J,"ValueScope",{enumerable:!0,get:function(){return pa.ValueScope}});Object.defineProperty(J,"ValueScopeName",{enumerable:!0,get:function(){return pa.ValueScopeName}});Object.defineProperty(J,"varKinds",{enumerable:!0,get:function(){return pa.varKinds}});J.operators={GT:new ne._Code(">"),GTE:new ne._Code(">="),LT:new ne._Code("<"),LTE:new ne._Code("<="),EQ:new ne._Code("==="),NEQ:new ne._Code("!=="),NOT:new ne._Code("!"),OR:new ne._Code("||"),AND:new ne._Code("&&"),ADD:new ne._Code("+")};var mr=class{optimizeNodes(){return this}optimizeNames(e,r){return this}},rl=class extends mr{constructor(e,r,n){super(),this.varKind=e,this.name=r,this.rhs=n}render({es5:e,_n:r}){let n=e?Nt.varKinds.var:this.varKind,s=this.rhs===void 0?"":` = ${this.rhs}`;return`${n} ${this.name}${s};`+r}optimizeNames(e,r){if(e[this.name.str])return this.rhs&&(this.rhs=ns(this.rhs,e,r)),this}get names(){return this.rhs instanceof ne._CodeOrName?this.rhs.names:{}}},ua=class extends mr{constructor(e,r,n){super(),this.lhs=e,this.rhs=r,this.sideEffects=n}render({_n:e}){return`${this.lhs} = ${this.rhs};`+e}optimizeNames(e,r){if(!(this.lhs instanceof ne.Name&&!e[this.lhs.str]&&!this.sideEffects))return this.rhs=ns(this.rhs,e,r),this}get names(){let e=this.lhs instanceof ne.Name?{}:{...this.lhs.names};return da(e,this.rhs)}},nl=class extends ua{constructor(e,r,n,s){super(e,n,s),this.op=r}render({_n:e}){return`${this.lhs} ${this.op}= ${this.rhs};`+e}},sl=class extends mr{constructor(e){super(),this.label=e,this.names={}}render({_n:e}){return`${this.label}:`+e}},ol=class extends mr{constructor(e){super(),this.label=e,this.names={}}render({_n:e}){return`break${this.label?` ${this.label}`:""};`+e}},il=class extends mr{constructor(e){super(),this.error=e}render({_n:e}){return`throw ${this.error};`+e}get names(){return this.error.names}},al=class extends mr{constructor(e){super(),this.code=e}render({_n:e}){return`${this.code};`+e}optimizeNodes(){return`${this.code}`?this:void 0}optimizeNames(e,r){return this.code=ns(this.code,e,r),this}get names(){return this.code instanceof ne._CodeOrName?this.code.names:{}}},po=class extends mr{constructor(e=[]){super(),this.nodes=e}render(e){return this.nodes.reduce((r,n)=>r+n.render(e),"")}optimizeNodes(){let{nodes:e}=this,r=e.length;for(;r--;){let n=e[r].optimizeNodes();Array.isArray(n)?e.splice(r,1,...n):n?e[r]=n:e.splice(r,1)}return e.length>0?this:void 0}optimizeNames(e,r){let{nodes:n}=this,s=n.length;for(;s--;){let o=n[s];o.optimizeNames(e,r)||(eE(e,o.names),n.splice(s,1))}return n.length>0?this:void 0}get names(){return this.nodes.reduce((e,r)=>xn(e,r.names),{})}},hr=class extends po{render(e){return"{"+e._n+super.render(e)+"}"+e._n}},cl=class extends po{},rs=class extends hr{};rs.kind="else";var wn=class t extends hr{constructor(e,r){super(r),this.condition=e}render(e){let r=`if(${this.condition})`+super.render(e);return this.else&&(r+="else "+this.else.render(e)),r}optimizeNodes(){super.optimizeNodes();let e=this.condition;if(e===!0)return this.nodes;let r=this.else;if(r){let n=r.optimizeNodes();r=this.else=Array.isArray(n)?new rs(n):n}if(r)return e===!1?r instanceof t?r:r.nodes:this.nodes.length?this:new t(Iy(e),r instanceof t?[r]:r.nodes);if(!(e===!1||!this.nodes.length))return this}optimizeNames(e,r){var n;if(this.else=(n=this.else)===null||n===void 0?void 0:n.optimizeNames(e,r),!!(super.optimizeNames(e,r)||this.else))return this.condition=ns(this.condition,e,r),this}get names(){let e=super.names;return da(e,this.condition),this.else&&xn(e,this.else.names),e}};wn.kind="if";var $n=class extends hr{};$n.kind="for";var ul=class extends $n{constructor(e){super(),this.iteration=e}render(e){return`for(${this.iteration})`+super.render(e)}optimizeNames(e,r){if(super.optimizeNames(e,r))return this.iteration=ns(this.iteration,e,r),this}get names(){return xn(super.names,this.iteration.names)}},ll=class extends $n{constructor(e,r,n,s){super(),this.varKind=e,this.name=r,this.from=n,this.to=s}render(e){let r=e.es5?Nt.varKinds.var:this.varKind,{name:n,from:s,to:o}=this;return`for(${r} ${n}=${s}; ${n}<${o}; ${n}++)`+super.render(e)}get names(){let e=da(super.names,this.from);return da(e,this.to)}},la=class extends $n{constructor(e,r,n,s){super(),this.loop=e,this.varKind=r,this.name=n,this.iterable=s}render(e){return`for(${this.varKind} ${this.name} ${this.loop} ${this.iterable})`+super.render(e)}optimizeNames(e,r){if(super.optimizeNames(e,r))return this.iterable=ns(this.iterable,e,r),this}get names(){return xn(super.names,this.iterable.names)}},fo=class extends hr{constructor(e,r,n){super(),this.name=e,this.args=r,this.async=n}render(e){return`${this.async?"async ":""}function ${this.name}(${this.args})`+super.render(e)}};fo.kind="func";var mo=class extends po{render(e){return"return "+super.render(e)}};mo.kind="return";var dl=class extends hr{render(e){let r="try"+super.render(e);return this.catch&&(r+=this.catch.render(e)),this.finally&&(r+=this.finally.render(e)),r}optimizeNodes(){var e,r;return super.optimizeNodes(),(e=this.catch)===null||e===void 0||e.optimizeNodes(),(r=this.finally)===null||r===void 0||r.optimizeNodes(),this}optimizeNames(e,r){var n,s;return super.optimizeNames(e,r),(n=this.catch)===null||n===void 0||n.optimizeNames(e,r),(s=this.finally)===null||s===void 0||s.optimizeNames(e,r),this}get names(){let e=super.names;return this.catch&&xn(e,this.catch.names),this.finally&&xn(e,this.finally.names),e}},ho=class extends hr{constructor(e){super(),this.error=e}render(e){return`catch(${this.error})`+super.render(e)}};ho.kind="catch";var go=class extends hr{render(e){return"finally"+super.render(e)}};go.kind="finally";var pl=class{constructor(e,r={}){this._values={},this._blockStarts=[],this._constants={},this.opts={...r,_n:r.lines?`
`:""},this._extScope=e,this._scope=new Nt.Scope({parent:e}),this._nodes=[new cl]}toString(){return this._root.render(this.opts)}name(e){return this._scope.name(e)}scopeName(e){return this._extScope.name(e)}scopeValue(e,r){let n=this._extScope.value(e,r);return(this._values[n.prefix]||(this._values[n.prefix]=new Set)).add(n),n}getScopeValue(e,r){return this._extScope.getValue(e,r)}scopeRefs(e){return this._extScope.scopeRefs(e,this._values)}scopeCode(){return this._extScope.scopeCode(this._values)}_def(e,r,n,s){let o=this._scope.toName(r);return n!==void 0&&s&&(this._constants[o.str]=n),this._leafNode(new rl(e,o,n)),o}const(e,r,n){return this._def(Nt.varKinds.const,e,r,n)}let(e,r,n){return this._def(Nt.varKinds.let,e,r,n)}var(e,r,n){return this._def(Nt.varKinds.var,e,r,n)}assign(e,r,n){return this._leafNode(new ua(e,r,n))}add(e,r){return this._leafNode(new nl(e,J.operators.ADD,r))}code(e){return typeof e=="function"?e():e!==ne.nil&&this._leafNode(new al(e)),this}object(...e){let r=["{"];for(let[n,s]of e)r.length>1&&r.push(","),r.push(n),(n!==s||this.opts.es5)&&(r.push(":"),(0,ne.addCodeArg)(r,s));return r.push("}"),new ne._Code(r)}if(e,r,n){if(this._blockNode(new wn(e)),r&&n)this.code(r).else().code(n).endIf();else if(r)this.code(r).endIf();else if(n)throw new Error('CodeGen: "else" body without "then" body');return this}elseIf(e){return this._elseNode(new wn(e))}else(){return this._elseNode(new rs)}endIf(){return this._endBlockNode(wn,rs)}_for(e,r){return this._blockNode(e),r&&this.code(r).endFor(),this}for(e,r){return this._for(new ul(e),r)}forRange(e,r,n,s,o=this.opts.es5?Nt.varKinds.var:Nt.varKinds.let){let i=this._scope.toName(e);return this._for(new ll(o,i,r,n),()=>s(i))}forOf(e,r,n,s=Nt.varKinds.const){let o=this._scope.toName(e);if(this.opts.es5){let i=r instanceof ne.Name?r:this.var("_arr",r);return this.forRange("_i",0,(0,ne._)`${i}.length`,a=>{this.var(o,(0,ne._)`${i}[${a}]`),n(o)})}return this._for(new la("of",s,o,r),()=>n(o))}forIn(e,r,n,s=this.opts.es5?Nt.varKinds.var:Nt.varKinds.const){if(this.opts.ownProperties)return this.forOf(e,(0,ne._)`Object.keys(${r})`,n);let o=this._scope.toName(e);return this._for(new la("in",s,o,r),()=>n(o))}endFor(){return this._endBlockNode($n)}label(e){return this._leafNode(new sl(e))}break(e){return this._leafNode(new ol(e))}return(e){let r=new mo;if(this._blockNode(r),this.code(e),r.nodes.length!==1)throw new Error('CodeGen: "return" should have one node');return this._endBlockNode(mo)}try(e,r,n){if(!r&&!n)throw new Error('CodeGen: "try" without "catch" and "finally"');let s=new dl;if(this._blockNode(s),this.code(e),r){let o=this.name("e");this._currNode=s.catch=new ho(o),r(o)}return n&&(this._currNode=s.finally=new go,this.code(n)),this._endBlockNode(ho,go)}throw(e){return this._leafNode(new il(e))}block(e,r){return this._blockStarts.push(this._nodes.length),e&&this.code(e).endBlock(r),this}endBlock(e){let r=this._blockStarts.pop();if(r===void 0)throw new Error("CodeGen: not in self-balancing block");let n=this._nodes.length-r;if(n<0||e!==void 0&&n!==e)throw new Error(`CodeGen: wrong number of nodes: ${n} vs ${e} expected`);return this._nodes.length=r,this}func(e,r=ne.nil,n,s){return this._blockNode(new fo(e,r,n)),s&&this.code(s).endFunc(),this}endFunc(){return this._endBlockNode(fo)}optimize(e=1){for(;e-- >0;)this._root.optimizeNodes(),this._root.optimizeNames(this._root.names,this._constants)}_leafNode(e){return this._currNode.nodes.push(e),this}_blockNode(e){this._currNode.nodes.push(e),this._nodes.push(e)}_endBlockNode(e,r){let n=this._currNode;if(n instanceof e||r&&n instanceof r)return this._nodes.pop(),this;throw new Error(`CodeGen: not in block "${r?`${e.kind}/${r.kind}`:e.kind}"`)}_elseNode(e){let r=this._currNode;if(!(r instanceof wn))throw new Error('CodeGen: "else" without "if"');return this._currNode=r.else=e,this}get _root(){return this._nodes[0]}get _currNode(){let e=this._nodes;return e[e.length-1]}set _currNode(e){let r=this._nodes;r[r.length-1]=e}};J.CodeGen=pl;function xn(t,e){for(let r in e)t[r]=(t[r]||0)+(e[r]||0);return t}function da(t,e){return e instanceof ne._CodeOrName?xn(t,e.names):t}function ns(t,e,r){if(t instanceof ne.Name)return n(t);if(!s(t))return t;return new ne._Code(t._items.reduce((o,i)=>(i instanceof ne.Name&&(i=n(i)),i instanceof ne._Code?o.push(...i._items):o.push(i),o),[]));function n(o){let i=r[o.str];return i===void 0||e[o.str]!==1?o:(delete e[o.str],i)}function s(o){return o instanceof ne._Code&&o._items.some(i=>i instanceof ne.Name&&e[i.str]===1&&r[i.str]!==void 0)}}function eE(t,e){for(let r in e)t[r]=(t[r]||0)-(e[r]||0)}function Iy(t){return typeof t=="boolean"||typeof t=="number"||t===null?!t:(0,ne._)`!${fl(t)}`}J.not=Iy;var tE=Ry(J.operators.AND);function rE(...t){return t.reduce(tE)}J.and=rE;var nE=Ry(J.operators.OR);function sE(...t){return t.reduce(nE)}J.or=sE;function Ry(t){return(e,r)=>e===ne.nil?r:r===ne.nil?e:(0,ne._)`${fl(e)} ${t} ${fl(r)}`}function fl(t){return t instanceof ne.Name?t:(0,ne._)`(${t})`}});var ce=v(X=>{"use strict";Object.defineProperty(X,"__esModule",{value:!0});X.checkStrictMode=X.getErrorPath=X.Type=X.useFunc=X.setEvaluated=X.evaluatedPropsToName=X.mergeEvaluated=X.eachItem=X.unescapeJsonPointer=X.escapeJsonPointer=X.escapeFragment=X.unescapeFragment=X.schemaRefOrVal=X.schemaHasRulesButRef=X.schemaHasRules=X.checkUnknownRules=X.alwaysValidSchema=X.toHash=void 0;var ge=Q(),oE=lo();function iE(t){let e={};for(let r of t)e[r]=!0;return e}X.toHash=iE;function aE(t,e){return typeof e=="boolean"?e:Object.keys(e).length===0?!0:(jy(t,e),!Ay(e,t.self.RULES.all))}X.alwaysValidSchema=aE;function jy(t,e=t.schema){let{opts:r,self:n}=t;if(!r.strictSchema||typeof e=="boolean")return;let s=n.RULES.keywords;for(let o in e)s[o]||Dy(t,`unknown keyword: "${o}"`)}X.checkUnknownRules=jy;function Ay(t,e){if(typeof t=="boolean")return!t;for(let r in t)if(e[r])return!0;return!1}X.schemaHasRules=Ay;function cE(t,e){if(typeof t=="boolean")return!t;for(let r in t)if(r!=="$ref"&&e.all[r])return!0;return!1}X.schemaHasRulesButRef=cE;function uE({topSchemaRef:t,schemaPath:e},r,n,s){if(!s){if(typeof r=="number"||typeof r=="boolean")return r;if(typeof r=="string")return(0,ge._)`${r}`}return(0,ge._)`${t}${e}${(0,ge.getProperty)(n)}`}X.schemaRefOrVal=uE;function lE(t){return My(decodeURIComponent(t))}X.unescapeFragment=lE;function dE(t){return encodeURIComponent(hl(t))}X.escapeFragment=dE;function hl(t){return typeof t=="number"?`${t}`:t.replace(/~/g,"~0").replace(/\//g,"~1")}X.escapeJsonPointer=hl;function My(t){return t.replace(/~1/g,"/").replace(/~0/g,"~")}X.unescapeJsonPointer=My;function pE(t,e){if(Array.isArray(t))for(let r of t)e(r);else e(t)}X.eachItem=pE;function Oy({mergeNames:t,mergeToName:e,mergeValues:r,resultToName:n}){return(s,o,i,a)=>{let c=i===void 0?o:i instanceof ge.Name?(o instanceof ge.Name?t(s,o,i):e(s,o,i),i):o instanceof ge.Name?(e(s,i,o),o):r(o,i);return a===ge.Name&&!(c instanceof ge.Name)?n(s,c):c}}X.mergeEvaluated={props:Oy({mergeNames:(t,e,r)=>t.if((0,ge._)`${r} !== true && ${e} !== undefined`,()=>{t.if((0,ge._)`${e} === true`,()=>t.assign(r,!0),()=>t.assign(r,(0,ge._)`${r} || {}`).code((0,ge._)`Object.assign(${r}, ${e})`))}),mergeToName:(t,e,r)=>t.if((0,ge._)`${r} !== true`,()=>{e===!0?t.assign(r,!0):(t.assign(r,(0,ge._)`${r} || {}`),gl(t,r,e))}),mergeValues:(t,e)=>t===!0?!0:{...t,...e},resultToName:qy}),items:Oy({mergeNames:(t,e,r)=>t.if((0,ge._)`${r} !== true && ${e} !== undefined`,()=>t.assign(r,(0,ge._)`${e} === true ? true : ${r} > ${e} ? ${r} : ${e}`)),mergeToName:(t,e,r)=>t.if((0,ge._)`${r} !== true`,()=>t.assign(r,e===!0?!0:(0,ge._)`${r} > ${e} ? ${r} : ${e}`)),mergeValues:(t,e)=>t===!0?!0:Math.max(t,e),resultToName:(t,e)=>t.var("items",e)})};function qy(t,e){if(e===!0)return t.var("props",!0);let r=t.var("props",(0,ge._)`{}`);return e!==void 0&&gl(t,r,e),r}X.evaluatedPropsToName=qy;function gl(t,e,r){Object.keys(r).forEach(n=>t.assign((0,ge._)`${e}${(0,ge.getProperty)(n)}`,!0))}X.setEvaluated=gl;var Ny={};function fE(t,e){return t.scopeValue("func",{ref:e,code:Ny[e.code]||(Ny[e.code]=new oE._Code(e.code))})}X.useFunc=fE;var ml;(function(t){t[t.Num=0]="Num",t[t.Str=1]="Str"})(ml||(X.Type=ml={}));function mE(t,e,r){if(t instanceof ge.Name){let n=e===ml.Num;return r?n?(0,ge._)`"[" + ${t} + "]"`:(0,ge._)`"['" + ${t} + "']"`:n?(0,ge._)`"/" + ${t}`:(0,ge._)`"/" + ${t}.replace(/~/g, "~0").replace(/\\//g, "~1")`}return r?(0,ge.getProperty)(t).toString():"/"+hl(t)}X.getErrorPath=mE;function Dy(t,e,r=t.opts.strictSchema){if(r){if(e=`strict mode: ${e}`,r===!0)throw new Error(e);t.self.logger.warn(e)}}X.checkStrictMode=Dy});var gr=v(yl=>{"use strict";Object.defineProperty(yl,"__esModule",{value:!0});var Je=Q(),hE={data:new Je.Name("data"),valCxt:new Je.Name("valCxt"),instancePath:new Je.Name("instancePath"),parentData:new Je.Name("parentData"),parentDataProperty:new Je.Name("parentDataProperty"),rootData:new Je.Name("rootData"),dynamicAnchors:new Je.Name("dynamicAnchors"),vErrors:new Je.Name("vErrors"),errors:new Je.Name("errors"),this:new Je.Name("this"),self:new Je.Name("self"),scope:new Je.Name("scope"),json:new Je.Name("json"),jsonPos:new Je.Name("jsonPos"),jsonLen:new Je.Name("jsonLen"),jsonPart:new Je.Name("jsonPart")};yl.default=hE});var yo=v(Ye=>{"use strict";Object.defineProperty(Ye,"__esModule",{value:!0});Ye.extendErrors=Ye.resetErrorsCount=Ye.reportExtraError=Ye.reportError=Ye.keyword$DataError=Ye.keywordError=void 0;var oe=Q(),fa=ce(),rt=gr();Ye.keywordError={message:({keyword:t})=>(0,oe.str)`must pass "${t}" keyword validation`};Ye.keyword$DataError={message:({keyword:t,schemaType:e})=>e?(0,oe.str)`"${t}" keyword must be ${e} ($data)`:(0,oe.str)`"${t}" keyword is invalid ($data)`};function gE(t,e=Ye.keywordError,r,n){let{it:s}=t,{gen:o,compositeRule:i,allErrors:a}=s,c=Vy(t,e,r);n??(i||a)?Zy(o,c):Ly(s,(0,oe._)`[${c}]`)}Ye.reportError=gE;function yE(t,e=Ye.keywordError,r){let{it:n}=t,{gen:s,compositeRule:o,allErrors:i}=n,a=Vy(t,e,r);Zy(s,a),o||i||Ly(n,rt.default.vErrors)}Ye.reportExtraError=yE;function vE(t,e){t.assign(rt.default.errors,e),t.if((0,oe._)`${rt.default.vErrors} !== null`,()=>t.if(e,()=>t.assign((0,oe._)`${rt.default.vErrors}.length`,e),()=>t.assign(rt.default.vErrors,null)))}Ye.resetErrorsCount=vE;function _E({gen:t,keyword:e,schemaValue:r,data:n,errsCount:s,it:o}){if(s===void 0)throw new Error("ajv implementation error");let i=t.name("err");t.forRange("i",s,rt.default.errors,a=>{t.const(i,(0,oe._)`${rt.default.vErrors}[${a}]`),t.if((0,oe._)`${i}.instancePath === undefined`,()=>t.assign((0,oe._)`${i}.instancePath`,(0,oe.strConcat)(rt.default.instancePath,o.errorPath))),t.assign((0,oe._)`${i}.schemaPath`,(0,oe.str)`${o.errSchemaPath}/${e}`),o.opts.verbose&&(t.assign((0,oe._)`${i}.schema`,r),t.assign((0,oe._)`${i}.data`,n))})}Ye.extendErrors=_E;function Zy(t,e){let r=t.const("err",e);t.if((0,oe._)`${rt.default.vErrors} === null`,()=>t.assign(rt.default.vErrors,(0,oe._)`[${r}]`),(0,oe._)`${rt.default.vErrors}.push(${r})`),t.code((0,oe._)`${rt.default.errors}++`)}function Ly(t,e){let{gen:r,validateName:n,schemaEnv:s}=t;s.$async?r.throw((0,oe._)`new ${t.ValidationError}(${e})`):(r.assign((0,oe._)`${n}.errors`,e),r.return(!1))}var kn={keyword:new oe.Name("keyword"),schemaPath:new oe.Name("schemaPath"),params:new oe.Name("params"),propertyName:new oe.Name("propertyName"),message:new oe.Name("message"),schema:new oe.Name("schema"),parentSchema:new oe.Name("parentSchema")};function Vy(t,e,r){let{createErrors:n}=t.it;return n===!1?(0,oe._)`{}`:bE(t,e,r)}function bE(t,e,r={}){let{gen:n,it:s}=t,o=[wE(s,r),$E(t,r)];return xE(t,e,o),n.object(...o)}function wE({errorPath:t},{instancePath:e}){let r=e?(0,oe.str)`${t}${(0,fa.getErrorPath)(e,fa.Type.Str)}`:t;return[rt.default.instancePath,(0,oe.strConcat)(rt.default.instancePath,r)]}function $E({keyword:t,it:{errSchemaPath:e}},{schemaPath:r,parentSchema:n}){let s=n?e:(0,oe.str)`${e}/${t}`;return r&&(s=(0,oe.str)`${s}${(0,fa.getErrorPath)(r,fa.Type.Str)}`),[kn.schemaPath,s]}function xE(t,{params:e,message:r},n){let{keyword:s,data:o,schemaValue:i,it:a}=t,{opts:c,propertyName:u,topSchemaRef:l,schemaPath:d}=a;n.push([kn.keyword,s],[kn.params,typeof e=="function"?e(t):e||(0,oe._)`{}`]),c.messages&&n.push([kn.message,typeof r=="function"?r(t):r]),c.verbose&&n.push([kn.schema,i],[kn.parentSchema,(0,oe._)`${l}${d}`],[rt.default.data,o]),u&&n.push([kn.propertyName,u])}});var Uy=v(ss=>{"use strict";Object.defineProperty(ss,"__esModule",{value:!0});ss.boolOrEmptySchema=ss.topBoolOrEmptySchema=void 0;var kE=yo(),SE=Q(),PE=gr(),EE={message:"boolean schema is false"};function TE(t){let{gen:e,schema:r,validateName:n}=t;r===!1?Fy(t,!1):typeof r=="object"&&r.$async===!0?e.return(PE.default.data):(e.assign((0,SE._)`${n}.errors`,null),e.return(!0))}ss.topBoolOrEmptySchema=TE;function zE(t,e){let{gen:r,schema:n}=t;n===!1?(r.var(e,!1),Fy(t)):r.var(e,!0)}ss.boolOrEmptySchema=zE;function Fy(t,e){let{gen:r,data:n}=t,s={gen:r,keyword:"false schema",data:n,schema:!1,schemaCode:!1,schemaValue:!1,params:{},it:t};(0,kE.reportError)(s,EE,void 0,e)}});var vl=v(os=>{"use strict";Object.defineProperty(os,"__esModule",{value:!0});os.getRules=os.isJSONType=void 0;var CE=["string","number","integer","boolean","null","object","array"],IE=new Set(CE);function RE(t){return typeof t=="string"&&IE.has(t)}os.isJSONType=RE;function OE(){let t={number:{type:"number",rules:[]},string:{type:"string",rules:[]},array:{type:"array",rules:[]},object:{type:"object",rules:[]}};return{types:{...t,integer:!0,boolean:!0,null:!0},rules:[{rules:[]},t.number,t.string,t.array,t.object],post:{rules:[]},all:{},keywords:{}}}os.getRules=OE});var _l=v(Nr=>{"use strict";Object.defineProperty(Nr,"__esModule",{value:!0});Nr.shouldUseRule=Nr.shouldUseGroup=Nr.schemaHasRulesForType=void 0;function NE({schema:t,self:e},r){let n=e.RULES.types[r];return n&&n!==!0&&Hy(t,n)}Nr.schemaHasRulesForType=NE;function Hy(t,e){return e.rules.some(r=>Ky(t,r))}Nr.shouldUseGroup=Hy;function Ky(t,e){var r;return t[e.keyword]!==void 0||((r=e.definition.implements)===null||r===void 0?void 0:r.some(n=>t[n]!==void 0))}Nr.shouldUseRule=Ky});var vo=v(Qe=>{"use strict";Object.defineProperty(Qe,"__esModule",{value:!0});Qe.reportTypeError=Qe.checkDataTypes=Qe.checkDataType=Qe.coerceAndCheckDataType=Qe.getJSONTypes=Qe.getSchemaTypes=Qe.DataType=void 0;var jE=vl(),AE=_l(),ME=yo(),K=Q(),By=ce(),is;(function(t){t[t.Correct=0]="Correct",t[t.Wrong=1]="Wrong"})(is||(Qe.DataType=is={}));function qE(t){let e=Gy(t.type);if(e.includes("null")){if(t.nullable===!1)throw new Error("type: null contradicts nullable: false")}else{if(!e.length&&t.nullable!==void 0)throw new Error('"nullable" cannot be used without "type"');t.nullable===!0&&e.push("null")}return e}Qe.getSchemaTypes=qE;function Gy(t){let e=Array.isArray(t)?t:t?[t]:[];if(e.every(jE.isJSONType))return e;throw new Error("type must be JSONType or JSONType[]: "+e.join(","))}Qe.getJSONTypes=Gy;function DE(t,e){let{gen:r,data:n,opts:s}=t,o=ZE(e,s.coerceTypes),i=e.length>0&&!(o.length===0&&e.length===1&&(0,AE.schemaHasRulesForType)(t,e[0]));if(i){let a=wl(e,n,s.strictNumbers,is.Wrong);r.if(a,()=>{o.length?LE(t,e,o):$l(t)})}return i}Qe.coerceAndCheckDataType=DE;var Wy=new Set(["string","number","integer","boolean","null"]);function ZE(t,e){return e?t.filter(r=>Wy.has(r)||e==="array"&&r==="array"):[]}function LE(t,e,r){let{gen:n,data:s,opts:o}=t,i=n.let("dataType",(0,K._)`typeof ${s}`),a=n.let("coerced",(0,K._)`undefined`);o.coerceTypes==="array"&&n.if((0,K._)`${i} == 'object' && Array.isArray(${s}) && ${s}.length == 1`,()=>n.assign(s,(0,K._)`${s}[0]`).assign(i,(0,K._)`typeof ${s}`).if(wl(e,s,o.strictNumbers),()=>n.assign(a,s))),n.if((0,K._)`${a} !== undefined`);for(let u of r)(Wy.has(u)||u==="array"&&o.coerceTypes==="array")&&c(u);n.else(),$l(t),n.endIf(),n.if((0,K._)`${a} !== undefined`,()=>{n.assign(s,a),VE(t,a)});function c(u){switch(u){case"string":n.elseIf((0,K._)`${i} == "number" || ${i} == "boolean"`).assign(a,(0,K._)`"" + ${s}`).elseIf((0,K._)`${s} === null`).assign(a,(0,K._)`""`);return;case"number":n.elseIf((0,K._)`${i} == "boolean" || ${s} === null
              || (${i} == "string" && ${s} && ${s} == +${s})`).assign(a,(0,K._)`+${s}`);return;case"integer":n.elseIf((0,K._)`${i} === "boolean" || ${s} === null
              || (${i} === "string" && ${s} && ${s} == +${s} && !(${s} % 1))`).assign(a,(0,K._)`+${s}`);return;case"boolean":n.elseIf((0,K._)`${s} === "false" || ${s} === 0 || ${s} === null`).assign(a,!1).elseIf((0,K._)`${s} === "true" || ${s} === 1`).assign(a,!0);return;case"null":n.elseIf((0,K._)`${s} === "" || ${s} === 0 || ${s} === false`),n.assign(a,null);return;case"array":n.elseIf((0,K._)`${i} === "string" || ${i} === "number"
              || ${i} === "boolean" || ${s} === null`).assign(a,(0,K._)`[${s}]`)}}}function VE({gen:t,parentData:e,parentDataProperty:r},n){t.if((0,K._)`${e} !== undefined`,()=>t.assign((0,K._)`${e}[${r}]`,n))}function bl(t,e,r,n=is.Correct){let s=n===is.Correct?K.operators.EQ:K.operators.NEQ,o;switch(t){case"null":return(0,K._)`${e} ${s} null`;case"array":o=(0,K._)`Array.isArray(${e})`;break;case"object":o=(0,K._)`${e} && typeof ${e} == "object" && !Array.isArray(${e})`;break;case"integer":o=i((0,K._)`!(${e} % 1) && !isNaN(${e})`);break;case"number":o=i();break;default:return(0,K._)`typeof ${e} ${s} ${t}`}return n===is.Correct?o:(0,K.not)(o);function i(a=K.nil){return(0,K.and)((0,K._)`typeof ${e} == "number"`,a,r?(0,K._)`isFinite(${e})`:K.nil)}}Qe.checkDataType=bl;function wl(t,e,r,n){if(t.length===1)return bl(t[0],e,r,n);let s,o=(0,By.toHash)(t);if(o.array&&o.object){let i=(0,K._)`typeof ${e} != "object"`;s=o.null?i:(0,K._)`!${e} || ${i}`,delete o.null,delete o.array,delete o.object}else s=K.nil;o.number&&delete o.integer;for(let i in o)s=(0,K.and)(s,bl(i,e,r,n));return s}Qe.checkDataTypes=wl;var FE={message:({schema:t})=>`must be ${t}`,params:({schema:t,schemaValue:e})=>typeof t=="string"?(0,K._)`{type: ${t}}`:(0,K._)`{type: ${e}}`};function $l(t){let e=UE(t);(0,ME.reportError)(e,FE)}Qe.reportTypeError=$l;function UE(t){let{gen:e,data:r,schema:n}=t,s=(0,By.schemaRefOrVal)(t,n,"type");return{gen:e,keyword:"type",data:r,schema:n.type,schemaCode:s,schemaValue:s,parentSchema:n,params:{},it:t}}});var Yy=v(ma=>{"use strict";Object.defineProperty(ma,"__esModule",{value:!0});ma.assignDefaults=void 0;var as=Q(),HE=ce();function KE(t,e){let{properties:r,items:n}=t.schema;if(e==="object"&&r)for(let s in r)Jy(t,s,r[s].default);else e==="array"&&Array.isArray(n)&&n.forEach((s,o)=>Jy(t,o,s.default))}ma.assignDefaults=KE;function Jy(t,e,r){let{gen:n,compositeRule:s,data:o,opts:i}=t;if(r===void 0)return;let a=(0,as._)`${o}${(0,as.getProperty)(e)}`;if(s){(0,HE.checkStrictMode)(t,`default is ignored for: ${a}`);return}let c=(0,as._)`${a} === undefined`;i.useDefaults==="empty"&&(c=(0,as._)`${c} || ${a} === null || ${a} === ""`),n.if(c,(0,as._)`${a} = ${(0,as.stringify)(r)}`)}});var kt=v(fe=>{"use strict";Object.defineProperty(fe,"__esModule",{value:!0});fe.validateUnion=fe.validateArray=fe.usePattern=fe.callValidateCode=fe.schemaProperties=fe.allSchemaProperties=fe.noPropertyInData=fe.propertyInData=fe.isOwnProperty=fe.hasPropFunc=fe.reportMissingProp=fe.checkMissingProp=fe.checkReportMissingProp=void 0;var ke=Q(),xl=ce(),jr=gr(),BE=ce();function GE(t,e){let{gen:r,data:n,it:s}=t;r.if(Sl(r,n,e,s.opts.ownProperties),()=>{t.setParams({missingProperty:(0,ke._)`${e}`},!0),t.error()})}fe.checkReportMissingProp=GE;function WE({gen:t,data:e,it:{opts:r}},n,s){return(0,ke.or)(...n.map(o=>(0,ke.and)(Sl(t,e,o,r.ownProperties),(0,ke._)`${s} = ${o}`)))}fe.checkMissingProp=WE;function JE(t,e){t.setParams({missingProperty:e},!0),t.error()}fe.reportMissingProp=JE;function Qy(t){return t.scopeValue("func",{ref:Object.prototype.hasOwnProperty,code:(0,ke._)`Object.prototype.hasOwnProperty`})}fe.hasPropFunc=Qy;function kl(t,e,r){return(0,ke._)`${Qy(t)}.call(${e}, ${r})`}fe.isOwnProperty=kl;function YE(t,e,r,n){let s=(0,ke._)`${e}${(0,ke.getProperty)(r)} !== undefined`;return n?(0,ke._)`${s} && ${kl(t,e,r)}`:s}fe.propertyInData=YE;function Sl(t,e,r,n){let s=(0,ke._)`${e}${(0,ke.getProperty)(r)} === undefined`;return n?(0,ke.or)(s,(0,ke.not)(kl(t,e,r))):s}fe.noPropertyInData=Sl;function Xy(t){return t?Object.keys(t).filter(e=>e!=="__proto__"):[]}fe.allSchemaProperties=Xy;function QE(t,e){return Xy(e).filter(r=>!(0,xl.alwaysValidSchema)(t,e[r]))}fe.schemaProperties=QE;function XE({schemaCode:t,data:e,it:{gen:r,topSchemaRef:n,schemaPath:s,errorPath:o},it:i},a,c,u){let l=u?(0,ke._)`${t}, ${e}, ${n}${s}`:e,d=[[jr.default.instancePath,(0,ke.strConcat)(jr.default.instancePath,o)],[jr.default.parentData,i.parentData],[jr.default.parentDataProperty,i.parentDataProperty],[jr.default.rootData,jr.default.rootData]];i.opts.dynamicRef&&d.push([jr.default.dynamicAnchors,jr.default.dynamicAnchors]);let f=(0,ke._)`${l}, ${r.object(...d)}`;return c!==ke.nil?(0,ke._)`${a}.call(${c}, ${f})`:(0,ke._)`${a}(${f})`}fe.callValidateCode=XE;var eT=(0,ke._)`new RegExp`;function tT({gen:t,it:{opts:e}},r){let n=e.unicodeRegExp?"u":"",{regExp:s}=e.code,o=s(r,n);return t.scopeValue("pattern",{key:o.toString(),ref:o,code:(0,ke._)`${s.code==="new RegExp"?eT:(0,BE.useFunc)(t,s)}(${r}, ${n})`})}fe.usePattern=tT;function rT(t){let{gen:e,data:r,keyword:n,it:s}=t,o=e.name("valid");if(s.allErrors){let a=e.let("valid",!0);return i(()=>e.assign(a,!1)),a}return e.var(o,!0),i(()=>e.break()),o;function i(a){let c=e.const("len",(0,ke._)`${r}.length`);e.forRange("i",0,c,u=>{t.subschema({keyword:n,dataProp:u,dataPropType:xl.Type.Num},o),e.if((0,ke.not)(o),a)})}}fe.validateArray=rT;function nT(t){let{gen:e,schema:r,keyword:n,it:s}=t;if(!Array.isArray(r))throw new Error("ajv implementation error");if(r.some(c=>(0,xl.alwaysValidSchema)(s,c))&&!s.opts.unevaluated)return;let i=e.let("valid",!1),a=e.name("_valid");e.block(()=>r.forEach((c,u)=>{let l=t.subschema({keyword:n,schemaProp:u,compositeRule:!0},a);e.assign(i,(0,ke._)`${i} || ${a}`),t.mergeValidEvaluated(l,a)||e.if((0,ke.not)(i))})),t.result(i,()=>t.reset(),()=>t.error(!0))}fe.validateUnion=nT});var rv=v(Yt=>{"use strict";Object.defineProperty(Yt,"__esModule",{value:!0});Yt.validateKeywordUsage=Yt.validSchemaType=Yt.funcKeywordCode=Yt.macroKeywordCode=void 0;var nt=Q(),Sn=gr(),sT=kt(),oT=yo();function iT(t,e){let{gen:r,keyword:n,schema:s,parentSchema:o,it:i}=t,a=e.macro.call(i.self,s,o,i),c=tv(r,n,a);i.opts.validateSchema!==!1&&i.self.validateSchema(a,!0);let u=r.name("valid");t.subschema({schema:a,schemaPath:nt.nil,errSchemaPath:`${i.errSchemaPath}/${n}`,topSchemaRef:c,compositeRule:!0},u),t.pass(u,()=>t.error(!0))}Yt.macroKeywordCode=iT;function aT(t,e){var r;let{gen:n,keyword:s,schema:o,parentSchema:i,$data:a,it:c}=t;uT(c,e);let u=!a&&e.compile?e.compile.call(c.self,o,i,c):e.validate,l=tv(n,s,u),d=n.let("valid");t.block$data(d,f),t.ok((r=e.valid)!==null&&r!==void 0?r:d);function f(){if(e.errors===!1)h(),e.modifying&&ev(t),g(()=>t.error());else{let y=e.async?p():m();e.modifying&&ev(t),g(()=>cT(t,y))}}function p(){let y=n.let("ruleErrs",null);return n.try(()=>h((0,nt._)`await `),x=>n.assign(d,!1).if((0,nt._)`${x} instanceof ${c.ValidationError}`,()=>n.assign(y,(0,nt._)`${x}.errors`),()=>n.throw(x))),y}function m(){let y=(0,nt._)`${l}.errors`;return n.assign(y,null),h(nt.nil),y}function h(y=e.async?(0,nt._)`await `:nt.nil){let x=c.opts.passContext?Sn.default.this:Sn.default.self,$=!("compile"in e&&!a||e.schema===!1);n.assign(d,(0,nt._)`${y}${(0,sT.callValidateCode)(t,l,x,$)}`,e.modifying)}function g(y){var x;n.if((0,nt.not)((x=e.valid)!==null&&x!==void 0?x:d),y)}}Yt.funcKeywordCode=aT;function ev(t){let{gen:e,data:r,it:n}=t;e.if(n.parentData,()=>e.assign(r,(0,nt._)`${n.parentData}[${n.parentDataProperty}]`))}function cT(t,e){let{gen:r}=t;r.if((0,nt._)`Array.isArray(${e})`,()=>{r.assign(Sn.default.vErrors,(0,nt._)`${Sn.default.vErrors} === null ? ${e} : ${Sn.default.vErrors}.concat(${e})`).assign(Sn.default.errors,(0,nt._)`${Sn.default.vErrors}.length`),(0,oT.extendErrors)(t)},()=>t.error())}function uT({schemaEnv:t},e){if(e.async&&!t.$async)throw new Error("async keyword in sync schema")}function tv(t,e,r){if(r===void 0)throw new Error(`keyword "${e}" failed to compile`);return t.scopeValue("keyword",typeof r=="function"?{ref:r}:{ref:r,code:(0,nt.stringify)(r)})}function lT(t,e,r=!1){return!e.length||e.some(n=>n==="array"?Array.isArray(t):n==="object"?t&&typeof t=="object"&&!Array.isArray(t):typeof t==n||r&&typeof t>"u")}Yt.validSchemaType=lT;function dT({schema:t,opts:e,self:r,errSchemaPath:n},s,o){if(Array.isArray(s.keyword)?!s.keyword.includes(o):s.keyword!==o)throw new Error("ajv implementation error");let i=s.dependencies;if(i?.some(a=>!Object.prototype.hasOwnProperty.call(t,a)))throw new Error(`parent schema must have dependencies of ${o}: ${i.join(",")}`);if(s.validateSchema&&!s.validateSchema(t[o])){let c=`keyword "${o}" value is invalid at path "${n}": `+r.errorsText(s.validateSchema.errors);if(e.validateSchema==="log")r.logger.error(c);else throw new Error(c)}}Yt.validateKeywordUsage=dT});var sv=v(Ar=>{"use strict";Object.defineProperty(Ar,"__esModule",{value:!0});Ar.extendSubschemaMode=Ar.extendSubschemaData=Ar.getSubschema=void 0;var Qt=Q(),nv=ce();function pT(t,{keyword:e,schemaProp:r,schema:n,schemaPath:s,errSchemaPath:o,topSchemaRef:i}){if(e!==void 0&&n!==void 0)throw new Error('both "keyword" and "schema" passed, only one allowed');if(e!==void 0){let a=t.schema[e];return r===void 0?{schema:a,schemaPath:(0,Qt._)`${t.schemaPath}${(0,Qt.getProperty)(e)}`,errSchemaPath:`${t.errSchemaPath}/${e}`}:{schema:a[r],schemaPath:(0,Qt._)`${t.schemaPath}${(0,Qt.getProperty)(e)}${(0,Qt.getProperty)(r)}`,errSchemaPath:`${t.errSchemaPath}/${e}/${(0,nv.escapeFragment)(r)}`}}if(n!==void 0){if(s===void 0||o===void 0||i===void 0)throw new Error('"schemaPath", "errSchemaPath" and "topSchemaRef" are required with "schema"');return{schema:n,schemaPath:s,topSchemaRef:i,errSchemaPath:o}}throw new Error('either "keyword" or "schema" must be passed')}Ar.getSubschema=pT;function fT(t,e,{dataProp:r,dataPropType:n,data:s,dataTypes:o,propertyName:i}){if(s!==void 0&&r!==void 0)throw new Error('both "data" and "dataProp" passed, only one allowed');let{gen:a}=e;if(r!==void 0){let{errorPath:u,dataPathArr:l,opts:d}=e,f=a.let("data",(0,Qt._)`${e.data}${(0,Qt.getProperty)(r)}`,!0);c(f),t.errorPath=(0,Qt.str)`${u}${(0,nv.getErrorPath)(r,n,d.jsPropertySyntax)}`,t.parentDataProperty=(0,Qt._)`${r}`,t.dataPathArr=[...l,t.parentDataProperty]}if(s!==void 0){let u=s instanceof Qt.Name?s:a.let("data",s,!0);c(u),i!==void 0&&(t.propertyName=i)}o&&(t.dataTypes=o);function c(u){t.data=u,t.dataLevel=e.dataLevel+1,t.dataTypes=[],e.definedProperties=new Set,t.parentData=e.data,t.dataNames=[...e.dataNames,u]}}Ar.extendSubschemaData=fT;function mT(t,{jtdDiscriminator:e,jtdMetadata:r,compositeRule:n,createErrors:s,allErrors:o}){n!==void 0&&(t.compositeRule=n),s!==void 0&&(t.createErrors=s),o!==void 0&&(t.allErrors=o),t.jtdDiscriminator=e,t.jtdMetadata=r}Ar.extendSubschemaMode=mT});var _o=v((g2,ov)=>{"use strict";ov.exports=function t(e,r){if(e===r)return!0;if(e&&r&&typeof e=="object"&&typeof r=="object"){if(e.constructor!==r.constructor)return!1;var n,s,o;if(Array.isArray(e)){if(n=e.length,n!=r.length)return!1;for(s=n;s--!==0;)if(!t(e[s],r[s]))return!1;return!0}if(e.constructor===RegExp)return e.source===r.source&&e.flags===r.flags;if(e.valueOf!==Object.prototype.valueOf)return e.valueOf()===r.valueOf();if(e.toString!==Object.prototype.toString)return e.toString()===r.toString();if(o=Object.keys(e),n=o.length,n!==Object.keys(r).length)return!1;for(s=n;s--!==0;)if(!Object.prototype.hasOwnProperty.call(r,o[s]))return!1;for(s=n;s--!==0;){var i=o[s];if(!t(e[i],r[i]))return!1}return!0}return e!==e&&r!==r}});var av=v((y2,iv)=>{"use strict";var Mr=iv.exports=function(t,e,r){typeof e=="function"&&(r=e,e={}),r=e.cb||r;var n=typeof r=="function"?r:r.pre||function(){},s=r.post||function(){};ha(e,n,s,t,"",t)};Mr.keywords={additionalItems:!0,items:!0,contains:!0,additionalProperties:!0,propertyNames:!0,not:!0,if:!0,then:!0,else:!0};Mr.arrayKeywords={items:!0,allOf:!0,anyOf:!0,oneOf:!0};Mr.propsKeywords={$defs:!0,definitions:!0,properties:!0,patternProperties:!0,dependencies:!0};Mr.skipKeywords={default:!0,enum:!0,const:!0,required:!0,maximum:!0,minimum:!0,exclusiveMaximum:!0,exclusiveMinimum:!0,multipleOf:!0,maxLength:!0,minLength:!0,pattern:!0,format:!0,maxItems:!0,minItems:!0,uniqueItems:!0,maxProperties:!0,minProperties:!0};function ha(t,e,r,n,s,o,i,a,c,u){if(n&&typeof n=="object"&&!Array.isArray(n)){e(n,s,o,i,a,c,u);for(var l in n){var d=n[l];if(Array.isArray(d)){if(l in Mr.arrayKeywords)for(var f=0;f<d.length;f++)ha(t,e,r,d[f],s+"/"+l+"/"+f,o,s,l,n,f)}else if(l in Mr.propsKeywords){if(d&&typeof d=="object")for(var p in d)ha(t,e,r,d[p],s+"/"+l+"/"+hT(p),o,s,l,n,p)}else(l in Mr.keywords||t.allKeys&&!(l in Mr.skipKeywords))&&ha(t,e,r,d,s+"/"+l,o,s,l,n)}r(n,s,o,i,a,c,u)}}function hT(t){return t.replace(/~/g,"~0").replace(/\//g,"~1")}});var bo=v(dt=>{"use strict";Object.defineProperty(dt,"__esModule",{value:!0});dt.getSchemaRefs=dt.resolveUrl=dt.normalizeId=dt._getFullPath=dt.getFullPath=dt.inlineRef=void 0;var gT=ce(),yT=_o(),vT=av(),_T=new Set(["type","format","pattern","maxLength","minLength","maxProperties","minProperties","maxItems","minItems","maximum","minimum","uniqueItems","multipleOf","required","enum","const"]);function bT(t,e=!0){return typeof t=="boolean"?!0:e===!0?!Pl(t):e?cv(t)<=e:!1}dt.inlineRef=bT;var wT=new Set(["$ref","$recursiveRef","$recursiveAnchor","$dynamicRef","$dynamicAnchor"]);function Pl(t){for(let e in t){if(wT.has(e))return!0;let r=t[e];if(Array.isArray(r)&&r.some(Pl)||typeof r=="object"&&Pl(r))return!0}return!1}function cv(t){let e=0;for(let r in t){if(r==="$ref")return 1/0;if(e++,!_T.has(r)&&(typeof t[r]=="object"&&(0,gT.eachItem)(t[r],n=>e+=cv(n)),e===1/0))return 1/0}return e}function uv(t,e="",r){r!==!1&&(e=cs(e));let n=t.parse(e);return lv(t,n)}dt.getFullPath=uv;function lv(t,e){return t.serialize(e).split("#")[0]+"#"}dt._getFullPath=lv;var $T=/#\/?$/;function cs(t){return t?t.replace($T,""):""}dt.normalizeId=cs;function xT(t,e,r){return r=cs(r),t.resolve(e,r)}dt.resolveUrl=xT;var kT=/^[a-z_][-a-z0-9._]*$/i;function ST(t,e){if(typeof t=="boolean")return{};let{schemaId:r,uriResolver:n}=this.opts,s=cs(t[r]||e),o={"":s},i=uv(n,s,!1),a={},c=new Set;return vT(t,{allKeys:!0},(d,f,p,m)=>{if(m===void 0)return;let h=i+f,g=o[m];typeof d[r]=="string"&&(g=y.call(this,d[r])),x.call(this,d.$anchor),x.call(this,d.$dynamicAnchor),o[f]=g;function y($){let S=this.opts.uriResolver.resolve;if($=cs(g?S(g,$):$),c.has($))throw l($);c.add($);let w=this.refs[$];return typeof w=="string"&&(w=this.refs[w]),typeof w=="object"?u(d,w.schema,$):$!==cs(h)&&($[0]==="#"?(u(d,a[$],$),a[$]=d):this.refs[$]=h),$}function x($){if(typeof $=="string"){if(!kT.test($))throw new Error(`invalid anchor "${$}"`);y.call(this,`#${$}`)}}}),a;function u(d,f,p){if(f!==void 0&&!yT(d,f))throw l(p)}function l(d){return new Error(`reference "${d}" resolves to more than one schema`)}}dt.getSchemaRefs=ST});var xo=v(qr=>{"use strict";Object.defineProperty(qr,"__esModule",{value:!0});qr.getData=qr.KeywordCxt=qr.validateFunctionCode=void 0;var hv=Uy(),dv=vo(),Tl=_l(),ga=vo(),PT=Yy(),$o=rv(),El=sv(),O=Q(),L=gr(),ET=bo(),yr=ce(),wo=yo();function TT(t){if(vv(t)&&(_v(t),yv(t))){IT(t);return}gv(t,()=>(0,hv.topBoolOrEmptySchema)(t))}qr.validateFunctionCode=TT;function gv({gen:t,validateName:e,schema:r,schemaEnv:n,opts:s},o){s.code.es5?t.func(e,(0,O._)`${L.default.data}, ${L.default.valCxt}`,n.$async,()=>{t.code((0,O._)`"use strict"; ${pv(r,s)}`),CT(t,s),t.code(o)}):t.func(e,(0,O._)`${L.default.data}, ${zT(s)}`,n.$async,()=>t.code(pv(r,s)).code(o))}function zT(t){return(0,O._)`{${L.default.instancePath}="", ${L.default.parentData}, ${L.default.parentDataProperty}, ${L.default.rootData}=${L.default.data}${t.dynamicRef?(0,O._)`, ${L.default.dynamicAnchors}={}`:O.nil}}={}`}function CT(t,e){t.if(L.default.valCxt,()=>{t.var(L.default.instancePath,(0,O._)`${L.default.valCxt}.${L.default.instancePath}`),t.var(L.default.parentData,(0,O._)`${L.default.valCxt}.${L.default.parentData}`),t.var(L.default.parentDataProperty,(0,O._)`${L.default.valCxt}.${L.default.parentDataProperty}`),t.var(L.default.rootData,(0,O._)`${L.default.valCxt}.${L.default.rootData}`),e.dynamicRef&&t.var(L.default.dynamicAnchors,(0,O._)`${L.default.valCxt}.${L.default.dynamicAnchors}`)},()=>{t.var(L.default.instancePath,(0,O._)`""`),t.var(L.default.parentData,(0,O._)`undefined`),t.var(L.default.parentDataProperty,(0,O._)`undefined`),t.var(L.default.rootData,L.default.data),e.dynamicRef&&t.var(L.default.dynamicAnchors,(0,O._)`{}`)})}function IT(t){let{schema:e,opts:r,gen:n}=t;gv(t,()=>{r.$comment&&e.$comment&&wv(t),AT(t),n.let(L.default.vErrors,null),n.let(L.default.errors,0),r.unevaluated&&RT(t),bv(t),DT(t)})}function RT(t){let{gen:e,validateName:r}=t;t.evaluated=e.const("evaluated",(0,O._)`${r}.evaluated`),e.if((0,O._)`${t.evaluated}.dynamicProps`,()=>e.assign((0,O._)`${t.evaluated}.props`,(0,O._)`undefined`)),e.if((0,O._)`${t.evaluated}.dynamicItems`,()=>e.assign((0,O._)`${t.evaluated}.items`,(0,O._)`undefined`))}function pv(t,e){let r=typeof t=="object"&&t[e.schemaId];return r&&(e.code.source||e.code.process)?(0,O._)`/*# sourceURL=${r} */`:O.nil}function OT(t,e){if(vv(t)&&(_v(t),yv(t))){NT(t,e);return}(0,hv.boolOrEmptySchema)(t,e)}function yv({schema:t,self:e}){if(typeof t=="boolean")return!t;for(let r in t)if(e.RULES.all[r])return!0;return!1}function vv(t){return typeof t.schema!="boolean"}function NT(t,e){let{schema:r,gen:n,opts:s}=t;s.$comment&&r.$comment&&wv(t),MT(t),qT(t);let o=n.const("_errs",L.default.errors);bv(t,o),n.var(e,(0,O._)`${o} === ${L.default.errors}`)}function _v(t){(0,yr.checkUnknownRules)(t),jT(t)}function bv(t,e){if(t.opts.jtd)return fv(t,[],!1,e);let r=(0,dv.getSchemaTypes)(t.schema),n=(0,dv.coerceAndCheckDataType)(t,r);fv(t,r,!n,e)}function jT(t){let{schema:e,errSchemaPath:r,opts:n,self:s}=t;e.$ref&&n.ignoreKeywordsWithRef&&(0,yr.schemaHasRulesButRef)(e,s.RULES)&&s.logger.warn(`$ref: keywords ignored in schema at path "${r}"`)}function AT(t){let{schema:e,opts:r}=t;e.default!==void 0&&r.useDefaults&&r.strictSchema&&(0,yr.checkStrictMode)(t,"default is ignored in the schema root")}function MT(t){let e=t.schema[t.opts.schemaId];e&&(t.baseId=(0,ET.resolveUrl)(t.opts.uriResolver,t.baseId,e))}function qT(t){if(t.schema.$async&&!t.schemaEnv.$async)throw new Error("async schema in sync schema")}function wv({gen:t,schemaEnv:e,schema:r,errSchemaPath:n,opts:s}){let o=r.$comment;if(s.$comment===!0)t.code((0,O._)`${L.default.self}.logger.log(${o})`);else if(typeof s.$comment=="function"){let i=(0,O.str)`${n}/$comment`,a=t.scopeValue("root",{ref:e.root});t.code((0,O._)`${L.default.self}.opts.$comment(${o}, ${i}, ${a}.schema)`)}}function DT(t){let{gen:e,schemaEnv:r,validateName:n,ValidationError:s,opts:o}=t;r.$async?e.if((0,O._)`${L.default.errors} === 0`,()=>e.return(L.default.data),()=>e.throw((0,O._)`new ${s}(${L.default.vErrors})`)):(e.assign((0,O._)`${n}.errors`,L.default.vErrors),o.unevaluated&&ZT(t),e.return((0,O._)`${L.default.errors} === 0`))}function ZT({gen:t,evaluated:e,props:r,items:n}){r instanceof O.Name&&t.assign((0,O._)`${e}.props`,r),n instanceof O.Name&&t.assign((0,O._)`${e}.items`,n)}function fv(t,e,r,n){let{gen:s,schema:o,data:i,allErrors:a,opts:c,self:u}=t,{RULES:l}=u;if(o.$ref&&(c.ignoreKeywordsWithRef||!(0,yr.schemaHasRulesButRef)(o,l))){s.block(()=>xv(t,"$ref",l.all.$ref.definition));return}c.jtd||LT(t,e),s.block(()=>{for(let f of l.rules)d(f);d(l.post)});function d(f){(0,Tl.shouldUseGroup)(o,f)&&(f.type?(s.if((0,ga.checkDataType)(f.type,i,c.strictNumbers)),mv(t,f),e.length===1&&e[0]===f.type&&r&&(s.else(),(0,ga.reportTypeError)(t)),s.endIf()):mv(t,f),a||s.if((0,O._)`${L.default.errors} === ${n||0}`))}}function mv(t,e){let{gen:r,schema:n,opts:{useDefaults:s}}=t;s&&(0,PT.assignDefaults)(t,e.type),r.block(()=>{for(let o of e.rules)(0,Tl.shouldUseRule)(n,o)&&xv(t,o.keyword,o.definition,e.type)})}function LT(t,e){t.schemaEnv.meta||!t.opts.strictTypes||(VT(t,e),t.opts.allowUnionTypes||FT(t,e),UT(t,t.dataTypes))}function VT(t,e){if(e.length){if(!t.dataTypes.length){t.dataTypes=e;return}e.forEach(r=>{$v(t.dataTypes,r)||zl(t,`type "${r}" not allowed by context "${t.dataTypes.join(",")}"`)}),KT(t,e)}}function FT(t,e){e.length>1&&!(e.length===2&&e.includes("null"))&&zl(t,"use allowUnionTypes to allow union type keyword")}function UT(t,e){let r=t.self.RULES.all;for(let n in r){let s=r[n];if(typeof s=="object"&&(0,Tl.shouldUseRule)(t.schema,s)){let{type:o}=s.definition;o.length&&!o.some(i=>HT(e,i))&&zl(t,`missing type "${o.join(",")}" for keyword "${n}"`)}}}function HT(t,e){return t.includes(e)||e==="number"&&t.includes("integer")}function $v(t,e){return t.includes(e)||e==="integer"&&t.includes("number")}function KT(t,e){let r=[];for(let n of t.dataTypes)$v(e,n)?r.push(n):e.includes("integer")&&n==="number"&&r.push("integer");t.dataTypes=r}function zl(t,e){let r=t.schemaEnv.baseId+t.errSchemaPath;e+=` at "${r}" (strictTypes)`,(0,yr.checkStrictMode)(t,e,t.opts.strictTypes)}var ya=class{constructor(e,r,n){if((0,$o.validateKeywordUsage)(e,r,n),this.gen=e.gen,this.allErrors=e.allErrors,this.keyword=n,this.data=e.data,this.schema=e.schema[n],this.$data=r.$data&&e.opts.$data&&this.schema&&this.schema.$data,this.schemaValue=(0,yr.schemaRefOrVal)(e,this.schema,n,this.$data),this.schemaType=r.schemaType,this.parentSchema=e.schema,this.params={},this.it=e,this.def=r,this.$data)this.schemaCode=e.gen.const("vSchema",kv(this.$data,e));else if(this.schemaCode=this.schemaValue,!(0,$o.validSchemaType)(this.schema,r.schemaType,r.allowUndefined))throw new Error(`${n} value must be ${JSON.stringify(r.schemaType)}`);("code"in r?r.trackErrors:r.errors!==!1)&&(this.errsCount=e.gen.const("_errs",L.default.errors))}result(e,r,n){this.failResult((0,O.not)(e),r,n)}failResult(e,r,n){this.gen.if(e),n?n():this.error(),r?(this.gen.else(),r(),this.allErrors&&this.gen.endIf()):this.allErrors?this.gen.endIf():this.gen.else()}pass(e,r){this.failResult((0,O.not)(e),void 0,r)}fail(e){if(e===void 0){this.error(),this.allErrors||this.gen.if(!1);return}this.gen.if(e),this.error(),this.allErrors?this.gen.endIf():this.gen.else()}fail$data(e){if(!this.$data)return this.fail(e);let{schemaCode:r}=this;this.fail((0,O._)`${r} !== undefined && (${(0,O.or)(this.invalid$data(),e)})`)}error(e,r,n){if(r){this.setParams(r),this._error(e,n),this.setParams({});return}this._error(e,n)}_error(e,r){(e?wo.reportExtraError:wo.reportError)(this,this.def.error,r)}$dataError(){(0,wo.reportError)(this,this.def.$dataError||wo.keyword$DataError)}reset(){if(this.errsCount===void 0)throw new Error('add "trackErrors" to keyword definition');(0,wo.resetErrorsCount)(this.gen,this.errsCount)}ok(e){this.allErrors||this.gen.if(e)}setParams(e,r){r?Object.assign(this.params,e):this.params=e}block$data(e,r,n=O.nil){this.gen.block(()=>{this.check$data(e,n),r()})}check$data(e=O.nil,r=O.nil){if(!this.$data)return;let{gen:n,schemaCode:s,schemaType:o,def:i}=this;n.if((0,O.or)((0,O._)`${s} === undefined`,r)),e!==O.nil&&n.assign(e,!0),(o.length||i.validateSchema)&&(n.elseIf(this.invalid$data()),this.$dataError(),e!==O.nil&&n.assign(e,!1)),n.else()}invalid$data(){let{gen:e,schemaCode:r,schemaType:n,def:s,it:o}=this;return(0,O.or)(i(),a());function i(){if(n.length){if(!(r instanceof O.Name))throw new Error("ajv implementation error");let c=Array.isArray(n)?n:[n];return(0,O._)`${(0,ga.checkDataTypes)(c,r,o.opts.strictNumbers,ga.DataType.Wrong)}`}return O.nil}function a(){if(s.validateSchema){let c=e.scopeValue("validate$data",{ref:s.validateSchema});return(0,O._)`!${c}(${r})`}return O.nil}}subschema(e,r){let n=(0,El.getSubschema)(this.it,e);(0,El.extendSubschemaData)(n,this.it,e),(0,El.extendSubschemaMode)(n,e);let s={...this.it,...n,items:void 0,props:void 0};return OT(s,r),s}mergeEvaluated(e,r){let{it:n,gen:s}=this;n.opts.unevaluated&&(n.props!==!0&&e.props!==void 0&&(n.props=yr.mergeEvaluated.props(s,e.props,n.props,r)),n.items!==!0&&e.items!==void 0&&(n.items=yr.mergeEvaluated.items(s,e.items,n.items,r)))}mergeValidEvaluated(e,r){let{it:n,gen:s}=this;if(n.opts.unevaluated&&(n.props!==!0||n.items!==!0))return s.if(r,()=>this.mergeEvaluated(e,O.Name)),!0}};qr.KeywordCxt=ya;function xv(t,e,r,n){let s=new ya(t,r,e);"code"in r?r.code(s,n):s.$data&&r.validate?(0,$o.funcKeywordCode)(s,r):"macro"in r?(0,$o.macroKeywordCode)(s,r):(r.compile||r.validate)&&(0,$o.funcKeywordCode)(s,r)}var BT=/^\/(?:[^~]|~0|~1)*$/,GT=/^([0-9]+)(#|\/(?:[^~]|~0|~1)*)?$/;function kv(t,{dataLevel:e,dataNames:r,dataPathArr:n}){let s,o;if(t==="")return L.default.rootData;if(t[0]==="/"){if(!BT.test(t))throw new Error(`Invalid JSON-pointer: ${t}`);s=t,o=L.default.rootData}else{let u=GT.exec(t);if(!u)throw new Error(`Invalid JSON-pointer: ${t}`);let l=+u[1];if(s=u[2],s==="#"){if(l>=e)throw new Error(c("property/index",l));return n[e-l]}if(l>e)throw new Error(c("data",l));if(o=r[e-l],!s)return o}let i=o,a=s.split("/");for(let u of a)u&&(o=(0,O._)`${o}${(0,O.getProperty)((0,yr.unescapeJsonPointer)(u))}`,i=(0,O._)`${i} && ${o}`);return i;function c(u,l){return`Cannot access ${u} ${l} levels up, current level is ${e}`}}qr.getData=kv});var va=v(Il=>{"use strict";Object.defineProperty(Il,"__esModule",{value:!0});var Cl=class extends Error{constructor(e){super("validation failed"),this.errors=e,this.ajv=this.validation=!0}};Il.default=Cl});var ko=v(Nl=>{"use strict";Object.defineProperty(Nl,"__esModule",{value:!0});var Rl=bo(),Ol=class extends Error{constructor(e,r,n,s){super(s||`can't resolve reference ${n} from id ${r}`),this.missingRef=(0,Rl.resolveUrl)(e,r,n),this.missingSchema=(0,Rl.normalizeId)((0,Rl.getFullPath)(e,this.missingRef))}};Nl.default=Ol});var ba=v(St=>{"use strict";Object.defineProperty(St,"__esModule",{value:!0});St.resolveSchema=St.getCompilingSchema=St.resolveRef=St.compileSchema=St.SchemaEnv=void 0;var jt=Q(),WT=va(),Pn=gr(),At=bo(),Sv=ce(),JT=xo(),us=class{constructor(e){var r;this.refs={},this.dynamicAnchors={};let n;typeof e.schema=="object"&&(n=e.schema),this.schema=e.schema,this.schemaId=e.schemaId,this.root=e.root||this,this.baseId=(r=e.baseId)!==null&&r!==void 0?r:(0,At.normalizeId)(n?.[e.schemaId||"$id"]),this.schemaPath=e.schemaPath,this.localRefs=e.localRefs,this.meta=e.meta,this.$async=n?.$async,this.refs={}}};St.SchemaEnv=us;function Al(t){let e=Pv.call(this,t);if(e)return e;let r=(0,At.getFullPath)(this.opts.uriResolver,t.root.baseId),{es5:n,lines:s}=this.opts.code,{ownProperties:o}=this.opts,i=new jt.CodeGen(this.scope,{es5:n,lines:s,ownProperties:o}),a;t.$async&&(a=i.scopeValue("Error",{ref:WT.default,code:(0,jt._)`require("ajv/dist/runtime/validation_error").default`}));let c=i.scopeName("validate");t.validateName=c;let u={gen:i,allErrors:this.opts.allErrors,data:Pn.default.data,parentData:Pn.default.parentData,parentDataProperty:Pn.default.parentDataProperty,dataNames:[Pn.default.data],dataPathArr:[jt.nil],dataLevel:0,dataTypes:[],definedProperties:new Set,topSchemaRef:i.scopeValue("schema",this.opts.code.source===!0?{ref:t.schema,code:(0,jt.stringify)(t.schema)}:{ref:t.schema}),validateName:c,ValidationError:a,schema:t.schema,schemaEnv:t,rootId:r,baseId:t.baseId||r,schemaPath:jt.nil,errSchemaPath:t.schemaPath||(this.opts.jtd?"":"#"),errorPath:(0,jt._)`""`,opts:this.opts,self:this},l;try{this._compilations.add(t),(0,JT.validateFunctionCode)(u),i.optimize(this.opts.code.optimize);let d=i.toString();l=`${i.scopeRefs(Pn.default.scope)}return ${d}`,this.opts.code.process&&(l=this.opts.code.process(l,t));let p=new Function(`${Pn.default.self}`,`${Pn.default.scope}`,l)(this,this.scope.get());if(this.scope.value(c,{ref:p}),p.errors=null,p.schema=t.schema,p.schemaEnv=t,t.$async&&(p.$async=!0),this.opts.code.source===!0&&(p.source={validateName:c,validateCode:d,scopeValues:i._values}),this.opts.unevaluated){let{props:m,items:h}=u;p.evaluated={props:m instanceof jt.Name?void 0:m,items:h instanceof jt.Name?void 0:h,dynamicProps:m instanceof jt.Name,dynamicItems:h instanceof jt.Name},p.source&&(p.source.evaluated=(0,jt.stringify)(p.evaluated))}return t.validate=p,t}catch(d){throw delete t.validate,delete t.validateName,l&&this.logger.error("Error compiling schema, function code:",l),d}finally{this._compilations.delete(t)}}St.compileSchema=Al;function YT(t,e,r){var n;r=(0,At.resolveUrl)(this.opts.uriResolver,e,r);let s=t.refs[r];if(s)return s;let o=ez.call(this,t,r);if(o===void 0){let i=(n=t.localRefs)===null||n===void 0?void 0:n[r],{schemaId:a}=this.opts;i&&(o=new us({schema:i,schemaId:a,root:t,baseId:e}))}if(o!==void 0)return t.refs[r]=QT.call(this,o)}St.resolveRef=YT;function QT(t){return(0,At.inlineRef)(t.schema,this.opts.inlineRefs)?t.schema:t.validate?t:Al.call(this,t)}function Pv(t){for(let e of this._compilations)if(XT(e,t))return e}St.getCompilingSchema=Pv;function XT(t,e){return t.schema===e.schema&&t.root===e.root&&t.baseId===e.baseId}function ez(t,e){let r;for(;typeof(r=this.refs[e])=="string";)e=r;return r||this.schemas[e]||_a.call(this,t,e)}function _a(t,e){let r=this.opts.uriResolver.parse(e),n=(0,At._getFullPath)(this.opts.uriResolver,r),s=(0,At.getFullPath)(this.opts.uriResolver,t.baseId,void 0);if(Object.keys(t.schema).length>0&&n===s)return jl.call(this,r,t);let o=(0,At.normalizeId)(n),i=this.refs[o]||this.schemas[o];if(typeof i=="string"){let a=_a.call(this,t,i);return typeof a?.schema!="object"?void 0:jl.call(this,r,a)}if(typeof i?.schema=="object"){if(i.validate||Al.call(this,i),o===(0,At.normalizeId)(e)){let{schema:a}=i,{schemaId:c}=this.opts,u=a[c];return u&&(s=(0,At.resolveUrl)(this.opts.uriResolver,s,u)),new us({schema:a,schemaId:c,root:t,baseId:s})}return jl.call(this,r,i)}}St.resolveSchema=_a;var tz=new Set(["properties","patternProperties","enum","dependencies","definitions"]);function jl(t,{baseId:e,schema:r,root:n}){var s;if(((s=t.fragment)===null||s===void 0?void 0:s[0])!=="/")return;for(let a of t.fragment.slice(1).split("/")){if(typeof r=="boolean")return;let c=r[(0,Sv.unescapeFragment)(a)];if(c===void 0)return;r=c;let u=typeof r=="object"&&r[this.opts.schemaId];!tz.has(a)&&u&&(e=(0,At.resolveUrl)(this.opts.uriResolver,e,u))}let o;if(typeof r!="boolean"&&r.$ref&&!(0,Sv.schemaHasRulesButRef)(r,this.RULES)){let a=(0,At.resolveUrl)(this.opts.uriResolver,e,r.$ref);o=_a.call(this,n,a)}let{schemaId:i}=this.opts;if(o=o||new us({schema:r,schemaId:i,root:n,baseId:e}),o.schema!==o.root.schema)return o}});var Ev=v((x2,rz)=>{rz.exports={$id:"https://raw.githubusercontent.com/ajv-validator/ajv/master/lib/refs/data.json#",description:"Meta-schema for $data reference (JSON AnySchema extension proposal)",type:"object",required:["$data"],properties:{$data:{type:"string",anyOf:[{format:"relative-json-pointer"},{format:"json-pointer"}]}},additionalProperties:!1}});var ql=v((k2,Iv)=>{"use strict";var nz=RegExp.prototype.test.bind(/^[\da-f]{8}-[\da-f]{4}-[\da-f]{4}-[\da-f]{4}-[\da-f]{12}$/iu),zv=RegExp.prototype.test.bind(/^(?:(?:25[0-5]|2[0-4]\d|1\d{2}|[1-9]\d|\d)\.){3}(?:25[0-5]|2[0-4]\d|1\d{2}|[1-9]\d|\d)$/u);function Ml(t){let e="",r=0,n=0;for(n=0;n<t.length;n++)if(r=t[n].charCodeAt(0),r!==48){if(!(r>=48&&r<=57||r>=65&&r<=70||r>=97&&r<=102))return"";e+=t[n];break}for(n+=1;n<t.length;n++){if(r=t[n].charCodeAt(0),!(r>=48&&r<=57||r>=65&&r<=70||r>=97&&r<=102))return"";e+=t[n]}return e}var sz=RegExp.prototype.test.bind(/[^!"$&'()*+,\-.;=_`a-z{}~]/u);function Tv(t){return t.length=0,!0}function oz(t,e,r){if(t.length){let n=Ml(t);if(n!=="")e.push(n);else return r.error=!0,!1;t.length=0}return!0}function iz(t){let e=0,r={error:!1,address:"",zone:""},n=[],s=[],o=!1,i=!1,a=oz;for(let c=0;c<t.length;c++){let u=t[c];if(!(u==="["||u==="]"))if(u===":"){if(o===!0&&(i=!0),!a(s,n,r))break;if(++e>7){r.error=!0;break}c>0&&t[c-1]===":"&&(o=!0),n.push(":");continue}else if(u==="%"){if(!a(s,n,r))break;a=Tv}else{s.push(u);continue}}return s.length&&(a===Tv?r.zone=s.join(""):i?n.push(s.join("")):n.push(Ml(s))),r.address=n.join(""),r}function Cv(t){if(az(t,":")<2)return{host:t,isIPV6:!1};let e=iz(t);if(e.error)return{host:t,isIPV6:!1};{let r=e.address,n=e.address;return e.zone&&(r+="%"+e.zone,n+="%25"+e.zone),{host:r,isIPV6:!0,escapedHost:n}}}function az(t,e){let r=0;for(let n=0;n<t.length;n++)t[n]===e&&r++;return r}function cz(t){let e=t,r=[],n=-1,s=0;for(;s=e.length;){if(s===1){if(e===".")break;if(e==="/"){r.push("/");break}else{r.push(e);break}}else if(s===2){if(e[0]==="."){if(e[1]===".")break;if(e[1]==="/"){e=e.slice(2);continue}}else if(e[0]==="/"&&(e[1]==="."||e[1]==="/")){r.push("/");break}}else if(s===3&&e==="/.."){r.length!==0&&r.pop(),r.push("/");break}if(e[0]==="."){if(e[1]==="."){if(e[2]==="/"){e=e.slice(3);continue}}else if(e[1]==="/"){e=e.slice(2);continue}}else if(e[0]==="/"&&e[1]==="."){if(e[2]==="/"){e=e.slice(2);continue}else if(e[2]==="."&&e[3]==="/"){e=e.slice(3),r.length!==0&&r.pop();continue}}if((n=e.indexOf("/",1))===-1){r.push(e);break}else r.push(e.slice(0,n)),e=e.slice(n)}return r.join("")}function uz(t,e){let r=e!==!0?escape:unescape;return t.scheme!==void 0&&(t.scheme=r(t.scheme)),t.userinfo!==void 0&&(t.userinfo=r(t.userinfo)),t.host!==void 0&&(t.host=r(t.host)),t.path!==void 0&&(t.path=r(t.path)),t.query!==void 0&&(t.query=r(t.query)),t.fragment!==void 0&&(t.fragment=r(t.fragment)),t}function lz(t){let e=[];if(t.userinfo!==void 0&&(e.push(t.userinfo),e.push("@")),t.host!==void 0){let r=unescape(t.host);if(!zv(r)){let n=Cv(r);n.isIPV6===!0?r=`[${n.escapedHost}]`:r=t.host}e.push(r)}return(typeof t.port=="number"||typeof t.port=="string")&&(e.push(":"),e.push(String(t.port))),e.length?e.join(""):void 0}Iv.exports={nonSimpleDomain:sz,recomposeAuthority:lz,normalizeComponentEncoding:uz,removeDotSegments:cz,isIPv4:zv,isUUID:nz,normalizeIPv6:Cv,stringArrayToHexStripped:Ml}});var Av=v((S2,jv)=>{"use strict";var{isUUID:dz}=ql(),pz=/([\da-z][\d\-a-z]{0,31}):((?:[\w!$'()*+,\-.:;=@]|%[\da-f]{2})+)/iu,fz=["http","https","ws","wss","urn","urn:uuid"];function mz(t){return fz.indexOf(t)!==-1}function Dl(t){return t.secure===!0?!0:t.secure===!1?!1:t.scheme?t.scheme.length===3&&(t.scheme[0]==="w"||t.scheme[0]==="W")&&(t.scheme[1]==="s"||t.scheme[1]==="S")&&(t.scheme[2]==="s"||t.scheme[2]==="S"):!1}function Rv(t){return t.host||(t.error=t.error||"HTTP URIs must have a host."),t}function Ov(t){let e=String(t.scheme).toLowerCase()==="https";return(t.port===(e?443:80)||t.port==="")&&(t.port=void 0),t.path||(t.path="/"),t}function hz(t){return t.secure=Dl(t),t.resourceName=(t.path||"/")+(t.query?"?"+t.query:""),t.path=void 0,t.query=void 0,t}function gz(t){if((t.port===(Dl(t)?443:80)||t.port==="")&&(t.port=void 0),typeof t.secure=="boolean"&&(t.scheme=t.secure?"wss":"ws",t.secure=void 0),t.resourceName){let[e,r]=t.resourceName.split("?");t.path=e&&e!=="/"?e:void 0,t.query=r,t.resourceName=void 0}return t.fragment=void 0,t}function yz(t,e){if(!t.path)return t.error="URN can not be parsed",t;let r=t.path.match(pz);if(r){let n=e.scheme||t.scheme||"urn";t.nid=r[1].toLowerCase(),t.nss=r[2];let s=`${n}:${e.nid||t.nid}`,o=Zl(s);t.path=void 0,o&&(t=o.parse(t,e))}else t.error=t.error||"URN can not be parsed.";return t}function vz(t,e){if(t.nid===void 0)throw new Error("URN without nid cannot be serialized");let r=e.scheme||t.scheme||"urn",n=t.nid.toLowerCase(),s=`${r}:${e.nid||n}`,o=Zl(s);o&&(t=o.serialize(t,e));let i=t,a=t.nss;return i.path=`${n||e.nid}:${a}`,e.skipEscape=!0,i}function _z(t,e){let r=t;return r.uuid=r.nss,r.nss=void 0,!e.tolerant&&(!r.uuid||!dz(r.uuid))&&(r.error=r.error||"UUID is not valid."),r}function bz(t){let e=t;return e.nss=(t.uuid||"").toLowerCase(),e}var Nv={scheme:"http",domainHost:!0,parse:Rv,serialize:Ov},wz={scheme:"https",domainHost:Nv.domainHost,parse:Rv,serialize:Ov},wa={scheme:"ws",domainHost:!0,parse:hz,serialize:gz},$z={scheme:"wss",domainHost:wa.domainHost,parse:wa.parse,serialize:wa.serialize},xz={scheme:"urn",parse:yz,serialize:vz,skipNormalize:!0},kz={scheme:"urn:uuid",parse:_z,serialize:bz,skipNormalize:!0},$a={http:Nv,https:wz,ws:wa,wss:$z,urn:xz,"urn:uuid":kz};Object.setPrototypeOf($a,null);function Zl(t){return t&&($a[t]||$a[t.toLowerCase()])||void 0}jv.exports={wsIsSecure:Dl,SCHEMES:$a,isValidSchemeName:mz,getSchemeHandler:Zl}});var Vl=v((P2,ka)=>{"use strict";var{normalizeIPv6:Sz,removeDotSegments:So,recomposeAuthority:Pz,normalizeComponentEncoding:xa,isIPv4:Ez,nonSimpleDomain:Tz}=ql(),{SCHEMES:zz,getSchemeHandler:Mv}=Av();function Cz(t,e){return typeof t=="string"?t=Xt(vr(t,e),e):typeof t=="object"&&(t=vr(Xt(t,e),e)),t}function Iz(t,e,r){let n=r?Object.assign({scheme:"null"},r):{scheme:"null"},s=qv(vr(t,n),vr(e,n),n,!0);return n.skipEscape=!0,Xt(s,n)}function qv(t,e,r,n){let s={};return n||(t=vr(Xt(t,r),r),e=vr(Xt(e,r),r)),r=r||{},!r.tolerant&&e.scheme?(s.scheme=e.scheme,s.userinfo=e.userinfo,s.host=e.host,s.port=e.port,s.path=So(e.path||""),s.query=e.query):(e.userinfo!==void 0||e.host!==void 0||e.port!==void 0?(s.userinfo=e.userinfo,s.host=e.host,s.port=e.port,s.path=So(e.path||""),s.query=e.query):(e.path?(e.path[0]==="/"?s.path=So(e.path):((t.userinfo!==void 0||t.host!==void 0||t.port!==void 0)&&!t.path?s.path="/"+e.path:t.path?s.path=t.path.slice(0,t.path.lastIndexOf("/")+1)+e.path:s.path=e.path,s.path=So(s.path)),s.query=e.query):(s.path=t.path,e.query!==void 0?s.query=e.query:s.query=t.query),s.userinfo=t.userinfo,s.host=t.host,s.port=t.port),s.scheme=t.scheme),s.fragment=e.fragment,s}function Rz(t,e,r){return typeof t=="string"?(t=unescape(t),t=Xt(xa(vr(t,r),!0),{...r,skipEscape:!0})):typeof t=="object"&&(t=Xt(xa(t,!0),{...r,skipEscape:!0})),typeof e=="string"?(e=unescape(e),e=Xt(xa(vr(e,r),!0),{...r,skipEscape:!0})):typeof e=="object"&&(e=Xt(xa(e,!0),{...r,skipEscape:!0})),t.toLowerCase()===e.toLowerCase()}function Xt(t,e){let r={host:t.host,scheme:t.scheme,userinfo:t.userinfo,port:t.port,path:t.path,query:t.query,nid:t.nid,nss:t.nss,uuid:t.uuid,fragment:t.fragment,reference:t.reference,resourceName:t.resourceName,secure:t.secure,error:""},n=Object.assign({},e),s=[],o=Mv(n.scheme||r.scheme);o&&o.serialize&&o.serialize(r,n),r.path!==void 0&&(n.skipEscape?r.path=unescape(r.path):(r.path=escape(r.path),r.scheme!==void 0&&(r.path=r.path.split("%3A").join(":")))),n.reference!=="suffix"&&r.scheme&&s.push(r.scheme,":");let i=Pz(r);if(i!==void 0&&(n.reference!=="suffix"&&s.push("//"),s.push(i),r.path&&r.path[0]!=="/"&&s.push("/")),r.path!==void 0){let a=r.path;!n.absolutePath&&(!o||!o.absolutePath)&&(a=So(a)),i===void 0&&a[0]==="/"&&a[1]==="/"&&(a="/%2F"+a.slice(2)),s.push(a)}return r.query!==void 0&&s.push("?",r.query),r.fragment!==void 0&&s.push("#",r.fragment),s.join("")}var Oz=/^(?:([^#/:?]+):)?(?:\/\/((?:([^#/?@]*)@)?(\[[^#/?\]]+\]|[^#/:?]*)(?::(\d*))?))?([^#?]*)(?:\?([^#]*))?(?:#((?:.|[\n\r])*))?/u;function vr(t,e){let r=Object.assign({},e),n={scheme:void 0,userinfo:void 0,host:"",port:void 0,path:"",query:void 0,fragment:void 0},s=!1;r.reference==="suffix"&&(r.scheme?t=r.scheme+":"+t:t="//"+t);let o=t.match(Oz);if(o){if(n.scheme=o[1],n.userinfo=o[3],n.host=o[4],n.port=parseInt(o[5],10),n.path=o[6]||"",n.query=o[7],n.fragment=o[8],isNaN(n.port)&&(n.port=o[5]),n.host)if(Ez(n.host)===!1){let c=Sz(n.host);n.host=c.host.toLowerCase(),s=c.isIPV6}else s=!0;n.scheme===void 0&&n.userinfo===void 0&&n.host===void 0&&n.port===void 0&&n.query===void 0&&!n.path?n.reference="same-document":n.scheme===void 0?n.reference="relative":n.fragment===void 0?n.reference="absolute":n.reference="uri",r.reference&&r.reference!=="suffix"&&r.reference!==n.reference&&(n.error=n.error||"URI is not a "+r.reference+" reference.");let i=Mv(r.scheme||n.scheme);if(!r.unicodeSupport&&(!i||!i.unicodeSupport)&&n.host&&(r.domainHost||i&&i.domainHost)&&s===!1&&Tz(n.host))try{n.host=URL.domainToASCII(n.host.toLowerCase())}catch(a){n.error=n.error||"Host's domain name can not be converted to ASCII: "+a}(!i||i&&!i.skipNormalize)&&(t.indexOf("%")!==-1&&(n.scheme!==void 0&&(n.scheme=unescape(n.scheme)),n.host!==void 0&&(n.host=unescape(n.host))),n.path&&(n.path=escape(unescape(n.path))),n.fragment&&(n.fragment=encodeURI(decodeURIComponent(n.fragment)))),i&&i.parse&&i.parse(n,r)}else n.error=n.error||"URI can not be parsed.";return n}var Ll={SCHEMES:zz,normalize:Cz,resolve:Iz,resolveComponent:qv,equal:Rz,serialize:Xt,parse:vr};ka.exports=Ll;ka.exports.default=Ll;ka.exports.fastUri=Ll});var Zv=v(Fl=>{"use strict";Object.defineProperty(Fl,"__esModule",{value:!0});var Dv=Vl();Dv.code='require("ajv/dist/runtime/uri").default';Fl.default=Dv});var Gv=v(Fe=>{"use strict";Object.defineProperty(Fe,"__esModule",{value:!0});Fe.CodeGen=Fe.Name=Fe.nil=Fe.stringify=Fe.str=Fe._=Fe.KeywordCxt=void 0;var Nz=xo();Object.defineProperty(Fe,"KeywordCxt",{enumerable:!0,get:function(){return Nz.KeywordCxt}});var ls=Q();Object.defineProperty(Fe,"_",{enumerable:!0,get:function(){return ls._}});Object.defineProperty(Fe,"str",{enumerable:!0,get:function(){return ls.str}});Object.defineProperty(Fe,"stringify",{enumerable:!0,get:function(){return ls.stringify}});Object.defineProperty(Fe,"nil",{enumerable:!0,get:function(){return ls.nil}});Object.defineProperty(Fe,"Name",{enumerable:!0,get:function(){return ls.Name}});Object.defineProperty(Fe,"CodeGen",{enumerable:!0,get:function(){return ls.CodeGen}});var jz=va(),Hv=ko(),Az=vl(),Po=ba(),Mz=Q(),Eo=bo(),Sa=vo(),Hl=ce(),Lv=Ev(),qz=Zv(),Kv=(t,e)=>new RegExp(t,e);Kv.code="new RegExp";var Dz=["removeAdditional","useDefaults","coerceTypes"],Zz=new Set(["validate","serialize","parse","wrapper","root","schema","keyword","pattern","formats","validate$data","func","obj","Error"]),Lz={errorDataPath:"",format:"`validateFormats: false` can be used instead.",nullable:'"nullable" keyword is supported by default.',jsonPointers:"Deprecated jsPropertySyntax can be used instead.",extendRefs:"Deprecated ignoreKeywordsWithRef can be used instead.",missingRefs:"Pass empty schema with $id that should be ignored to ajv.addSchema.",processCode:"Use option `code: {process: (code, schemaEnv: object) => string}`",sourceCode:"Use option `code: {source: true}`",strictDefaults:"It is default now, see option `strict`.",strictKeywords:"It is default now, see option `strict`.",uniqueItems:'"uniqueItems" keyword is always validated.',unknownFormats:"Disable strict mode or pass `true` to `ajv.addFormat` (or `formats` option).",cache:"Map is used as cache, schema object as key.",serialize:"Map is used as cache, schema object as key.",ajvErrors:"It is default now."},Vz={ignoreKeywordsWithRef:"",jsPropertySyntax:"",unicode:'"minLength"/"maxLength" account for unicode characters by default.'},Vv=200;function Fz(t){var e,r,n,s,o,i,a,c,u,l,d,f,p,m,h,g,y,x,$,S,w,D,F,Ce,H;let we=t.strict,Ae=(e=t.code)===null||e===void 0?void 0:e.optimize,Gr=Ae===!0||Ae===void 0?1:Ae||0,js=(n=(r=t.code)===null||r===void 0?void 0:r.regExp)!==null&&n!==void 0?n:Kv,zc=(s=t.uriResolver)!==null&&s!==void 0?s:qz.default;return{strictSchema:(i=(o=t.strictSchema)!==null&&o!==void 0?o:we)!==null&&i!==void 0?i:!0,strictNumbers:(c=(a=t.strictNumbers)!==null&&a!==void 0?a:we)!==null&&c!==void 0?c:!0,strictTypes:(l=(u=t.strictTypes)!==null&&u!==void 0?u:we)!==null&&l!==void 0?l:"log",strictTuples:(f=(d=t.strictTuples)!==null&&d!==void 0?d:we)!==null&&f!==void 0?f:"log",strictRequired:(m=(p=t.strictRequired)!==null&&p!==void 0?p:we)!==null&&m!==void 0?m:!1,code:t.code?{...t.code,optimize:Gr,regExp:js}:{optimize:Gr,regExp:js},loopRequired:(h=t.loopRequired)!==null&&h!==void 0?h:Vv,loopEnum:(g=t.loopEnum)!==null&&g!==void 0?g:Vv,meta:(y=t.meta)!==null&&y!==void 0?y:!0,messages:(x=t.messages)!==null&&x!==void 0?x:!0,inlineRefs:($=t.inlineRefs)!==null&&$!==void 0?$:!0,schemaId:(S=t.schemaId)!==null&&S!==void 0?S:"$id",addUsedSchema:(w=t.addUsedSchema)!==null&&w!==void 0?w:!0,validateSchema:(D=t.validateSchema)!==null&&D!==void 0?D:!0,validateFormats:(F=t.validateFormats)!==null&&F!==void 0?F:!0,unicodeRegExp:(Ce=t.unicodeRegExp)!==null&&Ce!==void 0?Ce:!0,int32range:(H=t.int32range)!==null&&H!==void 0?H:!0,uriResolver:zc}}var To=class{constructor(e={}){this.schemas={},this.refs={},this.formats={},this._compilations=new Set,this._loading={},this._cache=new Map,e=this.opts={...e,...Fz(e)};let{es5:r,lines:n}=this.opts.code;this.scope=new Mz.ValueScope({scope:{},prefixes:Zz,es5:r,lines:n}),this.logger=Wz(e.logger);let s=e.validateFormats;e.validateFormats=!1,this.RULES=(0,Az.getRules)(),Fv.call(this,Lz,e,"NOT SUPPORTED"),Fv.call(this,Vz,e,"DEPRECATED","warn"),this._metaOpts=Bz.call(this),e.formats&&Hz.call(this),this._addVocabularies(),this._addDefaultMetaSchema(),e.keywords&&Kz.call(this,e.keywords),typeof e.meta=="object"&&this.addMetaSchema(e.meta),Uz.call(this),e.validateFormats=s}_addVocabularies(){this.addKeyword("$async")}_addDefaultMetaSchema(){let{$data:e,meta:r,schemaId:n}=this.opts,s=Lv;n==="id"&&(s={...Lv},s.id=s.$id,delete s.$id),r&&e&&this.addMetaSchema(s,s[n],!1)}defaultMeta(){let{meta:e,schemaId:r}=this.opts;return this.opts.defaultMeta=typeof e=="object"?e[r]||e:void 0}validate(e,r){let n;if(typeof e=="string"){if(n=this.getSchema(e),!n)throw new Error(`no schema with key or ref "${e}"`)}else n=this.compile(e);let s=n(r);return"$async"in n||(this.errors=n.errors),s}compile(e,r){let n=this._addSchema(e,r);return n.validate||this._compileSchemaEnv(n)}compileAsync(e,r){if(typeof this.opts.loadSchema!="function")throw new Error("options.loadSchema should be a function");let{loadSchema:n}=this.opts;return s.call(this,e,r);async function s(l,d){await o.call(this,l.$schema);let f=this._addSchema(l,d);return f.validate||i.call(this,f)}async function o(l){l&&!this.getSchema(l)&&await s.call(this,{$ref:l},!0)}async function i(l){try{return this._compileSchemaEnv(l)}catch(d){if(!(d instanceof Hv.default))throw d;return a.call(this,d),await c.call(this,d.missingSchema),i.call(this,l)}}function a({missingSchema:l,missingRef:d}){if(this.refs[l])throw new Error(`AnySchema ${l} is loaded but ${d} cannot be resolved`)}async function c(l){let d=await u.call(this,l);this.refs[l]||await o.call(this,d.$schema),this.refs[l]||this.addSchema(d,l,r)}async function u(l){let d=this._loading[l];if(d)return d;try{return await(this._loading[l]=n(l))}finally{delete this._loading[l]}}}addSchema(e,r,n,s=this.opts.validateSchema){if(Array.isArray(e)){for(let i of e)this.addSchema(i,void 0,n,s);return this}let o;if(typeof e=="object"){let{schemaId:i}=this.opts;if(o=e[i],o!==void 0&&typeof o!="string")throw new Error(`schema ${i} must be string`)}return r=(0,Eo.normalizeId)(r||o),this._checkUnique(r),this.schemas[r]=this._addSchema(e,n,r,s,!0),this}addMetaSchema(e,r,n=this.opts.validateSchema){return this.addSchema(e,r,!0,n),this}validateSchema(e,r){if(typeof e=="boolean")return!0;let n;if(n=e.$schema,n!==void 0&&typeof n!="string")throw new Error("$schema must be a string");if(n=n||this.opts.defaultMeta||this.defaultMeta(),!n)return this.logger.warn("meta-schema not available"),this.errors=null,!0;let s=this.validate(n,e);if(!s&&r){let o="schema is invalid: "+this.errorsText();if(this.opts.validateSchema==="log")this.logger.error(o);else throw new Error(o)}return s}getSchema(e){let r;for(;typeof(r=Uv.call(this,e))=="string";)e=r;if(r===void 0){let{schemaId:n}=this.opts,s=new Po.SchemaEnv({schema:{},schemaId:n});if(r=Po.resolveSchema.call(this,s,e),!r)return;this.refs[e]=r}return r.validate||this._compileSchemaEnv(r)}removeSchema(e){if(e instanceof RegExp)return this._removeAllSchemas(this.schemas,e),this._removeAllSchemas(this.refs,e),this;switch(typeof e){case"undefined":return this._removeAllSchemas(this.schemas),this._removeAllSchemas(this.refs),this._cache.clear(),this;case"string":{let r=Uv.call(this,e);return typeof r=="object"&&this._cache.delete(r.schema),delete this.schemas[e],delete this.refs[e],this}case"object":{let r=e;this._cache.delete(r);let n=e[this.opts.schemaId];return n&&(n=(0,Eo.normalizeId)(n),delete this.schemas[n],delete this.refs[n]),this}default:throw new Error("ajv.removeSchema: invalid parameter")}}addVocabulary(e){for(let r of e)this.addKeyword(r);return this}addKeyword(e,r){let n;if(typeof e=="string")n=e,typeof r=="object"&&(this.logger.warn("these parameters are deprecated, see docs for addKeyword"),r.keyword=n);else if(typeof e=="object"&&r===void 0){if(r=e,n=r.keyword,Array.isArray(n)&&!n.length)throw new Error("addKeywords: keyword must be string or non-empty array")}else throw new Error("invalid addKeywords parameters");if(Yz.call(this,n,r),!r)return(0,Hl.eachItem)(n,o=>Ul.call(this,o)),this;Xz.call(this,r);let s={...r,type:(0,Sa.getJSONTypes)(r.type),schemaType:(0,Sa.getJSONTypes)(r.schemaType)};return(0,Hl.eachItem)(n,s.type.length===0?o=>Ul.call(this,o,s):o=>s.type.forEach(i=>Ul.call(this,o,s,i))),this}getKeyword(e){let r=this.RULES.all[e];return typeof r=="object"?r.definition:!!r}removeKeyword(e){let{RULES:r}=this;delete r.keywords[e],delete r.all[e];for(let n of r.rules){let s=n.rules.findIndex(o=>o.keyword===e);s>=0&&n.rules.splice(s,1)}return this}addFormat(e,r){return typeof r=="string"&&(r=new RegExp(r)),this.formats[e]=r,this}errorsText(e=this.errors,{separator:r=", ",dataVar:n="data"}={}){return!e||e.length===0?"No errors":e.map(s=>`${n}${s.instancePath} ${s.message}`).reduce((s,o)=>s+r+o)}$dataMetaSchema(e,r){let n=this.RULES.all;e=JSON.parse(JSON.stringify(e));for(let s of r){let o=s.split("/").slice(1),i=e;for(let a of o)i=i[a];for(let a in n){let c=n[a];if(typeof c!="object")continue;let{$data:u}=c.definition,l=i[a];u&&l&&(i[a]=Bv(l))}}return e}_removeAllSchemas(e,r){for(let n in e){let s=e[n];(!r||r.test(n))&&(typeof s=="string"?delete e[n]:s&&!s.meta&&(this._cache.delete(s.schema),delete e[n]))}}_addSchema(e,r,n,s=this.opts.validateSchema,o=this.opts.addUsedSchema){let i,{schemaId:a}=this.opts;if(typeof e=="object")i=e[a];else{if(this.opts.jtd)throw new Error("schema must be object");if(typeof e!="boolean")throw new Error("schema must be object or boolean")}let c=this._cache.get(e);if(c!==void 0)return c;n=(0,Eo.normalizeId)(i||n);let u=Eo.getSchemaRefs.call(this,e,n);return c=new Po.SchemaEnv({schema:e,schemaId:a,meta:r,baseId:n,localRefs:u}),this._cache.set(c.schema,c),o&&!n.startsWith("#")&&(n&&this._checkUnique(n),this.refs[n]=c),s&&this.validateSchema(e,!0),c}_checkUnique(e){if(this.schemas[e]||this.refs[e])throw new Error(`schema with key or id "${e}" already exists`)}_compileSchemaEnv(e){if(e.meta?this._compileMetaSchema(e):Po.compileSchema.call(this,e),!e.validate)throw new Error("ajv implementation error");return e.validate}_compileMetaSchema(e){let r=this.opts;this.opts=this._metaOpts;try{Po.compileSchema.call(this,e)}finally{this.opts=r}}};To.ValidationError=jz.default;To.MissingRefError=Hv.default;Fe.default=To;function Fv(t,e,r,n="error"){for(let s in t){let o=s;o in e&&this.logger[n](`${r}: option ${s}. ${t[o]}`)}}function Uv(t){return t=(0,Eo.normalizeId)(t),this.schemas[t]||this.refs[t]}function Uz(){let t=this.opts.schemas;if(t)if(Array.isArray(t))this.addSchema(t);else for(let e in t)this.addSchema(t[e],e)}function Hz(){for(let t in this.opts.formats){let e=this.opts.formats[t];e&&this.addFormat(t,e)}}function Kz(t){if(Array.isArray(t)){this.addVocabulary(t);return}this.logger.warn("keywords option as map is deprecated, pass array");for(let e in t){let r=t[e];r.keyword||(r.keyword=e),this.addKeyword(r)}}function Bz(){let t={...this.opts};for(let e of Dz)delete t[e];return t}var Gz={log(){},warn(){},error(){}};function Wz(t){if(t===!1)return Gz;if(t===void 0)return console;if(t.log&&t.warn&&t.error)return t;throw new Error("logger must implement log, warn and error methods")}var Jz=/^[a-z_$][a-z0-9_$:-]*$/i;function Yz(t,e){let{RULES:r}=this;if((0,Hl.eachItem)(t,n=>{if(r.keywords[n])throw new Error(`Keyword ${n} is already defined`);if(!Jz.test(n))throw new Error(`Keyword ${n} has invalid name`)}),!!e&&e.$data&&!("code"in e||"validate"in e))throw new Error('$data keyword must have "code" or "validate" function')}function Ul(t,e,r){var n;let s=e?.post;if(r&&s)throw new Error('keyword with "post" flag cannot have "type"');let{RULES:o}=this,i=s?o.post:o.rules.find(({type:c})=>c===r);if(i||(i={type:r,rules:[]},o.rules.push(i)),o.keywords[t]=!0,!e)return;let a={keyword:t,definition:{...e,type:(0,Sa.getJSONTypes)(e.type),schemaType:(0,Sa.getJSONTypes)(e.schemaType)}};e.before?Qz.call(this,i,a,e.before):i.rules.push(a),o.all[t]=a,(n=e.implements)===null||n===void 0||n.forEach(c=>this.addKeyword(c))}function Qz(t,e,r){let n=t.rules.findIndex(s=>s.keyword===r);n>=0?t.rules.splice(n,0,e):(t.rules.push(e),this.logger.warn(`rule ${r} is not defined`))}function Xz(t){let{metaSchema:e}=t;e!==void 0&&(t.$data&&this.opts.$data&&(e=Bv(e)),t.validateSchema=this.compile(e,!0))}var eC={$ref:"https://raw.githubusercontent.com/ajv-validator/ajv/master/lib/refs/data.json#"};function Bv(t){return{anyOf:[t,eC]}}});var Wv=v(Kl=>{"use strict";Object.defineProperty(Kl,"__esModule",{value:!0});var tC={keyword:"id",code(){throw new Error('NOT SUPPORTED: keyword "id", use "$id" for schema ID')}};Kl.default=tC});var Xv=v(En=>{"use strict";Object.defineProperty(En,"__esModule",{value:!0});En.callRef=En.getValidate=void 0;var rC=ko(),Jv=kt(),pt=Q(),ds=gr(),Yv=ba(),Pa=ce(),nC={keyword:"$ref",schemaType:"string",code(t){let{gen:e,schema:r,it:n}=t,{baseId:s,schemaEnv:o,validateName:i,opts:a,self:c}=n,{root:u}=o;if((r==="#"||r==="#/")&&s===u.baseId)return d();let l=Yv.resolveRef.call(c,u,s,r);if(l===void 0)throw new rC.default(n.opts.uriResolver,s,r);if(l instanceof Yv.SchemaEnv)return f(l);return p(l);function d(){if(o===u)return Ea(t,i,o,o.$async);let m=e.scopeValue("root",{ref:u});return Ea(t,(0,pt._)`${m}.validate`,u,u.$async)}function f(m){let h=Qv(t,m);Ea(t,h,m,m.$async)}function p(m){let h=e.scopeValue("schema",a.code.source===!0?{ref:m,code:(0,pt.stringify)(m)}:{ref:m}),g=e.name("valid"),y=t.subschema({schema:m,dataTypes:[],schemaPath:pt.nil,topSchemaRef:h,errSchemaPath:r},g);t.mergeEvaluated(y),t.ok(g)}}};function Qv(t,e){let{gen:r}=t;return e.validate?r.scopeValue("validate",{ref:e.validate}):(0,pt._)`${r.scopeValue("wrapper",{ref:e})}.validate`}En.getValidate=Qv;function Ea(t,e,r,n){let{gen:s,it:o}=t,{allErrors:i,schemaEnv:a,opts:c}=o,u=c.passContext?ds.default.this:pt.nil;n?l():d();function l(){if(!a.$async)throw new Error("async schema referenced by sync schema");let m=s.let("valid");s.try(()=>{s.code((0,pt._)`await ${(0,Jv.callValidateCode)(t,e,u)}`),p(e),i||s.assign(m,!0)},h=>{s.if((0,pt._)`!(${h} instanceof ${o.ValidationError})`,()=>s.throw(h)),f(h),i||s.assign(m,!1)}),t.ok(m)}function d(){t.result((0,Jv.callValidateCode)(t,e,u),()=>p(e),()=>f(e))}function f(m){let h=(0,pt._)`${m}.errors`;s.assign(ds.default.vErrors,(0,pt._)`${ds.default.vErrors} === null ? ${h} : ${ds.default.vErrors}.concat(${h})`),s.assign(ds.default.errors,(0,pt._)`${ds.default.vErrors}.length`)}function p(m){var h;if(!o.opts.unevaluated)return;let g=(h=r?.validate)===null||h===void 0?void 0:h.evaluated;if(o.props!==!0)if(g&&!g.dynamicProps)g.props!==void 0&&(o.props=Pa.mergeEvaluated.props(s,g.props,o.props));else{let y=s.var("props",(0,pt._)`${m}.evaluated.props`);o.props=Pa.mergeEvaluated.props(s,y,o.props,pt.Name)}if(o.items!==!0)if(g&&!g.dynamicItems)g.items!==void 0&&(o.items=Pa.mergeEvaluated.items(s,g.items,o.items));else{let y=s.var("items",(0,pt._)`${m}.evaluated.items`);o.items=Pa.mergeEvaluated.items(s,y,o.items,pt.Name)}}}En.callRef=Ea;En.default=nC});var e_=v(Bl=>{"use strict";Object.defineProperty(Bl,"__esModule",{value:!0});var sC=Wv(),oC=Xv(),iC=["$schema","$id","$defs","$vocabulary",{keyword:"$comment"},"definitions",sC.default,oC.default];Bl.default=iC});var t_=v(Gl=>{"use strict";Object.defineProperty(Gl,"__esModule",{value:!0});var Ta=Q(),Dr=Ta.operators,za={maximum:{okStr:"<=",ok:Dr.LTE,fail:Dr.GT},minimum:{okStr:">=",ok:Dr.GTE,fail:Dr.LT},exclusiveMaximum:{okStr:"<",ok:Dr.LT,fail:Dr.GTE},exclusiveMinimum:{okStr:">",ok:Dr.GT,fail:Dr.LTE}},aC={message:({keyword:t,schemaCode:e})=>(0,Ta.str)`must be ${za[t].okStr} ${e}`,params:({keyword:t,schemaCode:e})=>(0,Ta._)`{comparison: ${za[t].okStr}, limit: ${e}}`},cC={keyword:Object.keys(za),type:"number",schemaType:"number",$data:!0,error:aC,code(t){let{keyword:e,data:r,schemaCode:n}=t;t.fail$data((0,Ta._)`${r} ${za[e].fail} ${n} || isNaN(${r})`)}};Gl.default=cC});var r_=v(Wl=>{"use strict";Object.defineProperty(Wl,"__esModule",{value:!0});var zo=Q(),uC={message:({schemaCode:t})=>(0,zo.str)`must be multiple of ${t}`,params:({schemaCode:t})=>(0,zo._)`{multipleOf: ${t}}`},lC={keyword:"multipleOf",type:"number",schemaType:"number",$data:!0,error:uC,code(t){let{gen:e,data:r,schemaCode:n,it:s}=t,o=s.opts.multipleOfPrecision,i=e.let("res"),a=o?(0,zo._)`Math.abs(Math.round(${i}) - ${i}) > 1e-${o}`:(0,zo._)`${i} !== parseInt(${i})`;t.fail$data((0,zo._)`(${n} === 0 || (${i} = ${r}/${n}, ${a}))`)}};Wl.default=lC});var s_=v(Jl=>{"use strict";Object.defineProperty(Jl,"__esModule",{value:!0});function n_(t){let e=t.length,r=0,n=0,s;for(;n<e;)r++,s=t.charCodeAt(n++),s>=55296&&s<=56319&&n<e&&(s=t.charCodeAt(n),(s&64512)===56320&&n++);return r}Jl.default=n_;n_.code='require("ajv/dist/runtime/ucs2length").default'});var o_=v(Yl=>{"use strict";Object.defineProperty(Yl,"__esModule",{value:!0});var Tn=Q(),dC=ce(),pC=s_(),fC={message({keyword:t,schemaCode:e}){let r=t==="maxLength"?"more":"fewer";return(0,Tn.str)`must NOT have ${r} than ${e} characters`},params:({schemaCode:t})=>(0,Tn._)`{limit: ${t}}`},mC={keyword:["maxLength","minLength"],type:"string",schemaType:"number",$data:!0,error:fC,code(t){let{keyword:e,data:r,schemaCode:n,it:s}=t,o=e==="maxLength"?Tn.operators.GT:Tn.operators.LT,i=s.opts.unicode===!1?(0,Tn._)`${r}.length`:(0,Tn._)`${(0,dC.useFunc)(t.gen,pC.default)}(${r})`;t.fail$data((0,Tn._)`${i} ${o} ${n}`)}};Yl.default=mC});var i_=v(Ql=>{"use strict";Object.defineProperty(Ql,"__esModule",{value:!0});var hC=kt(),Ca=Q(),gC={message:({schemaCode:t})=>(0,Ca.str)`must match pattern "${t}"`,params:({schemaCode:t})=>(0,Ca._)`{pattern: ${t}}`},yC={keyword:"pattern",type:"string",schemaType:"string",$data:!0,error:gC,code(t){let{data:e,$data:r,schema:n,schemaCode:s,it:o}=t,i=o.opts.unicodeRegExp?"u":"",a=r?(0,Ca._)`(new RegExp(${s}, ${i}))`:(0,hC.usePattern)(t,n);t.fail$data((0,Ca._)`!${a}.test(${e})`)}};Ql.default=yC});var a_=v(Xl=>{"use strict";Object.defineProperty(Xl,"__esModule",{value:!0});var Co=Q(),vC={message({keyword:t,schemaCode:e}){let r=t==="maxProperties"?"more":"fewer";return(0,Co.str)`must NOT have ${r} than ${e} properties`},params:({schemaCode:t})=>(0,Co._)`{limit: ${t}}`},_C={keyword:["maxProperties","minProperties"],type:"object",schemaType:"number",$data:!0,error:vC,code(t){let{keyword:e,data:r,schemaCode:n}=t,s=e==="maxProperties"?Co.operators.GT:Co.operators.LT;t.fail$data((0,Co._)`Object.keys(${r}).length ${s} ${n}`)}};Xl.default=_C});var c_=v(ed=>{"use strict";Object.defineProperty(ed,"__esModule",{value:!0});var Io=kt(),Ro=Q(),bC=ce(),wC={message:({params:{missingProperty:t}})=>(0,Ro.str)`must have required property '${t}'`,params:({params:{missingProperty:t}})=>(0,Ro._)`{missingProperty: ${t}}`},$C={keyword:"required",type:"object",schemaType:"array",$data:!0,error:wC,code(t){let{gen:e,schema:r,schemaCode:n,data:s,$data:o,it:i}=t,{opts:a}=i;if(!o&&r.length===0)return;let c=r.length>=a.loopRequired;if(i.allErrors?u():l(),a.strictRequired){let p=t.parentSchema.properties,{definedProperties:m}=t.it;for(let h of r)if(p?.[h]===void 0&&!m.has(h)){let g=i.schemaEnv.baseId+i.errSchemaPath,y=`required property "${h}" is not defined at "${g}" (strictRequired)`;(0,bC.checkStrictMode)(i,y,i.opts.strictRequired)}}function u(){if(c||o)t.block$data(Ro.nil,d);else for(let p of r)(0,Io.checkReportMissingProp)(t,p)}function l(){let p=e.let("missing");if(c||o){let m=e.let("valid",!0);t.block$data(m,()=>f(p,m)),t.ok(m)}else e.if((0,Io.checkMissingProp)(t,r,p)),(0,Io.reportMissingProp)(t,p),e.else()}function d(){e.forOf("prop",n,p=>{t.setParams({missingProperty:p}),e.if((0,Io.noPropertyInData)(e,s,p,a.ownProperties),()=>t.error())})}function f(p,m){t.setParams({missingProperty:p}),e.forOf(p,n,()=>{e.assign(m,(0,Io.propertyInData)(e,s,p,a.ownProperties)),e.if((0,Ro.not)(m),()=>{t.error(),e.break()})},Ro.nil)}}};ed.default=$C});var u_=v(td=>{"use strict";Object.defineProperty(td,"__esModule",{value:!0});var Oo=Q(),xC={message({keyword:t,schemaCode:e}){let r=t==="maxItems"?"more":"fewer";return(0,Oo.str)`must NOT have ${r} than ${e} items`},params:({schemaCode:t})=>(0,Oo._)`{limit: ${t}}`},kC={keyword:["maxItems","minItems"],type:"array",schemaType:"number",$data:!0,error:xC,code(t){let{keyword:e,data:r,schemaCode:n}=t,s=e==="maxItems"?Oo.operators.GT:Oo.operators.LT;t.fail$data((0,Oo._)`${r}.length ${s} ${n}`)}};td.default=kC});var Ia=v(rd=>{"use strict";Object.defineProperty(rd,"__esModule",{value:!0});var l_=_o();l_.code='require("ajv/dist/runtime/equal").default';rd.default=l_});var d_=v(sd=>{"use strict";Object.defineProperty(sd,"__esModule",{value:!0});var nd=vo(),Ue=Q(),SC=ce(),PC=Ia(),EC={message:({params:{i:t,j:e}})=>(0,Ue.str)`must NOT have duplicate items (items ## ${e} and ${t} are identical)`,params:({params:{i:t,j:e}})=>(0,Ue._)`{i: ${t}, j: ${e}}`},TC={keyword:"uniqueItems",type:"array",schemaType:"boolean",$data:!0,error:EC,code(t){let{gen:e,data:r,$data:n,schema:s,parentSchema:o,schemaCode:i,it:a}=t;if(!n&&!s)return;let c=e.let("valid"),u=o.items?(0,nd.getSchemaTypes)(o.items):[];t.block$data(c,l,(0,Ue._)`${i} === false`),t.ok(c);function l(){let m=e.let("i",(0,Ue._)`${r}.length`),h=e.let("j");t.setParams({i:m,j:h}),e.assign(c,!0),e.if((0,Ue._)`${m} > 1`,()=>(d()?f:p)(m,h))}function d(){return u.length>0&&!u.some(m=>m==="object"||m==="array")}function f(m,h){let g=e.name("item"),y=(0,nd.checkDataTypes)(u,g,a.opts.strictNumbers,nd.DataType.Wrong),x=e.const("indices",(0,Ue._)`{}`);e.for((0,Ue._)`;${m}--;`,()=>{e.let(g,(0,Ue._)`${r}[${m}]`),e.if(y,(0,Ue._)`continue`),u.length>1&&e.if((0,Ue._)`typeof ${g} == "string"`,(0,Ue._)`${g} += "_"`),e.if((0,Ue._)`typeof ${x}[${g}] == "number"`,()=>{e.assign(h,(0,Ue._)`${x}[${g}]`),t.error(),e.assign(c,!1).break()}).code((0,Ue._)`${x}[${g}] = ${m}`)})}function p(m,h){let g=(0,SC.useFunc)(e,PC.default),y=e.name("outer");e.label(y).for((0,Ue._)`;${m}--;`,()=>e.for((0,Ue._)`${h} = ${m}; ${h}--;`,()=>e.if((0,Ue._)`${g}(${r}[${m}], ${r}[${h}])`,()=>{t.error(),e.assign(c,!1).break(y)})))}}};sd.default=TC});var p_=v(id=>{"use strict";Object.defineProperty(id,"__esModule",{value:!0});var od=Q(),zC=ce(),CC=Ia(),IC={message:"must be equal to constant",params:({schemaCode:t})=>(0,od._)`{allowedValue: ${t}}`},RC={keyword:"const",$data:!0,error:IC,code(t){let{gen:e,data:r,$data:n,schemaCode:s,schema:o}=t;n||o&&typeof o=="object"?t.fail$data((0,od._)`!${(0,zC.useFunc)(e,CC.default)}(${r}, ${s})`):t.fail((0,od._)`${o} !== ${r}`)}};id.default=RC});var f_=v(ad=>{"use strict";Object.defineProperty(ad,"__esModule",{value:!0});var No=Q(),OC=ce(),NC=Ia(),jC={message:"must be equal to one of the allowed values",params:({schemaCode:t})=>(0,No._)`{allowedValues: ${t}}`},AC={keyword:"enum",schemaType:"array",$data:!0,error:jC,code(t){let{gen:e,data:r,$data:n,schema:s,schemaCode:o,it:i}=t;if(!n&&s.length===0)throw new Error("enum must have non-empty array");let a=s.length>=i.opts.loopEnum,c,u=()=>c??(c=(0,OC.useFunc)(e,NC.default)),l;if(a||n)l=e.let("valid"),t.block$data(l,d);else{if(!Array.isArray(s))throw new Error("ajv implementation error");let p=e.const("vSchema",o);l=(0,No.or)(...s.map((m,h)=>f(p,h)))}t.pass(l);function d(){e.assign(l,!1),e.forOf("v",o,p=>e.if((0,No._)`${u()}(${r}, ${p})`,()=>e.assign(l,!0).break()))}function f(p,m){let h=s[m];return typeof h=="object"&&h!==null?(0,No._)`${u()}(${r}, ${p}[${m}])`:(0,No._)`${r} === ${h}`}}};ad.default=AC});var m_=v(cd=>{"use strict";Object.defineProperty(cd,"__esModule",{value:!0});var MC=t_(),qC=r_(),DC=o_(),ZC=i_(),LC=a_(),VC=c_(),FC=u_(),UC=d_(),HC=p_(),KC=f_(),BC=[MC.default,qC.default,DC.default,ZC.default,LC.default,VC.default,FC.default,UC.default,{keyword:"type",schemaType:["string","array"]},{keyword:"nullable",schemaType:"boolean"},HC.default,KC.default];cd.default=BC});var ld=v(jo=>{"use strict";Object.defineProperty(jo,"__esModule",{value:!0});jo.validateAdditionalItems=void 0;var zn=Q(),ud=ce(),GC={message:({params:{len:t}})=>(0,zn.str)`must NOT have more than ${t} items`,params:({params:{len:t}})=>(0,zn._)`{limit: ${t}}`},WC={keyword:"additionalItems",type:"array",schemaType:["boolean","object"],before:"uniqueItems",error:GC,code(t){let{parentSchema:e,it:r}=t,{items:n}=e;if(!Array.isArray(n)){(0,ud.checkStrictMode)(r,'"additionalItems" is ignored when "items" is not an array of schemas');return}h_(t,n)}};function h_(t,e){let{gen:r,schema:n,data:s,keyword:o,it:i}=t;i.items=!0;let a=r.const("len",(0,zn._)`${s}.length`);if(n===!1)t.setParams({len:e.length}),t.pass((0,zn._)`${a} <= ${e.length}`);else if(typeof n=="object"&&!(0,ud.alwaysValidSchema)(i,n)){let u=r.var("valid",(0,zn._)`${a} <= ${e.length}`);r.if((0,zn.not)(u),()=>c(u)),t.ok(u)}function c(u){r.forRange("i",e.length,a,l=>{t.subschema({keyword:o,dataProp:l,dataPropType:ud.Type.Num},u),i.allErrors||r.if((0,zn.not)(u),()=>r.break())})}}jo.validateAdditionalItems=h_;jo.default=WC});var dd=v(Ao=>{"use strict";Object.defineProperty(Ao,"__esModule",{value:!0});Ao.validateTuple=void 0;var g_=Q(),Ra=ce(),JC=kt(),YC={keyword:"items",type:"array",schemaType:["object","array","boolean"],before:"uniqueItems",code(t){let{schema:e,it:r}=t;if(Array.isArray(e))return y_(t,"additionalItems",e);r.items=!0,!(0,Ra.alwaysValidSchema)(r,e)&&t.ok((0,JC.validateArray)(t))}};function y_(t,e,r=t.schema){let{gen:n,parentSchema:s,data:o,keyword:i,it:a}=t;l(s),a.opts.unevaluated&&r.length&&a.items!==!0&&(a.items=Ra.mergeEvaluated.items(n,r.length,a.items));let c=n.name("valid"),u=n.const("len",(0,g_._)`${o}.length`);r.forEach((d,f)=>{(0,Ra.alwaysValidSchema)(a,d)||(n.if((0,g_._)`${u} > ${f}`,()=>t.subschema({keyword:i,schemaProp:f,dataProp:f},c)),t.ok(c))});function l(d){let{opts:f,errSchemaPath:p}=a,m=r.length,h=m===d.minItems&&(m===d.maxItems||d[e]===!1);if(f.strictTuples&&!h){let g=`"${i}" is ${m}-tuple, but minItems or maxItems/${e} are not specified or different at path "${p}"`;(0,Ra.checkStrictMode)(a,g,f.strictTuples)}}}Ao.validateTuple=y_;Ao.default=YC});var v_=v(pd=>{"use strict";Object.defineProperty(pd,"__esModule",{value:!0});var QC=dd(),XC={keyword:"prefixItems",type:"array",schemaType:["array"],before:"uniqueItems",code:t=>(0,QC.validateTuple)(t,"items")};pd.default=XC});var b_=v(fd=>{"use strict";Object.defineProperty(fd,"__esModule",{value:!0});var __=Q(),eI=ce(),tI=kt(),rI=ld(),nI={message:({params:{len:t}})=>(0,__.str)`must NOT have more than ${t} items`,params:({params:{len:t}})=>(0,__._)`{limit: ${t}}`},sI={keyword:"items",type:"array",schemaType:["object","boolean"],before:"uniqueItems",error:nI,code(t){let{schema:e,parentSchema:r,it:n}=t,{prefixItems:s}=r;n.items=!0,!(0,eI.alwaysValidSchema)(n,e)&&(s?(0,rI.validateAdditionalItems)(t,s):t.ok((0,tI.validateArray)(t)))}};fd.default=sI});var w_=v(md=>{"use strict";Object.defineProperty(md,"__esModule",{value:!0});var Pt=Q(),Oa=ce(),oI={message:({params:{min:t,max:e}})=>e===void 0?(0,Pt.str)`must contain at least ${t} valid item(s)`:(0,Pt.str)`must contain at least ${t} and no more than ${e} valid item(s)`,params:({params:{min:t,max:e}})=>e===void 0?(0,Pt._)`{minContains: ${t}}`:(0,Pt._)`{minContains: ${t}, maxContains: ${e}}`},iI={keyword:"contains",type:"array",schemaType:["object","boolean"],before:"uniqueItems",trackErrors:!0,error:oI,code(t){let{gen:e,schema:r,parentSchema:n,data:s,it:o}=t,i,a,{minContains:c,maxContains:u}=n;o.opts.next?(i=c===void 0?1:c,a=u):i=1;let l=e.const("len",(0,Pt._)`${s}.length`);if(t.setParams({min:i,max:a}),a===void 0&&i===0){(0,Oa.checkStrictMode)(o,'"minContains" == 0 without "maxContains": "contains" keyword ignored');return}if(a!==void 0&&i>a){(0,Oa.checkStrictMode)(o,'"minContains" > "maxContains" is always invalid'),t.fail();return}if((0,Oa.alwaysValidSchema)(o,r)){let h=(0,Pt._)`${l} >= ${i}`;a!==void 0&&(h=(0,Pt._)`${h} && ${l} <= ${a}`),t.pass(h);return}o.items=!0;let d=e.name("valid");a===void 0&&i===1?p(d,()=>e.if(d,()=>e.break())):i===0?(e.let(d,!0),a!==void 0&&e.if((0,Pt._)`${s}.length > 0`,f)):(e.let(d,!1),f()),t.result(d,()=>t.reset());function f(){let h=e.name("_valid"),g=e.let("count",0);p(h,()=>e.if(h,()=>m(g)))}function p(h,g){e.forRange("i",0,l,y=>{t.subschema({keyword:"contains",dataProp:y,dataPropType:Oa.Type.Num,compositeRule:!0},h),g()})}function m(h){e.code((0,Pt._)`${h}++`),a===void 0?e.if((0,Pt._)`${h} >= ${i}`,()=>e.assign(d,!0).break()):(e.if((0,Pt._)`${h} > ${a}`,()=>e.assign(d,!1).break()),i===1?e.assign(d,!0):e.if((0,Pt._)`${h} >= ${i}`,()=>e.assign(d,!0)))}}};md.default=iI});var k_=v(er=>{"use strict";Object.defineProperty(er,"__esModule",{value:!0});er.validateSchemaDeps=er.validatePropertyDeps=er.error=void 0;var hd=Q(),aI=ce(),Mo=kt();er.error={message:({params:{property:t,depsCount:e,deps:r}})=>{let n=e===1?"property":"properties";return(0,hd.str)`must have ${n} ${r} when property ${t} is present`},params:({params:{property:t,depsCount:e,deps:r,missingProperty:n}})=>(0,hd._)`{property: ${t},
    missingProperty: ${n},
    depsCount: ${e},
    deps: ${r}}`};var cI={keyword:"dependencies",type:"object",schemaType:"object",error:er.error,code(t){let[e,r]=uI(t);$_(t,e),x_(t,r)}};function uI({schema:t}){let e={},r={};for(let n in t){if(n==="__proto__")continue;let s=Array.isArray(t[n])?e:r;s[n]=t[n]}return[e,r]}function $_(t,e=t.schema){let{gen:r,data:n,it:s}=t;if(Object.keys(e).length===0)return;let o=r.let("missing");for(let i in e){let a=e[i];if(a.length===0)continue;let c=(0,Mo.propertyInData)(r,n,i,s.opts.ownProperties);t.setParams({property:i,depsCount:a.length,deps:a.join(", ")}),s.allErrors?r.if(c,()=>{for(let u of a)(0,Mo.checkReportMissingProp)(t,u)}):(r.if((0,hd._)`${c} && (${(0,Mo.checkMissingProp)(t,a,o)})`),(0,Mo.reportMissingProp)(t,o),r.else())}}er.validatePropertyDeps=$_;function x_(t,e=t.schema){let{gen:r,data:n,keyword:s,it:o}=t,i=r.name("valid");for(let a in e)(0,aI.alwaysValidSchema)(o,e[a])||(r.if((0,Mo.propertyInData)(r,n,a,o.opts.ownProperties),()=>{let c=t.subschema({keyword:s,schemaProp:a},i);t.mergeValidEvaluated(c,i)},()=>r.var(i,!0)),t.ok(i))}er.validateSchemaDeps=x_;er.default=cI});var P_=v(gd=>{"use strict";Object.defineProperty(gd,"__esModule",{value:!0});var S_=Q(),lI=ce(),dI={message:"property name must be valid",params:({params:t})=>(0,S_._)`{propertyName: ${t.propertyName}}`},pI={keyword:"propertyNames",type:"object",schemaType:["object","boolean"],error:dI,code(t){let{gen:e,schema:r,data:n,it:s}=t;if((0,lI.alwaysValidSchema)(s,r))return;let o=e.name("valid");e.forIn("key",n,i=>{t.setParams({propertyName:i}),t.subschema({keyword:"propertyNames",data:i,dataTypes:["string"],propertyName:i,compositeRule:!0},o),e.if((0,S_.not)(o),()=>{t.error(!0),s.allErrors||e.break()})}),t.ok(o)}};gd.default=pI});var vd=v(yd=>{"use strict";Object.defineProperty(yd,"__esModule",{value:!0});var Na=kt(),Mt=Q(),fI=gr(),ja=ce(),mI={message:"must NOT have additional properties",params:({params:t})=>(0,Mt._)`{additionalProperty: ${t.additionalProperty}}`},hI={keyword:"additionalProperties",type:["object"],schemaType:["boolean","object"],allowUndefined:!0,trackErrors:!0,error:mI,code(t){let{gen:e,schema:r,parentSchema:n,data:s,errsCount:o,it:i}=t;if(!o)throw new Error("ajv implementation error");let{allErrors:a,opts:c}=i;if(i.props=!0,c.removeAdditional!=="all"&&(0,ja.alwaysValidSchema)(i,r))return;let u=(0,Na.allSchemaProperties)(n.properties),l=(0,Na.allSchemaProperties)(n.patternProperties);d(),t.ok((0,Mt._)`${o} === ${fI.default.errors}`);function d(){e.forIn("key",s,g=>{!u.length&&!l.length?m(g):e.if(f(g),()=>m(g))})}function f(g){let y;if(u.length>8){let x=(0,ja.schemaRefOrVal)(i,n.properties,"properties");y=(0,Na.isOwnProperty)(e,x,g)}else u.length?y=(0,Mt.or)(...u.map(x=>(0,Mt._)`${g} === ${x}`)):y=Mt.nil;return l.length&&(y=(0,Mt.or)(y,...l.map(x=>(0,Mt._)`${(0,Na.usePattern)(t,x)}.test(${g})`))),(0,Mt.not)(y)}function p(g){e.code((0,Mt._)`delete ${s}[${g}]`)}function m(g){if(c.removeAdditional==="all"||c.removeAdditional&&r===!1){p(g);return}if(r===!1){t.setParams({additionalProperty:g}),t.error(),a||e.break();return}if(typeof r=="object"&&!(0,ja.alwaysValidSchema)(i,r)){let y=e.name("valid");c.removeAdditional==="failing"?(h(g,y,!1),e.if((0,Mt.not)(y),()=>{t.reset(),p(g)})):(h(g,y),a||e.if((0,Mt.not)(y),()=>e.break()))}}function h(g,y,x){let $={keyword:"additionalProperties",dataProp:g,dataPropType:ja.Type.Str};x===!1&&Object.assign($,{compositeRule:!0,createErrors:!1,allErrors:!1}),t.subschema($,y)}}};yd.default=hI});var z_=v(bd=>{"use strict";Object.defineProperty(bd,"__esModule",{value:!0});var gI=xo(),E_=kt(),_d=ce(),T_=vd(),yI={keyword:"properties",type:"object",schemaType:"object",code(t){let{gen:e,schema:r,parentSchema:n,data:s,it:o}=t;o.opts.removeAdditional==="all"&&n.additionalProperties===void 0&&T_.default.code(new gI.KeywordCxt(o,T_.default,"additionalProperties"));let i=(0,E_.allSchemaProperties)(r);for(let d of i)o.definedProperties.add(d);o.opts.unevaluated&&i.length&&o.props!==!0&&(o.props=_d.mergeEvaluated.props(e,(0,_d.toHash)(i),o.props));let a=i.filter(d=>!(0,_d.alwaysValidSchema)(o,r[d]));if(a.length===0)return;let c=e.name("valid");for(let d of a)u(d)?l(d):(e.if((0,E_.propertyInData)(e,s,d,o.opts.ownProperties)),l(d),o.allErrors||e.else().var(c,!0),e.endIf()),t.it.definedProperties.add(d),t.ok(c);function u(d){return o.opts.useDefaults&&!o.compositeRule&&r[d].default!==void 0}function l(d){t.subschema({keyword:"properties",schemaProp:d,dataProp:d},c)}}};bd.default=yI});var O_=v(wd=>{"use strict";Object.defineProperty(wd,"__esModule",{value:!0});var C_=kt(),Aa=Q(),I_=ce(),R_=ce(),vI={keyword:"patternProperties",type:"object",schemaType:"object",code(t){let{gen:e,schema:r,data:n,parentSchema:s,it:o}=t,{opts:i}=o,a=(0,C_.allSchemaProperties)(r),c=a.filter(h=>(0,I_.alwaysValidSchema)(o,r[h]));if(a.length===0||c.length===a.length&&(!o.opts.unevaluated||o.props===!0))return;let u=i.strictSchema&&!i.allowMatchingProperties&&s.properties,l=e.name("valid");o.props!==!0&&!(o.props instanceof Aa.Name)&&(o.props=(0,R_.evaluatedPropsToName)(e,o.props));let{props:d}=o;f();function f(){for(let h of a)u&&p(h),o.allErrors?m(h):(e.var(l,!0),m(h),e.if(l))}function p(h){for(let g in u)new RegExp(h).test(g)&&(0,I_.checkStrictMode)(o,`property ${g} matches pattern ${h} (use allowMatchingProperties)`)}function m(h){e.forIn("key",n,g=>{e.if((0,Aa._)`${(0,C_.usePattern)(t,h)}.test(${g})`,()=>{let y=c.includes(h);y||t.subschema({keyword:"patternProperties",schemaProp:h,dataProp:g,dataPropType:R_.Type.Str},l),o.opts.unevaluated&&d!==!0?e.assign((0,Aa._)`${d}[${g}]`,!0):!y&&!o.allErrors&&e.if((0,Aa.not)(l),()=>e.break())})})}}};wd.default=vI});var N_=v($d=>{"use strict";Object.defineProperty($d,"__esModule",{value:!0});var _I=ce(),bI={keyword:"not",schemaType:["object","boolean"],trackErrors:!0,code(t){let{gen:e,schema:r,it:n}=t;if((0,_I.alwaysValidSchema)(n,r)){t.fail();return}let s=e.name("valid");t.subschema({keyword:"not",compositeRule:!0,createErrors:!1,allErrors:!1},s),t.failResult(s,()=>t.reset(),()=>t.error())},error:{message:"must NOT be valid"}};$d.default=bI});var j_=v(xd=>{"use strict";Object.defineProperty(xd,"__esModule",{value:!0});var wI=kt(),$I={keyword:"anyOf",schemaType:"array",trackErrors:!0,code:wI.validateUnion,error:{message:"must match a schema in anyOf"}};xd.default=$I});var A_=v(kd=>{"use strict";Object.defineProperty(kd,"__esModule",{value:!0});var Ma=Q(),xI=ce(),kI={message:"must match exactly one schema in oneOf",params:({params:t})=>(0,Ma._)`{passingSchemas: ${t.passing}}`},SI={keyword:"oneOf",schemaType:"array",trackErrors:!0,error:kI,code(t){let{gen:e,schema:r,parentSchema:n,it:s}=t;if(!Array.isArray(r))throw new Error("ajv implementation error");if(s.opts.discriminator&&n.discriminator)return;let o=r,i=e.let("valid",!1),a=e.let("passing",null),c=e.name("_valid");t.setParams({passing:a}),e.block(u),t.result(i,()=>t.reset(),()=>t.error(!0));function u(){o.forEach((l,d)=>{let f;(0,xI.alwaysValidSchema)(s,l)?e.var(c,!0):f=t.subschema({keyword:"oneOf",schemaProp:d,compositeRule:!0},c),d>0&&e.if((0,Ma._)`${c} && ${i}`).assign(i,!1).assign(a,(0,Ma._)`[${a}, ${d}]`).else(),e.if(c,()=>{e.assign(i,!0),e.assign(a,d),f&&t.mergeEvaluated(f,Ma.Name)})})}}};kd.default=SI});var M_=v(Sd=>{"use strict";Object.defineProperty(Sd,"__esModule",{value:!0});var PI=ce(),EI={keyword:"allOf",schemaType:"array",code(t){let{gen:e,schema:r,it:n}=t;if(!Array.isArray(r))throw new Error("ajv implementation error");let s=e.name("valid");r.forEach((o,i)=>{if((0,PI.alwaysValidSchema)(n,o))return;let a=t.subschema({keyword:"allOf",schemaProp:i},s);t.ok(s),t.mergeEvaluated(a)})}};Sd.default=EI});var Z_=v(Pd=>{"use strict";Object.defineProperty(Pd,"__esModule",{value:!0});var qa=Q(),D_=ce(),TI={message:({params:t})=>(0,qa.str)`must match "${t.ifClause}" schema`,params:({params:t})=>(0,qa._)`{failingKeyword: ${t.ifClause}}`},zI={keyword:"if",schemaType:["object","boolean"],trackErrors:!0,error:TI,code(t){let{gen:e,parentSchema:r,it:n}=t;r.then===void 0&&r.else===void 0&&(0,D_.checkStrictMode)(n,'"if" without "then" and "else" is ignored');let s=q_(n,"then"),o=q_(n,"else");if(!s&&!o)return;let i=e.let("valid",!0),a=e.name("_valid");if(c(),t.reset(),s&&o){let l=e.let("ifClause");t.setParams({ifClause:l}),e.if(a,u("then",l),u("else",l))}else s?e.if(a,u("then")):e.if((0,qa.not)(a),u("else"));t.pass(i,()=>t.error(!0));function c(){let l=t.subschema({keyword:"if",compositeRule:!0,createErrors:!1,allErrors:!1},a);t.mergeEvaluated(l)}function u(l,d){return()=>{let f=t.subschema({keyword:l},a);e.assign(i,a),t.mergeValidEvaluated(f,i),d?e.assign(d,(0,qa._)`${l}`):t.setParams({ifClause:l})}}}};function q_(t,e){let r=t.schema[e];return r!==void 0&&!(0,D_.alwaysValidSchema)(t,r)}Pd.default=zI});var L_=v(Ed=>{"use strict";Object.defineProperty(Ed,"__esModule",{value:!0});var CI=ce(),II={keyword:["then","else"],schemaType:["object","boolean"],code({keyword:t,parentSchema:e,it:r}){e.if===void 0&&(0,CI.checkStrictMode)(r,`"${t}" without "if" is ignored`)}};Ed.default=II});var V_=v(Td=>{"use strict";Object.defineProperty(Td,"__esModule",{value:!0});var RI=ld(),OI=v_(),NI=dd(),jI=b_(),AI=w_(),MI=k_(),qI=P_(),DI=vd(),ZI=z_(),LI=O_(),VI=N_(),FI=j_(),UI=A_(),HI=M_(),KI=Z_(),BI=L_();function GI(t=!1){let e=[VI.default,FI.default,UI.default,HI.default,KI.default,BI.default,qI.default,DI.default,MI.default,ZI.default,LI.default];return t?e.push(OI.default,jI.default):e.push(RI.default,NI.default),e.push(AI.default),e}Td.default=GI});var F_=v(zd=>{"use strict";Object.defineProperty(zd,"__esModule",{value:!0});var Re=Q(),WI={message:({schemaCode:t})=>(0,Re.str)`must match format "${t}"`,params:({schemaCode:t})=>(0,Re._)`{format: ${t}}`},JI={keyword:"format",type:["number","string"],schemaType:"string",$data:!0,error:WI,code(t,e){let{gen:r,data:n,$data:s,schema:o,schemaCode:i,it:a}=t,{opts:c,errSchemaPath:u,schemaEnv:l,self:d}=a;if(!c.validateFormats)return;s?f():p();function f(){let m=r.scopeValue("formats",{ref:d.formats,code:c.code.formats}),h=r.const("fDef",(0,Re._)`${m}[${i}]`),g=r.let("fType"),y=r.let("format");r.if((0,Re._)`typeof ${h} == "object" && !(${h} instanceof RegExp)`,()=>r.assign(g,(0,Re._)`${h}.type || "string"`).assign(y,(0,Re._)`${h}.validate`),()=>r.assign(g,(0,Re._)`"string"`).assign(y,h)),t.fail$data((0,Re.or)(x(),$()));function x(){return c.strictSchema===!1?Re.nil:(0,Re._)`${i} && !${y}`}function $(){let S=l.$async?(0,Re._)`(${h}.async ? await ${y}(${n}) : ${y}(${n}))`:(0,Re._)`${y}(${n})`,w=(0,Re._)`(typeof ${y} == "function" ? ${S} : ${y}.test(${n}))`;return(0,Re._)`${y} && ${y} !== true && ${g} === ${e} && !${w}`}}function p(){let m=d.formats[o];if(!m){x();return}if(m===!0)return;let[h,g,y]=$(m);h===e&&t.pass(S());function x(){if(c.strictSchema===!1){d.logger.warn(w());return}throw new Error(w());function w(){return`unknown format "${o}" ignored in schema at path "${u}"`}}function $(w){let D=w instanceof RegExp?(0,Re.regexpCode)(w):c.code.formats?(0,Re._)`${c.code.formats}${(0,Re.getProperty)(o)}`:void 0,F=r.scopeValue("formats",{key:o,ref:w,code:D});return typeof w=="object"&&!(w instanceof RegExp)?[w.type||"string",w.validate,(0,Re._)`${F}.validate`]:["string",w,F]}function S(){if(typeof m=="object"&&!(m instanceof RegExp)&&m.async){if(!l.$async)throw new Error("async format in sync schema");return(0,Re._)`await ${y}(${n})`}return typeof g=="function"?(0,Re._)`${y}(${n})`:(0,Re._)`${y}.test(${n})`}}}};zd.default=JI});var U_=v(Cd=>{"use strict";Object.defineProperty(Cd,"__esModule",{value:!0});var YI=F_(),QI=[YI.default];Cd.default=QI});var H_=v(ps=>{"use strict";Object.defineProperty(ps,"__esModule",{value:!0});ps.contentVocabulary=ps.metadataVocabulary=void 0;ps.metadataVocabulary=["title","description","default","deprecated","readOnly","writeOnly","examples"];ps.contentVocabulary=["contentMediaType","contentEncoding","contentSchema"]});var B_=v(Id=>{"use strict";Object.defineProperty(Id,"__esModule",{value:!0});var XI=e_(),eR=m_(),tR=V_(),rR=U_(),K_=H_(),nR=[XI.default,eR.default,(0,tR.default)(),rR.default,K_.metadataVocabulary,K_.contentVocabulary];Id.default=nR});var W_=v(Da=>{"use strict";Object.defineProperty(Da,"__esModule",{value:!0});Da.DiscrError=void 0;var G_;(function(t){t.Tag="tag",t.Mapping="mapping"})(G_||(Da.DiscrError=G_={}))});var Y_=v(Od=>{"use strict";Object.defineProperty(Od,"__esModule",{value:!0});var fs=Q(),Rd=W_(),J_=ba(),sR=ko(),oR=ce(),iR={message:({params:{discrError:t,tagName:e}})=>t===Rd.DiscrError.Tag?`tag "${e}" must be string`:`value of tag "${e}" must be in oneOf`,params:({params:{discrError:t,tag:e,tagName:r}})=>(0,fs._)`{error: ${t}, tag: ${r}, tagValue: ${e}}`},aR={keyword:"discriminator",type:"object",schemaType:"object",error:iR,code(t){let{gen:e,data:r,schema:n,parentSchema:s,it:o}=t,{oneOf:i}=s;if(!o.opts.discriminator)throw new Error("discriminator: requires discriminator option");let a=n.propertyName;if(typeof a!="string")throw new Error("discriminator: requires propertyName");if(n.mapping)throw new Error("discriminator: mapping is not supported");if(!i)throw new Error("discriminator: requires oneOf keyword");let c=e.let("valid",!1),u=e.const("tag",(0,fs._)`${r}${(0,fs.getProperty)(a)}`);e.if((0,fs._)`typeof ${u} == "string"`,()=>l(),()=>t.error(!1,{discrError:Rd.DiscrError.Tag,tag:u,tagName:a})),t.ok(c);function l(){let p=f();e.if(!1);for(let m in p)e.elseIf((0,fs._)`${u} === ${m}`),e.assign(c,d(p[m]));e.else(),t.error(!1,{discrError:Rd.DiscrError.Mapping,tag:u,tagName:a}),e.endIf()}function d(p){let m=e.name("valid"),h=t.subschema({keyword:"oneOf",schemaProp:p},m);return t.mergeEvaluated(h,fs.Name),m}function f(){var p;let m={},h=y(s),g=!0;for(let S=0;S<i.length;S++){let w=i[S];if(w?.$ref&&!(0,oR.schemaHasRulesButRef)(w,o.self.RULES)){let F=w.$ref;if(w=J_.resolveRef.call(o.self,o.schemaEnv.root,o.baseId,F),w instanceof J_.SchemaEnv&&(w=w.schema),w===void 0)throw new sR.default(o.opts.uriResolver,o.baseId,F)}let D=(p=w?.properties)===null||p===void 0?void 0:p[a];if(typeof D!="object")throw new Error(`discriminator: oneOf subschemas (or referenced schemas) must have "properties/${a}"`);g=g&&(h||y(w)),x(D,S)}if(!g)throw new Error(`discriminator: "${a}" must be required`);return m;function y({required:S}){return Array.isArray(S)&&S.includes(a)}function x(S,w){if(S.const)$(S.const,w);else if(S.enum)for(let D of S.enum)$(D,w);else throw new Error(`discriminator: "properties/${a}" must have "const" or "enum"`)}function $(S,w){if(typeof S!="string"||S in m)throw new Error(`discriminator: "${a}" values must be unique strings`);m[S]=w}}}};Od.default=aR});var Q_=v((mV,cR)=>{cR.exports={$schema:"http://json-schema.org/draft-07/schema#",$id:"http://json-schema.org/draft-07/schema#",title:"Core schema meta-schema",definitions:{schemaArray:{type:"array",minItems:1,items:{$ref:"#"}},nonNegativeInteger:{type:"integer",minimum:0},nonNegativeIntegerDefault0:{allOf:[{$ref:"#/definitions/nonNegativeInteger"},{default:0}]},simpleTypes:{enum:["array","boolean","integer","null","number","object","string"]},stringArray:{type:"array",items:{type:"string"},uniqueItems:!0,default:[]}},type:["object","boolean"],properties:{$id:{type:"string",format:"uri-reference"},$schema:{type:"string",format:"uri"},$ref:{type:"string",format:"uri-reference"},$comment:{type:"string"},title:{type:"string"},description:{type:"string"},default:!0,readOnly:{type:"boolean",default:!1},examples:{type:"array",items:!0},multipleOf:{type:"number",exclusiveMinimum:0},maximum:{type:"number"},exclusiveMaximum:{type:"number"},minimum:{type:"number"},exclusiveMinimum:{type:"number"},maxLength:{$ref:"#/definitions/nonNegativeInteger"},minLength:{$ref:"#/definitions/nonNegativeIntegerDefault0"},pattern:{type:"string",format:"regex"},additionalItems:{$ref:"#"},items:{anyOf:[{$ref:"#"},{$ref:"#/definitions/schemaArray"}],default:!0},maxItems:{$ref:"#/definitions/nonNegativeInteger"},minItems:{$ref:"#/definitions/nonNegativeIntegerDefault0"},uniqueItems:{type:"boolean",default:!1},contains:{$ref:"#"},maxProperties:{$ref:"#/definitions/nonNegativeInteger"},minProperties:{$ref:"#/definitions/nonNegativeIntegerDefault0"},required:{$ref:"#/definitions/stringArray"},additionalProperties:{$ref:"#"},definitions:{type:"object",additionalProperties:{$ref:"#"},default:{}},properties:{type:"object",additionalProperties:{$ref:"#"},default:{}},patternProperties:{type:"object",additionalProperties:{$ref:"#"},propertyNames:{format:"regex"},default:{}},dependencies:{type:"object",additionalProperties:{anyOf:[{$ref:"#"},{$ref:"#/definitions/stringArray"}]}},propertyNames:{$ref:"#"},const:!0,enum:{type:"array",items:!0,minItems:1,uniqueItems:!0},type:{anyOf:[{$ref:"#/definitions/simpleTypes"},{type:"array",items:{$ref:"#/definitions/simpleTypes"},minItems:1,uniqueItems:!0}]},format:{type:"string"},contentMediaType:{type:"string"},contentEncoding:{type:"string"},if:{$ref:"#"},then:{$ref:"#"},else:{$ref:"#"},allOf:{$ref:"#/definitions/schemaArray"},anyOf:{$ref:"#/definitions/schemaArray"},oneOf:{$ref:"#/definitions/schemaArray"},not:{$ref:"#"}},default:!0}});var e0=v((Se,Nd)=>{"use strict";Object.defineProperty(Se,"__esModule",{value:!0});Se.MissingRefError=Se.ValidationError=Se.CodeGen=Se.Name=Se.nil=Se.stringify=Se.str=Se._=Se.KeywordCxt=Se.Ajv=void 0;var uR=Gv(),lR=B_(),dR=Y_(),X_=Q_(),pR=["/properties"],Za="http://json-schema.org/draft-07/schema",ms=class extends uR.default{_addVocabularies(){super._addVocabularies(),lR.default.forEach(e=>this.addVocabulary(e)),this.opts.discriminator&&this.addKeyword(dR.default)}_addDefaultMetaSchema(){if(super._addDefaultMetaSchema(),!this.opts.meta)return;let e=this.opts.$data?this.$dataMetaSchema(X_,pR):X_;this.addMetaSchema(e,Za,!1),this.refs["http://json-schema.org/schema"]=Za}defaultMeta(){return this.opts.defaultMeta=super.defaultMeta()||(this.getSchema(Za)?Za:void 0)}};Se.Ajv=ms;Nd.exports=Se=ms;Nd.exports.Ajv=ms;Object.defineProperty(Se,"__esModule",{value:!0});Se.default=ms;var fR=xo();Object.defineProperty(Se,"KeywordCxt",{enumerable:!0,get:function(){return fR.KeywordCxt}});var hs=Q();Object.defineProperty(Se,"_",{enumerable:!0,get:function(){return hs._}});Object.defineProperty(Se,"str",{enumerable:!0,get:function(){return hs.str}});Object.defineProperty(Se,"stringify",{enumerable:!0,get:function(){return hs.stringify}});Object.defineProperty(Se,"nil",{enumerable:!0,get:function(){return hs.nil}});Object.defineProperty(Se,"Name",{enumerable:!0,get:function(){return hs.Name}});Object.defineProperty(Se,"CodeGen",{enumerable:!0,get:function(){return hs.CodeGen}});var mR=va();Object.defineProperty(Se,"ValidationError",{enumerable:!0,get:function(){return mR.default}});var hR=ko();Object.defineProperty(Se,"MissingRefError",{enumerable:!0,get:function(){return hR.default}})});var c0=v(rr=>{"use strict";Object.defineProperty(rr,"__esModule",{value:!0});rr.formatNames=rr.fastFormats=rr.fullFormats=void 0;function tr(t,e){return{validate:t,compare:e}}rr.fullFormats={date:tr(s0,qd),time:tr(Ad(!0),Dd),"date-time":tr(t0(!0),i0),"iso-time":tr(Ad(),o0),"iso-date-time":tr(t0(),a0),duration:/^P(?!$)((\d+Y)?(\d+M)?(\d+D)?(T(?=\d)(\d+H)?(\d+M)?(\d+S)?)?|(\d+W)?)$/,uri:wR,"uri-reference":/^(?:[a-z][a-z0-9+\-.]*:)?(?:\/?\/(?:(?:[a-z0-9\-._~!$&'()*+,;=:]|%[0-9a-f]{2})*@)?(?:\[(?:(?:(?:(?:[0-9a-f]{1,4}:){6}|::(?:[0-9a-f]{1,4}:){5}|(?:[0-9a-f]{1,4})?::(?:[0-9a-f]{1,4}:){4}|(?:(?:[0-9a-f]{1,4}:){0,1}[0-9a-f]{1,4})?::(?:[0-9a-f]{1,4}:){3}|(?:(?:[0-9a-f]{1,4}:){0,2}[0-9a-f]{1,4})?::(?:[0-9a-f]{1,4}:){2}|(?:(?:[0-9a-f]{1,4}:){0,3}[0-9a-f]{1,4})?::[0-9a-f]{1,4}:|(?:(?:[0-9a-f]{1,4}:){0,4}[0-9a-f]{1,4})?::)(?:[0-9a-f]{1,4}:[0-9a-f]{1,4}|(?:(?:25[0-5]|2[0-4]\d|[01]?\d\d?)\.){3}(?:25[0-5]|2[0-4]\d|[01]?\d\d?))|(?:(?:[0-9a-f]{1,4}:){0,5}[0-9a-f]{1,4})?::[0-9a-f]{1,4}|(?:(?:[0-9a-f]{1,4}:){0,6}[0-9a-f]{1,4})?::)|[Vv][0-9a-f]+\.[a-z0-9\-._~!$&'()*+,;=:]+)\]|(?:(?:25[0-5]|2[0-4]\d|[01]?\d\d?)\.){3}(?:25[0-5]|2[0-4]\d|[01]?\d\d?)|(?:[a-z0-9\-._~!$&'"()*+,;=]|%[0-9a-f]{2})*)(?::\d*)?(?:\/(?:[a-z0-9\-._~!$&'"()*+,;=:@]|%[0-9a-f]{2})*)*|\/(?:(?:[a-z0-9\-._~!$&'"()*+,;=:@]|%[0-9a-f]{2})+(?:\/(?:[a-z0-9\-._~!$&'"()*+,;=:@]|%[0-9a-f]{2})*)*)?|(?:[a-z0-9\-._~!$&'"()*+,;=:@]|%[0-9a-f]{2})+(?:\/(?:[a-z0-9\-._~!$&'"()*+,;=:@]|%[0-9a-f]{2})*)*)?(?:\?(?:[a-z0-9\-._~!$&'"()*+,;=:@/?]|%[0-9a-f]{2})*)?(?:#(?:[a-z0-9\-._~!$&'"()*+,;=:@/?]|%[0-9a-f]{2})*)?$/i,"uri-template":/^(?:(?:[^\x00-\x20"'<>%\\^`{|}]|%[0-9a-f]{2})|\{[+#./;?&=,!@|]?(?:[a-z0-9_]|%[0-9a-f]{2})+(?::[1-9][0-9]{0,3}|\*)?(?:,(?:[a-z0-9_]|%[0-9a-f]{2})+(?::[1-9][0-9]{0,3}|\*)?)*\})*$/i,url:/^(?:https?|ftp):\/\/(?:\S+(?::\S*)?@)?(?:(?!(?:10|127)(?:\.\d{1,3}){3})(?!(?:169\.254|192\.168)(?:\.\d{1,3}){2})(?!172\.(?:1[6-9]|2\d|3[0-1])(?:\.\d{1,3}){2})(?:[1-9]\d?|1\d\d|2[01]\d|22[0-3])(?:\.(?:1?\d{1,2}|2[0-4]\d|25[0-5])){2}(?:\.(?:[1-9]\d?|1\d\d|2[0-4]\d|25[0-4]))|(?:(?:[a-z0-9\u{00a1}-\u{ffff}]+-)*[a-z0-9\u{00a1}-\u{ffff}]+)(?:\.(?:[a-z0-9\u{00a1}-\u{ffff}]+-)*[a-z0-9\u{00a1}-\u{ffff}]+)*(?:\.(?:[a-z\u{00a1}-\u{ffff}]{2,})))(?::\d{2,5})?(?:\/[^\s]*)?$/iu,email:/^[a-z0-9!#$%&'*+/=?^_`{|}~-]+(?:\.[a-z0-9!#$%&'*+/=?^_`{|}~-]+)*@(?:[a-z0-9](?:[a-z0-9-]*[a-z0-9])?\.)+[a-z0-9](?:[a-z0-9-]*[a-z0-9])?$/i,hostname:/^(?=.{1,253}\.?$)[a-z0-9](?:[a-z0-9-]{0,61}[a-z0-9])?(?:\.[a-z0-9](?:[-0-9a-z]{0,61}[0-9a-z])?)*\.?$/i,ipv4:/^(?:(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)\.){3}(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)$/,ipv6:/^((([0-9a-f]{1,4}:){7}([0-9a-f]{1,4}|:))|(([0-9a-f]{1,4}:){6}(:[0-9a-f]{1,4}|((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3})|:))|(([0-9a-f]{1,4}:){5}(((:[0-9a-f]{1,4}){1,2})|:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3})|:))|(([0-9a-f]{1,4}:){4}(((:[0-9a-f]{1,4}){1,3})|((:[0-9a-f]{1,4})?:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(([0-9a-f]{1,4}:){3}(((:[0-9a-f]{1,4}){1,4})|((:[0-9a-f]{1,4}){0,2}:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(([0-9a-f]{1,4}:){2}(((:[0-9a-f]{1,4}){1,5})|((:[0-9a-f]{1,4}){0,3}:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(([0-9a-f]{1,4}:){1}(((:[0-9a-f]{1,4}){1,6})|((:[0-9a-f]{1,4}){0,4}:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(:(((:[0-9a-f]{1,4}){1,7})|((:[0-9a-f]{1,4}){0,5}:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:)))$/i,regex:TR,uuid:/^(?:urn:uuid:)?[0-9a-f]{8}-(?:[0-9a-f]{4}-){3}[0-9a-f]{12}$/i,"json-pointer":/^(?:\/(?:[^~/]|~0|~1)*)*$/,"json-pointer-uri-fragment":/^#(?:\/(?:[a-z0-9_\-.!$&'()*+,;:=@]|%[0-9a-f]{2}|~0|~1)*)*$/i,"relative-json-pointer":/^(?:0|[1-9][0-9]*)(?:#|(?:\/(?:[^~/]|~0|~1)*)*)$/,byte:$R,int32:{type:"number",validate:SR},int64:{type:"number",validate:PR},float:{type:"number",validate:n0},double:{type:"number",validate:n0},password:!0,binary:!0};rr.fastFormats={...rr.fullFormats,date:tr(/^\d\d\d\d-[0-1]\d-[0-3]\d$/,qd),time:tr(/^(?:[0-2]\d:[0-5]\d:[0-5]\d|23:59:60)(?:\.\d+)?(?:z|[+-]\d\d(?::?\d\d)?)$/i,Dd),"date-time":tr(/^\d\d\d\d-[0-1]\d-[0-3]\dt(?:[0-2]\d:[0-5]\d:[0-5]\d|23:59:60)(?:\.\d+)?(?:z|[+-]\d\d(?::?\d\d)?)$/i,i0),"iso-time":tr(/^(?:[0-2]\d:[0-5]\d:[0-5]\d|23:59:60)(?:\.\d+)?(?:z|[+-]\d\d(?::?\d\d)?)?$/i,o0),"iso-date-time":tr(/^\d\d\d\d-[0-1]\d-[0-3]\d[t\s](?:[0-2]\d:[0-5]\d:[0-5]\d|23:59:60)(?:\.\d+)?(?:z|[+-]\d\d(?::?\d\d)?)?$/i,a0),uri:/^(?:[a-z][a-z0-9+\-.]*:)(?:\/?\/)?[^\s]*$/i,"uri-reference":/^(?:(?:[a-z][a-z0-9+\-.]*:)?\/?\/)?(?:[^\\\s#][^\s#]*)?(?:#[^\\\s]*)?$/i,email:/^[a-z0-9.!#$%&'*+/=?^_`{|}~-]+@[a-z0-9](?:[a-z0-9-]{0,61}[a-z0-9])?(?:\.[a-z0-9](?:[a-z0-9-]{0,61}[a-z0-9])?)*$/i};rr.formatNames=Object.keys(rr.fullFormats);function gR(t){return t%4===0&&(t%100!==0||t%400===0)}var yR=/^(\d\d\d\d)-(\d\d)-(\d\d)$/,vR=[0,31,28,31,30,31,30,31,31,30,31,30,31];function s0(t){let e=yR.exec(t);if(!e)return!1;let r=+e[1],n=+e[2],s=+e[3];return n>=1&&n<=12&&s>=1&&s<=(n===2&&gR(r)?29:vR[n])}function qd(t,e){if(t&&e)return t>e?1:t<e?-1:0}var jd=/^(\d\d):(\d\d):(\d\d(?:\.\d+)?)(z|([+-])(\d\d)(?::?(\d\d))?)?$/i;function Ad(t){return function(r){let n=jd.exec(r);if(!n)return!1;let s=+n[1],o=+n[2],i=+n[3],a=n[4],c=n[5]==="-"?-1:1,u=+(n[6]||0),l=+(n[7]||0);if(u>23||l>59||t&&!a)return!1;if(s<=23&&o<=59&&i<60)return!0;let d=o-l*c,f=s-u*c-(d<0?1:0);return(f===23||f===-1)&&(d===59||d===-1)&&i<61}}function Dd(t,e){if(!(t&&e))return;let r=new Date("2020-01-01T"+t).valueOf(),n=new Date("2020-01-01T"+e).valueOf();if(r&&n)return r-n}function o0(t,e){if(!(t&&e))return;let r=jd.exec(t),n=jd.exec(e);if(r&&n)return t=r[1]+r[2]+r[3],e=n[1]+n[2]+n[3],t>e?1:t<e?-1:0}var Md=/t|\s/i;function t0(t){let e=Ad(t);return function(n){let s=n.split(Md);return s.length===2&&s0(s[0])&&e(s[1])}}function i0(t,e){if(!(t&&e))return;let r=new Date(t).valueOf(),n=new Date(e).valueOf();if(r&&n)return r-n}function a0(t,e){if(!(t&&e))return;let[r,n]=t.split(Md),[s,o]=e.split(Md),i=qd(r,s);if(i!==void 0)return i||Dd(n,o)}var _R=/\/|:/,bR=/^(?:[a-z][a-z0-9+\-.]*:)(?:\/?\/(?:(?:[a-z0-9\-._~!$&'()*+,;=:]|%[0-9a-f]{2})*@)?(?:\[(?:(?:(?:(?:[0-9a-f]{1,4}:){6}|::(?:[0-9a-f]{1,4}:){5}|(?:[0-9a-f]{1,4})?::(?:[0-9a-f]{1,4}:){4}|(?:(?:[0-9a-f]{1,4}:){0,1}[0-9a-f]{1,4})?::(?:[0-9a-f]{1,4}:){3}|(?:(?:[0-9a-f]{1,4}:){0,2}[0-9a-f]{1,4})?::(?:[0-9a-f]{1,4}:){2}|(?:(?:[0-9a-f]{1,4}:){0,3}[0-9a-f]{1,4})?::[0-9a-f]{1,4}:|(?:(?:[0-9a-f]{1,4}:){0,4}[0-9a-f]{1,4})?::)(?:[0-9a-f]{1,4}:[0-9a-f]{1,4}|(?:(?:25[0-5]|2[0-4]\d|[01]?\d\d?)\.){3}(?:25[0-5]|2[0-4]\d|[01]?\d\d?))|(?:(?:[0-9a-f]{1,4}:){0,5}[0-9a-f]{1,4})?::[0-9a-f]{1,4}|(?:(?:[0-9a-f]{1,4}:){0,6}[0-9a-f]{1,4})?::)|[Vv][0-9a-f]+\.[a-z0-9\-._~!$&'()*+,;=:]+)\]|(?:(?:25[0-5]|2[0-4]\d|[01]?\d\d?)\.){3}(?:25[0-5]|2[0-4]\d|[01]?\d\d?)|(?:[a-z0-9\-._~!$&'()*+,;=]|%[0-9a-f]{2})*)(?::\d*)?(?:\/(?:[a-z0-9\-._~!$&'()*+,;=:@]|%[0-9a-f]{2})*)*|\/(?:(?:[a-z0-9\-._~!$&'()*+,;=:@]|%[0-9a-f]{2})+(?:\/(?:[a-z0-9\-._~!$&'()*+,;=:@]|%[0-9a-f]{2})*)*)?|(?:[a-z0-9\-._~!$&'()*+,;=:@]|%[0-9a-f]{2})+(?:\/(?:[a-z0-9\-._~!$&'()*+,;=:@]|%[0-9a-f]{2})*)*)(?:\?(?:[a-z0-9\-._~!$&'()*+,;=:@/?]|%[0-9a-f]{2})*)?(?:#(?:[a-z0-9\-._~!$&'()*+,;=:@/?]|%[0-9a-f]{2})*)?$/i;function wR(t){return _R.test(t)&&bR.test(t)}var r0=/^(?:[A-Za-z0-9+/]{4})*(?:[A-Za-z0-9+/]{2}==|[A-Za-z0-9+/]{3}=)?$/gm;function $R(t){return r0.lastIndex=0,r0.test(t)}var xR=-(2**31),kR=2**31-1;function SR(t){return Number.isInteger(t)&&t<=kR&&t>=xR}function PR(t){return Number.isInteger(t)}function n0(){return!0}var ER=/[^\\]\\Z/;function TR(t){if(ER.test(t))return!1;try{return new RegExp(t),!0}catch{return!1}}});var Zo=v(ue=>{"use strict";Object.defineProperty(ue,"__esModule",{value:!0});ue.regexpCode=ue.getEsmExportName=ue.getProperty=ue.safeStringify=ue.stringify=ue.strConcat=ue.addCodeArg=ue.str=ue._=ue.nil=ue._Code=ue.Name=ue.IDENTIFIER=ue._CodeOrName=void 0;var qo=class{};ue._CodeOrName=qo;ue.IDENTIFIER=/^[a-z$_][a-z$_0-9]*$/i;var Cn=class extends qo{constructor(e){if(super(),!ue.IDENTIFIER.test(e))throw new Error("CodeGen: name must be a valid identifier");this.str=e}toString(){return this.str}emptyStr(){return!1}get names(){return{[this.str]:1}}};ue.Name=Cn;var Et=class extends qo{constructor(e){super(),this._items=typeof e=="string"?[e]:e}toString(){return this.str}emptyStr(){if(this._items.length>1)return!1;let e=this._items[0];return e===""||e==='""'}get str(){var e;return(e=this._str)!==null&&e!==void 0?e:this._str=this._items.reduce((r,n)=>`${r}${n}`,"")}get names(){var e;return(e=this._names)!==null&&e!==void 0?e:this._names=this._items.reduce((r,n)=>(n instanceof Cn&&(r[n.str]=(r[n.str]||0)+1),r),{})}};ue._Code=Et;ue.nil=new Et("");function u0(t,...e){let r=[t[0]],n=0;for(;n<e.length;)Ld(r,e[n]),r.push(t[++n]);return new Et(r)}ue._=u0;var Zd=new Et("+");function l0(t,...e){let r=[Do(t[0])],n=0;for(;n<e.length;)r.push(Zd),Ld(r,e[n]),r.push(Zd,Do(t[++n]));return zR(r),new Et(r)}ue.str=l0;function Ld(t,e){e instanceof Et?t.push(...e._items):e instanceof Cn?t.push(e):t.push(RR(e))}ue.addCodeArg=Ld;function zR(t){let e=1;for(;e<t.length-1;){if(t[e]===Zd){let r=CR(t[e-1],t[e+1]);if(r!==void 0){t.splice(e-1,3,r);continue}t[e++]="+"}e++}}function CR(t,e){if(e==='""')return t;if(t==='""')return e;if(typeof t=="string")return e instanceof Cn||t[t.length-1]!=='"'?void 0:typeof e!="string"?`${t.slice(0,-1)}${e}"`:e[0]==='"'?t.slice(0,-1)+e.slice(1):void 0;if(typeof e=="string"&&e[0]==='"'&&!(t instanceof Cn))return`"${t}${e.slice(1)}`}function IR(t,e){return e.emptyStr()?t:t.emptyStr()?e:l0`${t}${e}`}ue.strConcat=IR;function RR(t){return typeof t=="number"||typeof t=="boolean"||t===null?t:Do(Array.isArray(t)?t.join(","):t)}function OR(t){return new Et(Do(t))}ue.stringify=OR;function Do(t){return JSON.stringify(t).replace(/\u2028/g,"\\u2028").replace(/\u2029/g,"\\u2029")}ue.safeStringify=Do;function NR(t){return typeof t=="string"&&ue.IDENTIFIER.test(t)?new Et(`.${t}`):u0`[${t}]`}ue.getProperty=NR;function jR(t){if(typeof t=="string"&&ue.IDENTIFIER.test(t))return new Et(`${t}`);throw new Error(`CodeGen: invalid export name: ${t}, use explicit $id name mapping`)}ue.getEsmExportName=jR;function AR(t){return new Et(t.toString())}ue.regexpCode=AR});var Ud=v(mt=>{"use strict";Object.defineProperty(mt,"__esModule",{value:!0});mt.ValueScope=mt.ValueScopeName=mt.Scope=mt.varKinds=mt.UsedValueState=void 0;var ft=Zo(),Vd=class extends Error{constructor(e){super(`CodeGen: "code" for ${e} not defined`),this.value=e.value}},La;(function(t){t[t.Started=0]="Started",t[t.Completed=1]="Completed"})(La||(mt.UsedValueState=La={}));mt.varKinds={const:new ft.Name("const"),let:new ft.Name("let"),var:new ft.Name("var")};var Va=class{constructor({prefixes:e,parent:r}={}){this._names={},this._prefixes=e,this._parent=r}toName(e){return e instanceof ft.Name?e:this.name(e)}name(e){return new ft.Name(this._newName(e))}_newName(e){let r=this._names[e]||this._nameGroup(e);return`${e}${r.index++}`}_nameGroup(e){var r,n;if(!((n=(r=this._parent)===null||r===void 0?void 0:r._prefixes)===null||n===void 0)&&n.has(e)||this._prefixes&&!this._prefixes.has(e))throw new Error(`CodeGen: prefix "${e}" is not allowed in this scope`);return this._names[e]={prefix:e,index:0}}};mt.Scope=Va;var Fa=class extends ft.Name{constructor(e,r){super(r),this.prefix=e}setValue(e,{property:r,itemIndex:n}){this.value=e,this.scopePath=(0,ft._)`.${new ft.Name(r)}[${n}]`}};mt.ValueScopeName=Fa;var MR=(0,ft._)`\n`,Fd=class extends Va{constructor(e){super(e),this._values={},this._scope=e.scope,this.opts={...e,_n:e.lines?MR:ft.nil}}get(){return this._scope}name(e){return new Fa(e,this._newName(e))}value(e,r){var n;if(r.ref===void 0)throw new Error("CodeGen: ref must be passed in value");let s=this.toName(e),{prefix:o}=s,i=(n=r.key)!==null&&n!==void 0?n:r.ref,a=this._values[o];if(a){let l=a.get(i);if(l)return l}else a=this._values[o]=new Map;a.set(i,s);let c=this._scope[o]||(this._scope[o]=[]),u=c.length;return c[u]=r.ref,s.setValue(r,{property:o,itemIndex:u}),s}getValue(e,r){let n=this._values[e];if(n)return n.get(r)}scopeRefs(e,r=this._values){return this._reduceValues(r,n=>{if(n.scopePath===void 0)throw new Error(`CodeGen: name "${n}" has no value`);return(0,ft._)`${e}${n.scopePath}`})}scopeCode(e=this._values,r,n){return this._reduceValues(e,s=>{if(s.value===void 0)throw new Error(`CodeGen: name "${s}" has no value`);return s.value.code},r,n)}_reduceValues(e,r,n={},s){let o=ft.nil;for(let i in e){let a=e[i];if(!a)continue;let c=n[i]=n[i]||new Map;a.forEach(u=>{if(c.has(u))return;c.set(u,La.Started);let l=r(u);if(l){let d=this.opts.es5?mt.varKinds.var:mt.varKinds.const;o=(0,ft._)`${o}${d} ${u} = ${l};${this.opts._n}`}else if(l=s?.(u))o=(0,ft._)`${o}${l}${this.opts._n}`;else throw new Vd(u);c.set(u,La.Completed)})}return o}};mt.ValueScope=Fd});var W=v(Y=>{"use strict";Object.defineProperty(Y,"__esModule",{value:!0});Y.or=Y.and=Y.not=Y.CodeGen=Y.operators=Y.varKinds=Y.ValueScopeName=Y.ValueScope=Y.Scope=Y.Name=Y.regexpCode=Y.stringify=Y.getProperty=Y.nil=Y.strConcat=Y.str=Y._=void 0;var se=Zo(),qt=Ud(),Zr=Zo();Object.defineProperty(Y,"_",{enumerable:!0,get:function(){return Zr._}});Object.defineProperty(Y,"str",{enumerable:!0,get:function(){return Zr.str}});Object.defineProperty(Y,"strConcat",{enumerable:!0,get:function(){return Zr.strConcat}});Object.defineProperty(Y,"nil",{enumerable:!0,get:function(){return Zr.nil}});Object.defineProperty(Y,"getProperty",{enumerable:!0,get:function(){return Zr.getProperty}});Object.defineProperty(Y,"stringify",{enumerable:!0,get:function(){return Zr.stringify}});Object.defineProperty(Y,"regexpCode",{enumerable:!0,get:function(){return Zr.regexpCode}});Object.defineProperty(Y,"Name",{enumerable:!0,get:function(){return Zr.Name}});var Ba=Ud();Object.defineProperty(Y,"Scope",{enumerable:!0,get:function(){return Ba.Scope}});Object.defineProperty(Y,"ValueScope",{enumerable:!0,get:function(){return Ba.ValueScope}});Object.defineProperty(Y,"ValueScopeName",{enumerable:!0,get:function(){return Ba.ValueScopeName}});Object.defineProperty(Y,"varKinds",{enumerable:!0,get:function(){return Ba.varKinds}});Y.operators={GT:new se._Code(">"),GTE:new se._Code(">="),LT:new se._Code("<"),LTE:new se._Code("<="),EQ:new se._Code("==="),NEQ:new se._Code("!=="),NOT:new se._Code("!"),OR:new se._Code("||"),AND:new se._Code("&&"),ADD:new se._Code("+")};var _r=class{optimizeNodes(){return this}optimizeNames(e,r){return this}},Hd=class extends _r{constructor(e,r,n){super(),this.varKind=e,this.name=r,this.rhs=n}render({es5:e,_n:r}){let n=e?qt.varKinds.var:this.varKind,s=this.rhs===void 0?"":` = ${this.rhs}`;return`${n} ${this.name}${s};`+r}optimizeNames(e,r){if(e[this.name.str])return this.rhs&&(this.rhs=ys(this.rhs,e,r)),this}get names(){return this.rhs instanceof se._CodeOrName?this.rhs.names:{}}},Ua=class extends _r{constructor(e,r,n){super(),this.lhs=e,this.rhs=r,this.sideEffects=n}render({_n:e}){return`${this.lhs} = ${this.rhs};`+e}optimizeNames(e,r){if(!(this.lhs instanceof se.Name&&!e[this.lhs.str]&&!this.sideEffects))return this.rhs=ys(this.rhs,e,r),this}get names(){let e=this.lhs instanceof se.Name?{}:{...this.lhs.names};return Ka(e,this.rhs)}},Kd=class extends Ua{constructor(e,r,n,s){super(e,n,s),this.op=r}render({_n:e}){return`${this.lhs} ${this.op}= ${this.rhs};`+e}},Bd=class extends _r{constructor(e){super(),this.label=e,this.names={}}render({_n:e}){return`${this.label}:`+e}},Gd=class extends _r{constructor(e){super(),this.label=e,this.names={}}render({_n:e}){return`break${this.label?` ${this.label}`:""};`+e}},Wd=class extends _r{constructor(e){super(),this.error=e}render({_n:e}){return`throw ${this.error};`+e}get names(){return this.error.names}},Jd=class extends _r{constructor(e){super(),this.code=e}render({_n:e}){return`${this.code};`+e}optimizeNodes(){return`${this.code}`?this:void 0}optimizeNames(e,r){return this.code=ys(this.code,e,r),this}get names(){return this.code instanceof se._CodeOrName?this.code.names:{}}},Lo=class extends _r{constructor(e=[]){super(),this.nodes=e}render(e){return this.nodes.reduce((r,n)=>r+n.render(e),"")}optimizeNodes(){let{nodes:e}=this,r=e.length;for(;r--;){let n=e[r].optimizeNodes();Array.isArray(n)?e.splice(r,1,...n):n?e[r]=n:e.splice(r,1)}return e.length>0?this:void 0}optimizeNames(e,r){let{nodes:n}=this,s=n.length;for(;s--;){let o=n[s];o.optimizeNames(e,r)||(qR(e,o.names),n.splice(s,1))}return n.length>0?this:void 0}get names(){return this.nodes.reduce((e,r)=>On(e,r.names),{})}},br=class extends Lo{render(e){return"{"+e._n+super.render(e)+"}"+e._n}},Yd=class extends Lo{},gs=class extends br{};gs.kind="else";var In=class t extends br{constructor(e,r){super(r),this.condition=e}render(e){let r=`if(${this.condition})`+super.render(e);return this.else&&(r+="else "+this.else.render(e)),r}optimizeNodes(){super.optimizeNodes();let e=this.condition;if(e===!0)return this.nodes;let r=this.else;if(r){let n=r.optimizeNodes();r=this.else=Array.isArray(n)?new gs(n):n}if(r)return e===!1?r instanceof t?r:r.nodes:this.nodes.length?this:new t(d0(e),r instanceof t?[r]:r.nodes);if(!(e===!1||!this.nodes.length))return this}optimizeNames(e,r){var n;if(this.else=(n=this.else)===null||n===void 0?void 0:n.optimizeNames(e,r),!!(super.optimizeNames(e,r)||this.else))return this.condition=ys(this.condition,e,r),this}get names(){let e=super.names;return Ka(e,this.condition),this.else&&On(e,this.else.names),e}};In.kind="if";var Rn=class extends br{};Rn.kind="for";var Qd=class extends Rn{constructor(e){super(),this.iteration=e}render(e){return`for(${this.iteration})`+super.render(e)}optimizeNames(e,r){if(super.optimizeNames(e,r))return this.iteration=ys(this.iteration,e,r),this}get names(){return On(super.names,this.iteration.names)}},Xd=class extends Rn{constructor(e,r,n,s){super(),this.varKind=e,this.name=r,this.from=n,this.to=s}render(e){let r=e.es5?qt.varKinds.var:this.varKind,{name:n,from:s,to:o}=this;return`for(${r} ${n}=${s}; ${n}<${o}; ${n}++)`+super.render(e)}get names(){let e=Ka(super.names,this.from);return Ka(e,this.to)}},Ha=class extends Rn{constructor(e,r,n,s){super(),this.loop=e,this.varKind=r,this.name=n,this.iterable=s}render(e){return`for(${this.varKind} ${this.name} ${this.loop} ${this.iterable})`+super.render(e)}optimizeNames(e,r){if(super.optimizeNames(e,r))return this.iterable=ys(this.iterable,e,r),this}get names(){return On(super.names,this.iterable.names)}},Vo=class extends br{constructor(e,r,n){super(),this.name=e,this.args=r,this.async=n}render(e){return`${this.async?"async ":""}function ${this.name}(${this.args})`+super.render(e)}};Vo.kind="func";var Fo=class extends Lo{render(e){return"return "+super.render(e)}};Fo.kind="return";var ep=class extends br{render(e){let r="try"+super.render(e);return this.catch&&(r+=this.catch.render(e)),this.finally&&(r+=this.finally.render(e)),r}optimizeNodes(){var e,r;return super.optimizeNodes(),(e=this.catch)===null||e===void 0||e.optimizeNodes(),(r=this.finally)===null||r===void 0||r.optimizeNodes(),this}optimizeNames(e,r){var n,s;return super.optimizeNames(e,r),(n=this.catch)===null||n===void 0||n.optimizeNames(e,r),(s=this.finally)===null||s===void 0||s.optimizeNames(e,r),this}get names(){let e=super.names;return this.catch&&On(e,this.catch.names),this.finally&&On(e,this.finally.names),e}},Uo=class extends br{constructor(e){super(),this.error=e}render(e){return`catch(${this.error})`+super.render(e)}};Uo.kind="catch";var Ho=class extends br{render(e){return"finally"+super.render(e)}};Ho.kind="finally";var tp=class{constructor(e,r={}){this._values={},this._blockStarts=[],this._constants={},this.opts={...r,_n:r.lines?`
`:""},this._extScope=e,this._scope=new qt.Scope({parent:e}),this._nodes=[new Yd]}toString(){return this._root.render(this.opts)}name(e){return this._scope.name(e)}scopeName(e){return this._extScope.name(e)}scopeValue(e,r){let n=this._extScope.value(e,r);return(this._values[n.prefix]||(this._values[n.prefix]=new Set)).add(n),n}getScopeValue(e,r){return this._extScope.getValue(e,r)}scopeRefs(e){return this._extScope.scopeRefs(e,this._values)}scopeCode(){return this._extScope.scopeCode(this._values)}_def(e,r,n,s){let o=this._scope.toName(r);return n!==void 0&&s&&(this._constants[o.str]=n),this._leafNode(new Hd(e,o,n)),o}const(e,r,n){return this._def(qt.varKinds.const,e,r,n)}let(e,r,n){return this._def(qt.varKinds.let,e,r,n)}var(e,r,n){return this._def(qt.varKinds.var,e,r,n)}assign(e,r,n){return this._leafNode(new Ua(e,r,n))}add(e,r){return this._leafNode(new Kd(e,Y.operators.ADD,r))}code(e){return typeof e=="function"?e():e!==se.nil&&this._leafNode(new Jd(e)),this}object(...e){let r=["{"];for(let[n,s]of e)r.length>1&&r.push(","),r.push(n),(n!==s||this.opts.es5)&&(r.push(":"),(0,se.addCodeArg)(r,s));return r.push("}"),new se._Code(r)}if(e,r,n){if(this._blockNode(new In(e)),r&&n)this.code(r).else().code(n).endIf();else if(r)this.code(r).endIf();else if(n)throw new Error('CodeGen: "else" body without "then" body');return this}elseIf(e){return this._elseNode(new In(e))}else(){return this._elseNode(new gs)}endIf(){return this._endBlockNode(In,gs)}_for(e,r){return this._blockNode(e),r&&this.code(r).endFor(),this}for(e,r){return this._for(new Qd(e),r)}forRange(e,r,n,s,o=this.opts.es5?qt.varKinds.var:qt.varKinds.let){let i=this._scope.toName(e);return this._for(new Xd(o,i,r,n),()=>s(i))}forOf(e,r,n,s=qt.varKinds.const){let o=this._scope.toName(e);if(this.opts.es5){let i=r instanceof se.Name?r:this.var("_arr",r);return this.forRange("_i",0,(0,se._)`${i}.length`,a=>{this.var(o,(0,se._)`${i}[${a}]`),n(o)})}return this._for(new Ha("of",s,o,r),()=>n(o))}forIn(e,r,n,s=this.opts.es5?qt.varKinds.var:qt.varKinds.const){if(this.opts.ownProperties)return this.forOf(e,(0,se._)`Object.keys(${r})`,n);let o=this._scope.toName(e);return this._for(new Ha("in",s,o,r),()=>n(o))}endFor(){return this._endBlockNode(Rn)}label(e){return this._leafNode(new Bd(e))}break(e){return this._leafNode(new Gd(e))}return(e){let r=new Fo;if(this._blockNode(r),this.code(e),r.nodes.length!==1)throw new Error('CodeGen: "return" should have one node');return this._endBlockNode(Fo)}try(e,r,n){if(!r&&!n)throw new Error('CodeGen: "try" without "catch" and "finally"');let s=new ep;if(this._blockNode(s),this.code(e),r){let o=this.name("e");this._currNode=s.catch=new Uo(o),r(o)}return n&&(this._currNode=s.finally=new Ho,this.code(n)),this._endBlockNode(Uo,Ho)}throw(e){return this._leafNode(new Wd(e))}block(e,r){return this._blockStarts.push(this._nodes.length),e&&this.code(e).endBlock(r),this}endBlock(e){let r=this._blockStarts.pop();if(r===void 0)throw new Error("CodeGen: not in self-balancing block");let n=this._nodes.length-r;if(n<0||e!==void 0&&n!==e)throw new Error(`CodeGen: wrong number of nodes: ${n} vs ${e} expected`);return this._nodes.length=r,this}func(e,r=se.nil,n,s){return this._blockNode(new Vo(e,r,n)),s&&this.code(s).endFunc(),this}endFunc(){return this._endBlockNode(Vo)}optimize(e=1){for(;e-- >0;)this._root.optimizeNodes(),this._root.optimizeNames(this._root.names,this._constants)}_leafNode(e){return this._currNode.nodes.push(e),this}_blockNode(e){this._currNode.nodes.push(e),this._nodes.push(e)}_endBlockNode(e,r){let n=this._currNode;if(n instanceof e||r&&n instanceof r)return this._nodes.pop(),this;throw new Error(`CodeGen: not in block "${r?`${e.kind}/${r.kind}`:e.kind}"`)}_elseNode(e){let r=this._currNode;if(!(r instanceof In))throw new Error('CodeGen: "else" without "if"');return this._currNode=r.else=e,this}get _root(){return this._nodes[0]}get _currNode(){let e=this._nodes;return e[e.length-1]}set _currNode(e){let r=this._nodes;r[r.length-1]=e}};Y.CodeGen=tp;function On(t,e){for(let r in e)t[r]=(t[r]||0)+(e[r]||0);return t}function Ka(t,e){return e instanceof se._CodeOrName?On(t,e.names):t}function ys(t,e,r){if(t instanceof se.Name)return n(t);if(!s(t))return t;return new se._Code(t._items.reduce((o,i)=>(i instanceof se.Name&&(i=n(i)),i instanceof se._Code?o.push(...i._items):o.push(i),o),[]));function n(o){let i=r[o.str];return i===void 0||e[o.str]!==1?o:(delete e[o.str],i)}function s(o){return o instanceof se._Code&&o._items.some(i=>i instanceof se.Name&&e[i.str]===1&&r[i.str]!==void 0)}}function qR(t,e){for(let r in e)t[r]=(t[r]||0)-(e[r]||0)}function d0(t){return typeof t=="boolean"||typeof t=="number"||t===null?!t:(0,se._)`!${rp(t)}`}Y.not=d0;var DR=p0(Y.operators.AND);function ZR(...t){return t.reduce(DR)}Y.and=ZR;var LR=p0(Y.operators.OR);function VR(...t){return t.reduce(LR)}Y.or=VR;function p0(t){return(e,r)=>e===se.nil?r:r===se.nil?e:(0,se._)`${rp(e)} ${t} ${rp(r)}`}function rp(t){return t instanceof se.Name?t:(0,se._)`(${t})`}});var le=v(ee=>{"use strict";Object.defineProperty(ee,"__esModule",{value:!0});ee.checkStrictMode=ee.getErrorPath=ee.Type=ee.useFunc=ee.setEvaluated=ee.evaluatedPropsToName=ee.mergeEvaluated=ee.eachItem=ee.unescapeJsonPointer=ee.escapeJsonPointer=ee.escapeFragment=ee.unescapeFragment=ee.schemaRefOrVal=ee.schemaHasRulesButRef=ee.schemaHasRules=ee.checkUnknownRules=ee.alwaysValidSchema=ee.toHash=void 0;var ye=W(),FR=Zo();function UR(t){let e={};for(let r of t)e[r]=!0;return e}ee.toHash=UR;function HR(t,e){return typeof e=="boolean"?e:Object.keys(e).length===0?!0:(h0(t,e),!g0(e,t.self.RULES.all))}ee.alwaysValidSchema=HR;function h0(t,e=t.schema){let{opts:r,self:n}=t;if(!r.strictSchema||typeof e=="boolean")return;let s=n.RULES.keywords;for(let o in e)s[o]||_0(t,`unknown keyword: "${o}"`)}ee.checkUnknownRules=h0;function g0(t,e){if(typeof t=="boolean")return!t;for(let r in t)if(e[r])return!0;return!1}ee.schemaHasRules=g0;function KR(t,e){if(typeof t=="boolean")return!t;for(let r in t)if(r!=="$ref"&&e.all[r])return!0;return!1}ee.schemaHasRulesButRef=KR;function BR({topSchemaRef:t,schemaPath:e},r,n,s){if(!s){if(typeof r=="number"||typeof r=="boolean")return r;if(typeof r=="string")return(0,ye._)`${r}`}return(0,ye._)`${t}${e}${(0,ye.getProperty)(n)}`}ee.schemaRefOrVal=BR;function GR(t){return y0(decodeURIComponent(t))}ee.unescapeFragment=GR;function WR(t){return encodeURIComponent(sp(t))}ee.escapeFragment=WR;function sp(t){return typeof t=="number"?`${t}`:t.replace(/~/g,"~0").replace(/\//g,"~1")}ee.escapeJsonPointer=sp;function y0(t){return t.replace(/~1/g,"/").replace(/~0/g,"~")}ee.unescapeJsonPointer=y0;function JR(t,e){if(Array.isArray(t))for(let r of t)e(r);else e(t)}ee.eachItem=JR;function f0({mergeNames:t,mergeToName:e,mergeValues:r,resultToName:n}){return(s,o,i,a)=>{let c=i===void 0?o:i instanceof ye.Name?(o instanceof ye.Name?t(s,o,i):e(s,o,i),i):o instanceof ye.Name?(e(s,i,o),o):r(o,i);return a===ye.Name&&!(c instanceof ye.Name)?n(s,c):c}}ee.mergeEvaluated={props:f0({mergeNames:(t,e,r)=>t.if((0,ye._)`${r} !== true && ${e} !== undefined`,()=>{t.if((0,ye._)`${e} === true`,()=>t.assign(r,!0),()=>t.assign(r,(0,ye._)`${r} || {}`).code((0,ye._)`Object.assign(${r}, ${e})`))}),mergeToName:(t,e,r)=>t.if((0,ye._)`${r} !== true`,()=>{e===!0?t.assign(r,!0):(t.assign(r,(0,ye._)`${r} || {}`),op(t,r,e))}),mergeValues:(t,e)=>t===!0?!0:{...t,...e},resultToName:v0}),items:f0({mergeNames:(t,e,r)=>t.if((0,ye._)`${r} !== true && ${e} !== undefined`,()=>t.assign(r,(0,ye._)`${e} === true ? true : ${r} > ${e} ? ${r} : ${e}`)),mergeToName:(t,e,r)=>t.if((0,ye._)`${r} !== true`,()=>t.assign(r,e===!0?!0:(0,ye._)`${r} > ${e} ? ${r} : ${e}`)),mergeValues:(t,e)=>t===!0?!0:Math.max(t,e),resultToName:(t,e)=>t.var("items",e)})};function v0(t,e){if(e===!0)return t.var("props",!0);let r=t.var("props",(0,ye._)`{}`);return e!==void 0&&op(t,r,e),r}ee.evaluatedPropsToName=v0;function op(t,e,r){Object.keys(r).forEach(n=>t.assign((0,ye._)`${e}${(0,ye.getProperty)(n)}`,!0))}ee.setEvaluated=op;var m0={};function YR(t,e){return t.scopeValue("func",{ref:e,code:m0[e.code]||(m0[e.code]=new FR._Code(e.code))})}ee.useFunc=YR;var np;(function(t){t[t.Num=0]="Num",t[t.Str=1]="Str"})(np||(ee.Type=np={}));function QR(t,e,r){if(t instanceof ye.Name){let n=e===np.Num;return r?n?(0,ye._)`"[" + ${t} + "]"`:(0,ye._)`"['" + ${t} + "']"`:n?(0,ye._)`"/" + ${t}`:(0,ye._)`"/" + ${t}.replace(/~/g, "~0").replace(/\\//g, "~1")`}return r?(0,ye.getProperty)(t).toString():"/"+sp(t)}ee.getErrorPath=QR;function _0(t,e,r=t.opts.strictSchema){if(r){if(e=`strict mode: ${e}`,r===!0)throw new Error(e);t.self.logger.warn(e)}}ee.checkStrictMode=_0});var wr=v(ip=>{"use strict";Object.defineProperty(ip,"__esModule",{value:!0});var Xe=W(),XR={data:new Xe.Name("data"),valCxt:new Xe.Name("valCxt"),instancePath:new Xe.Name("instancePath"),parentData:new Xe.Name("parentData"),parentDataProperty:new Xe.Name("parentDataProperty"),rootData:new Xe.Name("rootData"),dynamicAnchors:new Xe.Name("dynamicAnchors"),vErrors:new Xe.Name("vErrors"),errors:new Xe.Name("errors"),this:new Xe.Name("this"),self:new Xe.Name("self"),scope:new Xe.Name("scope"),json:new Xe.Name("json"),jsonPos:new Xe.Name("jsonPos"),jsonLen:new Xe.Name("jsonLen"),jsonPart:new Xe.Name("jsonPart")};ip.default=XR});var Ko=v(et=>{"use strict";Object.defineProperty(et,"__esModule",{value:!0});et.extendErrors=et.resetErrorsCount=et.reportExtraError=et.reportError=et.keyword$DataError=et.keywordError=void 0;var ie=W(),Ga=le(),st=wr();et.keywordError={message:({keyword:t})=>(0,ie.str)`must pass "${t}" keyword validation`};et.keyword$DataError={message:({keyword:t,schemaType:e})=>e?(0,ie.str)`"${t}" keyword must be ${e} ($data)`:(0,ie.str)`"${t}" keyword is invalid ($data)`};function eO(t,e=et.keywordError,r,n){let{it:s}=t,{gen:o,compositeRule:i,allErrors:a}=s,c=$0(t,e,r);n??(i||a)?b0(o,c):w0(s,(0,ie._)`[${c}]`)}et.reportError=eO;function tO(t,e=et.keywordError,r){let{it:n}=t,{gen:s,compositeRule:o,allErrors:i}=n,a=$0(t,e,r);b0(s,a),o||i||w0(n,st.default.vErrors)}et.reportExtraError=tO;function rO(t,e){t.assign(st.default.errors,e),t.if((0,ie._)`${st.default.vErrors} !== null`,()=>t.if(e,()=>t.assign((0,ie._)`${st.default.vErrors}.length`,e),()=>t.assign(st.default.vErrors,null)))}et.resetErrorsCount=rO;function nO({gen:t,keyword:e,schemaValue:r,data:n,errsCount:s,it:o}){if(s===void 0)throw new Error("ajv implementation error");let i=t.name("err");t.forRange("i",s,st.default.errors,a=>{t.const(i,(0,ie._)`${st.default.vErrors}[${a}]`),t.if((0,ie._)`${i}.instancePath === undefined`,()=>t.assign((0,ie._)`${i}.instancePath`,(0,ie.strConcat)(st.default.instancePath,o.errorPath))),t.assign((0,ie._)`${i}.schemaPath`,(0,ie.str)`${o.errSchemaPath}/${e}`),o.opts.verbose&&(t.assign((0,ie._)`${i}.schema`,r),t.assign((0,ie._)`${i}.data`,n))})}et.extendErrors=nO;function b0(t,e){let r=t.const("err",e);t.if((0,ie._)`${st.default.vErrors} === null`,()=>t.assign(st.default.vErrors,(0,ie._)`[${r}]`),(0,ie._)`${st.default.vErrors}.push(${r})`),t.code((0,ie._)`${st.default.errors}++`)}function w0(t,e){let{gen:r,validateName:n,schemaEnv:s}=t;s.$async?r.throw((0,ie._)`new ${t.ValidationError}(${e})`):(r.assign((0,ie._)`${n}.errors`,e),r.return(!1))}var Nn={keyword:new ie.Name("keyword"),schemaPath:new ie.Name("schemaPath"),params:new ie.Name("params"),propertyName:new ie.Name("propertyName"),message:new ie.Name("message"),schema:new ie.Name("schema"),parentSchema:new ie.Name("parentSchema")};function $0(t,e,r){let{createErrors:n}=t.it;return n===!1?(0,ie._)`{}`:sO(t,e,r)}function sO(t,e,r={}){let{gen:n,it:s}=t,o=[oO(s,r),iO(t,r)];return aO(t,e,o),n.object(...o)}function oO({errorPath:t},{instancePath:e}){let r=e?(0,ie.str)`${t}${(0,Ga.getErrorPath)(e,Ga.Type.Str)}`:t;return[st.default.instancePath,(0,ie.strConcat)(st.default.instancePath,r)]}function iO({keyword:t,it:{errSchemaPath:e}},{schemaPath:r,parentSchema:n}){let s=n?e:(0,ie.str)`${e}/${t}`;return r&&(s=(0,ie.str)`${s}${(0,Ga.getErrorPath)(r,Ga.Type.Str)}`),[Nn.schemaPath,s]}function aO(t,{params:e,message:r},n){let{keyword:s,data:o,schemaValue:i,it:a}=t,{opts:c,propertyName:u,topSchemaRef:l,schemaPath:d}=a;n.push([Nn.keyword,s],[Nn.params,typeof e=="function"?e(t):e||(0,ie._)`{}`]),c.messages&&n.push([Nn.message,typeof r=="function"?r(t):r]),c.verbose&&n.push([Nn.schema,i],[Nn.parentSchema,(0,ie._)`${l}${d}`],[st.default.data,o]),u&&n.push([Nn.propertyName,u])}});var k0=v(vs=>{"use strict";Object.defineProperty(vs,"__esModule",{value:!0});vs.boolOrEmptySchema=vs.topBoolOrEmptySchema=void 0;var cO=Ko(),uO=W(),lO=wr(),dO={message:"boolean schema is false"};function pO(t){let{gen:e,schema:r,validateName:n}=t;r===!1?x0(t,!1):typeof r=="object"&&r.$async===!0?e.return(lO.default.data):(e.assign((0,uO._)`${n}.errors`,null),e.return(!0))}vs.topBoolOrEmptySchema=pO;function fO(t,e){let{gen:r,schema:n}=t;n===!1?(r.var(e,!1),x0(t)):r.var(e,!0)}vs.boolOrEmptySchema=fO;function x0(t,e){let{gen:r,data:n}=t,s={gen:r,keyword:"false schema",data:n,schema:!1,schemaCode:!1,schemaValue:!1,params:{},it:t};(0,cO.reportError)(s,dO,void 0,e)}});var ap=v(_s=>{"use strict";Object.defineProperty(_s,"__esModule",{value:!0});_s.getRules=_s.isJSONType=void 0;var mO=["string","number","integer","boolean","null","object","array"],hO=new Set(mO);function gO(t){return typeof t=="string"&&hO.has(t)}_s.isJSONType=gO;function yO(){let t={number:{type:"number",rules:[]},string:{type:"string",rules:[]},array:{type:"array",rules:[]},object:{type:"object",rules:[]}};return{types:{...t,integer:!0,boolean:!0,null:!0},rules:[{rules:[]},t.number,t.string,t.array,t.object],post:{rules:[]},all:{},keywords:{}}}_s.getRules=yO});var cp=v(Lr=>{"use strict";Object.defineProperty(Lr,"__esModule",{value:!0});Lr.shouldUseRule=Lr.shouldUseGroup=Lr.schemaHasRulesForType=void 0;function vO({schema:t,self:e},r){let n=e.RULES.types[r];return n&&n!==!0&&S0(t,n)}Lr.schemaHasRulesForType=vO;function S0(t,e){return e.rules.some(r=>P0(t,r))}Lr.shouldUseGroup=S0;function P0(t,e){var r;return t[e.keyword]!==void 0||((r=e.definition.implements)===null||r===void 0?void 0:r.some(n=>t[n]!==void 0))}Lr.shouldUseRule=P0});var Bo=v(tt=>{"use strict";Object.defineProperty(tt,"__esModule",{value:!0});tt.reportTypeError=tt.checkDataTypes=tt.checkDataType=tt.coerceAndCheckDataType=tt.getJSONTypes=tt.getSchemaTypes=tt.DataType=void 0;var _O=ap(),bO=cp(),wO=Ko(),B=W(),E0=le(),bs;(function(t){t[t.Correct=0]="Correct",t[t.Wrong=1]="Wrong"})(bs||(tt.DataType=bs={}));function $O(t){let e=T0(t.type);if(e.includes("null")){if(t.nullable===!1)throw new Error("type: null contradicts nullable: false")}else{if(!e.length&&t.nullable!==void 0)throw new Error('"nullable" cannot be used without "type"');t.nullable===!0&&e.push("null")}return e}tt.getSchemaTypes=$O;function T0(t){let e=Array.isArray(t)?t:t?[t]:[];if(e.every(_O.isJSONType))return e;throw new Error("type must be JSONType or JSONType[]: "+e.join(","))}tt.getJSONTypes=T0;function xO(t,e){let{gen:r,data:n,opts:s}=t,o=kO(e,s.coerceTypes),i=e.length>0&&!(o.length===0&&e.length===1&&(0,bO.schemaHasRulesForType)(t,e[0]));if(i){let a=lp(e,n,s.strictNumbers,bs.Wrong);r.if(a,()=>{o.length?SO(t,e,o):dp(t)})}return i}tt.coerceAndCheckDataType=xO;var z0=new Set(["string","number","integer","boolean","null"]);function kO(t,e){return e?t.filter(r=>z0.has(r)||e==="array"&&r==="array"):[]}function SO(t,e,r){let{gen:n,data:s,opts:o}=t,i=n.let("dataType",(0,B._)`typeof ${s}`),a=n.let("coerced",(0,B._)`undefined`);o.coerceTypes==="array"&&n.if((0,B._)`${i} == 'object' && Array.isArray(${s}) && ${s}.length == 1`,()=>n.assign(s,(0,B._)`${s}[0]`).assign(i,(0,B._)`typeof ${s}`).if(lp(e,s,o.strictNumbers),()=>n.assign(a,s))),n.if((0,B._)`${a} !== undefined`);for(let u of r)(z0.has(u)||u==="array"&&o.coerceTypes==="array")&&c(u);n.else(),dp(t),n.endIf(),n.if((0,B._)`${a} !== undefined`,()=>{n.assign(s,a),PO(t,a)});function c(u){switch(u){case"string":n.elseIf((0,B._)`${i} == "number" || ${i} == "boolean"`).assign(a,(0,B._)`"" + ${s}`).elseIf((0,B._)`${s} === null`).assign(a,(0,B._)`""`);return;case"number":n.elseIf((0,B._)`${i} == "boolean" || ${s} === null
              || (${i} == "string" && ${s} && ${s} == +${s})`).assign(a,(0,B._)`+${s}`);return;case"integer":n.elseIf((0,B._)`${i} === "boolean" || ${s} === null
              || (${i} === "string" && ${s} && ${s} == +${s} && !(${s} % 1))`).assign(a,(0,B._)`+${s}`);return;case"boolean":n.elseIf((0,B._)`${s} === "false" || ${s} === 0 || ${s} === null`).assign(a,!1).elseIf((0,B._)`${s} === "true" || ${s} === 1`).assign(a,!0);return;case"null":n.elseIf((0,B._)`${s} === "" || ${s} === 0 || ${s} === false`),n.assign(a,null);return;case"array":n.elseIf((0,B._)`${i} === "string" || ${i} === "number"
              || ${i} === "boolean" || ${s} === null`).assign(a,(0,B._)`[${s}]`)}}}function PO({gen:t,parentData:e,parentDataProperty:r},n){t.if((0,B._)`${e} !== undefined`,()=>t.assign((0,B._)`${e}[${r}]`,n))}function up(t,e,r,n=bs.Correct){let s=n===bs.Correct?B.operators.EQ:B.operators.NEQ,o;switch(t){case"null":return(0,B._)`${e} ${s} null`;case"array":o=(0,B._)`Array.isArray(${e})`;break;case"object":o=(0,B._)`${e} && typeof ${e} == "object" && !Array.isArray(${e})`;break;case"integer":o=i((0,B._)`!(${e} % 1) && !isNaN(${e})`);break;case"number":o=i();break;default:return(0,B._)`typeof ${e} ${s} ${t}`}return n===bs.Correct?o:(0,B.not)(o);function i(a=B.nil){return(0,B.and)((0,B._)`typeof ${e} == "number"`,a,r?(0,B._)`isFinite(${e})`:B.nil)}}tt.checkDataType=up;function lp(t,e,r,n){if(t.length===1)return up(t[0],e,r,n);let s,o=(0,E0.toHash)(t);if(o.array&&o.object){let i=(0,B._)`typeof ${e} != "object"`;s=o.null?i:(0,B._)`!${e} || ${i}`,delete o.null,delete o.array,delete o.object}else s=B.nil;o.number&&delete o.integer;for(let i in o)s=(0,B.and)(s,up(i,e,r,n));return s}tt.checkDataTypes=lp;var EO={message:({schema:t})=>`must be ${t}`,params:({schema:t,schemaValue:e})=>typeof t=="string"?(0,B._)`{type: ${t}}`:(0,B._)`{type: ${e}}`};function dp(t){let e=TO(t);(0,wO.reportError)(e,EO)}tt.reportTypeError=dp;function TO(t){let{gen:e,data:r,schema:n}=t,s=(0,E0.schemaRefOrVal)(t,n,"type");return{gen:e,keyword:"type",data:r,schema:n.type,schemaCode:s,schemaValue:s,parentSchema:n,params:{},it:t}}});var I0=v(Wa=>{"use strict";Object.defineProperty(Wa,"__esModule",{value:!0});Wa.assignDefaults=void 0;var ws=W(),zO=le();function CO(t,e){let{properties:r,items:n}=t.schema;if(e==="object"&&r)for(let s in r)C0(t,s,r[s].default);else e==="array"&&Array.isArray(n)&&n.forEach((s,o)=>C0(t,o,s.default))}Wa.assignDefaults=CO;function C0(t,e,r){let{gen:n,compositeRule:s,data:o,opts:i}=t;if(r===void 0)return;let a=(0,ws._)`${o}${(0,ws.getProperty)(e)}`;if(s){(0,zO.checkStrictMode)(t,`default is ignored for: ${a}`);return}let c=(0,ws._)`${a} === undefined`;i.useDefaults==="empty"&&(c=(0,ws._)`${c} || ${a} === null || ${a} === ""`),n.if(c,(0,ws._)`${a} = ${(0,ws.stringify)(r)}`)}});var Tt=v(me=>{"use strict";Object.defineProperty(me,"__esModule",{value:!0});me.validateUnion=me.validateArray=me.usePattern=me.callValidateCode=me.schemaProperties=me.allSchemaProperties=me.noPropertyInData=me.propertyInData=me.isOwnProperty=me.hasPropFunc=me.reportMissingProp=me.checkMissingProp=me.checkReportMissingProp=void 0;var Pe=W(),pp=le(),Vr=wr(),IO=le();function RO(t,e){let{gen:r,data:n,it:s}=t;r.if(mp(r,n,e,s.opts.ownProperties),()=>{t.setParams({missingProperty:(0,Pe._)`${e}`},!0),t.error()})}me.checkReportMissingProp=RO;function OO({gen:t,data:e,it:{opts:r}},n,s){return(0,Pe.or)(...n.map(o=>(0,Pe.and)(mp(t,e,o,r.ownProperties),(0,Pe._)`${s} = ${o}`)))}me.checkMissingProp=OO;function NO(t,e){t.setParams({missingProperty:e},!0),t.error()}me.reportMissingProp=NO;function R0(t){return t.scopeValue("func",{ref:Object.prototype.hasOwnProperty,code:(0,Pe._)`Object.prototype.hasOwnProperty`})}me.hasPropFunc=R0;function fp(t,e,r){return(0,Pe._)`${R0(t)}.call(${e}, ${r})`}me.isOwnProperty=fp;function jO(t,e,r,n){let s=(0,Pe._)`${e}${(0,Pe.getProperty)(r)} !== undefined`;return n?(0,Pe._)`${s} && ${fp(t,e,r)}`:s}me.propertyInData=jO;function mp(t,e,r,n){let s=(0,Pe._)`${e}${(0,Pe.getProperty)(r)} === undefined`;return n?(0,Pe.or)(s,(0,Pe.not)(fp(t,e,r))):s}me.noPropertyInData=mp;function O0(t){return t?Object.keys(t).filter(e=>e!=="__proto__"):[]}me.allSchemaProperties=O0;function AO(t,e){return O0(e).filter(r=>!(0,pp.alwaysValidSchema)(t,e[r]))}me.schemaProperties=AO;function MO({schemaCode:t,data:e,it:{gen:r,topSchemaRef:n,schemaPath:s,errorPath:o},it:i},a,c,u){let l=u?(0,Pe._)`${t}, ${e}, ${n}${s}`:e,d=[[Vr.default.instancePath,(0,Pe.strConcat)(Vr.default.instancePath,o)],[Vr.default.parentData,i.parentData],[Vr.default.parentDataProperty,i.parentDataProperty],[Vr.default.rootData,Vr.default.rootData]];i.opts.dynamicRef&&d.push([Vr.default.dynamicAnchors,Vr.default.dynamicAnchors]);let f=(0,Pe._)`${l}, ${r.object(...d)}`;return c!==Pe.nil?(0,Pe._)`${a}.call(${c}, ${f})`:(0,Pe._)`${a}(${f})`}me.callValidateCode=MO;var qO=(0,Pe._)`new RegExp`;function DO({gen:t,it:{opts:e}},r){let n=e.unicodeRegExp?"u":"",{regExp:s}=e.code,o=s(r,n);return t.scopeValue("pattern",{key:o.toString(),ref:o,code:(0,Pe._)`${s.code==="new RegExp"?qO:(0,IO.useFunc)(t,s)}(${r}, ${n})`})}me.usePattern=DO;function ZO(t){let{gen:e,data:r,keyword:n,it:s}=t,o=e.name("valid");if(s.allErrors){let a=e.let("valid",!0);return i(()=>e.assign(a,!1)),a}return e.var(o,!0),i(()=>e.break()),o;function i(a){let c=e.const("len",(0,Pe._)`${r}.length`);e.forRange("i",0,c,u=>{t.subschema({keyword:n,dataProp:u,dataPropType:pp.Type.Num},o),e.if((0,Pe.not)(o),a)})}}me.validateArray=ZO;function LO(t){let{gen:e,schema:r,keyword:n,it:s}=t;if(!Array.isArray(r))throw new Error("ajv implementation error");if(r.some(c=>(0,pp.alwaysValidSchema)(s,c))&&!s.opts.unevaluated)return;let i=e.let("valid",!1),a=e.name("_valid");e.block(()=>r.forEach((c,u)=>{let l=t.subschema({keyword:n,schemaProp:u,compositeRule:!0},a);e.assign(i,(0,Pe._)`${i} || ${a}`),t.mergeValidEvaluated(l,a)||e.if((0,Pe.not)(i))})),t.result(i,()=>t.reset(),()=>t.error(!0))}me.validateUnion=LO});var A0=v(nr=>{"use strict";Object.defineProperty(nr,"__esModule",{value:!0});nr.validateKeywordUsage=nr.validSchemaType=nr.funcKeywordCode=nr.macroKeywordCode=void 0;var ot=W(),jn=wr(),VO=Tt(),FO=Ko();function UO(t,e){let{gen:r,keyword:n,schema:s,parentSchema:o,it:i}=t,a=e.macro.call(i.self,s,o,i),c=j0(r,n,a);i.opts.validateSchema!==!1&&i.self.validateSchema(a,!0);let u=r.name("valid");t.subschema({schema:a,schemaPath:ot.nil,errSchemaPath:`${i.errSchemaPath}/${n}`,topSchemaRef:c,compositeRule:!0},u),t.pass(u,()=>t.error(!0))}nr.macroKeywordCode=UO;function HO(t,e){var r;let{gen:n,keyword:s,schema:o,parentSchema:i,$data:a,it:c}=t;BO(c,e);let u=!a&&e.compile?e.compile.call(c.self,o,i,c):e.validate,l=j0(n,s,u),d=n.let("valid");t.block$data(d,f),t.ok((r=e.valid)!==null&&r!==void 0?r:d);function f(){if(e.errors===!1)h(),e.modifying&&N0(t),g(()=>t.error());else{let y=e.async?p():m();e.modifying&&N0(t),g(()=>KO(t,y))}}function p(){let y=n.let("ruleErrs",null);return n.try(()=>h((0,ot._)`await `),x=>n.assign(d,!1).if((0,ot._)`${x} instanceof ${c.ValidationError}`,()=>n.assign(y,(0,ot._)`${x}.errors`),()=>n.throw(x))),y}function m(){let y=(0,ot._)`${l}.errors`;return n.assign(y,null),h(ot.nil),y}function h(y=e.async?(0,ot._)`await `:ot.nil){let x=c.opts.passContext?jn.default.this:jn.default.self,$=!("compile"in e&&!a||e.schema===!1);n.assign(d,(0,ot._)`${y}${(0,VO.callValidateCode)(t,l,x,$)}`,e.modifying)}function g(y){var x;n.if((0,ot.not)((x=e.valid)!==null&&x!==void 0?x:d),y)}}nr.funcKeywordCode=HO;function N0(t){let{gen:e,data:r,it:n}=t;e.if(n.parentData,()=>e.assign(r,(0,ot._)`${n.parentData}[${n.parentDataProperty}]`))}function KO(t,e){let{gen:r}=t;r.if((0,ot._)`Array.isArray(${e})`,()=>{r.assign(jn.default.vErrors,(0,ot._)`${jn.default.vErrors} === null ? ${e} : ${jn.default.vErrors}.concat(${e})`).assign(jn.default.errors,(0,ot._)`${jn.default.vErrors}.length`),(0,FO.extendErrors)(t)},()=>t.error())}function BO({schemaEnv:t},e){if(e.async&&!t.$async)throw new Error("async keyword in sync schema")}function j0(t,e,r){if(r===void 0)throw new Error(`keyword "${e}" failed to compile`);return t.scopeValue("keyword",typeof r=="function"?{ref:r}:{ref:r,code:(0,ot.stringify)(r)})}function GO(t,e,r=!1){return!e.length||e.some(n=>n==="array"?Array.isArray(t):n==="object"?t&&typeof t=="object"&&!Array.isArray(t):typeof t==n||r&&typeof t>"u")}nr.validSchemaType=GO;function WO({schema:t,opts:e,self:r,errSchemaPath:n},s,o){if(Array.isArray(s.keyword)?!s.keyword.includes(o):s.keyword!==o)throw new Error("ajv implementation error");let i=s.dependencies;if(i?.some(a=>!Object.prototype.hasOwnProperty.call(t,a)))throw new Error(`parent schema must have dependencies of ${o}: ${i.join(",")}`);if(s.validateSchema&&!s.validateSchema(t[o])){let c=`keyword "${o}" value is invalid at path "${n}": `+r.errorsText(s.validateSchema.errors);if(e.validateSchema==="log")r.logger.error(c);else throw new Error(c)}}nr.validateKeywordUsage=WO});var q0=v(Fr=>{"use strict";Object.defineProperty(Fr,"__esModule",{value:!0});Fr.extendSubschemaMode=Fr.extendSubschemaData=Fr.getSubschema=void 0;var sr=W(),M0=le();function JO(t,{keyword:e,schemaProp:r,schema:n,schemaPath:s,errSchemaPath:o,topSchemaRef:i}){if(e!==void 0&&n!==void 0)throw new Error('both "keyword" and "schema" passed, only one allowed');if(e!==void 0){let a=t.schema[e];return r===void 0?{schema:a,schemaPath:(0,sr._)`${t.schemaPath}${(0,sr.getProperty)(e)}`,errSchemaPath:`${t.errSchemaPath}/${e}`}:{schema:a[r],schemaPath:(0,sr._)`${t.schemaPath}${(0,sr.getProperty)(e)}${(0,sr.getProperty)(r)}`,errSchemaPath:`${t.errSchemaPath}/${e}/${(0,M0.escapeFragment)(r)}`}}if(n!==void 0){if(s===void 0||o===void 0||i===void 0)throw new Error('"schemaPath", "errSchemaPath" and "topSchemaRef" are required with "schema"');return{schema:n,schemaPath:s,topSchemaRef:i,errSchemaPath:o}}throw new Error('either "keyword" or "schema" must be passed')}Fr.getSubschema=JO;function YO(t,e,{dataProp:r,dataPropType:n,data:s,dataTypes:o,propertyName:i}){if(s!==void 0&&r!==void 0)throw new Error('both "data" and "dataProp" passed, only one allowed');let{gen:a}=e;if(r!==void 0){let{errorPath:u,dataPathArr:l,opts:d}=e,f=a.let("data",(0,sr._)`${e.data}${(0,sr.getProperty)(r)}`,!0);c(f),t.errorPath=(0,sr.str)`${u}${(0,M0.getErrorPath)(r,n,d.jsPropertySyntax)}`,t.parentDataProperty=(0,sr._)`${r}`,t.dataPathArr=[...l,t.parentDataProperty]}if(s!==void 0){let u=s instanceof sr.Name?s:a.let("data",s,!0);c(u),i!==void 0&&(t.propertyName=i)}o&&(t.dataTypes=o);function c(u){t.data=u,t.dataLevel=e.dataLevel+1,t.dataTypes=[],e.definedProperties=new Set,t.parentData=e.data,t.dataNames=[...e.dataNames,u]}}Fr.extendSubschemaData=YO;function QO(t,{jtdDiscriminator:e,jtdMetadata:r,compositeRule:n,createErrors:s,allErrors:o}){n!==void 0&&(t.compositeRule=n),s!==void 0&&(t.createErrors=s),o!==void 0&&(t.allErrors=o),t.jtdDiscriminator=e,t.jtdMetadata=r}Fr.extendSubschemaMode=QO});var Z0=v((CV,D0)=>{"use strict";var Ur=D0.exports=function(t,e,r){typeof e=="function"&&(r=e,e={}),r=e.cb||r;var n=typeof r=="function"?r:r.pre||function(){},s=r.post||function(){};Ja(e,n,s,t,"",t)};Ur.keywords={additionalItems:!0,items:!0,contains:!0,additionalProperties:!0,propertyNames:!0,not:!0,if:!0,then:!0,else:!0};Ur.arrayKeywords={items:!0,allOf:!0,anyOf:!0,oneOf:!0};Ur.propsKeywords={$defs:!0,definitions:!0,properties:!0,patternProperties:!0,dependencies:!0};Ur.skipKeywords={default:!0,enum:!0,const:!0,required:!0,maximum:!0,minimum:!0,exclusiveMaximum:!0,exclusiveMinimum:!0,multipleOf:!0,maxLength:!0,minLength:!0,pattern:!0,format:!0,maxItems:!0,minItems:!0,uniqueItems:!0,maxProperties:!0,minProperties:!0};function Ja(t,e,r,n,s,o,i,a,c,u){if(n&&typeof n=="object"&&!Array.isArray(n)){e(n,s,o,i,a,c,u);for(var l in n){var d=n[l];if(Array.isArray(d)){if(l in Ur.arrayKeywords)for(var f=0;f<d.length;f++)Ja(t,e,r,d[f],s+"/"+l+"/"+f,o,s,l,n,f)}else if(l in Ur.propsKeywords){if(d&&typeof d=="object")for(var p in d)Ja(t,e,r,d[p],s+"/"+l+"/"+XO(p),o,s,l,n,p)}else(l in Ur.keywords||t.allKeys&&!(l in Ur.skipKeywords))&&Ja(t,e,r,d,s+"/"+l,o,s,l,n)}r(n,s,o,i,a,c,u)}}function XO(t){return t.replace(/~/g,"~0").replace(/\//g,"~1")}});var Go=v(ht=>{"use strict";Object.defineProperty(ht,"__esModule",{value:!0});ht.getSchemaRefs=ht.resolveUrl=ht.normalizeId=ht._getFullPath=ht.getFullPath=ht.inlineRef=void 0;var eN=le(),tN=_o(),rN=Z0(),nN=new Set(["type","format","pattern","maxLength","minLength","maxProperties","minProperties","maxItems","minItems","maximum","minimum","uniqueItems","multipleOf","required","enum","const"]);function sN(t,e=!0){return typeof t=="boolean"?!0:e===!0?!hp(t):e?L0(t)<=e:!1}ht.inlineRef=sN;var oN=new Set(["$ref","$recursiveRef","$recursiveAnchor","$dynamicRef","$dynamicAnchor"]);function hp(t){for(let e in t){if(oN.has(e))return!0;let r=t[e];if(Array.isArray(r)&&r.some(hp)||typeof r=="object"&&hp(r))return!0}return!1}function L0(t){let e=0;for(let r in t){if(r==="$ref")return 1/0;if(e++,!nN.has(r)&&(typeof t[r]=="object"&&(0,eN.eachItem)(t[r],n=>e+=L0(n)),e===1/0))return 1/0}return e}function V0(t,e="",r){r!==!1&&(e=$s(e));let n=t.parse(e);return F0(t,n)}ht.getFullPath=V0;function F0(t,e){return t.serialize(e).split("#")[0]+"#"}ht._getFullPath=F0;var iN=/#\/?$/;function $s(t){return t?t.replace(iN,""):""}ht.normalizeId=$s;function aN(t,e,r){return r=$s(r),t.resolve(e,r)}ht.resolveUrl=aN;var cN=/^[a-z_][-a-z0-9._]*$/i;function uN(t,e){if(typeof t=="boolean")return{};let{schemaId:r,uriResolver:n}=this.opts,s=$s(t[r]||e),o={"":s},i=V0(n,s,!1),a={},c=new Set;return rN(t,{allKeys:!0},(d,f,p,m)=>{if(m===void 0)return;let h=i+f,g=o[m];typeof d[r]=="string"&&(g=y.call(this,d[r])),x.call(this,d.$anchor),x.call(this,d.$dynamicAnchor),o[f]=g;function y($){let S=this.opts.uriResolver.resolve;if($=$s(g?S(g,$):$),c.has($))throw l($);c.add($);let w=this.refs[$];return typeof w=="string"&&(w=this.refs[w]),typeof w=="object"?u(d,w.schema,$):$!==$s(h)&&($[0]==="#"?(u(d,a[$],$),a[$]=d):this.refs[$]=h),$}function x($){if(typeof $=="string"){if(!cN.test($))throw new Error(`invalid anchor "${$}"`);y.call(this,`#${$}`)}}}),a;function u(d,f,p){if(f!==void 0&&!tN(d,f))throw l(p)}function l(d){return new Error(`reference "${d}" resolves to more than one schema`)}}ht.getSchemaRefs=uN});var Yo=v(Hr=>{"use strict";Object.defineProperty(Hr,"__esModule",{value:!0});Hr.getData=Hr.KeywordCxt=Hr.validateFunctionCode=void 0;var G0=k0(),U0=Bo(),yp=cp(),Ya=Bo(),lN=I0(),Jo=A0(),gp=q0(),N=W(),V=wr(),dN=Go(),$r=le(),Wo=Ko();function pN(t){if(Y0(t)&&(Q0(t),J0(t))){hN(t);return}W0(t,()=>(0,G0.topBoolOrEmptySchema)(t))}Hr.validateFunctionCode=pN;function W0({gen:t,validateName:e,schema:r,schemaEnv:n,opts:s},o){s.code.es5?t.func(e,(0,N._)`${V.default.data}, ${V.default.valCxt}`,n.$async,()=>{t.code((0,N._)`"use strict"; ${H0(r,s)}`),mN(t,s),t.code(o)}):t.func(e,(0,N._)`${V.default.data}, ${fN(s)}`,n.$async,()=>t.code(H0(r,s)).code(o))}function fN(t){return(0,N._)`{${V.default.instancePath}="", ${V.default.parentData}, ${V.default.parentDataProperty}, ${V.default.rootData}=${V.default.data}${t.dynamicRef?(0,N._)`, ${V.default.dynamicAnchors}={}`:N.nil}}={}`}function mN(t,e){t.if(V.default.valCxt,()=>{t.var(V.default.instancePath,(0,N._)`${V.default.valCxt}.${V.default.instancePath}`),t.var(V.default.parentData,(0,N._)`${V.default.valCxt}.${V.default.parentData}`),t.var(V.default.parentDataProperty,(0,N._)`${V.default.valCxt}.${V.default.parentDataProperty}`),t.var(V.default.rootData,(0,N._)`${V.default.valCxt}.${V.default.rootData}`),e.dynamicRef&&t.var(V.default.dynamicAnchors,(0,N._)`${V.default.valCxt}.${V.default.dynamicAnchors}`)},()=>{t.var(V.default.instancePath,(0,N._)`""`),t.var(V.default.parentData,(0,N._)`undefined`),t.var(V.default.parentDataProperty,(0,N._)`undefined`),t.var(V.default.rootData,V.default.data),e.dynamicRef&&t.var(V.default.dynamicAnchors,(0,N._)`{}`)})}function hN(t){let{schema:e,opts:r,gen:n}=t;W0(t,()=>{r.$comment&&e.$comment&&eb(t),bN(t),n.let(V.default.vErrors,null),n.let(V.default.errors,0),r.unevaluated&&gN(t),X0(t),xN(t)})}function gN(t){let{gen:e,validateName:r}=t;t.evaluated=e.const("evaluated",(0,N._)`${r}.evaluated`),e.if((0,N._)`${t.evaluated}.dynamicProps`,()=>e.assign((0,N._)`${t.evaluated}.props`,(0,N._)`undefined`)),e.if((0,N._)`${t.evaluated}.dynamicItems`,()=>e.assign((0,N._)`${t.evaluated}.items`,(0,N._)`undefined`))}function H0(t,e){let r=typeof t=="object"&&t[e.schemaId];return r&&(e.code.source||e.code.process)?(0,N._)`/*# sourceURL=${r} */`:N.nil}function yN(t,e){if(Y0(t)&&(Q0(t),J0(t))){vN(t,e);return}(0,G0.boolOrEmptySchema)(t,e)}function J0({schema:t,self:e}){if(typeof t=="boolean")return!t;for(let r in t)if(e.RULES.all[r])return!0;return!1}function Y0(t){return typeof t.schema!="boolean"}function vN(t,e){let{schema:r,gen:n,opts:s}=t;s.$comment&&r.$comment&&eb(t),wN(t),$N(t);let o=n.const("_errs",V.default.errors);X0(t,o),n.var(e,(0,N._)`${o} === ${V.default.errors}`)}function Q0(t){(0,$r.checkUnknownRules)(t),_N(t)}function X0(t,e){if(t.opts.jtd)return K0(t,[],!1,e);let r=(0,U0.getSchemaTypes)(t.schema),n=(0,U0.coerceAndCheckDataType)(t,r);K0(t,r,!n,e)}function _N(t){let{schema:e,errSchemaPath:r,opts:n,self:s}=t;e.$ref&&n.ignoreKeywordsWithRef&&(0,$r.schemaHasRulesButRef)(e,s.RULES)&&s.logger.warn(`$ref: keywords ignored in schema at path "${r}"`)}function bN(t){let{schema:e,opts:r}=t;e.default!==void 0&&r.useDefaults&&r.strictSchema&&(0,$r.checkStrictMode)(t,"default is ignored in the schema root")}function wN(t){let e=t.schema[t.opts.schemaId];e&&(t.baseId=(0,dN.resolveUrl)(t.opts.uriResolver,t.baseId,e))}function $N(t){if(t.schema.$async&&!t.schemaEnv.$async)throw new Error("async schema in sync schema")}function eb({gen:t,schemaEnv:e,schema:r,errSchemaPath:n,opts:s}){let o=r.$comment;if(s.$comment===!0)t.code((0,N._)`${V.default.self}.logger.log(${o})`);else if(typeof s.$comment=="function"){let i=(0,N.str)`${n}/$comment`,a=t.scopeValue("root",{ref:e.root});t.code((0,N._)`${V.default.self}.opts.$comment(${o}, ${i}, ${a}.schema)`)}}function xN(t){let{gen:e,schemaEnv:r,validateName:n,ValidationError:s,opts:o}=t;r.$async?e.if((0,N._)`${V.default.errors} === 0`,()=>e.return(V.default.data),()=>e.throw((0,N._)`new ${s}(${V.default.vErrors})`)):(e.assign((0,N._)`${n}.errors`,V.default.vErrors),o.unevaluated&&kN(t),e.return((0,N._)`${V.default.errors} === 0`))}function kN({gen:t,evaluated:e,props:r,items:n}){r instanceof N.Name&&t.assign((0,N._)`${e}.props`,r),n instanceof N.Name&&t.assign((0,N._)`${e}.items`,n)}function K0(t,e,r,n){let{gen:s,schema:o,data:i,allErrors:a,opts:c,self:u}=t,{RULES:l}=u;if(o.$ref&&(c.ignoreKeywordsWithRef||!(0,$r.schemaHasRulesButRef)(o,l))){s.block(()=>rb(t,"$ref",l.all.$ref.definition));return}c.jtd||SN(t,e),s.block(()=>{for(let f of l.rules)d(f);d(l.post)});function d(f){(0,yp.shouldUseGroup)(o,f)&&(f.type?(s.if((0,Ya.checkDataType)(f.type,i,c.strictNumbers)),B0(t,f),e.length===1&&e[0]===f.type&&r&&(s.else(),(0,Ya.reportTypeError)(t)),s.endIf()):B0(t,f),a||s.if((0,N._)`${V.default.errors} === ${n||0}`))}}function B0(t,e){let{gen:r,schema:n,opts:{useDefaults:s}}=t;s&&(0,lN.assignDefaults)(t,e.type),r.block(()=>{for(let o of e.rules)(0,yp.shouldUseRule)(n,o)&&rb(t,o.keyword,o.definition,e.type)})}function SN(t,e){t.schemaEnv.meta||!t.opts.strictTypes||(PN(t,e),t.opts.allowUnionTypes||EN(t,e),TN(t,t.dataTypes))}function PN(t,e){if(e.length){if(!t.dataTypes.length){t.dataTypes=e;return}e.forEach(r=>{tb(t.dataTypes,r)||vp(t,`type "${r}" not allowed by context "${t.dataTypes.join(",")}"`)}),CN(t,e)}}function EN(t,e){e.length>1&&!(e.length===2&&e.includes("null"))&&vp(t,"use allowUnionTypes to allow union type keyword")}function TN(t,e){let r=t.self.RULES.all;for(let n in r){let s=r[n];if(typeof s=="object"&&(0,yp.shouldUseRule)(t.schema,s)){let{type:o}=s.definition;o.length&&!o.some(i=>zN(e,i))&&vp(t,`missing type "${o.join(",")}" for keyword "${n}"`)}}}function zN(t,e){return t.includes(e)||e==="number"&&t.includes("integer")}function tb(t,e){return t.includes(e)||e==="integer"&&t.includes("number")}function CN(t,e){let r=[];for(let n of t.dataTypes)tb(e,n)?r.push(n):e.includes("integer")&&n==="number"&&r.push("integer");t.dataTypes=r}function vp(t,e){let r=t.schemaEnv.baseId+t.errSchemaPath;e+=` at "${r}" (strictTypes)`,(0,$r.checkStrictMode)(t,e,t.opts.strictTypes)}var Qa=class{constructor(e,r,n){if((0,Jo.validateKeywordUsage)(e,r,n),this.gen=e.gen,this.allErrors=e.allErrors,this.keyword=n,this.data=e.data,this.schema=e.schema[n],this.$data=r.$data&&e.opts.$data&&this.schema&&this.schema.$data,this.schemaValue=(0,$r.schemaRefOrVal)(e,this.schema,n,this.$data),this.schemaType=r.schemaType,this.parentSchema=e.schema,this.params={},this.it=e,this.def=r,this.$data)this.schemaCode=e.gen.const("vSchema",nb(this.$data,e));else if(this.schemaCode=this.schemaValue,!(0,Jo.validSchemaType)(this.schema,r.schemaType,r.allowUndefined))throw new Error(`${n} value must be ${JSON.stringify(r.schemaType)}`);("code"in r?r.trackErrors:r.errors!==!1)&&(this.errsCount=e.gen.const("_errs",V.default.errors))}result(e,r,n){this.failResult((0,N.not)(e),r,n)}failResult(e,r,n){this.gen.if(e),n?n():this.error(),r?(this.gen.else(),r(),this.allErrors&&this.gen.endIf()):this.allErrors?this.gen.endIf():this.gen.else()}pass(e,r){this.failResult((0,N.not)(e),void 0,r)}fail(e){if(e===void 0){this.error(),this.allErrors||this.gen.if(!1);return}this.gen.if(e),this.error(),this.allErrors?this.gen.endIf():this.gen.else()}fail$data(e){if(!this.$data)return this.fail(e);let{schemaCode:r}=this;this.fail((0,N._)`${r} !== undefined && (${(0,N.or)(this.invalid$data(),e)})`)}error(e,r,n){if(r){this.setParams(r),this._error(e,n),this.setParams({});return}this._error(e,n)}_error(e,r){(e?Wo.reportExtraError:Wo.reportError)(this,this.def.error,r)}$dataError(){(0,Wo.reportError)(this,this.def.$dataError||Wo.keyword$DataError)}reset(){if(this.errsCount===void 0)throw new Error('add "trackErrors" to keyword definition');(0,Wo.resetErrorsCount)(this.gen,this.errsCount)}ok(e){this.allErrors||this.gen.if(e)}setParams(e,r){r?Object.assign(this.params,e):this.params=e}block$data(e,r,n=N.nil){this.gen.block(()=>{this.check$data(e,n),r()})}check$data(e=N.nil,r=N.nil){if(!this.$data)return;let{gen:n,schemaCode:s,schemaType:o,def:i}=this;n.if((0,N.or)((0,N._)`${s} === undefined`,r)),e!==N.nil&&n.assign(e,!0),(o.length||i.validateSchema)&&(n.elseIf(this.invalid$data()),this.$dataError(),e!==N.nil&&n.assign(e,!1)),n.else()}invalid$data(){let{gen:e,schemaCode:r,schemaType:n,def:s,it:o}=this;return(0,N.or)(i(),a());function i(){if(n.length){if(!(r instanceof N.Name))throw new Error("ajv implementation error");let c=Array.isArray(n)?n:[n];return(0,N._)`${(0,Ya.checkDataTypes)(c,r,o.opts.strictNumbers,Ya.DataType.Wrong)}`}return N.nil}function a(){if(s.validateSchema){let c=e.scopeValue("validate$data",{ref:s.validateSchema});return(0,N._)`!${c}(${r})`}return N.nil}}subschema(e,r){let n=(0,gp.getSubschema)(this.it,e);(0,gp.extendSubschemaData)(n,this.it,e),(0,gp.extendSubschemaMode)(n,e);let s={...this.it,...n,items:void 0,props:void 0};return yN(s,r),s}mergeEvaluated(e,r){let{it:n,gen:s}=this;n.opts.unevaluated&&(n.props!==!0&&e.props!==void 0&&(n.props=$r.mergeEvaluated.props(s,e.props,n.props,r)),n.items!==!0&&e.items!==void 0&&(n.items=$r.mergeEvaluated.items(s,e.items,n.items,r)))}mergeValidEvaluated(e,r){let{it:n,gen:s}=this;if(n.opts.unevaluated&&(n.props!==!0||n.items!==!0))return s.if(r,()=>this.mergeEvaluated(e,N.Name)),!0}};Hr.KeywordCxt=Qa;function rb(t,e,r,n){let s=new Qa(t,r,e);"code"in r?r.code(s,n):s.$data&&r.validate?(0,Jo.funcKeywordCode)(s,r):"macro"in r?(0,Jo.macroKeywordCode)(s,r):(r.compile||r.validate)&&(0,Jo.funcKeywordCode)(s,r)}var IN=/^\/(?:[^~]|~0|~1)*$/,RN=/^([0-9]+)(#|\/(?:[^~]|~0|~1)*)?$/;function nb(t,{dataLevel:e,dataNames:r,dataPathArr:n}){let s,o;if(t==="")return V.default.rootData;if(t[0]==="/"){if(!IN.test(t))throw new Error(`Invalid JSON-pointer: ${t}`);s=t,o=V.default.rootData}else{let u=RN.exec(t);if(!u)throw new Error(`Invalid JSON-pointer: ${t}`);let l=+u[1];if(s=u[2],s==="#"){if(l>=e)throw new Error(c("property/index",l));return n[e-l]}if(l>e)throw new Error(c("data",l));if(o=r[e-l],!s)return o}let i=o,a=s.split("/");for(let u of a)u&&(o=(0,N._)`${o}${(0,N.getProperty)((0,$r.unescapeJsonPointer)(u))}`,i=(0,N._)`${i} && ${o}`);return i;function c(u,l){return`Cannot access ${u} ${l} levels up, current level is ${e}`}}Hr.getData=nb});var Xa=v(bp=>{"use strict";Object.defineProperty(bp,"__esModule",{value:!0});var _p=class extends Error{constructor(e){super("validation failed"),this.errors=e,this.ajv=this.validation=!0}};bp.default=_p});var Qo=v(xp=>{"use strict";Object.defineProperty(xp,"__esModule",{value:!0});var wp=Go(),$p=class extends Error{constructor(e,r,n,s){super(s||`can't resolve reference ${n} from id ${r}`),this.missingRef=(0,wp.resolveUrl)(e,r,n),this.missingSchema=(0,wp.normalizeId)((0,wp.getFullPath)(e,this.missingRef))}};xp.default=$p});var tc=v(zt=>{"use strict";Object.defineProperty(zt,"__esModule",{value:!0});zt.resolveSchema=zt.getCompilingSchema=zt.resolveRef=zt.compileSchema=zt.SchemaEnv=void 0;var Dt=W(),ON=Xa(),An=wr(),Zt=Go(),sb=le(),NN=Yo(),xs=class{constructor(e){var r;this.refs={},this.dynamicAnchors={};let n;typeof e.schema=="object"&&(n=e.schema),this.schema=e.schema,this.schemaId=e.schemaId,this.root=e.root||this,this.baseId=(r=e.baseId)!==null&&r!==void 0?r:(0,Zt.normalizeId)(n?.[e.schemaId||"$id"]),this.schemaPath=e.schemaPath,this.localRefs=e.localRefs,this.meta=e.meta,this.$async=n?.$async,this.refs={}}};zt.SchemaEnv=xs;function Sp(t){let e=ob.call(this,t);if(e)return e;let r=(0,Zt.getFullPath)(this.opts.uriResolver,t.root.baseId),{es5:n,lines:s}=this.opts.code,{ownProperties:o}=this.opts,i=new Dt.CodeGen(this.scope,{es5:n,lines:s,ownProperties:o}),a;t.$async&&(a=i.scopeValue("Error",{ref:ON.default,code:(0,Dt._)`require("ajv/dist/runtime/validation_error").default`}));let c=i.scopeName("validate");t.validateName=c;let u={gen:i,allErrors:this.opts.allErrors,data:An.default.data,parentData:An.default.parentData,parentDataProperty:An.default.parentDataProperty,dataNames:[An.default.data],dataPathArr:[Dt.nil],dataLevel:0,dataTypes:[],definedProperties:new Set,topSchemaRef:i.scopeValue("schema",this.opts.code.source===!0?{ref:t.schema,code:(0,Dt.stringify)(t.schema)}:{ref:t.schema}),validateName:c,ValidationError:a,schema:t.schema,schemaEnv:t,rootId:r,baseId:t.baseId||r,schemaPath:Dt.nil,errSchemaPath:t.schemaPath||(this.opts.jtd?"":"#"),errorPath:(0,Dt._)`""`,opts:this.opts,self:this},l;try{this._compilations.add(t),(0,NN.validateFunctionCode)(u),i.optimize(this.opts.code.optimize);let d=i.toString();l=`${i.scopeRefs(An.default.scope)}return ${d}`,this.opts.code.process&&(l=this.opts.code.process(l,t));let p=new Function(`${An.default.self}`,`${An.default.scope}`,l)(this,this.scope.get());if(this.scope.value(c,{ref:p}),p.errors=null,p.schema=t.schema,p.schemaEnv=t,t.$async&&(p.$async=!0),this.opts.code.source===!0&&(p.source={validateName:c,validateCode:d,scopeValues:i._values}),this.opts.unevaluated){let{props:m,items:h}=u;p.evaluated={props:m instanceof Dt.Name?void 0:m,items:h instanceof Dt.Name?void 0:h,dynamicProps:m instanceof Dt.Name,dynamicItems:h instanceof Dt.Name},p.source&&(p.source.evaluated=(0,Dt.stringify)(p.evaluated))}return t.validate=p,t}catch(d){throw delete t.validate,delete t.validateName,l&&this.logger.error("Error compiling schema, function code:",l),d}finally{this._compilations.delete(t)}}zt.compileSchema=Sp;function jN(t,e,r){var n;r=(0,Zt.resolveUrl)(this.opts.uriResolver,e,r);let s=t.refs[r];if(s)return s;let o=qN.call(this,t,r);if(o===void 0){let i=(n=t.localRefs)===null||n===void 0?void 0:n[r],{schemaId:a}=this.opts;i&&(o=new xs({schema:i,schemaId:a,root:t,baseId:e}))}if(o!==void 0)return t.refs[r]=AN.call(this,o)}zt.resolveRef=jN;function AN(t){return(0,Zt.inlineRef)(t.schema,this.opts.inlineRefs)?t.schema:t.validate?t:Sp.call(this,t)}function ob(t){for(let e of this._compilations)if(MN(e,t))return e}zt.getCompilingSchema=ob;function MN(t,e){return t.schema===e.schema&&t.root===e.root&&t.baseId===e.baseId}function qN(t,e){let r;for(;typeof(r=this.refs[e])=="string";)e=r;return r||this.schemas[e]||ec.call(this,t,e)}function ec(t,e){let r=this.opts.uriResolver.parse(e),n=(0,Zt._getFullPath)(this.opts.uriResolver,r),s=(0,Zt.getFullPath)(this.opts.uriResolver,t.baseId,void 0);if(Object.keys(t.schema).length>0&&n===s)return kp.call(this,r,t);let o=(0,Zt.normalizeId)(n),i=this.refs[o]||this.schemas[o];if(typeof i=="string"){let a=ec.call(this,t,i);return typeof a?.schema!="object"?void 0:kp.call(this,r,a)}if(typeof i?.schema=="object"){if(i.validate||Sp.call(this,i),o===(0,Zt.normalizeId)(e)){let{schema:a}=i,{schemaId:c}=this.opts,u=a[c];return u&&(s=(0,Zt.resolveUrl)(this.opts.uriResolver,s,u)),new xs({schema:a,schemaId:c,root:t,baseId:s})}return kp.call(this,r,i)}}zt.resolveSchema=ec;var DN=new Set(["properties","patternProperties","enum","dependencies","definitions"]);function kp(t,{baseId:e,schema:r,root:n}){var s;if(((s=t.fragment)===null||s===void 0?void 0:s[0])!=="/")return;for(let a of t.fragment.slice(1).split("/")){if(typeof r=="boolean")return;let c=r[(0,sb.unescapeFragment)(a)];if(c===void 0)return;r=c;let u=typeof r=="object"&&r[this.opts.schemaId];!DN.has(a)&&u&&(e=(0,Zt.resolveUrl)(this.opts.uriResolver,e,u))}let o;if(typeof r!="boolean"&&r.$ref&&!(0,sb.schemaHasRulesButRef)(r,this.RULES)){let a=(0,Zt.resolveUrl)(this.opts.uriResolver,e,r.$ref);o=ec.call(this,n,a)}let{schemaId:i}=this.opts;if(o=o||new xs({schema:r,schemaId:i,root:n,baseId:e}),o.schema!==o.root.schema)return o}});var ib=v((AV,ZN)=>{ZN.exports={$id:"https://raw.githubusercontent.com/ajv-validator/ajv/master/lib/refs/data.json#",description:"Meta-schema for $data reference (JSON AnySchema extension proposal)",type:"object",required:["$data"],properties:{$data:{type:"string",anyOf:[{format:"relative-json-pointer"},{format:"json-pointer"}]}},additionalProperties:!1}});var cb=v(Pp=>{"use strict";Object.defineProperty(Pp,"__esModule",{value:!0});var ab=Vl();ab.code='require("ajv/dist/runtime/uri").default';Pp.default=ab});var gb=v(He=>{"use strict";Object.defineProperty(He,"__esModule",{value:!0});He.CodeGen=He.Name=He.nil=He.stringify=He.str=He._=He.KeywordCxt=void 0;var LN=Yo();Object.defineProperty(He,"KeywordCxt",{enumerable:!0,get:function(){return LN.KeywordCxt}});var ks=W();Object.defineProperty(He,"_",{enumerable:!0,get:function(){return ks._}});Object.defineProperty(He,"str",{enumerable:!0,get:function(){return ks.str}});Object.defineProperty(He,"stringify",{enumerable:!0,get:function(){return ks.stringify}});Object.defineProperty(He,"nil",{enumerable:!0,get:function(){return ks.nil}});Object.defineProperty(He,"Name",{enumerable:!0,get:function(){return ks.Name}});Object.defineProperty(He,"CodeGen",{enumerable:!0,get:function(){return ks.CodeGen}});var VN=Xa(),fb=Qo(),FN=ap(),Xo=tc(),UN=W(),ei=Go(),rc=Bo(),Tp=le(),ub=ib(),HN=cb(),mb=(t,e)=>new RegExp(t,e);mb.code="new RegExp";var KN=["removeAdditional","useDefaults","coerceTypes"],BN=new Set(["validate","serialize","parse","wrapper","root","schema","keyword","pattern","formats","validate$data","func","obj","Error"]),GN={errorDataPath:"",format:"`validateFormats: false` can be used instead.",nullable:'"nullable" keyword is supported by default.',jsonPointers:"Deprecated jsPropertySyntax can be used instead.",extendRefs:"Deprecated ignoreKeywordsWithRef can be used instead.",missingRefs:"Pass empty schema with $id that should be ignored to ajv.addSchema.",processCode:"Use option `code: {process: (code, schemaEnv: object) => string}`",sourceCode:"Use option `code: {source: true}`",strictDefaults:"It is default now, see option `strict`.",strictKeywords:"It is default now, see option `strict`.",uniqueItems:'"uniqueItems" keyword is always validated.',unknownFormats:"Disable strict mode or pass `true` to `ajv.addFormat` (or `formats` option).",cache:"Map is used as cache, schema object as key.",serialize:"Map is used as cache, schema object as key.",ajvErrors:"It is default now."},WN={ignoreKeywordsWithRef:"",jsPropertySyntax:"",unicode:'"minLength"/"maxLength" account for unicode characters by default.'},lb=200;function JN(t){var e,r,n,s,o,i,a,c,u,l,d,f,p,m,h,g,y,x,$,S,w,D,F,Ce,H;let we=t.strict,Ae=(e=t.code)===null||e===void 0?void 0:e.optimize,Gr=Ae===!0||Ae===void 0?1:Ae||0,js=(n=(r=t.code)===null||r===void 0?void 0:r.regExp)!==null&&n!==void 0?n:mb,zc=(s=t.uriResolver)!==null&&s!==void 0?s:HN.default;return{strictSchema:(i=(o=t.strictSchema)!==null&&o!==void 0?o:we)!==null&&i!==void 0?i:!0,strictNumbers:(c=(a=t.strictNumbers)!==null&&a!==void 0?a:we)!==null&&c!==void 0?c:!0,strictTypes:(l=(u=t.strictTypes)!==null&&u!==void 0?u:we)!==null&&l!==void 0?l:"log",strictTuples:(f=(d=t.strictTuples)!==null&&d!==void 0?d:we)!==null&&f!==void 0?f:"log",strictRequired:(m=(p=t.strictRequired)!==null&&p!==void 0?p:we)!==null&&m!==void 0?m:!1,code:t.code?{...t.code,optimize:Gr,regExp:js}:{optimize:Gr,regExp:js},loopRequired:(h=t.loopRequired)!==null&&h!==void 0?h:lb,loopEnum:(g=t.loopEnum)!==null&&g!==void 0?g:lb,meta:(y=t.meta)!==null&&y!==void 0?y:!0,messages:(x=t.messages)!==null&&x!==void 0?x:!0,inlineRefs:($=t.inlineRefs)!==null&&$!==void 0?$:!0,schemaId:(S=t.schemaId)!==null&&S!==void 0?S:"$id",addUsedSchema:(w=t.addUsedSchema)!==null&&w!==void 0?w:!0,validateSchema:(D=t.validateSchema)!==null&&D!==void 0?D:!0,validateFormats:(F=t.validateFormats)!==null&&F!==void 0?F:!0,unicodeRegExp:(Ce=t.unicodeRegExp)!==null&&Ce!==void 0?Ce:!0,int32range:(H=t.int32range)!==null&&H!==void 0?H:!0,uriResolver:zc}}var ti=class{constructor(e={}){this.schemas={},this.refs={},this.formats={},this._compilations=new Set,this._loading={},this._cache=new Map,e=this.opts={...e,...JN(e)};let{es5:r,lines:n}=this.opts.code;this.scope=new UN.ValueScope({scope:{},prefixes:BN,es5:r,lines:n}),this.logger=r1(e.logger);let s=e.validateFormats;e.validateFormats=!1,this.RULES=(0,FN.getRules)(),db.call(this,GN,e,"NOT SUPPORTED"),db.call(this,WN,e,"DEPRECATED","warn"),this._metaOpts=e1.call(this),e.formats&&QN.call(this),this._addVocabularies(),this._addDefaultMetaSchema(),e.keywords&&XN.call(this,e.keywords),typeof e.meta=="object"&&this.addMetaSchema(e.meta),YN.call(this),e.validateFormats=s}_addVocabularies(){this.addKeyword("$async")}_addDefaultMetaSchema(){let{$data:e,meta:r,schemaId:n}=this.opts,s=ub;n==="id"&&(s={...ub},s.id=s.$id,delete s.$id),r&&e&&this.addMetaSchema(s,s[n],!1)}defaultMeta(){let{meta:e,schemaId:r}=this.opts;return this.opts.defaultMeta=typeof e=="object"?e[r]||e:void 0}validate(e,r){let n;if(typeof e=="string"){if(n=this.getSchema(e),!n)throw new Error(`no schema with key or ref "${e}"`)}else n=this.compile(e);let s=n(r);return"$async"in n||(this.errors=n.errors),s}compile(e,r){let n=this._addSchema(e,r);return n.validate||this._compileSchemaEnv(n)}compileAsync(e,r){if(typeof this.opts.loadSchema!="function")throw new Error("options.loadSchema should be a function");let{loadSchema:n}=this.opts;return s.call(this,e,r);async function s(l,d){await o.call(this,l.$schema);let f=this._addSchema(l,d);return f.validate||i.call(this,f)}async function o(l){l&&!this.getSchema(l)&&await s.call(this,{$ref:l},!0)}async function i(l){try{return this._compileSchemaEnv(l)}catch(d){if(!(d instanceof fb.default))throw d;return a.call(this,d),await c.call(this,d.missingSchema),i.call(this,l)}}function a({missingSchema:l,missingRef:d}){if(this.refs[l])throw new Error(`AnySchema ${l} is loaded but ${d} cannot be resolved`)}async function c(l){let d=await u.call(this,l);this.refs[l]||await o.call(this,d.$schema),this.refs[l]||this.addSchema(d,l,r)}async function u(l){let d=this._loading[l];if(d)return d;try{return await(this._loading[l]=n(l))}finally{delete this._loading[l]}}}addSchema(e,r,n,s=this.opts.validateSchema){if(Array.isArray(e)){for(let i of e)this.addSchema(i,void 0,n,s);return this}let o;if(typeof e=="object"){let{schemaId:i}=this.opts;if(o=e[i],o!==void 0&&typeof o!="string")throw new Error(`schema ${i} must be string`)}return r=(0,ei.normalizeId)(r||o),this._checkUnique(r),this.schemas[r]=this._addSchema(e,n,r,s,!0),this}addMetaSchema(e,r,n=this.opts.validateSchema){return this.addSchema(e,r,!0,n),this}validateSchema(e,r){if(typeof e=="boolean")return!0;let n;if(n=e.$schema,n!==void 0&&typeof n!="string")throw new Error("$schema must be a string");if(n=n||this.opts.defaultMeta||this.defaultMeta(),!n)return this.logger.warn("meta-schema not available"),this.errors=null,!0;let s=this.validate(n,e);if(!s&&r){let o="schema is invalid: "+this.errorsText();if(this.opts.validateSchema==="log")this.logger.error(o);else throw new Error(o)}return s}getSchema(e){let r;for(;typeof(r=pb.call(this,e))=="string";)e=r;if(r===void 0){let{schemaId:n}=this.opts,s=new Xo.SchemaEnv({schema:{},schemaId:n});if(r=Xo.resolveSchema.call(this,s,e),!r)return;this.refs[e]=r}return r.validate||this._compileSchemaEnv(r)}removeSchema(e){if(e instanceof RegExp)return this._removeAllSchemas(this.schemas,e),this._removeAllSchemas(this.refs,e),this;switch(typeof e){case"undefined":return this._removeAllSchemas(this.schemas),this._removeAllSchemas(this.refs),this._cache.clear(),this;case"string":{let r=pb.call(this,e);return typeof r=="object"&&this._cache.delete(r.schema),delete this.schemas[e],delete this.refs[e],this}case"object":{let r=e;this._cache.delete(r);let n=e[this.opts.schemaId];return n&&(n=(0,ei.normalizeId)(n),delete this.schemas[n],delete this.refs[n]),this}default:throw new Error("ajv.removeSchema: invalid parameter")}}addVocabulary(e){for(let r of e)this.addKeyword(r);return this}addKeyword(e,r){let n;if(typeof e=="string")n=e,typeof r=="object"&&(this.logger.warn("these parameters are deprecated, see docs for addKeyword"),r.keyword=n);else if(typeof e=="object"&&r===void 0){if(r=e,n=r.keyword,Array.isArray(n)&&!n.length)throw new Error("addKeywords: keyword must be string or non-empty array")}else throw new Error("invalid addKeywords parameters");if(s1.call(this,n,r),!r)return(0,Tp.eachItem)(n,o=>Ep.call(this,o)),this;i1.call(this,r);let s={...r,type:(0,rc.getJSONTypes)(r.type),schemaType:(0,rc.getJSONTypes)(r.schemaType)};return(0,Tp.eachItem)(n,s.type.length===0?o=>Ep.call(this,o,s):o=>s.type.forEach(i=>Ep.call(this,o,s,i))),this}getKeyword(e){let r=this.RULES.all[e];return typeof r=="object"?r.definition:!!r}removeKeyword(e){let{RULES:r}=this;delete r.keywords[e],delete r.all[e];for(let n of r.rules){let s=n.rules.findIndex(o=>o.keyword===e);s>=0&&n.rules.splice(s,1)}return this}addFormat(e,r){return typeof r=="string"&&(r=new RegExp(r)),this.formats[e]=r,this}errorsText(e=this.errors,{separator:r=", ",dataVar:n="data"}={}){return!e||e.length===0?"No errors":e.map(s=>`${n}${s.instancePath} ${s.message}`).reduce((s,o)=>s+r+o)}$dataMetaSchema(e,r){let n=this.RULES.all;e=JSON.parse(JSON.stringify(e));for(let s of r){let o=s.split("/").slice(1),i=e;for(let a of o)i=i[a];for(let a in n){let c=n[a];if(typeof c!="object")continue;let{$data:u}=c.definition,l=i[a];u&&l&&(i[a]=hb(l))}}return e}_removeAllSchemas(e,r){for(let n in e){let s=e[n];(!r||r.test(n))&&(typeof s=="string"?delete e[n]:s&&!s.meta&&(this._cache.delete(s.schema),delete e[n]))}}_addSchema(e,r,n,s=this.opts.validateSchema,o=this.opts.addUsedSchema){let i,{schemaId:a}=this.opts;if(typeof e=="object")i=e[a];else{if(this.opts.jtd)throw new Error("schema must be object");if(typeof e!="boolean")throw new Error("schema must be object or boolean")}let c=this._cache.get(e);if(c!==void 0)return c;n=(0,ei.normalizeId)(i||n);let u=ei.getSchemaRefs.call(this,e,n);return c=new Xo.SchemaEnv({schema:e,schemaId:a,meta:r,baseId:n,localRefs:u}),this._cache.set(c.schema,c),o&&!n.startsWith("#")&&(n&&this._checkUnique(n),this.refs[n]=c),s&&this.validateSchema(e,!0),c}_checkUnique(e){if(this.schemas[e]||this.refs[e])throw new Error(`schema with key or id "${e}" already exists`)}_compileSchemaEnv(e){if(e.meta?this._compileMetaSchema(e):Xo.compileSchema.call(this,e),!e.validate)throw new Error("ajv implementation error");return e.validate}_compileMetaSchema(e){let r=this.opts;this.opts=this._metaOpts;try{Xo.compileSchema.call(this,e)}finally{this.opts=r}}};ti.ValidationError=VN.default;ti.MissingRefError=fb.default;He.default=ti;function db(t,e,r,n="error"){for(let s in t){let o=s;o in e&&this.logger[n](`${r}: option ${s}. ${t[o]}`)}}function pb(t){return t=(0,ei.normalizeId)(t),this.schemas[t]||this.refs[t]}function YN(){let t=this.opts.schemas;if(t)if(Array.isArray(t))this.addSchema(t);else for(let e in t)this.addSchema(t[e],e)}function QN(){for(let t in this.opts.formats){let e=this.opts.formats[t];e&&this.addFormat(t,e)}}function XN(t){if(Array.isArray(t)){this.addVocabulary(t);return}this.logger.warn("keywords option as map is deprecated, pass array");for(let e in t){let r=t[e];r.keyword||(r.keyword=e),this.addKeyword(r)}}function e1(){let t={...this.opts};for(let e of KN)delete t[e];return t}var t1={log(){},warn(){},error(){}};function r1(t){if(t===!1)return t1;if(t===void 0)return console;if(t.log&&t.warn&&t.error)return t;throw new Error("logger must implement log, warn and error methods")}var n1=/^[a-z_$][a-z0-9_$:-]*$/i;function s1(t,e){let{RULES:r}=this;if((0,Tp.eachItem)(t,n=>{if(r.keywords[n])throw new Error(`Keyword ${n} is already defined`);if(!n1.test(n))throw new Error(`Keyword ${n} has invalid name`)}),!!e&&e.$data&&!("code"in e||"validate"in e))throw new Error('$data keyword must have "code" or "validate" function')}function Ep(t,e,r){var n;let s=e?.post;if(r&&s)throw new Error('keyword with "post" flag cannot have "type"');let{RULES:o}=this,i=s?o.post:o.rules.find(({type:c})=>c===r);if(i||(i={type:r,rules:[]},o.rules.push(i)),o.keywords[t]=!0,!e)return;let a={keyword:t,definition:{...e,type:(0,rc.getJSONTypes)(e.type),schemaType:(0,rc.getJSONTypes)(e.schemaType)}};e.before?o1.call(this,i,a,e.before):i.rules.push(a),o.all[t]=a,(n=e.implements)===null||n===void 0||n.forEach(c=>this.addKeyword(c))}function o1(t,e,r){let n=t.rules.findIndex(s=>s.keyword===r);n>=0?t.rules.splice(n,0,e):(t.rules.push(e),this.logger.warn(`rule ${r} is not defined`))}function i1(t){let{metaSchema:e}=t;e!==void 0&&(t.$data&&this.opts.$data&&(e=hb(e)),t.validateSchema=this.compile(e,!0))}var a1={$ref:"https://raw.githubusercontent.com/ajv-validator/ajv/master/lib/refs/data.json#"};function hb(t){return{anyOf:[t,a1]}}});var yb=v(zp=>{"use strict";Object.defineProperty(zp,"__esModule",{value:!0});var c1={keyword:"id",code(){throw new Error('NOT SUPPORTED: keyword "id", use "$id" for schema ID')}};zp.default=c1});var wb=v(Mn=>{"use strict";Object.defineProperty(Mn,"__esModule",{value:!0});Mn.callRef=Mn.getValidate=void 0;var u1=Qo(),vb=Tt(),gt=W(),Ss=wr(),_b=tc(),nc=le(),l1={keyword:"$ref",schemaType:"string",code(t){let{gen:e,schema:r,it:n}=t,{baseId:s,schemaEnv:o,validateName:i,opts:a,self:c}=n,{root:u}=o;if((r==="#"||r==="#/")&&s===u.baseId)return d();let l=_b.resolveRef.call(c,u,s,r);if(l===void 0)throw new u1.default(n.opts.uriResolver,s,r);if(l instanceof _b.SchemaEnv)return f(l);return p(l);function d(){if(o===u)return sc(t,i,o,o.$async);let m=e.scopeValue("root",{ref:u});return sc(t,(0,gt._)`${m}.validate`,u,u.$async)}function f(m){let h=bb(t,m);sc(t,h,m,m.$async)}function p(m){let h=e.scopeValue("schema",a.code.source===!0?{ref:m,code:(0,gt.stringify)(m)}:{ref:m}),g=e.name("valid"),y=t.subschema({schema:m,dataTypes:[],schemaPath:gt.nil,topSchemaRef:h,errSchemaPath:r},g);t.mergeEvaluated(y),t.ok(g)}}};function bb(t,e){let{gen:r}=t;return e.validate?r.scopeValue("validate",{ref:e.validate}):(0,gt._)`${r.scopeValue("wrapper",{ref:e})}.validate`}Mn.getValidate=bb;function sc(t,e,r,n){let{gen:s,it:o}=t,{allErrors:i,schemaEnv:a,opts:c}=o,u=c.passContext?Ss.default.this:gt.nil;n?l():d();function l(){if(!a.$async)throw new Error("async schema referenced by sync schema");let m=s.let("valid");s.try(()=>{s.code((0,gt._)`await ${(0,vb.callValidateCode)(t,e,u)}`),p(e),i||s.assign(m,!0)},h=>{s.if((0,gt._)`!(${h} instanceof ${o.ValidationError})`,()=>s.throw(h)),f(h),i||s.assign(m,!1)}),t.ok(m)}function d(){t.result((0,vb.callValidateCode)(t,e,u),()=>p(e),()=>f(e))}function f(m){let h=(0,gt._)`${m}.errors`;s.assign(Ss.default.vErrors,(0,gt._)`${Ss.default.vErrors} === null ? ${h} : ${Ss.default.vErrors}.concat(${h})`),s.assign(Ss.default.errors,(0,gt._)`${Ss.default.vErrors}.length`)}function p(m){var h;if(!o.opts.unevaluated)return;let g=(h=r?.validate)===null||h===void 0?void 0:h.evaluated;if(o.props!==!0)if(g&&!g.dynamicProps)g.props!==void 0&&(o.props=nc.mergeEvaluated.props(s,g.props,o.props));else{let y=s.var("props",(0,gt._)`${m}.evaluated.props`);o.props=nc.mergeEvaluated.props(s,y,o.props,gt.Name)}if(o.items!==!0)if(g&&!g.dynamicItems)g.items!==void 0&&(o.items=nc.mergeEvaluated.items(s,g.items,o.items));else{let y=s.var("items",(0,gt._)`${m}.evaluated.items`);o.items=nc.mergeEvaluated.items(s,y,o.items,gt.Name)}}}Mn.callRef=sc;Mn.default=l1});var $b=v(Cp=>{"use strict";Object.defineProperty(Cp,"__esModule",{value:!0});var d1=yb(),p1=wb(),f1=["$schema","$id","$defs","$vocabulary",{keyword:"$comment"},"definitions",d1.default,p1.default];Cp.default=f1});var xb=v(Ip=>{"use strict";Object.defineProperty(Ip,"__esModule",{value:!0});var oc=W(),Kr=oc.operators,ic={maximum:{okStr:"<=",ok:Kr.LTE,fail:Kr.GT},minimum:{okStr:">=",ok:Kr.GTE,fail:Kr.LT},exclusiveMaximum:{okStr:"<",ok:Kr.LT,fail:Kr.GTE},exclusiveMinimum:{okStr:">",ok:Kr.GT,fail:Kr.LTE}},m1={message:({keyword:t,schemaCode:e})=>(0,oc.str)`must be ${ic[t].okStr} ${e}`,params:({keyword:t,schemaCode:e})=>(0,oc._)`{comparison: ${ic[t].okStr}, limit: ${e}}`},h1={keyword:Object.keys(ic),type:"number",schemaType:"number",$data:!0,error:m1,code(t){let{keyword:e,data:r,schemaCode:n}=t;t.fail$data((0,oc._)`${r} ${ic[e].fail} ${n} || isNaN(${r})`)}};Ip.default=h1});var kb=v(Rp=>{"use strict";Object.defineProperty(Rp,"__esModule",{value:!0});var ri=W(),g1={message:({schemaCode:t})=>(0,ri.str)`must be multiple of ${t}`,params:({schemaCode:t})=>(0,ri._)`{multipleOf: ${t}}`},y1={keyword:"multipleOf",type:"number",schemaType:"number",$data:!0,error:g1,code(t){let{gen:e,data:r,schemaCode:n,it:s}=t,o=s.opts.multipleOfPrecision,i=e.let("res"),a=o?(0,ri._)`Math.abs(Math.round(${i}) - ${i}) > 1e-${o}`:(0,ri._)`${i} !== parseInt(${i})`;t.fail$data((0,ri._)`(${n} === 0 || (${i} = ${r}/${n}, ${a}))`)}};Rp.default=y1});var Pb=v(Op=>{"use strict";Object.defineProperty(Op,"__esModule",{value:!0});function Sb(t){let e=t.length,r=0,n=0,s;for(;n<e;)r++,s=t.charCodeAt(n++),s>=55296&&s<=56319&&n<e&&(s=t.charCodeAt(n),(s&64512)===56320&&n++);return r}Op.default=Sb;Sb.code='require("ajv/dist/runtime/ucs2length").default'});var Eb=v(Np=>{"use strict";Object.defineProperty(Np,"__esModule",{value:!0});var qn=W(),v1=le(),_1=Pb(),b1={message({keyword:t,schemaCode:e}){let r=t==="maxLength"?"more":"fewer";return(0,qn.str)`must NOT have ${r} than ${e} characters`},params:({schemaCode:t})=>(0,qn._)`{limit: ${t}}`},w1={keyword:["maxLength","minLength"],type:"string",schemaType:"number",$data:!0,error:b1,code(t){let{keyword:e,data:r,schemaCode:n,it:s}=t,o=e==="maxLength"?qn.operators.GT:qn.operators.LT,i=s.opts.unicode===!1?(0,qn._)`${r}.length`:(0,qn._)`${(0,v1.useFunc)(t.gen,_1.default)}(${r})`;t.fail$data((0,qn._)`${i} ${o} ${n}`)}};Np.default=w1});var Tb=v(jp=>{"use strict";Object.defineProperty(jp,"__esModule",{value:!0});var $1=Tt(),ac=W(),x1={message:({schemaCode:t})=>(0,ac.str)`must match pattern "${t}"`,params:({schemaCode:t})=>(0,ac._)`{pattern: ${t}}`},k1={keyword:"pattern",type:"string",schemaType:"string",$data:!0,error:x1,code(t){let{data:e,$data:r,schema:n,schemaCode:s,it:o}=t,i=o.opts.unicodeRegExp?"u":"",a=r?(0,ac._)`(new RegExp(${s}, ${i}))`:(0,$1.usePattern)(t,n);t.fail$data((0,ac._)`!${a}.test(${e})`)}};jp.default=k1});var zb=v(Ap=>{"use strict";Object.defineProperty(Ap,"__esModule",{value:!0});var ni=W(),S1={message({keyword:t,schemaCode:e}){let r=t==="maxProperties"?"more":"fewer";return(0,ni.str)`must NOT have ${r} than ${e} properties`},params:({schemaCode:t})=>(0,ni._)`{limit: ${t}}`},P1={keyword:["maxProperties","minProperties"],type:"object",schemaType:"number",$data:!0,error:S1,code(t){let{keyword:e,data:r,schemaCode:n}=t,s=e==="maxProperties"?ni.operators.GT:ni.operators.LT;t.fail$data((0,ni._)`Object.keys(${r}).length ${s} ${n}`)}};Ap.default=P1});var Cb=v(Mp=>{"use strict";Object.defineProperty(Mp,"__esModule",{value:!0});var si=Tt(),oi=W(),E1=le(),T1={message:({params:{missingProperty:t}})=>(0,oi.str)`must have required property '${t}'`,params:({params:{missingProperty:t}})=>(0,oi._)`{missingProperty: ${t}}`},z1={keyword:"required",type:"object",schemaType:"array",$data:!0,error:T1,code(t){let{gen:e,schema:r,schemaCode:n,data:s,$data:o,it:i}=t,{opts:a}=i;if(!o&&r.length===0)return;let c=r.length>=a.loopRequired;if(i.allErrors?u():l(),a.strictRequired){let p=t.parentSchema.properties,{definedProperties:m}=t.it;for(let h of r)if(p?.[h]===void 0&&!m.has(h)){let g=i.schemaEnv.baseId+i.errSchemaPath,y=`required property "${h}" is not defined at "${g}" (strictRequired)`;(0,E1.checkStrictMode)(i,y,i.opts.strictRequired)}}function u(){if(c||o)t.block$data(oi.nil,d);else for(let p of r)(0,si.checkReportMissingProp)(t,p)}function l(){let p=e.let("missing");if(c||o){let m=e.let("valid",!0);t.block$data(m,()=>f(p,m)),t.ok(m)}else e.if((0,si.checkMissingProp)(t,r,p)),(0,si.reportMissingProp)(t,p),e.else()}function d(){e.forOf("prop",n,p=>{t.setParams({missingProperty:p}),e.if((0,si.noPropertyInData)(e,s,p,a.ownProperties),()=>t.error())})}function f(p,m){t.setParams({missingProperty:p}),e.forOf(p,n,()=>{e.assign(m,(0,si.propertyInData)(e,s,p,a.ownProperties)),e.if((0,oi.not)(m),()=>{t.error(),e.break()})},oi.nil)}}};Mp.default=z1});var Ib=v(qp=>{"use strict";Object.defineProperty(qp,"__esModule",{value:!0});var ii=W(),C1={message({keyword:t,schemaCode:e}){let r=t==="maxItems"?"more":"fewer";return(0,ii.str)`must NOT have ${r} than ${e} items`},params:({schemaCode:t})=>(0,ii._)`{limit: ${t}}`},I1={keyword:["maxItems","minItems"],type:"array",schemaType:"number",$data:!0,error:C1,code(t){let{keyword:e,data:r,schemaCode:n}=t,s=e==="maxItems"?ii.operators.GT:ii.operators.LT;t.fail$data((0,ii._)`${r}.length ${s} ${n}`)}};qp.default=I1});var cc=v(Dp=>{"use strict";Object.defineProperty(Dp,"__esModule",{value:!0});var Rb=_o();Rb.code='require("ajv/dist/runtime/equal").default';Dp.default=Rb});var Ob=v(Lp=>{"use strict";Object.defineProperty(Lp,"__esModule",{value:!0});var Zp=Bo(),Ke=W(),R1=le(),O1=cc(),N1={message:({params:{i:t,j:e}})=>(0,Ke.str)`must NOT have duplicate items (items ## ${e} and ${t} are identical)`,params:({params:{i:t,j:e}})=>(0,Ke._)`{i: ${t}, j: ${e}}`},j1={keyword:"uniqueItems",type:"array",schemaType:"boolean",$data:!0,error:N1,code(t){let{gen:e,data:r,$data:n,schema:s,parentSchema:o,schemaCode:i,it:a}=t;if(!n&&!s)return;let c=e.let("valid"),u=o.items?(0,Zp.getSchemaTypes)(o.items):[];t.block$data(c,l,(0,Ke._)`${i} === false`),t.ok(c);function l(){let m=e.let("i",(0,Ke._)`${r}.length`),h=e.let("j");t.setParams({i:m,j:h}),e.assign(c,!0),e.if((0,Ke._)`${m} > 1`,()=>(d()?f:p)(m,h))}function d(){return u.length>0&&!u.some(m=>m==="object"||m==="array")}function f(m,h){let g=e.name("item"),y=(0,Zp.checkDataTypes)(u,g,a.opts.strictNumbers,Zp.DataType.Wrong),x=e.const("indices",(0,Ke._)`{}`);e.for((0,Ke._)`;${m}--;`,()=>{e.let(g,(0,Ke._)`${r}[${m}]`),e.if(y,(0,Ke._)`continue`),u.length>1&&e.if((0,Ke._)`typeof ${g} == "string"`,(0,Ke._)`${g} += "_"`),e.if((0,Ke._)`typeof ${x}[${g}] == "number"`,()=>{e.assign(h,(0,Ke._)`${x}[${g}]`),t.error(),e.assign(c,!1).break()}).code((0,Ke._)`${x}[${g}] = ${m}`)})}function p(m,h){let g=(0,R1.useFunc)(e,O1.default),y=e.name("outer");e.label(y).for((0,Ke._)`;${m}--;`,()=>e.for((0,Ke._)`${h} = ${m}; ${h}--;`,()=>e.if((0,Ke._)`${g}(${r}[${m}], ${r}[${h}])`,()=>{t.error(),e.assign(c,!1).break(y)})))}}};Lp.default=j1});var Nb=v(Fp=>{"use strict";Object.defineProperty(Fp,"__esModule",{value:!0});var Vp=W(),A1=le(),M1=cc(),q1={message:"must be equal to constant",params:({schemaCode:t})=>(0,Vp._)`{allowedValue: ${t}}`},D1={keyword:"const",$data:!0,error:q1,code(t){let{gen:e,data:r,$data:n,schemaCode:s,schema:o}=t;n||o&&typeof o=="object"?t.fail$data((0,Vp._)`!${(0,A1.useFunc)(e,M1.default)}(${r}, ${s})`):t.fail((0,Vp._)`${o} !== ${r}`)}};Fp.default=D1});var jb=v(Up=>{"use strict";Object.defineProperty(Up,"__esModule",{value:!0});var ai=W(),Z1=le(),L1=cc(),V1={message:"must be equal to one of the allowed values",params:({schemaCode:t})=>(0,ai._)`{allowedValues: ${t}}`},F1={keyword:"enum",schemaType:"array",$data:!0,error:V1,code(t){let{gen:e,data:r,$data:n,schema:s,schemaCode:o,it:i}=t;if(!n&&s.length===0)throw new Error("enum must have non-empty array");let a=s.length>=i.opts.loopEnum,c,u=()=>c??(c=(0,Z1.useFunc)(e,L1.default)),l;if(a||n)l=e.let("valid"),t.block$data(l,d);else{if(!Array.isArray(s))throw new Error("ajv implementation error");let p=e.const("vSchema",o);l=(0,ai.or)(...s.map((m,h)=>f(p,h)))}t.pass(l);function d(){e.assign(l,!1),e.forOf("v",o,p=>e.if((0,ai._)`${u()}(${r}, ${p})`,()=>e.assign(l,!0).break()))}function f(p,m){let h=s[m];return typeof h=="object"&&h!==null?(0,ai._)`${u()}(${r}, ${p}[${m}])`:(0,ai._)`${r} === ${h}`}}};Up.default=F1});var Ab=v(Hp=>{"use strict";Object.defineProperty(Hp,"__esModule",{value:!0});var U1=xb(),H1=kb(),K1=Eb(),B1=Tb(),G1=zb(),W1=Cb(),J1=Ib(),Y1=Ob(),Q1=Nb(),X1=jb(),ej=[U1.default,H1.default,K1.default,B1.default,G1.default,W1.default,J1.default,Y1.default,{keyword:"type",schemaType:["string","array"]},{keyword:"nullable",schemaType:"boolean"},Q1.default,X1.default];Hp.default=ej});var Bp=v(ci=>{"use strict";Object.defineProperty(ci,"__esModule",{value:!0});ci.validateAdditionalItems=void 0;var Dn=W(),Kp=le(),tj={message:({params:{len:t}})=>(0,Dn.str)`must NOT have more than ${t} items`,params:({params:{len:t}})=>(0,Dn._)`{limit: ${t}}`},rj={keyword:"additionalItems",type:"array",schemaType:["boolean","object"],before:"uniqueItems",error:tj,code(t){let{parentSchema:e,it:r}=t,{items:n}=e;if(!Array.isArray(n)){(0,Kp.checkStrictMode)(r,'"additionalItems" is ignored when "items" is not an array of schemas');return}Mb(t,n)}};function Mb(t,e){let{gen:r,schema:n,data:s,keyword:o,it:i}=t;i.items=!0;let a=r.const("len",(0,Dn._)`${s}.length`);if(n===!1)t.setParams({len:e.length}),t.pass((0,Dn._)`${a} <= ${e.length}`);else if(typeof n=="object"&&!(0,Kp.alwaysValidSchema)(i,n)){let u=r.var("valid",(0,Dn._)`${a} <= ${e.length}`);r.if((0,Dn.not)(u),()=>c(u)),t.ok(u)}function c(u){r.forRange("i",e.length,a,l=>{t.subschema({keyword:o,dataProp:l,dataPropType:Kp.Type.Num},u),i.allErrors||r.if((0,Dn.not)(u),()=>r.break())})}}ci.validateAdditionalItems=Mb;ci.default=rj});var Gp=v(ui=>{"use strict";Object.defineProperty(ui,"__esModule",{value:!0});ui.validateTuple=void 0;var qb=W(),uc=le(),nj=Tt(),sj={keyword:"items",type:"array",schemaType:["object","array","boolean"],before:"uniqueItems",code(t){let{schema:e,it:r}=t;if(Array.isArray(e))return Db(t,"additionalItems",e);r.items=!0,!(0,uc.alwaysValidSchema)(r,e)&&t.ok((0,nj.validateArray)(t))}};function Db(t,e,r=t.schema){let{gen:n,parentSchema:s,data:o,keyword:i,it:a}=t;l(s),a.opts.unevaluated&&r.length&&a.items!==!0&&(a.items=uc.mergeEvaluated.items(n,r.length,a.items));let c=n.name("valid"),u=n.const("len",(0,qb._)`${o}.length`);r.forEach((d,f)=>{(0,uc.alwaysValidSchema)(a,d)||(n.if((0,qb._)`${u} > ${f}`,()=>t.subschema({keyword:i,schemaProp:f,dataProp:f},c)),t.ok(c))});function l(d){let{opts:f,errSchemaPath:p}=a,m=r.length,h=m===d.minItems&&(m===d.maxItems||d[e]===!1);if(f.strictTuples&&!h){let g=`"${i}" is ${m}-tuple, but minItems or maxItems/${e} are not specified or different at path "${p}"`;(0,uc.checkStrictMode)(a,g,f.strictTuples)}}}ui.validateTuple=Db;ui.default=sj});var Zb=v(Wp=>{"use strict";Object.defineProperty(Wp,"__esModule",{value:!0});var oj=Gp(),ij={keyword:"prefixItems",type:"array",schemaType:["array"],before:"uniqueItems",code:t=>(0,oj.validateTuple)(t,"items")};Wp.default=ij});var Vb=v(Jp=>{"use strict";Object.defineProperty(Jp,"__esModule",{value:!0});var Lb=W(),aj=le(),cj=Tt(),uj=Bp(),lj={message:({params:{len:t}})=>(0,Lb.str)`must NOT have more than ${t} items`,params:({params:{len:t}})=>(0,Lb._)`{limit: ${t}}`},dj={keyword:"items",type:"array",schemaType:["object","boolean"],before:"uniqueItems",error:lj,code(t){let{schema:e,parentSchema:r,it:n}=t,{prefixItems:s}=r;n.items=!0,!(0,aj.alwaysValidSchema)(n,e)&&(s?(0,uj.validateAdditionalItems)(t,s):t.ok((0,cj.validateArray)(t)))}};Jp.default=dj});var Fb=v(Yp=>{"use strict";Object.defineProperty(Yp,"__esModule",{value:!0});var Ct=W(),lc=le(),pj={message:({params:{min:t,max:e}})=>e===void 0?(0,Ct.str)`must contain at least ${t} valid item(s)`:(0,Ct.str)`must contain at least ${t} and no more than ${e} valid item(s)`,params:({params:{min:t,max:e}})=>e===void 0?(0,Ct._)`{minContains: ${t}}`:(0,Ct._)`{minContains: ${t}, maxContains: ${e}}`},fj={keyword:"contains",type:"array",schemaType:["object","boolean"],before:"uniqueItems",trackErrors:!0,error:pj,code(t){let{gen:e,schema:r,parentSchema:n,data:s,it:o}=t,i,a,{minContains:c,maxContains:u}=n;o.opts.next?(i=c===void 0?1:c,a=u):i=1;let l=e.const("len",(0,Ct._)`${s}.length`);if(t.setParams({min:i,max:a}),a===void 0&&i===0){(0,lc.checkStrictMode)(o,'"minContains" == 0 without "maxContains": "contains" keyword ignored');return}if(a!==void 0&&i>a){(0,lc.checkStrictMode)(o,'"minContains" > "maxContains" is always invalid'),t.fail();return}if((0,lc.alwaysValidSchema)(o,r)){let h=(0,Ct._)`${l} >= ${i}`;a!==void 0&&(h=(0,Ct._)`${h} && ${l} <= ${a}`),t.pass(h);return}o.items=!0;let d=e.name("valid");a===void 0&&i===1?p(d,()=>e.if(d,()=>e.break())):i===0?(e.let(d,!0),a!==void 0&&e.if((0,Ct._)`${s}.length > 0`,f)):(e.let(d,!1),f()),t.result(d,()=>t.reset());function f(){let h=e.name("_valid"),g=e.let("count",0);p(h,()=>e.if(h,()=>m(g)))}function p(h,g){e.forRange("i",0,l,y=>{t.subschema({keyword:"contains",dataProp:y,dataPropType:lc.Type.Num,compositeRule:!0},h),g()})}function m(h){e.code((0,Ct._)`${h}++`),a===void 0?e.if((0,Ct._)`${h} >= ${i}`,()=>e.assign(d,!0).break()):(e.if((0,Ct._)`${h} > ${a}`,()=>e.assign(d,!1).break()),i===1?e.assign(d,!0):e.if((0,Ct._)`${h} >= ${i}`,()=>e.assign(d,!0)))}}};Yp.default=fj});var Kb=v(or=>{"use strict";Object.defineProperty(or,"__esModule",{value:!0});or.validateSchemaDeps=or.validatePropertyDeps=or.error=void 0;var Qp=W(),mj=le(),li=Tt();or.error={message:({params:{property:t,depsCount:e,deps:r}})=>{let n=e===1?"property":"properties";return(0,Qp.str)`must have ${n} ${r} when property ${t} is present`},params:({params:{property:t,depsCount:e,deps:r,missingProperty:n}})=>(0,Qp._)`{property: ${t},
    missingProperty: ${n},
    depsCount: ${e},
    deps: ${r}}`};var hj={keyword:"dependencies",type:"object",schemaType:"object",error:or.error,code(t){let[e,r]=gj(t);Ub(t,e),Hb(t,r)}};function gj({schema:t}){let e={},r={};for(let n in t){if(n==="__proto__")continue;let s=Array.isArray(t[n])?e:r;s[n]=t[n]}return[e,r]}function Ub(t,e=t.schema){let{gen:r,data:n,it:s}=t;if(Object.keys(e).length===0)return;let o=r.let("missing");for(let i in e){let a=e[i];if(a.length===0)continue;let c=(0,li.propertyInData)(r,n,i,s.opts.ownProperties);t.setParams({property:i,depsCount:a.length,deps:a.join(", ")}),s.allErrors?r.if(c,()=>{for(let u of a)(0,li.checkReportMissingProp)(t,u)}):(r.if((0,Qp._)`${c} && (${(0,li.checkMissingProp)(t,a,o)})`),(0,li.reportMissingProp)(t,o),r.else())}}or.validatePropertyDeps=Ub;function Hb(t,e=t.schema){let{gen:r,data:n,keyword:s,it:o}=t,i=r.name("valid");for(let a in e)(0,mj.alwaysValidSchema)(o,e[a])||(r.if((0,li.propertyInData)(r,n,a,o.opts.ownProperties),()=>{let c=t.subschema({keyword:s,schemaProp:a},i);t.mergeValidEvaluated(c,i)},()=>r.var(i,!0)),t.ok(i))}or.validateSchemaDeps=Hb;or.default=hj});var Gb=v(Xp=>{"use strict";Object.defineProperty(Xp,"__esModule",{value:!0});var Bb=W(),yj=le(),vj={message:"property name must be valid",params:({params:t})=>(0,Bb._)`{propertyName: ${t.propertyName}}`},_j={keyword:"propertyNames",type:"object",schemaType:["object","boolean"],error:vj,code(t){let{gen:e,schema:r,data:n,it:s}=t;if((0,yj.alwaysValidSchema)(s,r))return;let o=e.name("valid");e.forIn("key",n,i=>{t.setParams({propertyName:i}),t.subschema({keyword:"propertyNames",data:i,dataTypes:["string"],propertyName:i,compositeRule:!0},o),e.if((0,Bb.not)(o),()=>{t.error(!0),s.allErrors||e.break()})}),t.ok(o)}};Xp.default=_j});var tf=v(ef=>{"use strict";Object.defineProperty(ef,"__esModule",{value:!0});var dc=Tt(),Lt=W(),bj=wr(),pc=le(),wj={message:"must NOT have additional properties",params:({params:t})=>(0,Lt._)`{additionalProperty: ${t.additionalProperty}}`},$j={keyword:"additionalProperties",type:["object"],schemaType:["boolean","object"],allowUndefined:!0,trackErrors:!0,error:wj,code(t){let{gen:e,schema:r,parentSchema:n,data:s,errsCount:o,it:i}=t;if(!o)throw new Error("ajv implementation error");let{allErrors:a,opts:c}=i;if(i.props=!0,c.removeAdditional!=="all"&&(0,pc.alwaysValidSchema)(i,r))return;let u=(0,dc.allSchemaProperties)(n.properties),l=(0,dc.allSchemaProperties)(n.patternProperties);d(),t.ok((0,Lt._)`${o} === ${bj.default.errors}`);function d(){e.forIn("key",s,g=>{!u.length&&!l.length?m(g):e.if(f(g),()=>m(g))})}function f(g){let y;if(u.length>8){let x=(0,pc.schemaRefOrVal)(i,n.properties,"properties");y=(0,dc.isOwnProperty)(e,x,g)}else u.length?y=(0,Lt.or)(...u.map(x=>(0,Lt._)`${g} === ${x}`)):y=Lt.nil;return l.length&&(y=(0,Lt.or)(y,...l.map(x=>(0,Lt._)`${(0,dc.usePattern)(t,x)}.test(${g})`))),(0,Lt.not)(y)}function p(g){e.code((0,Lt._)`delete ${s}[${g}]`)}function m(g){if(c.removeAdditional==="all"||c.removeAdditional&&r===!1){p(g);return}if(r===!1){t.setParams({additionalProperty:g}),t.error(),a||e.break();return}if(typeof r=="object"&&!(0,pc.alwaysValidSchema)(i,r)){let y=e.name("valid");c.removeAdditional==="failing"?(h(g,y,!1),e.if((0,Lt.not)(y),()=>{t.reset(),p(g)})):(h(g,y),a||e.if((0,Lt.not)(y),()=>e.break()))}}function h(g,y,x){let $={keyword:"additionalProperties",dataProp:g,dataPropType:pc.Type.Str};x===!1&&Object.assign($,{compositeRule:!0,createErrors:!1,allErrors:!1}),t.subschema($,y)}}};ef.default=$j});var Yb=v(nf=>{"use strict";Object.defineProperty(nf,"__esModule",{value:!0});var xj=Yo(),Wb=Tt(),rf=le(),Jb=tf(),kj={keyword:"properties",type:"object",schemaType:"object",code(t){let{gen:e,schema:r,parentSchema:n,data:s,it:o}=t;o.opts.removeAdditional==="all"&&n.additionalProperties===void 0&&Jb.default.code(new xj.KeywordCxt(o,Jb.default,"additionalProperties"));let i=(0,Wb.allSchemaProperties)(r);for(let d of i)o.definedProperties.add(d);o.opts.unevaluated&&i.length&&o.props!==!0&&(o.props=rf.mergeEvaluated.props(e,(0,rf.toHash)(i),o.props));let a=i.filter(d=>!(0,rf.alwaysValidSchema)(o,r[d]));if(a.length===0)return;let c=e.name("valid");for(let d of a)u(d)?l(d):(e.if((0,Wb.propertyInData)(e,s,d,o.opts.ownProperties)),l(d),o.allErrors||e.else().var(c,!0),e.endIf()),t.it.definedProperties.add(d),t.ok(c);function u(d){return o.opts.useDefaults&&!o.compositeRule&&r[d].default!==void 0}function l(d){t.subschema({keyword:"properties",schemaProp:d,dataProp:d},c)}}};nf.default=kj});var tw=v(sf=>{"use strict";Object.defineProperty(sf,"__esModule",{value:!0});var Qb=Tt(),fc=W(),Xb=le(),ew=le(),Sj={keyword:"patternProperties",type:"object",schemaType:"object",code(t){let{gen:e,schema:r,data:n,parentSchema:s,it:o}=t,{opts:i}=o,a=(0,Qb.allSchemaProperties)(r),c=a.filter(h=>(0,Xb.alwaysValidSchema)(o,r[h]));if(a.length===0||c.length===a.length&&(!o.opts.unevaluated||o.props===!0))return;let u=i.strictSchema&&!i.allowMatchingProperties&&s.properties,l=e.name("valid");o.props!==!0&&!(o.props instanceof fc.Name)&&(o.props=(0,ew.evaluatedPropsToName)(e,o.props));let{props:d}=o;f();function f(){for(let h of a)u&&p(h),o.allErrors?m(h):(e.var(l,!0),m(h),e.if(l))}function p(h){for(let g in u)new RegExp(h).test(g)&&(0,Xb.checkStrictMode)(o,`property ${g} matches pattern ${h} (use allowMatchingProperties)`)}function m(h){e.forIn("key",n,g=>{e.if((0,fc._)`${(0,Qb.usePattern)(t,h)}.test(${g})`,()=>{let y=c.includes(h);y||t.subschema({keyword:"patternProperties",schemaProp:h,dataProp:g,dataPropType:ew.Type.Str},l),o.opts.unevaluated&&d!==!0?e.assign((0,fc._)`${d}[${g}]`,!0):!y&&!o.allErrors&&e.if((0,fc.not)(l),()=>e.break())})})}}};sf.default=Sj});var rw=v(of=>{"use strict";Object.defineProperty(of,"__esModule",{value:!0});var Pj=le(),Ej={keyword:"not",schemaType:["object","boolean"],trackErrors:!0,code(t){let{gen:e,schema:r,it:n}=t;if((0,Pj.alwaysValidSchema)(n,r)){t.fail();return}let s=e.name("valid");t.subschema({keyword:"not",compositeRule:!0,createErrors:!1,allErrors:!1},s),t.failResult(s,()=>t.reset(),()=>t.error())},error:{message:"must NOT be valid"}};of.default=Ej});var nw=v(af=>{"use strict";Object.defineProperty(af,"__esModule",{value:!0});var Tj=Tt(),zj={keyword:"anyOf",schemaType:"array",trackErrors:!0,code:Tj.validateUnion,error:{message:"must match a schema in anyOf"}};af.default=zj});var sw=v(cf=>{"use strict";Object.defineProperty(cf,"__esModule",{value:!0});var mc=W(),Cj=le(),Ij={message:"must match exactly one schema in oneOf",params:({params:t})=>(0,mc._)`{passingSchemas: ${t.passing}}`},Rj={keyword:"oneOf",schemaType:"array",trackErrors:!0,error:Ij,code(t){let{gen:e,schema:r,parentSchema:n,it:s}=t;if(!Array.isArray(r))throw new Error("ajv implementation error");if(s.opts.discriminator&&n.discriminator)return;let o=r,i=e.let("valid",!1),a=e.let("passing",null),c=e.name("_valid");t.setParams({passing:a}),e.block(u),t.result(i,()=>t.reset(),()=>t.error(!0));function u(){o.forEach((l,d)=>{let f;(0,Cj.alwaysValidSchema)(s,l)?e.var(c,!0):f=t.subschema({keyword:"oneOf",schemaProp:d,compositeRule:!0},c),d>0&&e.if((0,mc._)`${c} && ${i}`).assign(i,!1).assign(a,(0,mc._)`[${a}, ${d}]`).else(),e.if(c,()=>{e.assign(i,!0),e.assign(a,d),f&&t.mergeEvaluated(f,mc.Name)})})}}};cf.default=Rj});var ow=v(uf=>{"use strict";Object.defineProperty(uf,"__esModule",{value:!0});var Oj=le(),Nj={keyword:"allOf",schemaType:"array",code(t){let{gen:e,schema:r,it:n}=t;if(!Array.isArray(r))throw new Error("ajv implementation error");let s=e.name("valid");r.forEach((o,i)=>{if((0,Oj.alwaysValidSchema)(n,o))return;let a=t.subschema({keyword:"allOf",schemaProp:i},s);t.ok(s),t.mergeEvaluated(a)})}};uf.default=Nj});var cw=v(lf=>{"use strict";Object.defineProperty(lf,"__esModule",{value:!0});var hc=W(),aw=le(),jj={message:({params:t})=>(0,hc.str)`must match "${t.ifClause}" schema`,params:({params:t})=>(0,hc._)`{failingKeyword: ${t.ifClause}}`},Aj={keyword:"if",schemaType:["object","boolean"],trackErrors:!0,error:jj,code(t){let{gen:e,parentSchema:r,it:n}=t;r.then===void 0&&r.else===void 0&&(0,aw.checkStrictMode)(n,'"if" without "then" and "else" is ignored');let s=iw(n,"then"),o=iw(n,"else");if(!s&&!o)return;let i=e.let("valid",!0),a=e.name("_valid");if(c(),t.reset(),s&&o){let l=e.let("ifClause");t.setParams({ifClause:l}),e.if(a,u("then",l),u("else",l))}else s?e.if(a,u("then")):e.if((0,hc.not)(a),u("else"));t.pass(i,()=>t.error(!0));function c(){let l=t.subschema({keyword:"if",compositeRule:!0,createErrors:!1,allErrors:!1},a);t.mergeEvaluated(l)}function u(l,d){return()=>{let f=t.subschema({keyword:l},a);e.assign(i,a),t.mergeValidEvaluated(f,i),d?e.assign(d,(0,hc._)`${l}`):t.setParams({ifClause:l})}}}};function iw(t,e){let r=t.schema[e];return r!==void 0&&!(0,aw.alwaysValidSchema)(t,r)}lf.default=Aj});var uw=v(df=>{"use strict";Object.defineProperty(df,"__esModule",{value:!0});var Mj=le(),qj={keyword:["then","else"],schemaType:["object","boolean"],code({keyword:t,parentSchema:e,it:r}){e.if===void 0&&(0,Mj.checkStrictMode)(r,`"${t}" without "if" is ignored`)}};df.default=qj});var lw=v(pf=>{"use strict";Object.defineProperty(pf,"__esModule",{value:!0});var Dj=Bp(),Zj=Zb(),Lj=Gp(),Vj=Vb(),Fj=Fb(),Uj=Kb(),Hj=Gb(),Kj=tf(),Bj=Yb(),Gj=tw(),Wj=rw(),Jj=nw(),Yj=sw(),Qj=ow(),Xj=cw(),eA=uw();function tA(t=!1){let e=[Wj.default,Jj.default,Yj.default,Qj.default,Xj.default,eA.default,Hj.default,Kj.default,Uj.default,Bj.default,Gj.default];return t?e.push(Zj.default,Vj.default):e.push(Dj.default,Lj.default),e.push(Fj.default),e}pf.default=tA});var dw=v(ff=>{"use strict";Object.defineProperty(ff,"__esModule",{value:!0});var Oe=W(),rA={message:({schemaCode:t})=>(0,Oe.str)`must match format "${t}"`,params:({schemaCode:t})=>(0,Oe._)`{format: ${t}}`},nA={keyword:"format",type:["number","string"],schemaType:"string",$data:!0,error:rA,code(t,e){let{gen:r,data:n,$data:s,schema:o,schemaCode:i,it:a}=t,{opts:c,errSchemaPath:u,schemaEnv:l,self:d}=a;if(!c.validateFormats)return;s?f():p();function f(){let m=r.scopeValue("formats",{ref:d.formats,code:c.code.formats}),h=r.const("fDef",(0,Oe._)`${m}[${i}]`),g=r.let("fType"),y=r.let("format");r.if((0,Oe._)`typeof ${h} == "object" && !(${h} instanceof RegExp)`,()=>r.assign(g,(0,Oe._)`${h}.type || "string"`).assign(y,(0,Oe._)`${h}.validate`),()=>r.assign(g,(0,Oe._)`"string"`).assign(y,h)),t.fail$data((0,Oe.or)(x(),$()));function x(){return c.strictSchema===!1?Oe.nil:(0,Oe._)`${i} && !${y}`}function $(){let S=l.$async?(0,Oe._)`(${h}.async ? await ${y}(${n}) : ${y}(${n}))`:(0,Oe._)`${y}(${n})`,w=(0,Oe._)`(typeof ${y} == "function" ? ${S} : ${y}.test(${n}))`;return(0,Oe._)`${y} && ${y} !== true && ${g} === ${e} && !${w}`}}function p(){let m=d.formats[o];if(!m){x();return}if(m===!0)return;let[h,g,y]=$(m);h===e&&t.pass(S());function x(){if(c.strictSchema===!1){d.logger.warn(w());return}throw new Error(w());function w(){return`unknown format "${o}" ignored in schema at path "${u}"`}}function $(w){let D=w instanceof RegExp?(0,Oe.regexpCode)(w):c.code.formats?(0,Oe._)`${c.code.formats}${(0,Oe.getProperty)(o)}`:void 0,F=r.scopeValue("formats",{key:o,ref:w,code:D});return typeof w=="object"&&!(w instanceof RegExp)?[w.type||"string",w.validate,(0,Oe._)`${F}.validate`]:["string",w,F]}function S(){if(typeof m=="object"&&!(m instanceof RegExp)&&m.async){if(!l.$async)throw new Error("async format in sync schema");return(0,Oe._)`await ${y}(${n})`}return typeof g=="function"?(0,Oe._)`${y}(${n})`:(0,Oe._)`${y}.test(${n})`}}}};ff.default=nA});var pw=v(mf=>{"use strict";Object.defineProperty(mf,"__esModule",{value:!0});var sA=dw(),oA=[sA.default];mf.default=oA});var fw=v(Ps=>{"use strict";Object.defineProperty(Ps,"__esModule",{value:!0});Ps.contentVocabulary=Ps.metadataVocabulary=void 0;Ps.metadataVocabulary=["title","description","default","deprecated","readOnly","writeOnly","examples"];Ps.contentVocabulary=["contentMediaType","contentEncoding","contentSchema"]});var hw=v(hf=>{"use strict";Object.defineProperty(hf,"__esModule",{value:!0});var iA=$b(),aA=Ab(),cA=lw(),uA=pw(),mw=fw(),lA=[iA.default,aA.default,(0,cA.default)(),uA.default,mw.metadataVocabulary,mw.contentVocabulary];hf.default=lA});var yw=v(gc=>{"use strict";Object.defineProperty(gc,"__esModule",{value:!0});gc.DiscrError=void 0;var gw;(function(t){t.Tag="tag",t.Mapping="mapping"})(gw||(gc.DiscrError=gw={}))});var _w=v(yf=>{"use strict";Object.defineProperty(yf,"__esModule",{value:!0});var Es=W(),gf=yw(),vw=tc(),dA=Qo(),pA=le(),fA={message:({params:{discrError:t,tagName:e}})=>t===gf.DiscrError.Tag?`tag "${e}" must be string`:`value of tag "${e}" must be in oneOf`,params:({params:{discrError:t,tag:e,tagName:r}})=>(0,Es._)`{error: ${t}, tag: ${r}, tagValue: ${e}}`},mA={keyword:"discriminator",type:"object",schemaType:"object",error:fA,code(t){let{gen:e,data:r,schema:n,parentSchema:s,it:o}=t,{oneOf:i}=s;if(!o.opts.discriminator)throw new Error("discriminator: requires discriminator option");let a=n.propertyName;if(typeof a!="string")throw new Error("discriminator: requires propertyName");if(n.mapping)throw new Error("discriminator: mapping is not supported");if(!i)throw new Error("discriminator: requires oneOf keyword");let c=e.let("valid",!1),u=e.const("tag",(0,Es._)`${r}${(0,Es.getProperty)(a)}`);e.if((0,Es._)`typeof ${u} == "string"`,()=>l(),()=>t.error(!1,{discrError:gf.DiscrError.Tag,tag:u,tagName:a})),t.ok(c);function l(){let p=f();e.if(!1);for(let m in p)e.elseIf((0,Es._)`${u} === ${m}`),e.assign(c,d(p[m]));e.else(),t.error(!1,{discrError:gf.DiscrError.Mapping,tag:u,tagName:a}),e.endIf()}function d(p){let m=e.name("valid"),h=t.subschema({keyword:"oneOf",schemaProp:p},m);return t.mergeEvaluated(h,Es.Name),m}function f(){var p;let m={},h=y(s),g=!0;for(let S=0;S<i.length;S++){let w=i[S];if(w?.$ref&&!(0,pA.schemaHasRulesButRef)(w,o.self.RULES)){let F=w.$ref;if(w=vw.resolveRef.call(o.self,o.schemaEnv.root,o.baseId,F),w instanceof vw.SchemaEnv&&(w=w.schema),w===void 0)throw new dA.default(o.opts.uriResolver,o.baseId,F)}let D=(p=w?.properties)===null||p===void 0?void 0:p[a];if(typeof D!="object")throw new Error(`discriminator: oneOf subschemas (or referenced schemas) must have "properties/${a}"`);g=g&&(h||y(w)),x(D,S)}if(!g)throw new Error(`discriminator: "${a}" must be required`);return m;function y({required:S}){return Array.isArray(S)&&S.includes(a)}function x(S,w){if(S.const)$(S.const,w);else if(S.enum)for(let D of S.enum)$(D,w);else throw new Error(`discriminator: "properties/${a}" must have "const" or "enum"`)}function $(S,w){if(typeof S!="string"||S in m)throw new Error(`discriminator: "${a}" values must be unique strings`);m[S]=w}}}};yf.default=mA});var bw=v((kF,hA)=>{hA.exports={$schema:"http://json-schema.org/draft-07/schema#",$id:"http://json-schema.org/draft-07/schema#",title:"Core schema meta-schema",definitions:{schemaArray:{type:"array",minItems:1,items:{$ref:"#"}},nonNegativeInteger:{type:"integer",minimum:0},nonNegativeIntegerDefault0:{allOf:[{$ref:"#/definitions/nonNegativeInteger"},{default:0}]},simpleTypes:{enum:["array","boolean","integer","null","number","object","string"]},stringArray:{type:"array",items:{type:"string"},uniqueItems:!0,default:[]}},type:["object","boolean"],properties:{$id:{type:"string",format:"uri-reference"},$schema:{type:"string",format:"uri"},$ref:{type:"string",format:"uri-reference"},$comment:{type:"string"},title:{type:"string"},description:{type:"string"},default:!0,readOnly:{type:"boolean",default:!1},examples:{type:"array",items:!0},multipleOf:{type:"number",exclusiveMinimum:0},maximum:{type:"number"},exclusiveMaximum:{type:"number"},minimum:{type:"number"},exclusiveMinimum:{type:"number"},maxLength:{$ref:"#/definitions/nonNegativeInteger"},minLength:{$ref:"#/definitions/nonNegativeIntegerDefault0"},pattern:{type:"string",format:"regex"},additionalItems:{$ref:"#"},items:{anyOf:[{$ref:"#"},{$ref:"#/definitions/schemaArray"}],default:!0},maxItems:{$ref:"#/definitions/nonNegativeInteger"},minItems:{$ref:"#/definitions/nonNegativeIntegerDefault0"},uniqueItems:{type:"boolean",default:!1},contains:{$ref:"#"},maxProperties:{$ref:"#/definitions/nonNegativeInteger"},minProperties:{$ref:"#/definitions/nonNegativeIntegerDefault0"},required:{$ref:"#/definitions/stringArray"},additionalProperties:{$ref:"#"},definitions:{type:"object",additionalProperties:{$ref:"#"},default:{}},properties:{type:"object",additionalProperties:{$ref:"#"},default:{}},patternProperties:{type:"object",additionalProperties:{$ref:"#"},propertyNames:{format:"regex"},default:{}},dependencies:{type:"object",additionalProperties:{anyOf:[{$ref:"#"},{$ref:"#/definitions/stringArray"}]}},propertyNames:{$ref:"#"},const:!0,enum:{type:"array",items:!0,minItems:1,uniqueItems:!0},type:{anyOf:[{$ref:"#/definitions/simpleTypes"},{type:"array",items:{$ref:"#/definitions/simpleTypes"},minItems:1,uniqueItems:!0}]},format:{type:"string"},contentMediaType:{type:"string"},contentEncoding:{type:"string"},if:{$ref:"#"},then:{$ref:"#"},else:{$ref:"#"},allOf:{$ref:"#/definitions/schemaArray"},anyOf:{$ref:"#/definitions/schemaArray"},oneOf:{$ref:"#/definitions/schemaArray"},not:{$ref:"#"}},default:!0}});var $w=v((Ee,vf)=>{"use strict";Object.defineProperty(Ee,"__esModule",{value:!0});Ee.MissingRefError=Ee.ValidationError=Ee.CodeGen=Ee.Name=Ee.nil=Ee.stringify=Ee.str=Ee._=Ee.KeywordCxt=Ee.Ajv=void 0;var gA=gb(),yA=hw(),vA=_w(),ww=bw(),_A=["/properties"],yc="http://json-schema.org/draft-07/schema",Ts=class extends gA.default{_addVocabularies(){super._addVocabularies(),yA.default.forEach(e=>this.addVocabulary(e)),this.opts.discriminator&&this.addKeyword(vA.default)}_addDefaultMetaSchema(){if(super._addDefaultMetaSchema(),!this.opts.meta)return;let e=this.opts.$data?this.$dataMetaSchema(ww,_A):ww;this.addMetaSchema(e,yc,!1),this.refs["http://json-schema.org/schema"]=yc}defaultMeta(){return this.opts.defaultMeta=super.defaultMeta()||(this.getSchema(yc)?yc:void 0)}};Ee.Ajv=Ts;vf.exports=Ee=Ts;vf.exports.Ajv=Ts;Object.defineProperty(Ee,"__esModule",{value:!0});Ee.default=Ts;var bA=Yo();Object.defineProperty(Ee,"KeywordCxt",{enumerable:!0,get:function(){return bA.KeywordCxt}});var zs=W();Object.defineProperty(Ee,"_",{enumerable:!0,get:function(){return zs._}});Object.defineProperty(Ee,"str",{enumerable:!0,get:function(){return zs.str}});Object.defineProperty(Ee,"stringify",{enumerable:!0,get:function(){return zs.stringify}});Object.defineProperty(Ee,"nil",{enumerable:!0,get:function(){return zs.nil}});Object.defineProperty(Ee,"Name",{enumerable:!0,get:function(){return zs.Name}});Object.defineProperty(Ee,"CodeGen",{enumerable:!0,get:function(){return zs.CodeGen}});var wA=Xa();Object.defineProperty(Ee,"ValidationError",{enumerable:!0,get:function(){return wA.default}});var $A=Qo();Object.defineProperty(Ee,"MissingRefError",{enumerable:!0,get:function(){return $A.default}})});var xw=v(Cs=>{"use strict";Object.defineProperty(Cs,"__esModule",{value:!0});Cs.formatLimitDefinition=void 0;var xA=$w(),Vt=W(),Br=Vt.operators,vc={formatMaximum:{okStr:"<=",ok:Br.LTE,fail:Br.GT},formatMinimum:{okStr:">=",ok:Br.GTE,fail:Br.LT},formatExclusiveMaximum:{okStr:"<",ok:Br.LT,fail:Br.GTE},formatExclusiveMinimum:{okStr:">",ok:Br.GT,fail:Br.LTE}},kA={message:({keyword:t,schemaCode:e})=>(0,Vt.str)`should be ${vc[t].okStr} ${e}`,params:({keyword:t,schemaCode:e})=>(0,Vt._)`{comparison: ${vc[t].okStr}, limit: ${e}}`};Cs.formatLimitDefinition={keyword:Object.keys(vc),type:"string",schemaType:"string",$data:!0,error:kA,code(t){let{gen:e,data:r,schemaCode:n,keyword:s,it:o}=t,{opts:i,self:a}=o;if(!i.validateFormats)return;let c=new xA.KeywordCxt(o,a.RULES.all.format.definition,"format");c.$data?u():l();function u(){let f=e.scopeValue("formats",{ref:a.formats,code:i.code.formats}),p=e.const("fmt",(0,Vt._)`${f}[${c.schemaCode}]`);t.fail$data((0,Vt.or)((0,Vt._)`typeof ${p} != "object"`,(0,Vt._)`${p} instanceof RegExp`,(0,Vt._)`typeof ${p}.compare != "function"`,d(p)))}function l(){let f=c.schema,p=a.formats[f];if(!p||p===!0)return;if(typeof p!="object"||p instanceof RegExp||typeof p.compare!="function")throw new Error(`"${s}": format "${f}" does not define "compare" function`);let m=e.scopeValue("formats",{key:f,ref:p,code:i.code.formats?(0,Vt._)`${i.code.formats}${(0,Vt.getProperty)(f)}`:void 0});t.fail$data(d(m))}function d(f){return(0,Vt._)`${f}.compare(${r}, ${n}) ${vc[s].fail} 0`}},dependencies:["format"]};var SA=t=>(t.addKeyword(Cs.formatLimitDefinition),t);Cs.default=SA});var Ew=v((di,Pw)=>{"use strict";Object.defineProperty(di,"__esModule",{value:!0});var Is=c0(),PA=xw(),_f=W(),kw=new _f.Name("fullFormats"),EA=new _f.Name("fastFormats"),bf=(t,e={keywords:!0})=>{if(Array.isArray(e))return Sw(t,e,Is.fullFormats,kw),t;let[r,n]=e.mode==="fast"?[Is.fastFormats,EA]:[Is.fullFormats,kw],s=e.formats||Is.formatNames;return Sw(t,s,r,n),e.keywords&&(0,PA.default)(t),t};bf.get=(t,e="full")=>{let n=(e==="fast"?Is.fastFormats:Is.fullFormats)[t];if(!n)throw new Error(`Unknown format "${t}"`);return n};function Sw(t,e,r,n){var s,o;(s=(o=t.opts.code).formats)!==null&&s!==void 0||(o.formats=(0,_f._)`require("ajv-formats/dist/formats").${n}`);for(let i of e)t.addFormat(i,r[i])}Pw.exports=di=bf;Object.defineProperty(di,"__esModule",{value:!0});di.default=bf});var Aw=v((MF,jw)=>{jw.exports=Nw;Nw.sync=IA;var Rw=require("fs");function CA(t,e){var r=e.pathExt!==void 0?e.pathExt:process.env.PATHEXT;if(!r||(r=r.split(";"),r.indexOf("")!==-1))return!0;for(var n=0;n<r.length;n++){var s=r[n].toLowerCase();if(s&&t.substr(-s.length).toLowerCase()===s)return!0}return!1}function Ow(t,e,r){return!t.isSymbolicLink()&&!t.isFile()?!1:CA(e,r)}function Nw(t,e,r){Rw.stat(t,function(n,s){r(n,n?!1:Ow(s,t,e))})}function IA(t,e){return Ow(Rw.statSync(t),t,e)}});var Lw=v((qF,Zw)=>{Zw.exports=qw;qw.sync=RA;var Mw=require("fs");function qw(t,e,r){Mw.stat(t,function(n,s){r(n,n?!1:Dw(s,e))})}function RA(t,e){return Dw(Mw.statSync(t),e)}function Dw(t,e){return t.isFile()&&OA(t,e)}function OA(t,e){var r=t.mode,n=t.uid,s=t.gid,o=e.uid!==void 0?e.uid:process.getuid&&process.getuid(),i=e.gid!==void 0?e.gid:process.getgid&&process.getgid(),a=parseInt("100",8),c=parseInt("010",8),u=parseInt("001",8),l=a|c,d=r&u||r&c&&s===i||r&a&&n===o||r&l&&o===0;return d}});var Fw=v((ZF,Vw)=>{var DF=require("fs"),xc;process.platform==="win32"||global.TESTING_WINDOWS?xc=Aw():xc=Lw();Vw.exports=wf;wf.sync=NA;function wf(t,e,r){if(typeof e=="function"&&(r=e,e={}),!r){if(typeof Promise!="function")throw new TypeError("callback not provided");return new Promise(function(n,s){wf(t,e||{},function(o,i){o?s(o):n(i)})})}xc(t,e||{},function(n,s){n&&(n.code==="EACCES"||e&&e.ignoreErrors)&&(n=null,s=!1),r(n,s)})}function NA(t,e){try{return xc.sync(t,e||{})}catch(r){if(e&&e.ignoreErrors||r.code==="EACCES")return!1;throw r}}});var Jw=v((LF,Ww)=>{var Rs=process.platform==="win32"||process.env.OSTYPE==="cygwin"||process.env.OSTYPE==="msys",Uw=require("path"),jA=Rs?";":":",Hw=Fw(),Kw=t=>Object.assign(new Error(`not found: ${t}`),{code:"ENOENT"}),Bw=(t,e)=>{let r=e.colon||jA,n=t.match(/\//)||Rs&&t.match(/\\/)?[""]:[...Rs?[process.cwd()]:[],...(e.path||process.env.PATH||"").split(r)],s=Rs?e.pathExt||process.env.PATHEXT||".EXE;.CMD;.BAT;.COM":"",o=Rs?s.split(r):[""];return Rs&&t.indexOf(".")!==-1&&o[0]!==""&&o.unshift(""),{pathEnv:n,pathExt:o,pathExtExe:s}},Gw=(t,e,r)=>{typeof e=="function"&&(r=e,e={}),e||(e={});let{pathEnv:n,pathExt:s,pathExtExe:o}=Bw(t,e),i=[],a=u=>new Promise((l,d)=>{if(u===n.length)return e.all&&i.length?l(i):d(Kw(t));let f=n[u],p=/^".*"$/.test(f)?f.slice(1,-1):f,m=Uw.join(p,t),h=!p&&/^\.[\\\/]/.test(t)?t.slice(0,2)+m:m;l(c(h,u,0))}),c=(u,l,d)=>new Promise((f,p)=>{if(d===s.length)return f(a(l+1));let m=s[d];Hw(u+m,{pathExt:o},(h,g)=>{if(!h&&g)if(e.all)i.push(u+m);else return f(u+m);return f(c(u,l,d+1))})});return r?a(0).then(u=>r(null,u),r):a(0)},AA=(t,e)=>{e=e||{};let{pathEnv:r,pathExt:n,pathExtExe:s}=Bw(t,e),o=[];for(let i=0;i<r.length;i++){let a=r[i],c=/^".*"$/.test(a)?a.slice(1,-1):a,u=Uw.join(c,t),l=!c&&/^\.[\\\/]/.test(t)?t.slice(0,2)+u:u;for(let d=0;d<n.length;d++){let f=l+n[d];try{if(Hw.sync(f,{pathExt:s}))if(e.all)o.push(f);else return f}catch{}}}if(e.all&&o.length)return o;if(e.nothrow)return null;throw Kw(t)};Ww.exports=Gw;Gw.sync=AA});var Qw=v((VF,$f)=>{"use strict";var Yw=(t={})=>{let e=t.env||process.env;return(t.platform||process.platform)!=="win32"?"PATH":Object.keys(e).reverse().find(n=>n.toUpperCase()==="PATH")||"Path"};$f.exports=Yw;$f.exports.default=Yw});var r$=v((FF,t$)=>{"use strict";var Xw=require("path"),MA=Jw(),qA=Qw();function e$(t,e){let r=t.options.env||process.env,n=process.cwd(),s=t.options.cwd!=null,o=s&&process.chdir!==void 0&&!process.chdir.disabled;if(o)try{process.chdir(t.options.cwd)}catch{}let i;try{i=MA.sync(t.command,{path:r[qA({env:r})],pathExt:e?Xw.delimiter:void 0})}catch{}finally{o&&process.chdir(n)}return i&&(i=Xw.resolve(s?t.options.cwd:"",i)),i}function DA(t){return e$(t)||e$(t,!0)}t$.exports=DA});var n$=v((UF,kf)=>{"use strict";var xf=/([()\][%!^"`<>&|;, *?])/g;function ZA(t){return t=t.replace(xf,"^$1"),t}function LA(t,e){return t=`${t}`,t=t.replace(/(?=(\\+?)?)\1"/g,'$1$1\\"'),t=t.replace(/(?=(\\+?)?)\1$/,"$1$1"),t=`"${t}"`,t=t.replace(xf,"^$1"),e&&(t=t.replace(xf,"^$1")),t}kf.exports.command=ZA;kf.exports.argument=LA});var o$=v((HF,s$)=>{"use strict";s$.exports=/^#!(.*)/});var a$=v((KF,i$)=>{"use strict";var VA=o$();i$.exports=(t="")=>{let e=t.match(VA);if(!e)return null;let[r,n]=e[0].replace(/#! ?/,"").split(" "),s=r.split("/").pop();return s==="env"?n:n?`${s} ${n}`:s}});var u$=v((BF,c$)=>{"use strict";var Sf=require("fs"),FA=a$();function UA(t){let r=Buffer.alloc(150),n;try{n=Sf.openSync(t,"r"),Sf.readSync(n,r,0,150,0),Sf.closeSync(n)}catch{}return FA(r.toString())}c$.exports=UA});var f$=v((GF,p$)=>{"use strict";var HA=require("path"),l$=r$(),d$=n$(),KA=u$(),BA=process.platform==="win32",GA=/\.(?:com|exe)$/i,WA=/node_modules[\\/].bin[\\/][^\\/]+\.cmd$/i;function JA(t){t.file=l$(t);let e=t.file&&KA(t.file);return e?(t.args.unshift(t.file),t.command=e,l$(t)):t.file}function YA(t){if(!BA)return t;let e=JA(t),r=!GA.test(e);if(t.options.forceShell||r){let n=WA.test(e);t.command=HA.normalize(t.command),t.command=d$.command(t.command),t.args=t.args.map(o=>d$.argument(o,n));let s=[t.command].concat(t.args).join(" ");t.args=["/d","/s","/c",`"${s}"`],t.command=process.env.comspec||"cmd.exe",t.options.windowsVerbatimArguments=!0}return t}function QA(t,e,r){e&&!Array.isArray(e)&&(r=e,e=null),e=e?e.slice(0):[],r=Object.assign({},r);let n={command:t,args:e,options:r,file:void 0,original:{command:t,args:e}};return r.shell?n:YA(n)}p$.exports=QA});var g$=v((WF,h$)=>{"use strict";var Pf=process.platform==="win32";function Ef(t,e){return Object.assign(new Error(`${e} ${t.command} ENOENT`),{code:"ENOENT",errno:"ENOENT",syscall:`${e} ${t.command}`,path:t.command,spawnargs:t.args})}function XA(t,e){if(!Pf)return;let r=t.emit;t.emit=function(n,s){if(n==="exit"){let o=m$(s,e);if(o)return r.call(t,"error",o)}return r.apply(t,arguments)}}function m$(t,e){return Pf&&t===1&&!e.file?Ef(e.original,"spawn"):null}function eM(t,e){return Pf&&t===1&&!e.file?Ef(e.original,"spawnSync"):null}h$.exports={hookChildProcess:XA,verifyENOENT:m$,verifyENOENTSync:eM,notFoundError:Ef}});var _$=v((JF,Os)=>{"use strict";var y$=require("child_process"),Tf=f$(),zf=g$();function v$(t,e,r){let n=Tf(t,e,r),s=y$.spawn(n.command,n.args,n.options);return zf.hookChildProcess(s,n),s}function tM(t,e,r){let n=Tf(t,e,r),s=y$.spawnSync(n.command,n.args,n.options);return s.error=s.error||zf.verifyENOENTSync(s.status,n),s}Os.exports=v$;Os.exports.spawn=v$;Os.exports.sync=tM;Os.exports._parse=Tf;Os.exports._enoent=zf});var cM={};hi(cM,{activate:()=>iM,deactivate:()=>aM,getMetricsCollector:()=>Zn});module.exports=C$(cM);var pe=ve(require("vscode")),k$=ve(require("path"));var qf=ve(require("vscode"));var Wr=ve(require("fs/promises")),yi=ve(require("path")),gi=class{constructor(){this.projectStructure=null;this.masterContext=new Map;this.contextWindowTokens=256*1024}async resolveContext(e){if(!e||e.length===0)return"";let r=`

<context>
`;if(e.length>0&&e[0].path){let n=e[0].path,s=yi.dirname(n);await this.buildProjectStructure(s)}for(let n of e)try{let s=await Wr.readFile(n.path,"utf-8"),o=256,i=s.split(`
`);if(i.length>o){let a=i.slice(0,o).join(`
`)+`
... (content truncated)`;r+=`<file path="${n.path}" truncated="true">
${a}
</file>
`}else r+=`<file path="${n.path}">
${s}
</file>
`}catch(s){console.error(`Failed to read context file ${n.path}`,s),r+=`<file path="${n.path}" error="true">Could not read file.</file>
`}return r+=`</context>
`,r}async buildProjectStructure(e){try{this.projectStructure=await this.buildStructureFromPath(e)}catch(r){console.error("Failed to build project structure",r)}}async buildStructureFromPath(e){let r={root:e,files:[],directories:{}},n=await Wr.readdir(e);for(let s of n){let o=yi.join(e,s),i=await Wr.stat(o);i.isDirectory()?r.directories[s]=await this.buildStructureFromPath(o):i.isFile()&&r.files.push(o)}return r}getProjectStructure(){return this.projectStructure}async getHierarchicalContext(e,r=4096){return this.resolveContext(e)}addToMasterContext(e,r){this.masterContext.set(e,r)}getFromMasterContext(e){return this.masterContext.get(e)}removeFromMasterContext(e){this.masterContext.delete(e)}getAllMasterContext(){return new Map(this.masterContext)}clearMasterContext(){this.masterContext.clear()}generateSlidingWindowContext(){let r="",n=0,s=Array.from(this.masterContext.keys()).sort((o,i)=>o==="task_description"?-1:i==="task_description"?1:o.startsWith("context_")&&!i.startsWith("context_")?-1:!o.startsWith("context_")&&i.startsWith("context_")?1:0);for(let o of s){let i=this.masterContext.get(o)||"",a=this.estimateTokenCount(i);if(n+a>262144){let c=262144-n;if(c>0){let u=c*4;i=i.slice(0,u)+`
... (content truncated)`,a=this.estimateTokenCount(i),r+=`
<master_context key="${o}" truncated="true">
${i}
</master_context>
`,n+=a}break}else r+=`
<master_context key="${o}">
${i}
</master_context>
`,n+=a}return n>262144&&(r+=`
<!-- Context window exceeded, some content omitted -->
`),r}estimateTokenCount(e){return Math.ceil(e.length/4)}async getContextForTask(e,r){this.addToMasterContext("task_description",e);for(let n of r)try{let s=await Wr.readFile(n.path,"utf-8");this.addToMasterContext(`context_${n.path}`,s)}catch(s){console.error(`Failed to read context file ${n.path}`,s),this.addToMasterContext(`context_${n.path}`,`Could not read file: ${n.path}`)}return this.generateSlidingWindowContext()}};async function Of(t,e,r){return await t.getContextForTask(e,r||[])}async function Cc(t,e,r){return await t.chat(e,r)}function Nf(t){let e=t.match(/```json[\r\n]+([\s\S]*?)[\r\n]+```/),r=null;if(e)r=e[1].trim(),r.startsWith("json")&&(r=r.slice(4).trim());else{let n=/(\{\s*"(?:thought|tool_calls)"[\s\S]*?\})\s*$/,s=t.match(n);s&&(r=s[1])}if(!r)return{text:t};try{return JSON.parse(r)}catch{return{text:t}}}async function jf(t,e){return await t.executeTool(e)}function Ic(t,e,r){t.push({role:"tool",content:JSON.stringify({role:"tool_result",tool_call_id:r.id,status:e.status||"success",result:e.result||e,error:e.error||void 0})})}function Jr(t,e){t.push(e)}function Af(t){return t&&t.message?t.message:String(t)}function Mf(t){t&&t.abort()}var vi=class{constructor(e,r,n){this.llm=e;this.tools=r;this.abortController=null;this.contextManager=new gi,this.context={workspaceRoot:n,history:[{role:"system",content:this.getSystemPrompt()}]}}cancel(){this.abortController&&(this.abortController.abort(),this.abortController=null)}getSystemPrompt(){let e=qf.workspace.getConfiguration("vibey"),r=e.get("rules",{}),n=e.get("userGuidelines",""),s="";Object.keys(r).length>0&&(s=`## Rules

${JSON.stringify(r,null,2)}

`);let o="";n&&(o=`## User Guidelines

${n}

`);let i=this.tools.getToolDefinitions().map(a=>`## ${a.name}
${a.description}
Parameters: ${JSON.stringify(a.parameters)}`).join(`

`);return`You are Vibey, an expert autonomous coding agent.
You are running inside VS Code.

## Core Behavior

BE AUTONOMOUS. When given a task:
1. Gather information using tools
2. Plan your approach
3. EXECUTE the plan immediately - do NOT ask for permission
4. Continue working until the task is COMPLETE
5. Only stop when you have fully solved the problem

NEVER respond with "Would you like me to..." or "Should I...?" - just DO IT.
NEVER stop after gathering information - immediately proceed to implementation.
NEVER ask for confirmation before making changes - the user asked you to do something, so do it.

${s}${o}## Available Tools

${i}

## Response Format

When using tools, output ONLY a JSON block:
\`\`\`json
{
  "thought": "Brief reasoning about what I'm doing and why...",
  "tool_calls": [
    {
      "id": "unique_id",
      "name": "tool_name",
      "parameters": { ... }
    }
  ]
}
\`\`\`

When you are DONE with the entire task and have nothing more to do, respond with plain text summarizing what you accomplished.

## Important Rules

- Use tools to READ before you WRITE - understand the code first
- Make targeted, minimal changes - don't rewrite entire files
- If a tool fails, try a different approach
- Keep working until the task is fully complete
- For multi-step tasks, execute ALL steps in sequence without stopping
`}async chat(e,r,n){Mf(this.abortController),this.abortController=new AbortController;let s=this.abortController.signal;try{let o=r&&r.length>0?await Of(this.contextManager,e,r):"";Jr(this.context.history,{role:"user",content:e+o}),n&&n({type:"thinking",message:"Strategic planning with full context window..."});let i=256,a=0,c="";for(;a<i;){if(s.aborted)throw new Error("Request cancelled by user");a++,n&&n({type:"thinking",message:a===1?"Analyzing request...":`Turn ${a}: Reasoning...`});let d=await Cc(this.llm,this.context.history,s);if(s.aborted)throw new Error("Request cancelled by user");let f=Nf(d);if(!f||f.text){Jr(this.context.history,{role:"assistant",content:d}),c=d;break}if(f.thought&&n&&n({type:"thought",message:f.thought}),f.tool_calls&&Array.isArray(f.tool_calls)){Jr(this.context.history,{role:"assistant",content:d});for(let p of f.tool_calls){if(s.aborted)throw new Error("Request cancelled by user");try{n&&n({type:"tool_start",id:p.id,tool:p.name,parameters:p.parameters});let m=await jf(this.tools,p);n&&n({type:"tool_end",id:p.id,tool:p.name,success:!0,result:m}),Ic(this.context.history,m,p)}catch(m){n&&n({type:"tool_end",id:p.id,tool:p.name,success:!1,error:m.message}),Ic(this.context.history,{status:"error",error:m.message},p)}}}else{Jr(this.context.history,{role:"assistant",content:d}),c=f.thought||d;break}}if(this.abortController=null,c){let d=Zn();if(d){let f=d.getSummary("tokens_sent")?.currentValue||0,p=d.getSummary("tokens_received")?.currentValue||0;n&&n({type:"tokens",sent:f,received:p})}return c}n&&n({type:"thinking",message:"Max turns reached. Summarizing progress..."}),Jr(this.context.history,{role:"user",content:"You have reached the maximum number of turns. Please provide a concise summary of what you have accomplished so far, what issues you encountered, and what steps should be taken next to complete the task."});let u=await Cc(this.llm,this.context.history,s);Jr(this.context.history,{role:"assistant",content:u});let l=Zn();if(l){let d=l.getSummary("tokens_sent")?.currentValue||0,f=l.getSummary("tokens_received")?.currentValue||0;n&&n({type:"tokens",sent:d,received:f})}return`**Max Turns Reached (${i})**

${u}`}catch(o){this.abortController=null;let i=Af(o);return n&&n({type:"error",message:i}),`**Error:** ${i}`}}};var Df=ve(require("vscode"));var _i=class{constructor(){}getConfig(){let e=Df.workspace.getConfiguration("vibey");return{modelName:e.get("model")||"Qwen3-coder-roo-config:latest",baseUrl:e.get("ollamaUrl")||"http://localhost:11434"}}async chat(e,r){let{modelName:n,baseUrl:s}=this.getConfig(),o={model:n,messages:e.map(i=>i.role==="tool"?{role:"tool",content:JSON.stringify(i.content)}:{role:i.role,content:typeof i.content=="string"?i.content:JSON.stringify(i.content)}),stream:!1};try{let i=await fetch(`${s}/api/chat`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(o),signal:r});if(!i.ok)throw new Error(`Ollama API error: ${i.statusText}`);let a=await i.json(),c=Zn();return c&&a.prompt_eval_count!==void 0&&c.record("tokens_sent",a.prompt_eval_count),c&&a.eval_count!==void 0&&c.record("tokens_received",a.eval_count),a.message.content}catch(i){throw i.name==="AbortError"?new Error("Request cancelled by user"):(console.error("Failed to call Ollama:",i),i)}}async listModels(){let{baseUrl:e}=this.getConfig();try{let r=await fetch(`${e}/api/tags`);if(!r.ok)throw new Error(`Failed to fetch models: ${r.statusText}`);return(await r.json()).models.map(s=>s.name)}catch(r){return console.error("Failed to list models:",r),[]}}};var bi=class{constructor(e){this.policy=e;this.tools=new Map}registerTool(e){this.tools.set(e.name,e)}unregisterTool(e){this.tools.delete(e)}getToolDefinitions(){return Array.from(this.tools.values())}async executeTool(e){let r=this.tools.get(e.name);if(!r)return{role:"tool_result",tool_call_id:e.id,status:"error",error:`Tool ${e.name} not found`,output:""};console.log(`[Gateway] Executing ${e.name}`);try{let n=await r.execute(e.parameters,{});return{role:"tool_result",tool_call_id:e.id,status:"success",output:n}}catch(n){return{role:"tool_result",tool_call_id:e.id,status:"error",error:n.message,output:""}}}};var Zf=ve(require("path")),wi=class{constructor(e){this.workspaceRoot=e}checkPathAccess(e,r){let n=Zf.resolve(this.workspaceRoot,e);return n.startsWith(this.workspaceRoot)?!((n.includes(".git")||n.includes("node_modules"))&&r==="write"):(console.warn(`Blocked access to ${n} (outside workspace)`),!1)}checkCommand(e){return!["rm -rf","mkfs","shutdown","reboot","dd "].some(n=>e.includes(n))}};var Tr=ve(require("fs/promises"));var T={};hi(T,{BRAND:()=>rx,DIRTY:()=>Yr,EMPTY_PATH:()=>N$,INVALID:()=>A,NEVER:()=>Zx,OK:()=>Be,ParseStatus:()=>qe,Schema:()=>G,ZodAny:()=>Pr,ZodArray:()=>ur,ZodBigInt:()=>Xr,ZodBoolean:()=>en,ZodBranded:()=>Ms,ZodCatch:()=>pn,ZodDate:()=>tn,ZodDefault:()=>dn,ZodDiscriminatedUnion:()=>ki,ZodEffects:()=>_t,ZodEnum:()=>un,ZodError:()=>it,ZodFirstPartyTypeKind:()=>q,ZodFunction:()=>Pi,ZodIntersection:()=>on,ZodIssueCode:()=>k,ZodLazy:()=>an,ZodLiteral:()=>cn,ZodMap:()=>Kn,ZodNaN:()=>Gn,ZodNativeEnum:()=>ln,ZodNever:()=>It,ZodNull:()=>nn,ZodNullable:()=>Ht,ZodNumber:()=>Qr,ZodObject:()=>at,ZodOptional:()=>yt,ZodParsedType:()=>z,ZodPipeline:()=>qs,ZodPromise:()=>Er,ZodReadonly:()=>fn,ZodRecord:()=>Si,ZodSchema:()=>G,ZodSet:()=>Bn,ZodString:()=>Sr,ZodSymbol:()=>Un,ZodTransformer:()=>_t,ZodTuple:()=>Ut,ZodType:()=>G,ZodUndefined:()=>rn,ZodUnion:()=>sn,ZodUnknown:()=>cr,ZodVoid:()=>Hn,addIssueToContext:()=>E,any:()=>dx,array:()=>hx,bigint:()=>ix,boolean:()=>Yf,coerce:()=>Dx,custom:()=>Gf,date:()=>ax,datetimeRegex:()=>Kf,defaultErrorMap:()=>ir,discriminatedUnion:()=>_x,effect:()=>Ix,enum:()=>Tx,function:()=>Sx,getErrorMap:()=>Ln,getParsedType:()=>Ft,instanceof:()=>sx,intersection:()=>bx,isAborted:()=>$i,isAsync:()=>Vn,isDirty:()=>xi,isValid:()=>kr,late:()=>nx,lazy:()=>Px,literal:()=>Ex,makeIssue:()=>As,map:()=>xx,nan:()=>ox,nativeEnum:()=>zx,never:()=>fx,null:()=>lx,nullable:()=>Ox,number:()=>Jf,object:()=>gx,objectUtil:()=>Rc,oboolean:()=>qx,onumber:()=>Mx,optional:()=>Rx,ostring:()=>Ax,pipeline:()=>jx,preprocess:()=>Nx,promise:()=>Cx,quotelessJson:()=>I$,record:()=>$x,set:()=>kx,setErrorMap:()=>O$,strictObject:()=>yx,string:()=>Wf,symbol:()=>cx,transformer:()=>Ix,tuple:()=>wx,undefined:()=>ux,union:()=>vx,unknown:()=>px,util:()=>te,void:()=>mx});var te;(function(t){t.assertEqual=s=>{};function e(s){}t.assertIs=e;function r(s){throw new Error}t.assertNever=r,t.arrayToEnum=s=>{let o={};for(let i of s)o[i]=i;return o},t.getValidEnumValues=s=>{let o=t.objectKeys(s).filter(a=>typeof s[s[a]]!="number"),i={};for(let a of o)i[a]=s[a];return t.objectValues(i)},t.objectValues=s=>t.objectKeys(s).map(function(o){return s[o]}),t.objectKeys=typeof Object.keys=="function"?s=>Object.keys(s):s=>{let o=[];for(let i in s)Object.prototype.hasOwnProperty.call(s,i)&&o.push(i);return o},t.find=(s,o)=>{for(let i of s)if(o(i))return i},t.isInteger=typeof Number.isInteger=="function"?s=>Number.isInteger(s):s=>typeof s=="number"&&Number.isFinite(s)&&Math.floor(s)===s;function n(s,o=" | "){return s.map(i=>typeof i=="string"?`'${i}'`:i).join(o)}t.joinValues=n,t.jsonStringifyReplacer=(s,o)=>typeof o=="bigint"?o.toString():o})(te||(te={}));var Rc;(function(t){t.mergeShapes=(e,r)=>({...e,...r})})(Rc||(Rc={}));var z=te.arrayToEnum(["string","nan","number","integer","float","boolean","date","bigint","symbol","function","undefined","null","array","object","unknown","promise","void","never","map","set"]),Ft=t=>{switch(typeof t){case"undefined":return z.undefined;case"string":return z.string;case"number":return Number.isNaN(t)?z.nan:z.number;case"boolean":return z.boolean;case"function":return z.function;case"bigint":return z.bigint;case"symbol":return z.symbol;case"object":return Array.isArray(t)?z.array:t===null?z.null:t.then&&typeof t.then=="function"&&t.catch&&typeof t.catch=="function"?z.promise:typeof Map<"u"&&t instanceof Map?z.map:typeof Set<"u"&&t instanceof Set?z.set:typeof Date<"u"&&t instanceof Date?z.date:z.object;default:return z.unknown}};var k=te.arrayToEnum(["invalid_type","invalid_literal","custom","invalid_union","invalid_union_discriminator","invalid_enum_value","unrecognized_keys","invalid_arguments","invalid_return_type","invalid_date","invalid_string","too_small","too_big","invalid_intersection_types","not_multiple_of","not_finite"]),I$=t=>JSON.stringify(t,null,2).replace(/"([^"]+)":/g,"$1:"),it=class t extends Error{get errors(){return this.issues}constructor(e){super(),this.issues=[],this.addIssue=n=>{this.issues=[...this.issues,n]},this.addIssues=(n=[])=>{this.issues=[...this.issues,...n]};let r=new.target.prototype;Object.setPrototypeOf?Object.setPrototypeOf(this,r):this.__proto__=r,this.name="ZodError",this.issues=e}format(e){let r=e||function(o){return o.message},n={_errors:[]},s=o=>{for(let i of o.issues)if(i.code==="invalid_union")i.unionErrors.map(s);else if(i.code==="invalid_return_type")s(i.returnTypeError);else if(i.code==="invalid_arguments")s(i.argumentsError);else if(i.path.length===0)n._errors.push(r(i));else{let a=n,c=0;for(;c<i.path.length;){let u=i.path[c];c===i.path.length-1?(a[u]=a[u]||{_errors:[]},a[u]._errors.push(r(i))):a[u]=a[u]||{_errors:[]},a=a[u],c++}}};return s(this),n}static assert(e){if(!(e instanceof t))throw new Error(`Not a ZodError: ${e}`)}toString(){return this.message}get message(){return JSON.stringify(this.issues,te.jsonStringifyReplacer,2)}get isEmpty(){return this.issues.length===0}flatten(e=r=>r.message){let r={},n=[];for(let s of this.issues)if(s.path.length>0){let o=s.path[0];r[o]=r[o]||[],r[o].push(e(s))}else n.push(e(s));return{formErrors:n,fieldErrors:r}}get formErrors(){return this.flatten()}};it.create=t=>new it(t);var R$=(t,e)=>{let r;switch(t.code){case k.invalid_type:t.received===z.undefined?r="Required":r=`Expected ${t.expected}, received ${t.received}`;break;case k.invalid_literal:r=`Invalid literal value, expected ${JSON.stringify(t.expected,te.jsonStringifyReplacer)}`;break;case k.unrecognized_keys:r=`Unrecognized key(s) in object: ${te.joinValues(t.keys,", ")}`;break;case k.invalid_union:r="Invalid input";break;case k.invalid_union_discriminator:r=`Invalid discriminator value. Expected ${te.joinValues(t.options)}`;break;case k.invalid_enum_value:r=`Invalid enum value. Expected ${te.joinValues(t.options)}, received '${t.received}'`;break;case k.invalid_arguments:r="Invalid function arguments";break;case k.invalid_return_type:r="Invalid function return type";break;case k.invalid_date:r="Invalid date";break;case k.invalid_string:typeof t.validation=="object"?"includes"in t.validation?(r=`Invalid input: must include "${t.validation.includes}"`,typeof t.validation.position=="number"&&(r=`${r} at one or more positions greater than or equal to ${t.validation.position}`)):"startsWith"in t.validation?r=`Invalid input: must start with "${t.validation.startsWith}"`:"endsWith"in t.validation?r=`Invalid input: must end with "${t.validation.endsWith}"`:te.assertNever(t.validation):t.validation!=="regex"?r=`Invalid ${t.validation}`:r="Invalid";break;case k.too_small:t.type==="array"?r=`Array must contain ${t.exact?"exactly":t.inclusive?"at least":"more than"} ${t.minimum} element(s)`:t.type==="string"?r=`String must contain ${t.exact?"exactly":t.inclusive?"at least":"over"} ${t.minimum} character(s)`:t.type==="number"?r=`Number must be ${t.exact?"exactly equal to ":t.inclusive?"greater than or equal to ":"greater than "}${t.minimum}`:t.type==="bigint"?r=`Number must be ${t.exact?"exactly equal to ":t.inclusive?"greater than or equal to ":"greater than "}${t.minimum}`:t.type==="date"?r=`Date must be ${t.exact?"exactly equal to ":t.inclusive?"greater than or equal to ":"greater than "}${new Date(Number(t.minimum))}`:r="Invalid input";break;case k.too_big:t.type==="array"?r=`Array must contain ${t.exact?"exactly":t.inclusive?"at most":"less than"} ${t.maximum} element(s)`:t.type==="string"?r=`String must contain ${t.exact?"exactly":t.inclusive?"at most":"under"} ${t.maximum} character(s)`:t.type==="number"?r=`Number must be ${t.exact?"exactly":t.inclusive?"less than or equal to":"less than"} ${t.maximum}`:t.type==="bigint"?r=`BigInt must be ${t.exact?"exactly":t.inclusive?"less than or equal to":"less than"} ${t.maximum}`:t.type==="date"?r=`Date must be ${t.exact?"exactly":t.inclusive?"smaller than or equal to":"smaller than"} ${new Date(Number(t.maximum))}`:r="Invalid input";break;case k.custom:r="Invalid input";break;case k.invalid_intersection_types:r="Intersection results could not be merged";break;case k.not_multiple_of:r=`Number must be a multiple of ${t.multipleOf}`;break;case k.not_finite:r="Number must be finite";break;default:r=e.defaultError,te.assertNever(t)}return{message:r}},ir=R$;var Lf=ir;function O$(t){Lf=t}function Ln(){return Lf}var As=t=>{let{data:e,path:r,errorMaps:n,issueData:s}=t,o=[...r,...s.path||[]],i={...s,path:o};if(s.message!==void 0)return{...s,path:o,message:s.message};let a="",c=n.filter(u=>!!u).slice().reverse();for(let u of c)a=u(i,{data:e,defaultError:a}).message;return{...s,path:o,message:a}},N$=[];function E(t,e){let r=Ln(),n=As({issueData:e,data:t.data,path:t.path,errorMaps:[t.common.contextualErrorMap,t.schemaErrorMap,r,r===ir?void 0:ir].filter(s=>!!s)});t.common.issues.push(n)}var qe=class t{constructor(){this.value="valid"}dirty(){this.value==="valid"&&(this.value="dirty")}abort(){this.value!=="aborted"&&(this.value="aborted")}static mergeArray(e,r){let n=[];for(let s of r){if(s.status==="aborted")return A;s.status==="dirty"&&e.dirty(),n.push(s.value)}return{status:e.value,value:n}}static async mergeObjectAsync(e,r){let n=[];for(let s of r){let o=await s.key,i=await s.value;n.push({key:o,value:i})}return t.mergeObjectSync(e,n)}static mergeObjectSync(e,r){let n={};for(let s of r){let{key:o,value:i}=s;if(o.status==="aborted"||i.status==="aborted")return A;o.status==="dirty"&&e.dirty(),i.status==="dirty"&&e.dirty(),o.value!=="__proto__"&&(typeof i.value<"u"||s.alwaysSet)&&(n[o.value]=i.value)}return{status:e.value,value:n}}},A=Object.freeze({status:"aborted"}),Yr=t=>({status:"dirty",value:t}),Be=t=>({status:"valid",value:t}),$i=t=>t.status==="aborted",xi=t=>t.status==="dirty",kr=t=>t.status==="valid",Vn=t=>typeof Promise<"u"&&t instanceof Promise;var C;(function(t){t.errToObj=e=>typeof e=="string"?{message:e}:e||{},t.toString=e=>typeof e=="string"?e:e?.message})(C||(C={}));var vt=class{constructor(e,r,n,s){this._cachedPath=[],this.parent=e,this.data=r,this._path=n,this._key=s}get path(){return this._cachedPath.length||(Array.isArray(this._key)?this._cachedPath.push(...this._path,...this._key):this._cachedPath.push(...this._path,this._key)),this._cachedPath}},Vf=(t,e)=>{if(kr(e))return{success:!0,data:e.value};if(!t.common.issues.length)throw new Error("Validation failed but no issues detected.");return{success:!1,get error(){if(this._error)return this._error;let r=new it(t.common.issues);return this._error=r,this._error}}};function U(t){if(!t)return{};let{errorMap:e,invalid_type_error:r,required_error:n,description:s}=t;if(e&&(r||n))throw new Error(`Can't use "invalid_type_error" or "required_error" in conjunction with custom error map.`);return e?{errorMap:e,description:s}:{errorMap:(i,a)=>{let{message:c}=t;return i.code==="invalid_enum_value"?{message:c??a.defaultError}:typeof a.data>"u"?{message:c??n??a.defaultError}:i.code!=="invalid_type"?{message:a.defaultError}:{message:c??r??a.defaultError}},description:s}}var G=class{get description(){return this._def.description}_getType(e){return Ft(e.data)}_getOrReturnCtx(e,r){return r||{common:e.parent.common,data:e.data,parsedType:Ft(e.data),schemaErrorMap:this._def.errorMap,path:e.path,parent:e.parent}}_processInputParams(e){return{status:new qe,ctx:{common:e.parent.common,data:e.data,parsedType:Ft(e.data),schemaErrorMap:this._def.errorMap,path:e.path,parent:e.parent}}}_parseSync(e){let r=this._parse(e);if(Vn(r))throw new Error("Synchronous parse encountered promise.");return r}_parseAsync(e){let r=this._parse(e);return Promise.resolve(r)}parse(e,r){let n=this.safeParse(e,r);if(n.success)return n.data;throw n.error}safeParse(e,r){let n={common:{issues:[],async:r?.async??!1,contextualErrorMap:r?.errorMap},path:r?.path||[],schemaErrorMap:this._def.errorMap,parent:null,data:e,parsedType:Ft(e)},s=this._parseSync({data:e,path:n.path,parent:n});return Vf(n,s)}"~validate"(e){let r={common:{issues:[],async:!!this["~standard"].async},path:[],schemaErrorMap:this._def.errorMap,parent:null,data:e,parsedType:Ft(e)};if(!this["~standard"].async)try{let n=this._parseSync({data:e,path:[],parent:r});return kr(n)?{value:n.value}:{issues:r.common.issues}}catch(n){n?.message?.toLowerCase()?.includes("encountered")&&(this["~standard"].async=!0),r.common={issues:[],async:!0}}return this._parseAsync({data:e,path:[],parent:r}).then(n=>kr(n)?{value:n.value}:{issues:r.common.issues})}async parseAsync(e,r){let n=await this.safeParseAsync(e,r);if(n.success)return n.data;throw n.error}async safeParseAsync(e,r){let n={common:{issues:[],contextualErrorMap:r?.errorMap,async:!0},path:r?.path||[],schemaErrorMap:this._def.errorMap,parent:null,data:e,parsedType:Ft(e)},s=this._parse({data:e,path:n.path,parent:n}),o=await(Vn(s)?s:Promise.resolve(s));return Vf(n,o)}refine(e,r){let n=s=>typeof r=="string"||typeof r>"u"?{message:r}:typeof r=="function"?r(s):r;return this._refinement((s,o)=>{let i=e(s),a=()=>o.addIssue({code:k.custom,...n(s)});return typeof Promise<"u"&&i instanceof Promise?i.then(c=>c?!0:(a(),!1)):i?!0:(a(),!1)})}refinement(e,r){return this._refinement((n,s)=>e(n)?!0:(s.addIssue(typeof r=="function"?r(n,s):r),!1))}_refinement(e){return new _t({schema:this,typeName:q.ZodEffects,effect:{type:"refinement",refinement:e}})}superRefine(e){return this._refinement(e)}constructor(e){this.spa=this.safeParseAsync,this._def=e,this.parse=this.parse.bind(this),this.safeParse=this.safeParse.bind(this),this.parseAsync=this.parseAsync.bind(this),this.safeParseAsync=this.safeParseAsync.bind(this),this.spa=this.spa.bind(this),this.refine=this.refine.bind(this),this.refinement=this.refinement.bind(this),this.superRefine=this.superRefine.bind(this),this.optional=this.optional.bind(this),this.nullable=this.nullable.bind(this),this.nullish=this.nullish.bind(this),this.array=this.array.bind(this),this.promise=this.promise.bind(this),this.or=this.or.bind(this),this.and=this.and.bind(this),this.transform=this.transform.bind(this),this.brand=this.brand.bind(this),this.default=this.default.bind(this),this.catch=this.catch.bind(this),this.describe=this.describe.bind(this),this.pipe=this.pipe.bind(this),this.readonly=this.readonly.bind(this),this.isNullable=this.isNullable.bind(this),this.isOptional=this.isOptional.bind(this),this["~standard"]={version:1,vendor:"zod",validate:r=>this["~validate"](r)}}optional(){return yt.create(this,this._def)}nullable(){return Ht.create(this,this._def)}nullish(){return this.nullable().optional()}array(){return ur.create(this)}promise(){return Er.create(this,this._def)}or(e){return sn.create([this,e],this._def)}and(e){return on.create(this,e,this._def)}transform(e){return new _t({...U(this._def),schema:this,typeName:q.ZodEffects,effect:{type:"transform",transform:e}})}default(e){let r=typeof e=="function"?e:()=>e;return new dn({...U(this._def),innerType:this,defaultValue:r,typeName:q.ZodDefault})}brand(){return new Ms({typeName:q.ZodBranded,type:this,...U(this._def)})}catch(e){let r=typeof e=="function"?e:()=>e;return new pn({...U(this._def),innerType:this,catchValue:r,typeName:q.ZodCatch})}describe(e){let r=this.constructor;return new r({...this._def,description:e})}pipe(e){return qs.create(this,e)}readonly(){return fn.create(this)}isOptional(){return this.safeParse(void 0).success}isNullable(){return this.safeParse(null).success}},j$=/^c[^\s-]{8,}$/i,A$=/^[0-9a-z]+$/,M$=/^[0-9A-HJKMNP-TV-Z]{26}$/i,q$=/^[0-9a-fA-F]{8}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{12}$/i,D$=/^[a-z0-9_-]{21}$/i,Z$=/^[A-Za-z0-9-_]+\.[A-Za-z0-9-_]+\.[A-Za-z0-9-_]*$/,L$=/^[-+]?P(?!$)(?:(?:[-+]?\d+Y)|(?:[-+]?\d+[.,]\d+Y$))?(?:(?:[-+]?\d+M)|(?:[-+]?\d+[.,]\d+M$))?(?:(?:[-+]?\d+W)|(?:[-+]?\d+[.,]\d+W$))?(?:(?:[-+]?\d+D)|(?:[-+]?\d+[.,]\d+D$))?(?:T(?=[\d+-])(?:(?:[-+]?\d+H)|(?:[-+]?\d+[.,]\d+H$))?(?:(?:[-+]?\d+M)|(?:[-+]?\d+[.,]\d+M$))?(?:[-+]?\d+(?:[.,]\d+)?S)?)??$/,V$=/^(?!\.)(?!.*\.\.)([A-Z0-9_'+\-\.]*)[A-Z0-9_+-]@([A-Z0-9][A-Z0-9\-]*\.)+[A-Z]{2,}$/i,F$="^(\\p{Extended_Pictographic}|\\p{Emoji_Component})+$",Oc,U$=/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])$/,H$=/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\/(3[0-2]|[12]?[0-9])$/,K$=/^(([0-9a-fA-F]{1,4}:){7,7}[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,7}:|([0-9a-fA-F]{1,4}:){1,6}:[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,5}(:[0-9a-fA-F]{1,4}){1,2}|([0-9a-fA-F]{1,4}:){1,4}(:[0-9a-fA-F]{1,4}){1,3}|([0-9a-fA-F]{1,4}:){1,3}(:[0-9a-fA-F]{1,4}){1,4}|([0-9a-fA-F]{1,4}:){1,2}(:[0-9a-fA-F]{1,4}){1,5}|[0-9a-fA-F]{1,4}:((:[0-9a-fA-F]{1,4}){1,6})|:((:[0-9a-fA-F]{1,4}){1,7}|:)|fe80:(:[0-9a-fA-F]{0,4}){0,4}%[0-9a-zA-Z]{1,}|::(ffff(:0{1,4}){0,1}:){0,1}((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])|([0-9a-fA-F]{1,4}:){1,4}:((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9]))$/,B$=/^(([0-9a-fA-F]{1,4}:){7,7}[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,7}:|([0-9a-fA-F]{1,4}:){1,6}:[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,5}(:[0-9a-fA-F]{1,4}){1,2}|([0-9a-fA-F]{1,4}:){1,4}(:[0-9a-fA-F]{1,4}){1,3}|([0-9a-fA-F]{1,4}:){1,3}(:[0-9a-fA-F]{1,4}){1,4}|([0-9a-fA-F]{1,4}:){1,2}(:[0-9a-fA-F]{1,4}){1,5}|[0-9a-fA-F]{1,4}:((:[0-9a-fA-F]{1,4}){1,6})|:((:[0-9a-fA-F]{1,4}){1,7}|:)|fe80:(:[0-9a-fA-F]{0,4}){0,4}%[0-9a-zA-Z]{1,}|::(ffff(:0{1,4}){0,1}:){0,1}((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])|([0-9a-fA-F]{1,4}:){1,4}:((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9]))\/(12[0-8]|1[01][0-9]|[1-9]?[0-9])$/,G$=/^([0-9a-zA-Z+/]{4})*(([0-9a-zA-Z+/]{2}==)|([0-9a-zA-Z+/]{3}=))?$/,W$=/^([0-9a-zA-Z-_]{4})*(([0-9a-zA-Z-_]{2}(==)?)|([0-9a-zA-Z-_]{3}(=)?))?$/,Uf="((\\d\\d[2468][048]|\\d\\d[13579][26]|\\d\\d0[48]|[02468][048]00|[13579][26]00)-02-29|\\d{4}-((0[13578]|1[02])-(0[1-9]|[12]\\d|3[01])|(0[469]|11)-(0[1-9]|[12]\\d|30)|(02)-(0[1-9]|1\\d|2[0-8])))",J$=new RegExp(`^${Uf}$`);function Hf(t){let e="[0-5]\\d";t.precision?e=`${e}\\.\\d{${t.precision}}`:t.precision==null&&(e=`${e}(\\.\\d+)?`);let r=t.precision?"+":"?";return`([01]\\d|2[0-3]):[0-5]\\d(:${e})${r}`}function Y$(t){return new RegExp(`^${Hf(t)}$`)}function Kf(t){let e=`${Uf}T${Hf(t)}`,r=[];return r.push(t.local?"Z?":"Z"),t.offset&&r.push("([+-]\\d{2}:?\\d{2})"),e=`${e}(${r.join("|")})`,new RegExp(`^${e}$`)}function Q$(t,e){return!!((e==="v4"||!e)&&U$.test(t)||(e==="v6"||!e)&&K$.test(t))}function X$(t,e){if(!Z$.test(t))return!1;try{let[r]=t.split(".");if(!r)return!1;let n=r.replace(/-/g,"+").replace(/_/g,"/").padEnd(r.length+(4-r.length%4)%4,"="),s=JSON.parse(atob(n));return!(typeof s!="object"||s===null||"typ"in s&&s?.typ!=="JWT"||!s.alg||e&&s.alg!==e)}catch{return!1}}function ex(t,e){return!!((e==="v4"||!e)&&H$.test(t)||(e==="v6"||!e)&&B$.test(t))}var Sr=class t extends G{_parse(e){if(this._def.coerce&&(e.data=String(e.data)),this._getType(e)!==z.string){let o=this._getOrReturnCtx(e);return E(o,{code:k.invalid_type,expected:z.string,received:o.parsedType}),A}let n=new qe,s;for(let o of this._def.checks)if(o.kind==="min")e.data.length<o.value&&(s=this._getOrReturnCtx(e,s),E(s,{code:k.too_small,minimum:o.value,type:"string",inclusive:!0,exact:!1,message:o.message}),n.dirty());else if(o.kind==="max")e.data.length>o.value&&(s=this._getOrReturnCtx(e,s),E(s,{code:k.too_big,maximum:o.value,type:"string",inclusive:!0,exact:!1,message:o.message}),n.dirty());else if(o.kind==="length"){let i=e.data.length>o.value,a=e.data.length<o.value;(i||a)&&(s=this._getOrReturnCtx(e,s),i?E(s,{code:k.too_big,maximum:o.value,type:"string",inclusive:!0,exact:!0,message:o.message}):a&&E(s,{code:k.too_small,minimum:o.value,type:"string",inclusive:!0,exact:!0,message:o.message}),n.dirty())}else if(o.kind==="email")V$.test(e.data)||(s=this._getOrReturnCtx(e,s),E(s,{validation:"email",code:k.invalid_string,message:o.message}),n.dirty());else if(o.kind==="emoji")Oc||(Oc=new RegExp(F$,"u")),Oc.test(e.data)||(s=this._getOrReturnCtx(e,s),E(s,{validation:"emoji",code:k.invalid_string,message:o.message}),n.dirty());else if(o.kind==="uuid")q$.test(e.data)||(s=this._getOrReturnCtx(e,s),E(s,{validation:"uuid",code:k.invalid_string,message:o.message}),n.dirty());else if(o.kind==="nanoid")D$.test(e.data)||(s=this._getOrReturnCtx(e,s),E(s,{validation:"nanoid",code:k.invalid_string,message:o.message}),n.dirty());else if(o.kind==="cuid")j$.test(e.data)||(s=this._getOrReturnCtx(e,s),E(s,{validation:"cuid",code:k.invalid_string,message:o.message}),n.dirty());else if(o.kind==="cuid2")A$.test(e.data)||(s=this._getOrReturnCtx(e,s),E(s,{validation:"cuid2",code:k.invalid_string,message:o.message}),n.dirty());else if(o.kind==="ulid")M$.test(e.data)||(s=this._getOrReturnCtx(e,s),E(s,{validation:"ulid",code:k.invalid_string,message:o.message}),n.dirty());else if(o.kind==="url")try{new URL(e.data)}catch{s=this._getOrReturnCtx(e,s),E(s,{validation:"url",code:k.invalid_string,message:o.message}),n.dirty()}else o.kind==="regex"?(o.regex.lastIndex=0,o.regex.test(e.data)||(s=this._getOrReturnCtx(e,s),E(s,{validation:"regex",code:k.invalid_string,message:o.message}),n.dirty())):o.kind==="trim"?e.data=e.data.trim():o.kind==="includes"?e.data.includes(o.value,o.position)||(s=this._getOrReturnCtx(e,s),E(s,{code:k.invalid_string,validation:{includes:o.value,position:o.position},message:o.message}),n.dirty()):o.kind==="toLowerCase"?e.data=e.data.toLowerCase():o.kind==="toUpperCase"?e.data=e.data.toUpperCase():o.kind==="startsWith"?e.data.startsWith(o.value)||(s=this._getOrReturnCtx(e,s),E(s,{code:k.invalid_string,validation:{startsWith:o.value},message:o.message}),n.dirty()):o.kind==="endsWith"?e.data.endsWith(o.value)||(s=this._getOrReturnCtx(e,s),E(s,{code:k.invalid_string,validation:{endsWith:o.value},message:o.message}),n.dirty()):o.kind==="datetime"?Kf(o).test(e.data)||(s=this._getOrReturnCtx(e,s),E(s,{code:k.invalid_string,validation:"datetime",message:o.message}),n.dirty()):o.kind==="date"?J$.test(e.data)||(s=this._getOrReturnCtx(e,s),E(s,{code:k.invalid_string,validation:"date",message:o.message}),n.dirty()):o.kind==="time"?Y$(o).test(e.data)||(s=this._getOrReturnCtx(e,s),E(s,{code:k.invalid_string,validation:"time",message:o.message}),n.dirty()):o.kind==="duration"?L$.test(e.data)||(s=this._getOrReturnCtx(e,s),E(s,{validation:"duration",code:k.invalid_string,message:o.message}),n.dirty()):o.kind==="ip"?Q$(e.data,o.version)||(s=this._getOrReturnCtx(e,s),E(s,{validation:"ip",code:k.invalid_string,message:o.message}),n.dirty()):o.kind==="jwt"?X$(e.data,o.alg)||(s=this._getOrReturnCtx(e,s),E(s,{validation:"jwt",code:k.invalid_string,message:o.message}),n.dirty()):o.kind==="cidr"?ex(e.data,o.version)||(s=this._getOrReturnCtx(e,s),E(s,{validation:"cidr",code:k.invalid_string,message:o.message}),n.dirty()):o.kind==="base64"?G$.test(e.data)||(s=this._getOrReturnCtx(e,s),E(s,{validation:"base64",code:k.invalid_string,message:o.message}),n.dirty()):o.kind==="base64url"?W$.test(e.data)||(s=this._getOrReturnCtx(e,s),E(s,{validation:"base64url",code:k.invalid_string,message:o.message}),n.dirty()):te.assertNever(o);return{status:n.value,value:e.data}}_regex(e,r,n){return this.refinement(s=>e.test(s),{validation:r,code:k.invalid_string,...C.errToObj(n)})}_addCheck(e){return new t({...this._def,checks:[...this._def.checks,e]})}email(e){return this._addCheck({kind:"email",...C.errToObj(e)})}url(e){return this._addCheck({kind:"url",...C.errToObj(e)})}emoji(e){return this._addCheck({kind:"emoji",...C.errToObj(e)})}uuid(e){return this._addCheck({kind:"uuid",...C.errToObj(e)})}nanoid(e){return this._addCheck({kind:"nanoid",...C.errToObj(e)})}cuid(e){return this._addCheck({kind:"cuid",...C.errToObj(e)})}cuid2(e){return this._addCheck({kind:"cuid2",...C.errToObj(e)})}ulid(e){return this._addCheck({kind:"ulid",...C.errToObj(e)})}base64(e){return this._addCheck({kind:"base64",...C.errToObj(e)})}base64url(e){return this._addCheck({kind:"base64url",...C.errToObj(e)})}jwt(e){return this._addCheck({kind:"jwt",...C.errToObj(e)})}ip(e){return this._addCheck({kind:"ip",...C.errToObj(e)})}cidr(e){return this._addCheck({kind:"cidr",...C.errToObj(e)})}datetime(e){return typeof e=="string"?this._addCheck({kind:"datetime",precision:null,offset:!1,local:!1,message:e}):this._addCheck({kind:"datetime",precision:typeof e?.precision>"u"?null:e?.precision,offset:e?.offset??!1,local:e?.local??!1,...C.errToObj(e?.message)})}date(e){return this._addCheck({kind:"date",message:e})}time(e){return typeof e=="string"?this._addCheck({kind:"time",precision:null,message:e}):this._addCheck({kind:"time",precision:typeof e?.precision>"u"?null:e?.precision,...C.errToObj(e?.message)})}duration(e){return this._addCheck({kind:"duration",...C.errToObj(e)})}regex(e,r){return this._addCheck({kind:"regex",regex:e,...C.errToObj(r)})}includes(e,r){return this._addCheck({kind:"includes",value:e,position:r?.position,...C.errToObj(r?.message)})}startsWith(e,r){return this._addCheck({kind:"startsWith",value:e,...C.errToObj(r)})}endsWith(e,r){return this._addCheck({kind:"endsWith",value:e,...C.errToObj(r)})}min(e,r){return this._addCheck({kind:"min",value:e,...C.errToObj(r)})}max(e,r){return this._addCheck({kind:"max",value:e,...C.errToObj(r)})}length(e,r){return this._addCheck({kind:"length",value:e,...C.errToObj(r)})}nonempty(e){return this.min(1,C.errToObj(e))}trim(){return new t({...this._def,checks:[...this._def.checks,{kind:"trim"}]})}toLowerCase(){return new t({...this._def,checks:[...this._def.checks,{kind:"toLowerCase"}]})}toUpperCase(){return new t({...this._def,checks:[...this._def.checks,{kind:"toUpperCase"}]})}get isDatetime(){return!!this._def.checks.find(e=>e.kind==="datetime")}get isDate(){return!!this._def.checks.find(e=>e.kind==="date")}get isTime(){return!!this._def.checks.find(e=>e.kind==="time")}get isDuration(){return!!this._def.checks.find(e=>e.kind==="duration")}get isEmail(){return!!this._def.checks.find(e=>e.kind==="email")}get isURL(){return!!this._def.checks.find(e=>e.kind==="url")}get isEmoji(){return!!this._def.checks.find(e=>e.kind==="emoji")}get isUUID(){return!!this._def.checks.find(e=>e.kind==="uuid")}get isNANOID(){return!!this._def.checks.find(e=>e.kind==="nanoid")}get isCUID(){return!!this._def.checks.find(e=>e.kind==="cuid")}get isCUID2(){return!!this._def.checks.find(e=>e.kind==="cuid2")}get isULID(){return!!this._def.checks.find(e=>e.kind==="ulid")}get isIP(){return!!this._def.checks.find(e=>e.kind==="ip")}get isCIDR(){return!!this._def.checks.find(e=>e.kind==="cidr")}get isBase64(){return!!this._def.checks.find(e=>e.kind==="base64")}get isBase64url(){return!!this._def.checks.find(e=>e.kind==="base64url")}get minLength(){let e=null;for(let r of this._def.checks)r.kind==="min"&&(e===null||r.value>e)&&(e=r.value);return e}get maxLength(){let e=null;for(let r of this._def.checks)r.kind==="max"&&(e===null||r.value<e)&&(e=r.value);return e}};Sr.create=t=>new Sr({checks:[],typeName:q.ZodString,coerce:t?.coerce??!1,...U(t)});function tx(t,e){let r=(t.toString().split(".")[1]||"").length,n=(e.toString().split(".")[1]||"").length,s=r>n?r:n,o=Number.parseInt(t.toFixed(s).replace(".","")),i=Number.parseInt(e.toFixed(s).replace(".",""));return o%i/10**s}var Qr=class t extends G{constructor(){super(...arguments),this.min=this.gte,this.max=this.lte,this.step=this.multipleOf}_parse(e){if(this._def.coerce&&(e.data=Number(e.data)),this._getType(e)!==z.number){let o=this._getOrReturnCtx(e);return E(o,{code:k.invalid_type,expected:z.number,received:o.parsedType}),A}let n,s=new qe;for(let o of this._def.checks)o.kind==="int"?te.isInteger(e.data)||(n=this._getOrReturnCtx(e,n),E(n,{code:k.invalid_type,expected:"integer",received:"float",message:o.message}),s.dirty()):o.kind==="min"?(o.inclusive?e.data<o.value:e.data<=o.value)&&(n=this._getOrReturnCtx(e,n),E(n,{code:k.too_small,minimum:o.value,type:"number",inclusive:o.inclusive,exact:!1,message:o.message}),s.dirty()):o.kind==="max"?(o.inclusive?e.data>o.value:e.data>=o.value)&&(n=this._getOrReturnCtx(e,n),E(n,{code:k.too_big,maximum:o.value,type:"number",inclusive:o.inclusive,exact:!1,message:o.message}),s.dirty()):o.kind==="multipleOf"?tx(e.data,o.value)!==0&&(n=this._getOrReturnCtx(e,n),E(n,{code:k.not_multiple_of,multipleOf:o.value,message:o.message}),s.dirty()):o.kind==="finite"?Number.isFinite(e.data)||(n=this._getOrReturnCtx(e,n),E(n,{code:k.not_finite,message:o.message}),s.dirty()):te.assertNever(o);return{status:s.value,value:e.data}}gte(e,r){return this.setLimit("min",e,!0,C.toString(r))}gt(e,r){return this.setLimit("min",e,!1,C.toString(r))}lte(e,r){return this.setLimit("max",e,!0,C.toString(r))}lt(e,r){return this.setLimit("max",e,!1,C.toString(r))}setLimit(e,r,n,s){return new t({...this._def,checks:[...this._def.checks,{kind:e,value:r,inclusive:n,message:C.toString(s)}]})}_addCheck(e){return new t({...this._def,checks:[...this._def.checks,e]})}int(e){return this._addCheck({kind:"int",message:C.toString(e)})}positive(e){return this._addCheck({kind:"min",value:0,inclusive:!1,message:C.toString(e)})}negative(e){return this._addCheck({kind:"max",value:0,inclusive:!1,message:C.toString(e)})}nonpositive(e){return this._addCheck({kind:"max",value:0,inclusive:!0,message:C.toString(e)})}nonnegative(e){return this._addCheck({kind:"min",value:0,inclusive:!0,message:C.toString(e)})}multipleOf(e,r){return this._addCheck({kind:"multipleOf",value:e,message:C.toString(r)})}finite(e){return this._addCheck({kind:"finite",message:C.toString(e)})}safe(e){return this._addCheck({kind:"min",inclusive:!0,value:Number.MIN_SAFE_INTEGER,message:C.toString(e)})._addCheck({kind:"max",inclusive:!0,value:Number.MAX_SAFE_INTEGER,message:C.toString(e)})}get minValue(){let e=null;for(let r of this._def.checks)r.kind==="min"&&(e===null||r.value>e)&&(e=r.value);return e}get maxValue(){let e=null;for(let r of this._def.checks)r.kind==="max"&&(e===null||r.value<e)&&(e=r.value);return e}get isInt(){return!!this._def.checks.find(e=>e.kind==="int"||e.kind==="multipleOf"&&te.isInteger(e.value))}get isFinite(){let e=null,r=null;for(let n of this._def.checks){if(n.kind==="finite"||n.kind==="int"||n.kind==="multipleOf")return!0;n.kind==="min"?(r===null||n.value>r)&&(r=n.value):n.kind==="max"&&(e===null||n.value<e)&&(e=n.value)}return Number.isFinite(r)&&Number.isFinite(e)}};Qr.create=t=>new Qr({checks:[],typeName:q.ZodNumber,coerce:t?.coerce||!1,...U(t)});var Xr=class t extends G{constructor(){super(...arguments),this.min=this.gte,this.max=this.lte}_parse(e){if(this._def.coerce)try{e.data=BigInt(e.data)}catch{return this._getInvalidInput(e)}if(this._getType(e)!==z.bigint)return this._getInvalidInput(e);let n,s=new qe;for(let o of this._def.checks)o.kind==="min"?(o.inclusive?e.data<o.value:e.data<=o.value)&&(n=this._getOrReturnCtx(e,n),E(n,{code:k.too_small,type:"bigint",minimum:o.value,inclusive:o.inclusive,message:o.message}),s.dirty()):o.kind==="max"?(o.inclusive?e.data>o.value:e.data>=o.value)&&(n=this._getOrReturnCtx(e,n),E(n,{code:k.too_big,type:"bigint",maximum:o.value,inclusive:o.inclusive,message:o.message}),s.dirty()):o.kind==="multipleOf"?e.data%o.value!==BigInt(0)&&(n=this._getOrReturnCtx(e,n),E(n,{code:k.not_multiple_of,multipleOf:o.value,message:o.message}),s.dirty()):te.assertNever(o);return{status:s.value,value:e.data}}_getInvalidInput(e){let r=this._getOrReturnCtx(e);return E(r,{code:k.invalid_type,expected:z.bigint,received:r.parsedType}),A}gte(e,r){return this.setLimit("min",e,!0,C.toString(r))}gt(e,r){return this.setLimit("min",e,!1,C.toString(r))}lte(e,r){return this.setLimit("max",e,!0,C.toString(r))}lt(e,r){return this.setLimit("max",e,!1,C.toString(r))}setLimit(e,r,n,s){return new t({...this._def,checks:[...this._def.checks,{kind:e,value:r,inclusive:n,message:C.toString(s)}]})}_addCheck(e){return new t({...this._def,checks:[...this._def.checks,e]})}positive(e){return this._addCheck({kind:"min",value:BigInt(0),inclusive:!1,message:C.toString(e)})}negative(e){return this._addCheck({kind:"max",value:BigInt(0),inclusive:!1,message:C.toString(e)})}nonpositive(e){return this._addCheck({kind:"max",value:BigInt(0),inclusive:!0,message:C.toString(e)})}nonnegative(e){return this._addCheck({kind:"min",value:BigInt(0),inclusive:!0,message:C.toString(e)})}multipleOf(e,r){return this._addCheck({kind:"multipleOf",value:e,message:C.toString(r)})}get minValue(){let e=null;for(let r of this._def.checks)r.kind==="min"&&(e===null||r.value>e)&&(e=r.value);return e}get maxValue(){let e=null;for(let r of this._def.checks)r.kind==="max"&&(e===null||r.value<e)&&(e=r.value);return e}};Xr.create=t=>new Xr({checks:[],typeName:q.ZodBigInt,coerce:t?.coerce??!1,...U(t)});var en=class extends G{_parse(e){if(this._def.coerce&&(e.data=!!e.data),this._getType(e)!==z.boolean){let n=this._getOrReturnCtx(e);return E(n,{code:k.invalid_type,expected:z.boolean,received:n.parsedType}),A}return Be(e.data)}};en.create=t=>new en({typeName:q.ZodBoolean,coerce:t?.coerce||!1,...U(t)});var tn=class t extends G{_parse(e){if(this._def.coerce&&(e.data=new Date(e.data)),this._getType(e)!==z.date){let o=this._getOrReturnCtx(e);return E(o,{code:k.invalid_type,expected:z.date,received:o.parsedType}),A}if(Number.isNaN(e.data.getTime())){let o=this._getOrReturnCtx(e);return E(o,{code:k.invalid_date}),A}let n=new qe,s;for(let o of this._def.checks)o.kind==="min"?e.data.getTime()<o.value&&(s=this._getOrReturnCtx(e,s),E(s,{code:k.too_small,message:o.message,inclusive:!0,exact:!1,minimum:o.value,type:"date"}),n.dirty()):o.kind==="max"?e.data.getTime()>o.value&&(s=this._getOrReturnCtx(e,s),E(s,{code:k.too_big,message:o.message,inclusive:!0,exact:!1,maximum:o.value,type:"date"}),n.dirty()):te.assertNever(o);return{status:n.value,value:new Date(e.data.getTime())}}_addCheck(e){return new t({...this._def,checks:[...this._def.checks,e]})}min(e,r){return this._addCheck({kind:"min",value:e.getTime(),message:C.toString(r)})}max(e,r){return this._addCheck({kind:"max",value:e.getTime(),message:C.toString(r)})}get minDate(){let e=null;for(let r of this._def.checks)r.kind==="min"&&(e===null||r.value>e)&&(e=r.value);return e!=null?new Date(e):null}get maxDate(){let e=null;for(let r of this._def.checks)r.kind==="max"&&(e===null||r.value<e)&&(e=r.value);return e!=null?new Date(e):null}};tn.create=t=>new tn({checks:[],coerce:t?.coerce||!1,typeName:q.ZodDate,...U(t)});var Un=class extends G{_parse(e){if(this._getType(e)!==z.symbol){let n=this._getOrReturnCtx(e);return E(n,{code:k.invalid_type,expected:z.symbol,received:n.parsedType}),A}return Be(e.data)}};Un.create=t=>new Un({typeName:q.ZodSymbol,...U(t)});var rn=class extends G{_parse(e){if(this._getType(e)!==z.undefined){let n=this._getOrReturnCtx(e);return E(n,{code:k.invalid_type,expected:z.undefined,received:n.parsedType}),A}return Be(e.data)}};rn.create=t=>new rn({typeName:q.ZodUndefined,...U(t)});var nn=class extends G{_parse(e){if(this._getType(e)!==z.null){let n=this._getOrReturnCtx(e);return E(n,{code:k.invalid_type,expected:z.null,received:n.parsedType}),A}return Be(e.data)}};nn.create=t=>new nn({typeName:q.ZodNull,...U(t)});var Pr=class extends G{constructor(){super(...arguments),this._any=!0}_parse(e){return Be(e.data)}};Pr.create=t=>new Pr({typeName:q.ZodAny,...U(t)});var cr=class extends G{constructor(){super(...arguments),this._unknown=!0}_parse(e){return Be(e.data)}};cr.create=t=>new cr({typeName:q.ZodUnknown,...U(t)});var It=class extends G{_parse(e){let r=this._getOrReturnCtx(e);return E(r,{code:k.invalid_type,expected:z.never,received:r.parsedType}),A}};It.create=t=>new It({typeName:q.ZodNever,...U(t)});var Hn=class extends G{_parse(e){if(this._getType(e)!==z.undefined){let n=this._getOrReturnCtx(e);return E(n,{code:k.invalid_type,expected:z.void,received:n.parsedType}),A}return Be(e.data)}};Hn.create=t=>new Hn({typeName:q.ZodVoid,...U(t)});var ur=class t extends G{_parse(e){let{ctx:r,status:n}=this._processInputParams(e),s=this._def;if(r.parsedType!==z.array)return E(r,{code:k.invalid_type,expected:z.array,received:r.parsedType}),A;if(s.exactLength!==null){let i=r.data.length>s.exactLength.value,a=r.data.length<s.exactLength.value;(i||a)&&(E(r,{code:i?k.too_big:k.too_small,minimum:a?s.exactLength.value:void 0,maximum:i?s.exactLength.value:void 0,type:"array",inclusive:!0,exact:!0,message:s.exactLength.message}),n.dirty())}if(s.minLength!==null&&r.data.length<s.minLength.value&&(E(r,{code:k.too_small,minimum:s.minLength.value,type:"array",inclusive:!0,exact:!1,message:s.minLength.message}),n.dirty()),s.maxLength!==null&&r.data.length>s.maxLength.value&&(E(r,{code:k.too_big,maximum:s.maxLength.value,type:"array",inclusive:!0,exact:!1,message:s.maxLength.message}),n.dirty()),r.common.async)return Promise.all([...r.data].map((i,a)=>s.type._parseAsync(new vt(r,i,r.path,a)))).then(i=>qe.mergeArray(n,i));let o=[...r.data].map((i,a)=>s.type._parseSync(new vt(r,i,r.path,a)));return qe.mergeArray(n,o)}get element(){return this._def.type}min(e,r){return new t({...this._def,minLength:{value:e,message:C.toString(r)}})}max(e,r){return new t({...this._def,maxLength:{value:e,message:C.toString(r)}})}length(e,r){return new t({...this._def,exactLength:{value:e,message:C.toString(r)}})}nonempty(e){return this.min(1,e)}};ur.create=(t,e)=>new ur({type:t,minLength:null,maxLength:null,exactLength:null,typeName:q.ZodArray,...U(e)});function Fn(t){if(t instanceof at){let e={};for(let r in t.shape){let n=t.shape[r];e[r]=yt.create(Fn(n))}return new at({...t._def,shape:()=>e})}else return t instanceof ur?new ur({...t._def,type:Fn(t.element)}):t instanceof yt?yt.create(Fn(t.unwrap())):t instanceof Ht?Ht.create(Fn(t.unwrap())):t instanceof Ut?Ut.create(t.items.map(e=>Fn(e))):t}var at=class t extends G{constructor(){super(...arguments),this._cached=null,this.nonstrict=this.passthrough,this.augment=this.extend}_getCached(){if(this._cached!==null)return this._cached;let e=this._def.shape(),r=te.objectKeys(e);return this._cached={shape:e,keys:r},this._cached}_parse(e){if(this._getType(e)!==z.object){let u=this._getOrReturnCtx(e);return E(u,{code:k.invalid_type,expected:z.object,received:u.parsedType}),A}let{status:n,ctx:s}=this._processInputParams(e),{shape:o,keys:i}=this._getCached(),a=[];if(!(this._def.catchall instanceof It&&this._def.unknownKeys==="strip"))for(let u in s.data)i.includes(u)||a.push(u);let c=[];for(let u of i){let l=o[u],d=s.data[u];c.push({key:{status:"valid",value:u},value:l._parse(new vt(s,d,s.path,u)),alwaysSet:u in s.data})}if(this._def.catchall instanceof It){let u=this._def.unknownKeys;if(u==="passthrough")for(let l of a)c.push({key:{status:"valid",value:l},value:{status:"valid",value:s.data[l]}});else if(u==="strict")a.length>0&&(E(s,{code:k.unrecognized_keys,keys:a}),n.dirty());else if(u!=="strip")throw new Error("Internal ZodObject error: invalid unknownKeys value.")}else{let u=this._def.catchall;for(let l of a){let d=s.data[l];c.push({key:{status:"valid",value:l},value:u._parse(new vt(s,d,s.path,l)),alwaysSet:l in s.data})}}return s.common.async?Promise.resolve().then(async()=>{let u=[];for(let l of c){let d=await l.key,f=await l.value;u.push({key:d,value:f,alwaysSet:l.alwaysSet})}return u}).then(u=>qe.mergeObjectSync(n,u)):qe.mergeObjectSync(n,c)}get shape(){return this._def.shape()}strict(e){return C.errToObj,new t({...this._def,unknownKeys:"strict",...e!==void 0?{errorMap:(r,n)=>{let s=this._def.errorMap?.(r,n).message??n.defaultError;return r.code==="unrecognized_keys"?{message:C.errToObj(e).message??s}:{message:s}}}:{}})}strip(){return new t({...this._def,unknownKeys:"strip"})}passthrough(){return new t({...this._def,unknownKeys:"passthrough"})}extend(e){return new t({...this._def,shape:()=>({...this._def.shape(),...e})})}merge(e){return new t({unknownKeys:e._def.unknownKeys,catchall:e._def.catchall,shape:()=>({...this._def.shape(),...e._def.shape()}),typeName:q.ZodObject})}setKey(e,r){return this.augment({[e]:r})}catchall(e){return new t({...this._def,catchall:e})}pick(e){let r={};for(let n of te.objectKeys(e))e[n]&&this.shape[n]&&(r[n]=this.shape[n]);return new t({...this._def,shape:()=>r})}omit(e){let r={};for(let n of te.objectKeys(this.shape))e[n]||(r[n]=this.shape[n]);return new t({...this._def,shape:()=>r})}deepPartial(){return Fn(this)}partial(e){let r={};for(let n of te.objectKeys(this.shape)){let s=this.shape[n];e&&!e[n]?r[n]=s:r[n]=s.optional()}return new t({...this._def,shape:()=>r})}required(e){let r={};for(let n of te.objectKeys(this.shape))if(e&&!e[n])r[n]=this.shape[n];else{let o=this.shape[n];for(;o instanceof yt;)o=o._def.innerType;r[n]=o}return new t({...this._def,shape:()=>r})}keyof(){return Bf(te.objectKeys(this.shape))}};at.create=(t,e)=>new at({shape:()=>t,unknownKeys:"strip",catchall:It.create(),typeName:q.ZodObject,...U(e)});at.strictCreate=(t,e)=>new at({shape:()=>t,unknownKeys:"strict",catchall:It.create(),typeName:q.ZodObject,...U(e)});at.lazycreate=(t,e)=>new at({shape:t,unknownKeys:"strip",catchall:It.create(),typeName:q.ZodObject,...U(e)});var sn=class extends G{_parse(e){let{ctx:r}=this._processInputParams(e),n=this._def.options;function s(o){for(let a of o)if(a.result.status==="valid")return a.result;for(let a of o)if(a.result.status==="dirty")return r.common.issues.push(...a.ctx.common.issues),a.result;let i=o.map(a=>new it(a.ctx.common.issues));return E(r,{code:k.invalid_union,unionErrors:i}),A}if(r.common.async)return Promise.all(n.map(async o=>{let i={...r,common:{...r.common,issues:[]},parent:null};return{result:await o._parseAsync({data:r.data,path:r.path,parent:i}),ctx:i}})).then(s);{let o,i=[];for(let c of n){let u={...r,common:{...r.common,issues:[]},parent:null},l=c._parseSync({data:r.data,path:r.path,parent:u});if(l.status==="valid")return l;l.status==="dirty"&&!o&&(o={result:l,ctx:u}),u.common.issues.length&&i.push(u.common.issues)}if(o)return r.common.issues.push(...o.ctx.common.issues),o.result;let a=i.map(c=>new it(c));return E(r,{code:k.invalid_union,unionErrors:a}),A}}get options(){return this._def.options}};sn.create=(t,e)=>new sn({options:t,typeName:q.ZodUnion,...U(e)});var ar=t=>t instanceof an?ar(t.schema):t instanceof _t?ar(t.innerType()):t instanceof cn?[t.value]:t instanceof un?t.options:t instanceof ln?te.objectValues(t.enum):t instanceof dn?ar(t._def.innerType):t instanceof rn?[void 0]:t instanceof nn?[null]:t instanceof yt?[void 0,...ar(t.unwrap())]:t instanceof Ht?[null,...ar(t.unwrap())]:t instanceof Ms||t instanceof fn?ar(t.unwrap()):t instanceof pn?ar(t._def.innerType):[],ki=class t extends G{_parse(e){let{ctx:r}=this._processInputParams(e);if(r.parsedType!==z.object)return E(r,{code:k.invalid_type,expected:z.object,received:r.parsedType}),A;let n=this.discriminator,s=r.data[n],o=this.optionsMap.get(s);return o?r.common.async?o._parseAsync({data:r.data,path:r.path,parent:r}):o._parseSync({data:r.data,path:r.path,parent:r}):(E(r,{code:k.invalid_union_discriminator,options:Array.from(this.optionsMap.keys()),path:[n]}),A)}get discriminator(){return this._def.discriminator}get options(){return this._def.options}get optionsMap(){return this._def.optionsMap}static create(e,r,n){let s=new Map;for(let o of r){let i=ar(o.shape[e]);if(!i.length)throw new Error(`A discriminator value for key \`${e}\` could not be extracted from all schema options`);for(let a of i){if(s.has(a))throw new Error(`Discriminator property ${String(e)} has duplicate value ${String(a)}`);s.set(a,o)}}return new t({typeName:q.ZodDiscriminatedUnion,discriminator:e,options:r,optionsMap:s,...U(n)})}};function Nc(t,e){let r=Ft(t),n=Ft(e);if(t===e)return{valid:!0,data:t};if(r===z.object&&n===z.object){let s=te.objectKeys(e),o=te.objectKeys(t).filter(a=>s.indexOf(a)!==-1),i={...t,...e};for(let a of o){let c=Nc(t[a],e[a]);if(!c.valid)return{valid:!1};i[a]=c.data}return{valid:!0,data:i}}else if(r===z.array&&n===z.array){if(t.length!==e.length)return{valid:!1};let s=[];for(let o=0;o<t.length;o++){let i=t[o],a=e[o],c=Nc(i,a);if(!c.valid)return{valid:!1};s.push(c.data)}return{valid:!0,data:s}}else return r===z.date&&n===z.date&&+t==+e?{valid:!0,data:t}:{valid:!1}}var on=class extends G{_parse(e){let{status:r,ctx:n}=this._processInputParams(e),s=(o,i)=>{if($i(o)||$i(i))return A;let a=Nc(o.value,i.value);return a.valid?((xi(o)||xi(i))&&r.dirty(),{status:r.value,value:a.data}):(E(n,{code:k.invalid_intersection_types}),A)};return n.common.async?Promise.all([this._def.left._parseAsync({data:n.data,path:n.path,parent:n}),this._def.right._parseAsync({data:n.data,path:n.path,parent:n})]).then(([o,i])=>s(o,i)):s(this._def.left._parseSync({data:n.data,path:n.path,parent:n}),this._def.right._parseSync({data:n.data,path:n.path,parent:n}))}};on.create=(t,e,r)=>new on({left:t,right:e,typeName:q.ZodIntersection,...U(r)});var Ut=class t extends G{_parse(e){let{status:r,ctx:n}=this._processInputParams(e);if(n.parsedType!==z.array)return E(n,{code:k.invalid_type,expected:z.array,received:n.parsedType}),A;if(n.data.length<this._def.items.length)return E(n,{code:k.too_small,minimum:this._def.items.length,inclusive:!0,exact:!1,type:"array"}),A;!this._def.rest&&n.data.length>this._def.items.length&&(E(n,{code:k.too_big,maximum:this._def.items.length,inclusive:!0,exact:!1,type:"array"}),r.dirty());let o=[...n.data].map((i,a)=>{let c=this._def.items[a]||this._def.rest;return c?c._parse(new vt(n,i,n.path,a)):null}).filter(i=>!!i);return n.common.async?Promise.all(o).then(i=>qe.mergeArray(r,i)):qe.mergeArray(r,o)}get items(){return this._def.items}rest(e){return new t({...this._def,rest:e})}};Ut.create=(t,e)=>{if(!Array.isArray(t))throw new Error("You must pass an array of schemas to z.tuple([ ... ])");return new Ut({items:t,typeName:q.ZodTuple,rest:null,...U(e)})};var Si=class t extends G{get keySchema(){return this._def.keyType}get valueSchema(){return this._def.valueType}_parse(e){let{status:r,ctx:n}=this._processInputParams(e);if(n.parsedType!==z.object)return E(n,{code:k.invalid_type,expected:z.object,received:n.parsedType}),A;let s=[],o=this._def.keyType,i=this._def.valueType;for(let a in n.data)s.push({key:o._parse(new vt(n,a,n.path,a)),value:i._parse(new vt(n,n.data[a],n.path,a)),alwaysSet:a in n.data});return n.common.async?qe.mergeObjectAsync(r,s):qe.mergeObjectSync(r,s)}get element(){return this._def.valueType}static create(e,r,n){return r instanceof G?new t({keyType:e,valueType:r,typeName:q.ZodRecord,...U(n)}):new t({keyType:Sr.create(),valueType:e,typeName:q.ZodRecord,...U(r)})}},Kn=class extends G{get keySchema(){return this._def.keyType}get valueSchema(){return this._def.valueType}_parse(e){let{status:r,ctx:n}=this._processInputParams(e);if(n.parsedType!==z.map)return E(n,{code:k.invalid_type,expected:z.map,received:n.parsedType}),A;let s=this._def.keyType,o=this._def.valueType,i=[...n.data.entries()].map(([a,c],u)=>({key:s._parse(new vt(n,a,n.path,[u,"key"])),value:o._parse(new vt(n,c,n.path,[u,"value"]))}));if(n.common.async){let a=new Map;return Promise.resolve().then(async()=>{for(let c of i){let u=await c.key,l=await c.value;if(u.status==="aborted"||l.status==="aborted")return A;(u.status==="dirty"||l.status==="dirty")&&r.dirty(),a.set(u.value,l.value)}return{status:r.value,value:a}})}else{let a=new Map;for(let c of i){let u=c.key,l=c.value;if(u.status==="aborted"||l.status==="aborted")return A;(u.status==="dirty"||l.status==="dirty")&&r.dirty(),a.set(u.value,l.value)}return{status:r.value,value:a}}}};Kn.create=(t,e,r)=>new Kn({valueType:e,keyType:t,typeName:q.ZodMap,...U(r)});var Bn=class t extends G{_parse(e){let{status:r,ctx:n}=this._processInputParams(e);if(n.parsedType!==z.set)return E(n,{code:k.invalid_type,expected:z.set,received:n.parsedType}),A;let s=this._def;s.minSize!==null&&n.data.size<s.minSize.value&&(E(n,{code:k.too_small,minimum:s.minSize.value,type:"set",inclusive:!0,exact:!1,message:s.minSize.message}),r.dirty()),s.maxSize!==null&&n.data.size>s.maxSize.value&&(E(n,{code:k.too_big,maximum:s.maxSize.value,type:"set",inclusive:!0,exact:!1,message:s.maxSize.message}),r.dirty());let o=this._def.valueType;function i(c){let u=new Set;for(let l of c){if(l.status==="aborted")return A;l.status==="dirty"&&r.dirty(),u.add(l.value)}return{status:r.value,value:u}}let a=[...n.data.values()].map((c,u)=>o._parse(new vt(n,c,n.path,u)));return n.common.async?Promise.all(a).then(c=>i(c)):i(a)}min(e,r){return new t({...this._def,minSize:{value:e,message:C.toString(r)}})}max(e,r){return new t({...this._def,maxSize:{value:e,message:C.toString(r)}})}size(e,r){return this.min(e,r).max(e,r)}nonempty(e){return this.min(1,e)}};Bn.create=(t,e)=>new Bn({valueType:t,minSize:null,maxSize:null,typeName:q.ZodSet,...U(e)});var Pi=class t extends G{constructor(){super(...arguments),this.validate=this.implement}_parse(e){let{ctx:r}=this._processInputParams(e);if(r.parsedType!==z.function)return E(r,{code:k.invalid_type,expected:z.function,received:r.parsedType}),A;function n(a,c){return As({data:a,path:r.path,errorMaps:[r.common.contextualErrorMap,r.schemaErrorMap,Ln(),ir].filter(u=>!!u),issueData:{code:k.invalid_arguments,argumentsError:c}})}function s(a,c){return As({data:a,path:r.path,errorMaps:[r.common.contextualErrorMap,r.schemaErrorMap,Ln(),ir].filter(u=>!!u),issueData:{code:k.invalid_return_type,returnTypeError:c}})}let o={errorMap:r.common.contextualErrorMap},i=r.data;if(this._def.returns instanceof Er){let a=this;return Be(async function(...c){let u=new it([]),l=await a._def.args.parseAsync(c,o).catch(p=>{throw u.addIssue(n(c,p)),u}),d=await Reflect.apply(i,this,l);return await a._def.returns._def.type.parseAsync(d,o).catch(p=>{throw u.addIssue(s(d,p)),u})})}else{let a=this;return Be(function(...c){let u=a._def.args.safeParse(c,o);if(!u.success)throw new it([n(c,u.error)]);let l=Reflect.apply(i,this,u.data),d=a._def.returns.safeParse(l,o);if(!d.success)throw new it([s(l,d.error)]);return d.data})}}parameters(){return this._def.args}returnType(){return this._def.returns}args(...e){return new t({...this._def,args:Ut.create(e).rest(cr.create())})}returns(e){return new t({...this._def,returns:e})}implement(e){return this.parse(e)}strictImplement(e){return this.parse(e)}static create(e,r,n){return new t({args:e||Ut.create([]).rest(cr.create()),returns:r||cr.create(),typeName:q.ZodFunction,...U(n)})}},an=class extends G{get schema(){return this._def.getter()}_parse(e){let{ctx:r}=this._processInputParams(e);return this._def.getter()._parse({data:r.data,path:r.path,parent:r})}};an.create=(t,e)=>new an({getter:t,typeName:q.ZodLazy,...U(e)});var cn=class extends G{_parse(e){if(e.data!==this._def.value){let r=this._getOrReturnCtx(e);return E(r,{received:r.data,code:k.invalid_literal,expected:this._def.value}),A}return{status:"valid",value:e.data}}get value(){return this._def.value}};cn.create=(t,e)=>new cn({value:t,typeName:q.ZodLiteral,...U(e)});function Bf(t,e){return new un({values:t,typeName:q.ZodEnum,...U(e)})}var un=class t extends G{_parse(e){if(typeof e.data!="string"){let r=this._getOrReturnCtx(e),n=this._def.values;return E(r,{expected:te.joinValues(n),received:r.parsedType,code:k.invalid_type}),A}if(this._cache||(this._cache=new Set(this._def.values)),!this._cache.has(e.data)){let r=this._getOrReturnCtx(e),n=this._def.values;return E(r,{received:r.data,code:k.invalid_enum_value,options:n}),A}return Be(e.data)}get options(){return this._def.values}get enum(){let e={};for(let r of this._def.values)e[r]=r;return e}get Values(){let e={};for(let r of this._def.values)e[r]=r;return e}get Enum(){let e={};for(let r of this._def.values)e[r]=r;return e}extract(e,r=this._def){return t.create(e,{...this._def,...r})}exclude(e,r=this._def){return t.create(this.options.filter(n=>!e.includes(n)),{...this._def,...r})}};un.create=Bf;var ln=class extends G{_parse(e){let r=te.getValidEnumValues(this._def.values),n=this._getOrReturnCtx(e);if(n.parsedType!==z.string&&n.parsedType!==z.number){let s=te.objectValues(r);return E(n,{expected:te.joinValues(s),received:n.parsedType,code:k.invalid_type}),A}if(this._cache||(this._cache=new Set(te.getValidEnumValues(this._def.values))),!this._cache.has(e.data)){let s=te.objectValues(r);return E(n,{received:n.data,code:k.invalid_enum_value,options:s}),A}return Be(e.data)}get enum(){return this._def.values}};ln.create=(t,e)=>new ln({values:t,typeName:q.ZodNativeEnum,...U(e)});var Er=class extends G{unwrap(){return this._def.type}_parse(e){let{ctx:r}=this._processInputParams(e);if(r.parsedType!==z.promise&&r.common.async===!1)return E(r,{code:k.invalid_type,expected:z.promise,received:r.parsedType}),A;let n=r.parsedType===z.promise?r.data:Promise.resolve(r.data);return Be(n.then(s=>this._def.type.parseAsync(s,{path:r.path,errorMap:r.common.contextualErrorMap})))}};Er.create=(t,e)=>new Er({type:t,typeName:q.ZodPromise,...U(e)});var _t=class extends G{innerType(){return this._def.schema}sourceType(){return this._def.schema._def.typeName===q.ZodEffects?this._def.schema.sourceType():this._def.schema}_parse(e){let{status:r,ctx:n}=this._processInputParams(e),s=this._def.effect||null,o={addIssue:i=>{E(n,i),i.fatal?r.abort():r.dirty()},get path(){return n.path}};if(o.addIssue=o.addIssue.bind(o),s.type==="preprocess"){let i=s.transform(n.data,o);if(n.common.async)return Promise.resolve(i).then(async a=>{if(r.value==="aborted")return A;let c=await this._def.schema._parseAsync({data:a,path:n.path,parent:n});return c.status==="aborted"?A:c.status==="dirty"?Yr(c.value):r.value==="dirty"?Yr(c.value):c});{if(r.value==="aborted")return A;let a=this._def.schema._parseSync({data:i,path:n.path,parent:n});return a.status==="aborted"?A:a.status==="dirty"?Yr(a.value):r.value==="dirty"?Yr(a.value):a}}if(s.type==="refinement"){let i=a=>{let c=s.refinement(a,o);if(n.common.async)return Promise.resolve(c);if(c instanceof Promise)throw new Error("Async refinement encountered during synchronous parse operation. Use .parseAsync instead.");return a};if(n.common.async===!1){let a=this._def.schema._parseSync({data:n.data,path:n.path,parent:n});return a.status==="aborted"?A:(a.status==="dirty"&&r.dirty(),i(a.value),{status:r.value,value:a.value})}else return this._def.schema._parseAsync({data:n.data,path:n.path,parent:n}).then(a=>a.status==="aborted"?A:(a.status==="dirty"&&r.dirty(),i(a.value).then(()=>({status:r.value,value:a.value}))))}if(s.type==="transform")if(n.common.async===!1){let i=this._def.schema._parseSync({data:n.data,path:n.path,parent:n});if(!kr(i))return A;let a=s.transform(i.value,o);if(a instanceof Promise)throw new Error("Asynchronous transform encountered during synchronous parse operation. Use .parseAsync instead.");return{status:r.value,value:a}}else return this._def.schema._parseAsync({data:n.data,path:n.path,parent:n}).then(i=>kr(i)?Promise.resolve(s.transform(i.value,o)).then(a=>({status:r.value,value:a})):A);te.assertNever(s)}};_t.create=(t,e,r)=>new _t({schema:t,typeName:q.ZodEffects,effect:e,...U(r)});_t.createWithPreprocess=(t,e,r)=>new _t({schema:e,effect:{type:"preprocess",transform:t},typeName:q.ZodEffects,...U(r)});var yt=class extends G{_parse(e){return this._getType(e)===z.undefined?Be(void 0):this._def.innerType._parse(e)}unwrap(){return this._def.innerType}};yt.create=(t,e)=>new yt({innerType:t,typeName:q.ZodOptional,...U(e)});var Ht=class extends G{_parse(e){return this._getType(e)===z.null?Be(null):this._def.innerType._parse(e)}unwrap(){return this._def.innerType}};Ht.create=(t,e)=>new Ht({innerType:t,typeName:q.ZodNullable,...U(e)});var dn=class extends G{_parse(e){let{ctx:r}=this._processInputParams(e),n=r.data;return r.parsedType===z.undefined&&(n=this._def.defaultValue()),this._def.innerType._parse({data:n,path:r.path,parent:r})}removeDefault(){return this._def.innerType}};dn.create=(t,e)=>new dn({innerType:t,typeName:q.ZodDefault,defaultValue:typeof e.default=="function"?e.default:()=>e.default,...U(e)});var pn=class extends G{_parse(e){let{ctx:r}=this._processInputParams(e),n={...r,common:{...r.common,issues:[]}},s=this._def.innerType._parse({data:n.data,path:n.path,parent:{...n}});return Vn(s)?s.then(o=>({status:"valid",value:o.status==="valid"?o.value:this._def.catchValue({get error(){return new it(n.common.issues)},input:n.data})})):{status:"valid",value:s.status==="valid"?s.value:this._def.catchValue({get error(){return new it(n.common.issues)},input:n.data})}}removeCatch(){return this._def.innerType}};pn.create=(t,e)=>new pn({innerType:t,typeName:q.ZodCatch,catchValue:typeof e.catch=="function"?e.catch:()=>e.catch,...U(e)});var Gn=class extends G{_parse(e){if(this._getType(e)!==z.nan){let n=this._getOrReturnCtx(e);return E(n,{code:k.invalid_type,expected:z.nan,received:n.parsedType}),A}return{status:"valid",value:e.data}}};Gn.create=t=>new Gn({typeName:q.ZodNaN,...U(t)});var rx=Symbol("zod_brand"),Ms=class extends G{_parse(e){let{ctx:r}=this._processInputParams(e),n=r.data;return this._def.type._parse({data:n,path:r.path,parent:r})}unwrap(){return this._def.type}},qs=class t extends G{_parse(e){let{status:r,ctx:n}=this._processInputParams(e);if(n.common.async)return(async()=>{let o=await this._def.in._parseAsync({data:n.data,path:n.path,parent:n});return o.status==="aborted"?A:o.status==="dirty"?(r.dirty(),Yr(o.value)):this._def.out._parseAsync({data:o.value,path:n.path,parent:n})})();{let s=this._def.in._parseSync({data:n.data,path:n.path,parent:n});return s.status==="aborted"?A:s.status==="dirty"?(r.dirty(),{status:"dirty",value:s.value}):this._def.out._parseSync({data:s.value,path:n.path,parent:n})}}static create(e,r){return new t({in:e,out:r,typeName:q.ZodPipeline})}},fn=class extends G{_parse(e){let r=this._def.innerType._parse(e),n=s=>(kr(s)&&(s.value=Object.freeze(s.value)),s);return Vn(r)?r.then(s=>n(s)):n(r)}unwrap(){return this._def.innerType}};fn.create=(t,e)=>new fn({innerType:t,typeName:q.ZodReadonly,...U(e)});function Ff(t,e){let r=typeof t=="function"?t(e):typeof t=="string"?{message:t}:t;return typeof r=="string"?{message:r}:r}function Gf(t,e={},r){return t?Pr.create().superRefine((n,s)=>{let o=t(n);if(o instanceof Promise)return o.then(i=>{if(!i){let a=Ff(e,n),c=a.fatal??r??!0;s.addIssue({code:"custom",...a,fatal:c})}});if(!o){let i=Ff(e,n),a=i.fatal??r??!0;s.addIssue({code:"custom",...i,fatal:a})}}):Pr.create()}var nx={object:at.lazycreate},q;(function(t){t.ZodString="ZodString",t.ZodNumber="ZodNumber",t.ZodNaN="ZodNaN",t.ZodBigInt="ZodBigInt",t.ZodBoolean="ZodBoolean",t.ZodDate="ZodDate",t.ZodSymbol="ZodSymbol",t.ZodUndefined="ZodUndefined",t.ZodNull="ZodNull",t.ZodAny="ZodAny",t.ZodUnknown="ZodUnknown",t.ZodNever="ZodNever",t.ZodVoid="ZodVoid",t.ZodArray="ZodArray",t.ZodObject="ZodObject",t.ZodUnion="ZodUnion",t.ZodDiscriminatedUnion="ZodDiscriminatedUnion",t.ZodIntersection="ZodIntersection",t.ZodTuple="ZodTuple",t.ZodRecord="ZodRecord",t.ZodMap="ZodMap",t.ZodSet="ZodSet",t.ZodFunction="ZodFunction",t.ZodLazy="ZodLazy",t.ZodLiteral="ZodLiteral",t.ZodEnum="ZodEnum",t.ZodEffects="ZodEffects",t.ZodNativeEnum="ZodNativeEnum",t.ZodOptional="ZodOptional",t.ZodNullable="ZodNullable",t.ZodDefault="ZodDefault",t.ZodCatch="ZodCatch",t.ZodPromise="ZodPromise",t.ZodBranded="ZodBranded",t.ZodPipeline="ZodPipeline",t.ZodReadonly="ZodReadonly"})(q||(q={}));var sx=(t,e={message:`Input not instance of ${t.name}`})=>Gf(r=>r instanceof t,e),Wf=Sr.create,Jf=Qr.create,ox=Gn.create,ix=Xr.create,Yf=en.create,ax=tn.create,cx=Un.create,ux=rn.create,lx=nn.create,dx=Pr.create,px=cr.create,fx=It.create,mx=Hn.create,hx=ur.create,gx=at.create,yx=at.strictCreate,vx=sn.create,_x=ki.create,bx=on.create,wx=Ut.create,$x=Si.create,xx=Kn.create,kx=Bn.create,Sx=Pi.create,Px=an.create,Ex=cn.create,Tx=un.create,zx=ln.create,Cx=Er.create,Ix=_t.create,Rx=yt.create,Ox=Ht.create,Nx=_t.createWithPreprocess,jx=qs.create,Ax=()=>Wf().optional(),Mx=()=>Jf().optional(),qx=()=>Yf().optional(),Dx={string:(t=>Sr.create({...t,coerce:!0})),number:(t=>Qr.create({...t,coerce:!0})),boolean:(t=>en.create({...t,coerce:!0})),bigint:(t=>Xr.create({...t,coerce:!0})),date:(t=>tn.create({...t,coerce:!0}))};var Zx=A;var Kt=ve(require("path"));function Qf(t,e){let r=n=>Kt.isAbsolute(n)?n:Kt.join(e,n);return[{name:"read_file",description:"Read file content. Relative paths are resolved against the workspace root.",parameters:T.object({path:T.string()}),execute:async n=>{let s=r(n.path);if(!t.checkPathAccess(s,"read"))throw new Error(`Access Denied by Policy: ${s}`);return await Tr.readFile(s,"utf-8")}},{name:"write_file",description:"Write file content. Relative paths are resolved against the workspace root.",parameters:T.object({path:T.string(),content:T.string()}),execute:async n=>{let s=r(n.path);if(!t.checkPathAccess(s,"write"))throw new Error(`Access Denied by Policy: ${s}`);return await Tr.mkdir(Kt.dirname(s),{recursive:!0}),await Tr.writeFile(s,n.content),`Successfully wrote to ${s}`}},{name:"scan_project",description:"List all files in the workspace (excluding .git, node_modules, etc). Useful for understanding project structure.",parameters:T.object({}),execute:async()=>{let n=[];async function s(o){let i=await Tr.readdir(o,{withFileTypes:!0});for(let a of i){let c=Kt.relative(e,Kt.join(o,a.name));if(a.name===".git"||a.name==="node_modules"||a.name===".DS_Store"||a.name==="out"||a.name==="dist"){a.isDirectory()&&n.push(c+"/ (ignored)");continue}a.isDirectory()?await s(Kt.join(o,a.name)):n.push(c)}}return await s(e),`Project Files (${n.length}):
`+n.slice(0,100).join(`
`)+(n.length>100?`
... ${n.length-100} more files`:"")}}]}var zr=ve(require("fs/promises"));var Ei=ve(require("path"));function Xf(t,e){let r=n=>Ei.isAbsolute(n)?n:Ei.join(e,n);return[{name:"str_replace",description:"Replace a specific string in a file with new content. The old_str must match EXACTLY (including whitespace and indentation). Use this for precise edits.",parameters:T.object({path:T.string().describe("Path to the file to edit"),old_str:T.string().describe("The exact string to find and replace (must match exactly)"),new_str:T.string().describe("The new string to replace old_str with")}),execute:async n=>{let s=r(n.path);if(!t.checkPathAccess(s,"write"))throw new Error(`Access Denied by Policy: ${s}`);let o=await zr.readFile(s,"utf-8"),i=n.old_str,a=n.new_str,c=o;if(!o.includes(i)){if(c=o.replace(/\r\n/g,`
`),i=i.replace(/\r\n/g,`
`),a=a.replace(/\r\n/g,`
`),!c.includes(i))throw new Error("old_str not found in file. Make sure it matches exactly including whitespace and indentation.");o=c}let u=o.split(i).length-1;if(u>1)throw new Error(`old_str found ${u} times. It must be unique. Add more context to make it unique.`);let l=o.replace(i,a);return await zr.writeFile(s,l),`Successfully replaced content in ${s}`}},{name:"insert_after",description:"Insert new content after a specific string in a file. The marker string must match exactly.",parameters:T.object({path:T.string().describe("Path to the file to edit"),marker:T.string().describe("The exact string after which to insert new content"),content:T.string().describe("The content to insert after the marker")}),execute:async n=>{let s=r(n.path);if(!t.checkPathAccess(s,"write"))throw new Error(`Access Denied by Policy: ${s}`);let o=await zr.readFile(s,"utf-8"),i=n.marker,a=n.content;if(!o.includes(i)&&(o=o.replace(/\r\n/g,`
`),i=i.replace(/\r\n/g,`
`),a=a.replace(/\r\n/g,`
`),!o.includes(i)))throw new Error("Marker string not found in file.");let c=o.split(i).length-1;if(c>1)throw new Error(`Marker found ${c} times. It must be unique.`);let u=o.replace(i,i+a);return await zr.writeFile(s,u),`Successfully inserted content after marker in ${s}`}},{name:"apply_patch",description:"Apply a unified diff patch to a file. Supports standard unified diff format with @@ line markers.",parameters:T.object({path:T.string(),patch:T.string().describe("Unified diff format patch content")}),execute:async n=>{let s=r(n.path);if(!t.checkPathAccess(s,"write"))throw new Error(`Access Denied by Policy: ${s}`);let o=await zr.readFile(s,"utf-8"),i=Lx(o,n.patch);return await zr.writeFile(s,i),`Successfully applied patch to ${s}`}}]}function Lx(t,e){let r=t.split(`
`),n=e.split(`
`),s=[],o=null;for(let a of n){if(a.startsWith("---")||a.startsWith("+++"))continue;let c=a.match(/^@@ -(\d+)(?:,(\d+))? \+(\d+)(?:,(\d+))? @@/);if(c){o&&s.push(o),o={oldStart:parseInt(c[1],10),oldCount:parseInt(c[2]||"1",10),newStart:parseInt(c[3],10),newCount:parseInt(c[4]||"1",10),changes:[]};continue}o&&(a.startsWith("-")?o.changes.push({type:"remove",line:a.slice(1)}):a.startsWith("+")?o.changes.push({type:"add",line:a.slice(1)}):(a.startsWith(" ")||a==="")&&o.changes.push({type:"context",line:a.slice(1)||""}))}if(o&&s.push(o),s.length===0)throw new Error("No valid hunks found in patch. Use unified diff format with @@ markers.");let i=[...r];for(let a of s.reverse()){let c=a.oldStart-1,u=0,l=[];for(let p of a.changes)(p.type==="remove"||p.type==="context")&&u++,(p.type==="add"||p.type==="context")&&l.push(p.line);let d=a.changes.filter(p=>p.type==="remove").length,f=a.changes.filter(p=>p.type==="add").map(p=>p.line);i.splice(c,a.oldCount,...f.concat(a.changes.filter(p=>p.type==="context").map(p=>p.line)))}return i.join(`
`)}var em=t=>({name:"manage_task",description:"Create, update, or list tasks to track complex goals. Use this to break down large user requests into steps. Supports atomic changes tracking.",parameters:T.object({action:T.enum(["create","update_status","update_step","list","create_atomic_change","get_progress","start_step","complete_step"]).describe("The action to perform"),title:T.string().optional().describe("Title for new task"),description:T.string().optional().describe("Description for atomic change task"),steps:T.array(T.string()).optional().describe("List of step descriptions for new task"),taskId:T.string().optional().describe("ID of the task to update"),status:T.enum(["pending","in-progress","completed","failed"]).optional().describe("New status for task or step"),stepIndex:T.number().optional().describe("Index of the step to update (0-based)"),contextItems:T.array(T.string()).optional().describe("List of context items for atomic change task")}),execute:async e=>{if(e.action==="create"){if(!e.title)throw new Error("Title required for create");let r=t.createTask(e.title,e.steps||[]);return`Task created: [${r.id}] ${r.title}`}if(e.action==="list"){let r=t.listTasks();return JSON.stringify(r,null,2)}if(e.action==="update_status"){if(!e.taskId||!e.status)throw new Error("taskId and status required");return t.updateTaskStatus(e.taskId,e.status)?`Task ${e.taskId} status updated to ${e.status}`:`Task ${e.taskId} not found`}if(e.action==="update_step"){if(!e.taskId||e.stepIndex===void 0||!e.status)throw new Error("taskId, stepIndex, and status required");return t.updateStepStatus(e.taskId,e.stepIndex,e.status)?`Task ${e.taskId} step ${e.stepIndex} updated to ${e.status}`:`Task ${e.taskId} not found or step invalid`}if(e.action==="create_atomic_change"){if(!e.title)throw new Error("Title required for atomic change task");let r=t.createAtomicChangeTask(e.title,e.description||"",e.contextItems||[]);return`Atomic change task created: [${r.id}] ${r.title}`}if(e.action==="get_progress"){if(!e.taskId)throw new Error("taskId required");let r=t.getTaskProgress(e.taskId);return r?JSON.stringify(r,null,2):`Task ${e.taskId} not found`}if(e.action==="start_step"){if(!e.taskId||e.stepIndex===void 0)throw new Error("taskId and stepIndex required");return t.startStep(e.taskId,e.stepIndex)?`Step ${e.stepIndex} started for task ${e.taskId}`:`Failed to start step ${e.stepIndex} for task ${e.taskId}`}if(e.action==="complete_step"){if(!e.taskId||e.stepIndex===void 0)throw new Error("taskId and stepIndex required");return t.completeStep(e.taskId,e.stepIndex)?`Step ${e.stepIndex} completed for task ${e.taskId}`:`Failed to complete step ${e.stepIndex} for task ${e.taskId}`}return"Invalid action"}});var jc=ve(require("crypto")),Ti=class{constructor(){this.tasks=new Map}createTask(e,r=[]){let n=jc.randomUUID(),s={id:n,title:e,status:"pending",steps:r.map(o=>({id:jc.randomUUID(),description:o,status:"pending",createdAt:Date.now()})),createdAt:Date.now(),updatedAt:Date.now()};return this.tasks.set(n,s),s}updateTaskStatus(e,r){let n=this.tasks.get(e);return n&&(n.status=r,n.updatedAt=Date.now(),this.tasks.set(e,n)),n}updateStepStatus(e,r,n){let s=this.tasks.get(e);if(s&&s.steps[r])return s.steps[r].status=n,s.steps[r].updatedAt=Date.now(),s.updatedAt=Date.now(),this.tasks.set(e,s),s}createAtomicChangeTask(e,r,n){let s=this.createTask(e,["Analyze requirements","Plan atomic changes","Implement changes","Verify changes","Document changes"]);return s.description=r,s.contextItems=n||[],s}getTaskProgress(e){let r=this.tasks.get(e);if(!r)return null;let n=r.steps.length;if(n===0)return{completedSteps:0,totalSteps:0,percentage:0};let s=r.steps.filter(i=>i.status==="completed").length,o=Math.round(s/n*100);return{completedSteps:s,totalSteps:n,percentage:o}}getCurrentStep(e){let r=this.tasks.get(e);return r?(r.steps.find(s=>s.status==="in-progress"||s.status==="pending"),r):void 0}startStep(e,r){let n=this.tasks.get(e);return!n||n.steps[r]===void 0||n.steps[r].status!=="pending"?!1:(n.steps[r].status="in-progress",n.steps[r].startedAt=Date.now(),n.updatedAt=Date.now(),this.tasks.set(e,n),!0)}completeStep(e,r){let n=this.tasks.get(e);return!n||n.steps[r]===void 0||n.steps[r].status!=="in-progress"?!1:(n.steps[r].status="completed",n.steps[r].completedAt=Date.now(),n.updatedAt=Date.now(),this.tasks.set(e,n),!0)}getDetailedTask(e){let r=this.tasks.get(e);if(!r)return;let n=this.getTaskProgress(e);return n&&(r.progress=n),r}getTask(e){return this.tasks.get(e)}listTasks(){return Array.from(this.tasks.values()).sort((e,r)=>r.createdAt-e.createdAt)}toJSON(){return Array.from(this.tasks.values())}};var Cr=ve(require("vscode")),Ds=class{constructor(e,r,n,s){this._extensionUri=e;this.orchestrator=r;this.taskManager=n;this.historyManager=s;this.currentHistory=[];this.isGenerating=!1;this.webviewReady=!1;this.ongoingAgentProcess=null;this.lastAgentUpdate=null;this.agentUpdatesBuffer=[];this.pendingAgentUpdates=[]}static{this.viewType="vibey.chatView"}async resolveWebviewView(e,r,n){this._view=e,e.webview.options={enableScripts:!0,localResourceRoots:[this._extensionUri]},this.currentHistory=await this.historyManager.loadHistory(),e.webview.html=this._getHtmlForWebview(e.webview),e.webview.onDidReceiveMessage(async s=>{switch(s.type){case"webviewReady":{this.webviewReady=!0,this.currentHistory.length>0&&this._view?.webview.postMessage({type:"restoreHistory",messages:this.currentHistory}),this.isGenerating&&(this._view?.webview.postMessage({type:"restoreState",busy:!0}),this.lastAgentUpdate&&this._view?.webview.postMessage({type:"agentUpdate",update:this.lastAgentUpdate}),this.ongoingAgentProcess&&this.ongoingAgentProcess.reconnect(o=>{this.lastAgentUpdate=o,this.agentUpdatesBuffer.push(o),this.webviewReady&&this._view?.webview.postMessage({type:"agentUpdate",update:o})}));break}case"sendMessage":{if(!s.text)return;let o={role:"user",content:s.text};this.currentHistory.push(o),this.webviewReady&&this._view?.webview.postMessage({type:"addMessage",role:o.role,content:o.content}),await this.historyManager.saveHistory(this.currentHistory),this.isGenerating=!0,this.agentUpdatesBuffer=[],this.pendingAgentUpdates=[];let i=!1;try{let a=l=>{this.lastAgentUpdate=l,this.agentUpdatesBuffer.push(l),this.pendingAgentUpdates.push(l),this.webviewReady&&this._view?.webview.postMessage({type:"agentUpdate",update:l})},c=l=>{a=l};this.ongoingAgentProcess={cancel:()=>{i=!0,this.orchestrator.cancel()},reconnect:c};let u=await this.orchestrator.chat(s.text,s.context,l=>{i||a(l)});this.webviewReady&&this._view?.webview.postMessage({type:"addMessage",role:"assistant",content:u}),this.currentHistory.push({role:"assistant",content:u,agentUpdates:[...this.pendingAgentUpdates]}),await this.historyManager.saveHistory(this.currentHistory),u!=="Request cancelled."&&this.webviewReady&&this._view?.webview.postMessage({type:"requestComplete"})}catch(a){this.webviewReady&&this._view?.webview.postMessage({type:"addMessage",role:"assistant",content:`Error: ${a.message}`}),this.webviewReady&&this._view?.webview.postMessage({type:"requestComplete"})}finally{this.isGenerating=!1,this.ongoingAgentProcess=null,this.lastAgentUpdate=null,await this.historyManager.saveSession(this.currentHistory)}break}case"openSettings":{Cr.commands.executeCommand("vibey.openSettings");break}case"selectContext":{let o=await Cr.window.showOpenDialog({canSelectMany:!0,openLabel:"Add to Context"});o&&o.forEach(i=>{this.webviewReady&&e.webview.postMessage({type:"appendContext",file:{name:i.path.split("/").pop(),path:i.fsPath}})});break}case"stopRequest":{this.orchestrator.cancel(),this.webviewReady&&e.webview.postMessage({type:"requestStopped"});break}case"retryRequest":break;case"getTasks":{let o=this.taskManager.listTasks();this.webviewReady&&e.webview.postMessage({type:"updateTasks",tasks:o});break}case"error":{Cr.window.showErrorMessage(s.message);break}case"voiceInput":{this.handleVoiceInput().catch(o=>{console.error("Voice input error:",o),this.webviewReady&&this._view?.webview.postMessage({type:"voiceInputError",message:o.message||"Failed to process voice input"})});break}}})}async handleVoiceInput(){try{this.webviewReady&&this._view?.webview.postMessage({type:"startVoiceInput"})}catch(e){console.error("Voice input error:",e)}}_getHtmlForWebview(e){let r=e.asWebviewUri(Cr.Uri.joinPath(this._extensionUri,"src","ui","media","main.js"));return`<!DOCTYPE html>
        <html lang="en">
        <head>
            <meta charset="UTF-8">
            <meta name="viewport" content="width=device-width, initial-scale=1.0">
            <link href="${e.asWebviewUri(Cr.Uri.joinPath(this._extensionUri,"src","ui","media","main.css"))}" rel="stylesheet">
            <title>Vibey Chat</title>
        </head>
        <body>
            <div class="tabs">
                <div class="tab active" data-tab="chat">Chat</div>
                <div class="tab" data-tab="tasks">Tasks</div>
            </div>

            <div id="chat-view" class="view active">
                <div id="chat-container"></div>

                <div id="input-area">
                    <div id="context-area"></div>
                    
                    <div class="input-container">
                        <textarea id="InputBox" placeholder="Ask Vibey... (Shift+Enter for new line)"></textarea>
                        
                        <div class="input-actions">
                            <div class="toolbar">
                                <button id="attach-btn" class="icon-btn" title="Add Context">\u{1F4CE}</button>
                                <button id="mic-btn" class="icon-btn" title="Voice Input">\u{1F3A4}</button>
                                <button id="models-btn" class="icon-btn" title="Select Model">\u{1F916}</button>
                                <button id="settings-btn" class="icon-btn" title="Settings">\u2699\uFE0F</button>
                            </div>
                            <button id="send-btn">Send \u27A4</button>
                        </div>
                    </div>
                </div>
            </div>

            <div id="tasks-view" class="view">
                <div id="task-list">
                    <!-- Tasks will be rendered here -->
                    <div class="empty-state">No active tasks. Ask Vibey to start a task!</div>
                </div>
            </div>

            <script src="${r}"></script>
        </body>
        </html>`}};var Ac={win32:{powershell:{path:"powershell.exe",args:["-NoLogo"],displayName:"PowerShell"},cmd:{path:"cmd.exe",displayName:"Command Prompt"},bash:{path:"bash.exe",displayName:"Bash (WSL/Git)"},zsh:void 0,sh:void 0,fish:void 0,auto:void 0},linux:{powershell:{path:"pwsh",displayName:"PowerShell Core"},cmd:void 0,bash:{path:"/bin/bash",displayName:"Bash"},zsh:{path:"/bin/zsh",displayName:"Zsh"},sh:{path:"/bin/sh",displayName:"Shell"},fish:{path:"/usr/bin/fish",displayName:"Fish"},auto:void 0},darwin:{powershell:{path:"pwsh",displayName:"PowerShell Core"},cmd:void 0,bash:{path:"/bin/bash",displayName:"Bash"},zsh:{path:"/bin/zsh",displayName:"Zsh"},sh:{path:"/bin/sh",displayName:"Shell"},fish:{path:"/usr/bin/fish",displayName:"Fish"},auto:void 0}};var lr=ve(require("vscode")),Mc=ve(require("path")),dr=ve(require("fs")),tm=ve(require("os"));function zi(){return`vibey-${Date.now()}-${Math.random().toString(36).substring(2,11)}`}var Zs=class{constructor(e,r,n){this.workspaceRoot=e;this.context=r;this.iconPath=n;this.terminals=new Map;this.terminalStates=new Map;this.eventListeners=[];this.disposables=[];this.terminalOutputBuffers=new Map;this.history=this.context.globalState.get("vibey.terminalHistory")||{entries:[],maxEntries:500},this.outputChannel=lr.window.createOutputChannel("Vibey Terminal"),this.disposables.push(lr.window.onDidCloseTerminal(s=>{this.handleTerminalClosed(s)})),this.disposables.push(lr.window.onDidChangeActiveTerminal(s=>{s&&this.updateActiveState(s)}))}getPreferredShell(){return lr.workspace.getConfiguration("vibey").get("preferredShell")||"auto"}getShellConfig(e){let r=process.platform,n=Ac[r]||Ac.linux;if(e!=="auto")return n[e]}getIconPath(){return lr.Uri.file(this.iconPath)}async createTerminal(e={}){let r=e.shellType||this.getPreferredShell(),n=this.getShellConfig(r),s=zi(),o=e.name||`Vibey ${this.terminals.size+1}`,i={name:o,cwd:e.cwd||this.workspaceRoot,iconPath:this.getIconPath()};n&&(i.shellPath=n.path,i.shellArgs=n.args);let a=lr.window.createTerminal(i);this.terminals.set(s,a),this.terminalOutputBuffers.set(s,"");let c={id:s,name:o,shellType:r,createdAt:Date.now(),isActive:!0};return this.terminalStates.set(s,c),this.emitEvent({type:"terminal-created",terminalId:s}),this.outputChannel.appendLine(`[Terminal] Created: ${o} (${s})`),s}async getOrCreateTerminal(e={}){if(e.reuseExisting){for(let[r,n]of this.terminalStates.entries())if(n.isActive)return this.outputChannel.appendLine(`[Terminal] Reusing: ${n.name} (${r})`),r}return this.createTerminal(e)}async sendCommand(e,r){let n=this.terminals.get(e);if(!n)throw new Error(`Terminal ${e} not found`);let s=this.terminalStates.get(e);s&&(s.lastCommandAt=Date.now());let o={id:zi(),terminalId:e,command:r,executedAt:Date.now()};this.addHistoryEntry(o),n.sendText(r),this.outputChannel.appendLine(`[Terminal ${e}] > ${r}`),this.emitEvent({type:"command-executed",terminalId:e,data:{command:r}})}async runCommand(e,r={}){let n=await this.getOrCreateTerminal({...r,reuseExisting:!0}),s=this.terminals.get(n),o=Date.now();if(!s)throw new Error(`Terminal ${n} not found`);return r.showTerminal!==!1&&s.show(!0),s.shellIntegration?this.runWithShellIntegration(s,n,e,o,r.timeout):this.runWithFileRedirect(s,n,e,o,r.timeout)}async runWithShellIntegration(e,r,n,s,o=3e4){let i=e.shellIntegration;try{let a=i.executeCommand(n),c="",u=a.read(),l=new Promise((m,h)=>{setTimeout(()=>h(new Error("Command timeout")),o)}),d=(async()=>{for await(let m of u)c+=m;return c})();c=await Promise.race([d,l]);let f=a.exitCode,p={id:zi(),terminalId:r,command:n,executedAt:s,output:c.substring(0,1e4),exitCode:f,duration:Date.now()-s};return this.addHistoryEntry(p),this.outputChannel.appendLine(`[Terminal ${r}] Command completed (shell integration)`),this.emitEvent({type:"command-completed",terminalId:r,data:{command:n,exitCode:f,output:c}}),{success:f===void 0||f===0,output:c,terminalId:r,command:n,duration:Date.now()-s,exitCode:f,captureMethod:"shell_integration"}}catch(a){return this.outputChannel.appendLine(`[Terminal ${r}] Shell integration error: ${a.message}`),this.runWithFileRedirect(e,r,n,s,o)}}async runWithFileRedirect(e,r,n,s,o=3e4){let i=tm.tmpdir(),a=Mc.join(i,`vibey-output-${r}-${Date.now()}.txt`),c=Mc.join(i,`vibey-exit-${r}-${Date.now()}.txt`),l=this.terminalStates.get(r)?.shellType||"auto",d=this.buildRedirectCommand(n,a,c,l);e.sendText(d),this.outputChannel.appendLine(`[Terminal ${r}] > ${n} (file redirect)`);let f=100,p=o/f,m=0,h="",g;for(;m<p;)if(await this.sleep(f),m++,dr.existsSync(c)){try{let $=dr.readFileSync(c,"utf-8").trim();g=parseInt($,10),isNaN(g)&&(g=void 0)}catch{}if(dr.existsSync(a))try{h=dr.readFileSync(a,"utf-8")}catch{}this.cleanupTempFiles(a,c);break}let y={id:zi(),terminalId:r,command:n,executedAt:s,output:h.substring(0,1e4),exitCode:g,duration:Date.now()-s};this.addHistoryEntry(y);let x=m>=p;return x&&(this.cleanupTempFiles(a,c),h=`Command timed out after ${o}ms. Check terminal for output.`),this.emitEvent({type:"command-completed",terminalId:r,data:{command:n,exitCode:g,output:h}}),{success:!x&&(g===void 0||g===0),output:h||"No output captured",terminalId:r,command:n,duration:Date.now()-s,exitCode:g,captureMethod:"file_redirect"}}buildRedirectCommand(e,r,n,s){let o=process.platform,i=s;s==="auto"&&(i=o==="win32"?"powershell":"bash");let a=r.replace(/\\/g,"/"),c=n.replace(/\\/g,"/");switch(i){case"powershell":return`& { ${e} } 2>&1 | Out-File -FilePath "${a}" -Encoding utf8; $LASTEXITCODE | Out-File -FilePath "${c}" -Encoding utf8`;case"cmd":return`(${e}) > "${a}" 2>&1 & echo %ERRORLEVEL% > "${c}"`;case"bash":case"zsh":case"sh":default:return`{ ${e}; } > "${a}" 2>&1; echo $? > "${c}"`}}cleanupTempFiles(...e){for(let r of e)try{dr.existsSync(r)&&dr.unlinkSync(r)}catch{}}sleep(e){return new Promise(r=>setTimeout(r,e))}showTerminal(e,r=!0){let n=this.terminals.get(e);n&&n.show(r)}hideTerminal(e){let r=this.terminals.get(e);r&&r.hide()}closeTerminal(e){let r=this.terminals.get(e);r&&(r.dispose(),this.terminals.delete(e),this.terminalStates.delete(e),this.terminalOutputBuffers.delete(e))}listTerminals(){return Array.from(this.terminalStates.values())}getTerminalState(e){return this.terminalStates.get(e)}getHistory(e){let r=this.history.entries;return e?r.slice(-e):r}getTerminalHistory(e){return this.history.entries.filter(r=>r.terminalId===e)}getLastOutput(e){let r=this.getTerminalHistory(e);if(r.length!==0)return r[r.length-1].output}getRecentOutputs(e,r=5){return this.getTerminalHistory(e).slice(-r)}async clearHistory(){this.history.entries=[],await this.saveHistory()}addEventListener(e){this.eventListeners.push(e)}removeEventListener(e){let r=this.eventListeners.indexOf(e);r>=0&&this.eventListeners.splice(r,1)}dispose(){this.disposables.forEach(e=>e.dispose()),this.outputChannel.dispose()}handleTerminalClosed(e){for(let[r,n]of this.terminals.entries())if(n===e){let s=this.terminalStates.get(r);s&&(s.isActive=!1),this.terminals.delete(r),this.terminalOutputBuffers.delete(r),this.emitEvent({type:"terminal-closed",terminalId:r}),this.outputChannel.appendLine(`[Terminal] Closed: ${s?.name||r}`);break}}updateActiveState(e){for(let[r,n]of this.terminals.entries()){let s=this.terminalStates.get(r);s&&(s.isActive=n===e)}}addHistoryEntry(e){this.history.entries.push(e),this.history.entries.length>this.history.maxEntries&&(this.history.entries=this.history.entries.slice(-this.history.maxEntries)),this.saveHistory()}async saveHistory(){await this.context.globalState.update("vibey.terminalHistory",this.history)}emitEvent(e){for(let r of this.eventListeners)try{r(e)}catch(n){console.error("[VibeyTerminal] Event listener error:",n)}}};var rm=T.enum(["powershell","cmd","bash","zsh","sh","fish","auto"]).optional();function nm(t){return[{name:"terminal_create",description:"Create a new Vibey terminal. Returns a terminal ID.",parameters:T.object({name:T.string().optional().describe("Custom name for the terminal"),shell:rm.describe("Shell type: powershell, cmd, bash, zsh, sh, fish, or auto"),cwd:T.string().optional().describe("Working directory for the terminal")}),execute:async e=>{let r=await t.createTerminal({name:e.name,shellType:e.shell,cwd:e.cwd});return t.showTerminal(r),`Terminal created with ID: ${r}`}},{name:"terminal_run",description:"Run a command in a Vibey terminal and capture output. Reuses existing or creates new.",parameters:T.object({command:T.string().describe("The command to run"),shell:rm.describe("Shell type preference"),newTerminal:T.boolean().optional().describe("Force create a new terminal"),timeout:T.number().optional().describe("Timeout in ms (default 30000)")}),execute:async e=>{let r=await t.runCommand(e.command,{shellType:e.shell,reuseExisting:!e.newTerminal,timeout:e.timeout});t.showTerminal(r.terminalId);let n={terminalId:r.terminalId,command:e.command,success:r.success,exitCode:r.exitCode,output:r.output,captureMethod:r.captureMethod,duration:r.duration};return JSON.stringify(n,null,2)}},{name:"terminal_send",description:"Send a command to a specific terminal by ID.",parameters:T.object({terminalId:T.string().describe("The terminal ID"),command:T.string().describe("The command to send")}),execute:async e=>(await t.sendCommand(e.terminalId,e.command),`Command sent to terminal ${e.terminalId}`)},{name:"terminal_list",description:"List all Vibey terminals with their IDs and status.",parameters:T.object({}),execute:async()=>{let e=t.listTerminals();return e.length===0?"No Vibey terminals are currently open.":e.map(r=>`- ${r.id}: "${r.name}" (${r.shellType}, ${r.isActive?"active":"inactive"})`).join(`
`)}},{name:"terminal_show",description:"Show/focus a terminal by ID.",parameters:T.object({terminalId:T.string()}),execute:async e=>(t.showTerminal(e.terminalId,!1),`Terminal ${e.terminalId} is now visible.`)},{name:"terminal_close",description:"Close a terminal by ID.",parameters:T.object({terminalId:T.string()}),execute:async e=>(t.closeTerminal(e.terminalId),`Terminal ${e.terminalId} closed.`)},{name:"terminal_history",description:"Get command history for terminals including output.",parameters:T.object({terminalId:T.string().optional().describe("Filter by terminal ID"),limit:T.number().optional().describe("Max entries (default 20)"),includeOutput:T.boolean().optional().describe("Include command output (default false)")}),execute:async e=>{let r=e.limit||20,n=e.terminalId?t.getTerminalHistory(e.terminalId):t.getHistory(r);return n.length===0?"No history available.":e.includeOutput?JSON.stringify(n.slice(-r).map(s=>({time:new Date(s.executedAt).toISOString(),command:s.command,output:s.output||null,exitCode:s.exitCode,duration:s.duration})),null,2):n.slice(-r).map(s=>`[${new Date(s.executedAt).toLocaleTimeString()}] ${s.command}`).join(`
`)}},{name:"terminal_read_output",description:"Read the output from the last command(s) in a terminal.",parameters:T.object({terminalId:T.string().describe("The terminal ID to read from"),count:T.number().optional().describe("Number of recent commands to read (default 1)")}),execute:async e=>{let r=e.count||1,n=t.getRecentOutputs(e.terminalId,r);if(n.length===0)return JSON.stringify({error:"No output available for this terminal"});if(r===1){let s=n[n.length-1];return JSON.stringify({command:s.command,output:s.output||"No output captured",exitCode:s.exitCode,executedAt:new Date(s.executedAt).toISOString()},null,2)}return JSON.stringify(n.map(s=>({command:s.command,output:s.output||"No output captured",exitCode:s.exitCode,executedAt:new Date(s.executedAt).toISOString()})),null,2)}}]}var Me=ve(require("vscode"));function sm(){return[{name:"get_problems",description:"Get diagnostics (problems) from the current workspace. Can be filtered by severity or file.",parameters:T.object({filepath:T.string().optional().describe("Filter by specific file path"),severity:T.enum(["error","warning","info","hint"]).optional().describe("Filter by severity level. If omitted, returns all.")}),execute:async t=>{let e=Me.languages.getDiagnostics();if(t.filepath){let o=Me.Uri.file(t.filepath);e=Me.languages.getDiagnostics(o).map(i=>[o,[i]])}let r={error:Me.DiagnosticSeverity.Error,warning:Me.DiagnosticSeverity.Warning,info:Me.DiagnosticSeverity.Information,hint:Me.DiagnosticSeverity.Hint},n=t.severity?r[t.severity]:void 0,s=[];for(let[o,i]of e){if(i.length===0)continue;let a=i.filter(c=>n===void 0||c.severity===n);a.length>0&&s.push({file:Me.workspace.asRelativePath(o),problems:a.map(c=>({message:c.message,severity:Me.DiagnosticSeverity[c.severity],line:c.range.start.line+1,source:c.source,code:typeof c.code=="object"?c.code.value:c.code}))})}return s.length===0?"No problems found matching criteria.":JSON.stringify(s,null,2)}},{name:"get_open_editors",description:"List all currently visible text editors.",parameters:T.object({}),execute:async()=>{let t=Me.window.visibleTextEditors;return t.length===0?"No editors are currently visible.":JSON.stringify(t.map(e=>({file:Me.workspace.asRelativePath(e.document.uri),language:e.document.languageId,isDirty:e.document.isDirty,active:e===Me.window.activeTextEditor})),null,2)}},{name:"get_active_terminal",description:"Get information about the currently active terminal.",parameters:T.object({}),execute:async()=>{let t=Me.window.activeTerminal;return t?JSON.stringify({name:t.name,processId:await t.processId,state:t.state},null,2):"No terminal is currently active/focused."}}]}var Ie=ve(require("fs")),Ls=ve(require("path")),Ci=class t{constructor(e,r){this.context=e;this.workspaceRoot=r;this.currentSessionId=null;this.gitIgnoreChecked=!1;this.historyDir=Ls.join(this.workspaceRoot,".vibey"),this.historyFile=Ls.join(this.historyDir,"chat_history.json"),this.sessionsFile=Ls.join(this.historyDir,"sessions.json")}static{this.KEY="vibey.chatHistory"}static{this.SESSIONS_KEY="vibey.chatSessions"}async saveHistory(e){await this.context.workspaceState.update(t.KEY,e);try{await this.ensureHistoryDirectory(),await this.ensureGitIgnore(),await Ie.promises.writeFile(this.historyFile,JSON.stringify(e,null,2),"utf-8")}catch(r){console.error("Failed to save chat history to file:",r)}await this.saveSession(e)}async loadHistory(){try{if(Ie.existsSync(this.historyFile)){let r=await Ie.promises.readFile(this.historyFile,"utf-8"),n=JSON.parse(r);if(Array.isArray(n))return n}}catch(r){console.error("Failed to load chat history from file:",r)}return this.context.workspaceState.get(t.KEY)||[]}async clearHistory(){await this.context.workspaceState.update(t.KEY,void 0);try{Ie.existsSync(this.historyFile)&&await Ie.promises.unlink(this.historyFile)}catch(e){console.error("Failed to delete chat history file:",e)}await this.clearSessions()}async saveSession(e){let r=this.generateSessionId();this.currentSessionId=r;let n={sessionId:r,history:e,createdAt:Date.now(),updatedAt:Date.now()},s=await this.loadSessions();s.push(n),s.length>10&&s.shift();try{await this.ensureHistoryDirectory(),await Ie.promises.writeFile(this.sessionsFile,JSON.stringify(s,null,2),"utf-8")}catch(o){console.error("Failed to save chat sessions:",o)}}async loadSession(e){try{if(Ie.existsSync(this.sessionsFile)){let r=await Ie.promises.readFile(this.sessionsFile,"utf-8"),s=JSON.parse(r).find(o=>o.sessionId===e);return s?s.history:null}}catch(r){console.error("Failed to load chat session:",r)}return null}async loadLatestSession(){try{if(Ie.existsSync(this.sessionsFile)){let e=await Ie.promises.readFile(this.sessionsFile,"utf-8"),r=JSON.parse(e);if(r.length>0)return r[r.length-1].history}}catch(e){console.error("Failed to load latest chat session:",e)}return null}async loadSessions(){try{if(Ie.existsSync(this.sessionsFile)){let e=await Ie.promises.readFile(this.sessionsFile,"utf-8");return JSON.parse(e)}}catch(e){console.error("Failed to load chat sessions:",e)}return[]}async clearSessions(){try{Ie.existsSync(this.sessionsFile)&&await Ie.promises.unlink(this.sessionsFile)}catch(e){console.error("Failed to delete chat sessions file:",e)}}generateSessionId(){return"session_"+Date.now()+"_"+Math.random().toString(36).substr(2,9)}async ensureHistoryDirectory(){Ie.existsSync(this.historyDir)||await Ie.promises.mkdir(this.historyDir,{recursive:!0})}async ensureGitIgnore(){if(this.gitIgnoreChecked)return;let e=Ls.join(this.workspaceRoot,".gitignore"),r=".vibey/";try{let n="";if(Ie.existsSync(e)&&(n=await Ie.promises.readFile(e,"utf-8")),!n.includes(r)&&!n.includes(".vibey")){let s=n.endsWith(`
`)||n.length===0?`${n}${r}
`:`${n}
${r}
`;await Ie.promises.writeFile(e,s,"utf-8")}}catch(n){console.error("Failed to update .gitignore:",n)}finally{this.gitIgnoreChecked=!0}}};var Ns=ve(require("vscode"));var Rq=Object.freeze({status:"aborted"});function b(t,e,r){function n(a,c){var u;Object.defineProperty(a,"_zod",{value:a._zod??{},enumerable:!1}),(u=a._zod).traits??(u.traits=new Set),a._zod.traits.add(t),e(a,c);for(let l in i.prototype)l in a||Object.defineProperty(a,l,{value:i.prototype[l].bind(a)});a._zod.constr=i,a._zod.def=c}let s=r?.Parent??Object;class o extends s{}Object.defineProperty(o,"name",{value:t});function i(a){var c;let u=r?.Parent?new o:this;n(u,a),(c=u._zod).deferred??(c.deferred=[]);for(let l of u._zod.deferred)l();return u}return Object.defineProperty(i,"init",{value:n}),Object.defineProperty(i,Symbol.hasInstance,{value:a=>r?.Parent&&a instanceof r.Parent?!0:a?._zod?.traits?.has(t)}),Object.defineProperty(i,"name",{value:t}),i}var pr=class extends Error{constructor(){super("Encountered Promise during synchronous parse. Use .parseAsync() instead.")}},Ii={};function bt(t){return t&&Object.assign(Ii,t),Ii}var de={};hi(de,{BIGINT_FORMAT_RANGES:()=>im,Class:()=>Dc,NUMBER_FORMAT_RANGES:()=>Bc,aborted:()=>hn,allowsEval:()=>Uc,assert:()=>Kx,assertEqual:()=>Vx,assertIs:()=>Ux,assertNever:()=>Hx,assertNotEqual:()=>Fx,assignProp:()=>Fc,cached:()=>Fs,captureStackTrace:()=>Oi,cleanEnum:()=>ok,cleanRegex:()=>Hs,clone:()=>Bt,createTransparentProxy:()=>Qx,defineLazy:()=>_e,esc:()=>mn,escapeRegex:()=>Ir,extend:()=>tk,finalizeIssue:()=>Rt,floatSafeRemainder:()=>Vc,getElementAtPath:()=>Bx,getEnumValues:()=>Zc,getLengthableOrigin:()=>Ks,getParsedType:()=>Yx,getSizableOrigin:()=>am,isObject:()=>Wn,isPlainObject:()=>Jn,issue:()=>Gc,joinValues:()=>Ri,jsonStringifyReplacer:()=>Lc,merge:()=>rk,normalizeParams:()=>M,nullish:()=>Us,numKeys:()=>Jx,omit:()=>ek,optionalKeys:()=>Kc,partial:()=>nk,pick:()=>Xx,prefixIssues:()=>Gt,primitiveTypes:()=>om,promiseAllObject:()=>Gx,propertyKeyTypes:()=>Hc,randomString:()=>Wx,required:()=>sk,stringifyPrimitive:()=>Ni,unwrapMessage:()=>Vs});function Vx(t){return t}function Fx(t){return t}function Ux(t){}function Hx(t){throw new Error}function Kx(t){}function Zc(t){let e=Object.values(t).filter(n=>typeof n=="number");return Object.entries(t).filter(([n,s])=>e.indexOf(+n)===-1).map(([n,s])=>s)}function Ri(t,e="|"){return t.map(r=>Ni(r)).join(e)}function Lc(t,e){return typeof e=="bigint"?e.toString():e}function Fs(t){return{get value(){{let r=t();return Object.defineProperty(this,"value",{value:r}),r}throw new Error("cached value already set")}}}function Us(t){return t==null}function Hs(t){let e=t.startsWith("^")?1:0,r=t.endsWith("$")?t.length-1:t.length;return t.slice(e,r)}function Vc(t,e){let r=(t.toString().split(".")[1]||"").length,n=(e.toString().split(".")[1]||"").length,s=r>n?r:n,o=Number.parseInt(t.toFixed(s).replace(".","")),i=Number.parseInt(e.toFixed(s).replace(".",""));return o%i/10**s}function _e(t,e,r){Object.defineProperty(t,e,{get(){{let s=r();return t[e]=s,s}throw new Error("cached value already set")},set(s){Object.defineProperty(t,e,{value:s})},configurable:!0})}function Fc(t,e,r){Object.defineProperty(t,e,{value:r,writable:!0,enumerable:!0,configurable:!0})}function Bx(t,e){return e?e.reduce((r,n)=>r?.[n],t):t}function Gx(t){let e=Object.keys(t),r=e.map(n=>t[n]);return Promise.all(r).then(n=>{let s={};for(let o=0;o<e.length;o++)s[e[o]]=n[o];return s})}function Wx(t=10){let e="abcdefghijklmnopqrstuvwxyz",r="";for(let n=0;n<t;n++)r+=e[Math.floor(Math.random()*e.length)];return r}function mn(t){return JSON.stringify(t)}var Oi=Error.captureStackTrace?Error.captureStackTrace:(...t)=>{};function Wn(t){return typeof t=="object"&&t!==null&&!Array.isArray(t)}var Uc=Fs(()=>{if(typeof navigator<"u"&&navigator?.userAgent?.includes("Cloudflare"))return!1;try{let t=Function;return new t(""),!0}catch{return!1}});function Jn(t){if(Wn(t)===!1)return!1;let e=t.constructor;if(e===void 0)return!0;let r=e.prototype;return!(Wn(r)===!1||Object.prototype.hasOwnProperty.call(r,"isPrototypeOf")===!1)}function Jx(t){let e=0;for(let r in t)Object.prototype.hasOwnProperty.call(t,r)&&e++;return e}var Yx=t=>{let e=typeof t;switch(e){case"undefined":return"undefined";case"string":return"string";case"number":return Number.isNaN(t)?"nan":"number";case"boolean":return"boolean";case"function":return"function";case"bigint":return"bigint";case"symbol":return"symbol";case"object":return Array.isArray(t)?"array":t===null?"null":t.then&&typeof t.then=="function"&&t.catch&&typeof t.catch=="function"?"promise":typeof Map<"u"&&t instanceof Map?"map":typeof Set<"u"&&t instanceof Set?"set":typeof Date<"u"&&t instanceof Date?"date":typeof File<"u"&&t instanceof File?"file":"object";default:throw new Error(`Unknown data type: ${e}`)}},Hc=new Set(["string","number","symbol"]),om=new Set(["string","number","bigint","boolean","symbol","undefined"]);function Ir(t){return t.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}function Bt(t,e,r){let n=new t._zod.constr(e??t._zod.def);return(!e||r?.parent)&&(n._zod.parent=t),n}function M(t){let e=t;if(!e)return{};if(typeof e=="string")return{error:()=>e};if(e?.message!==void 0){if(e?.error!==void 0)throw new Error("Cannot specify both `message` and `error` params");e.error=e.message}return delete e.message,typeof e.error=="string"?{...e,error:()=>e.error}:e}function Qx(t){let e;return new Proxy({},{get(r,n,s){return e??(e=t()),Reflect.get(e,n,s)},set(r,n,s,o){return e??(e=t()),Reflect.set(e,n,s,o)},has(r,n){return e??(e=t()),Reflect.has(e,n)},deleteProperty(r,n){return e??(e=t()),Reflect.deleteProperty(e,n)},ownKeys(r){return e??(e=t()),Reflect.ownKeys(e)},getOwnPropertyDescriptor(r,n){return e??(e=t()),Reflect.getOwnPropertyDescriptor(e,n)},defineProperty(r,n,s){return e??(e=t()),Reflect.defineProperty(e,n,s)}})}function Ni(t){return typeof t=="bigint"?t.toString()+"n":typeof t=="string"?`"${t}"`:`${t}`}function Kc(t){return Object.keys(t).filter(e=>t[e]._zod.optin==="optional"&&t[e]._zod.optout==="optional")}var Bc={safeint:[Number.MIN_SAFE_INTEGER,Number.MAX_SAFE_INTEGER],int32:[-2147483648,2147483647],uint32:[0,4294967295],float32:[-34028234663852886e22,34028234663852886e22],float64:[-Number.MAX_VALUE,Number.MAX_VALUE]},im={int64:[BigInt("-9223372036854775808"),BigInt("9223372036854775807")],uint64:[BigInt(0),BigInt("18446744073709551615")]};function Xx(t,e){let r={},n=t._zod.def;for(let s in e){if(!(s in n.shape))throw new Error(`Unrecognized key: "${s}"`);e[s]&&(r[s]=n.shape[s])}return Bt(t,{...t._zod.def,shape:r,checks:[]})}function ek(t,e){let r={...t._zod.def.shape},n=t._zod.def;for(let s in e){if(!(s in n.shape))throw new Error(`Unrecognized key: "${s}"`);e[s]&&delete r[s]}return Bt(t,{...t._zod.def,shape:r,checks:[]})}function tk(t,e){if(!Jn(e))throw new Error("Invalid input to extend: expected a plain object");let r={...t._zod.def,get shape(){let n={...t._zod.def.shape,...e};return Fc(this,"shape",n),n},checks:[]};return Bt(t,r)}function rk(t,e){return Bt(t,{...t._zod.def,get shape(){let r={...t._zod.def.shape,...e._zod.def.shape};return Fc(this,"shape",r),r},catchall:e._zod.def.catchall,checks:[]})}function nk(t,e,r){let n=e._zod.def.shape,s={...n};if(r)for(let o in r){if(!(o in n))throw new Error(`Unrecognized key: "${o}"`);r[o]&&(s[o]=t?new t({type:"optional",innerType:n[o]}):n[o])}else for(let o in n)s[o]=t?new t({type:"optional",innerType:n[o]}):n[o];return Bt(e,{...e._zod.def,shape:s,checks:[]})}function sk(t,e,r){let n=e._zod.def.shape,s={...n};if(r)for(let o in r){if(!(o in s))throw new Error(`Unrecognized key: "${o}"`);r[o]&&(s[o]=new t({type:"nonoptional",innerType:n[o]}))}else for(let o in n)s[o]=new t({type:"nonoptional",innerType:n[o]});return Bt(e,{...e._zod.def,shape:s,checks:[]})}function hn(t,e=0){for(let r=e;r<t.issues.length;r++)if(t.issues[r]?.continue!==!0)return!0;return!1}function Gt(t,e){return e.map(r=>{var n;return(n=r).path??(n.path=[]),r.path.unshift(t),r})}function Vs(t){return typeof t=="string"?t:t?.message}function Rt(t,e,r){let n={...t,path:t.path??[]};if(!t.message){let s=Vs(t.inst?._zod.def?.error?.(t))??Vs(e?.error?.(t))??Vs(r.customError?.(t))??Vs(r.localeError?.(t))??"Invalid input";n.message=s}return delete n.inst,delete n.continue,e?.reportInput||delete n.input,n}function am(t){return t instanceof Set?"set":t instanceof Map?"map":t instanceof File?"file":"unknown"}function Ks(t){return Array.isArray(t)?"array":typeof t=="string"?"string":"unknown"}function Gc(...t){let[e,r,n]=t;return typeof e=="string"?{message:e,code:"custom",input:r,inst:n}:{...e}}function ok(t){return Object.entries(t).filter(([e,r])=>Number.isNaN(Number.parseInt(e,10))).map(e=>e[1])}var Dc=class{constructor(...e){}};var cm=(t,e)=>{t.name="$ZodError",Object.defineProperty(t,"_zod",{value:t._zod,enumerable:!1}),Object.defineProperty(t,"issues",{value:e,enumerable:!1}),Object.defineProperty(t,"message",{get(){return JSON.stringify(e,Lc,2)},enumerable:!0}),Object.defineProperty(t,"toString",{value:()=>t.message,enumerable:!1})},ji=b("$ZodError",cm),Wc=b("$ZodError",cm,{Parent:Error});function um(t,e=r=>r.message){let r={},n=[];for(let s of t.issues)s.path.length>0?(r[s.path[0]]=r[s.path[0]]||[],r[s.path[0]].push(e(s))):n.push(e(s));return{formErrors:n,fieldErrors:r}}function lm(t,e){let r=e||function(o){return o.message},n={_errors:[]},s=o=>{for(let i of o.issues)if(i.code==="invalid_union"&&i.errors.length)i.errors.map(a=>s({issues:a}));else if(i.code==="invalid_key")s({issues:i.issues});else if(i.code==="invalid_element")s({issues:i.issues});else if(i.path.length===0)n._errors.push(r(i));else{let a=n,c=0;for(;c<i.path.length;){let u=i.path[c];c===i.path.length-1?(a[u]=a[u]||{_errors:[]},a[u]._errors.push(r(i))):a[u]=a[u]||{_errors:[]},a=a[u],c++}}};return s(t),n}var dm=t=>(e,r,n,s)=>{let o=n?Object.assign(n,{async:!1}):{async:!1},i=e._zod.run({value:r,issues:[]},o);if(i instanceof Promise)throw new pr;if(i.issues.length){let a=new(s?.Err??t)(i.issues.map(c=>Rt(c,o,bt())));throw Oi(a,s?.callee),a}return i.value};var pm=t=>async(e,r,n,s)=>{let o=n?Object.assign(n,{async:!0}):{async:!0},i=e._zod.run({value:r,issues:[]},o);if(i instanceof Promise&&(i=await i),i.issues.length){let a=new(s?.Err??t)(i.issues.map(c=>Rt(c,o,bt())));throw Oi(a,s?.callee),a}return i.value};var Jc=t=>(e,r,n)=>{let s=n?{...n,async:!1}:{async:!1},o=e._zod.run({value:r,issues:[]},s);if(o instanceof Promise)throw new pr;return o.issues.length?{success:!1,error:new(t??ji)(o.issues.map(i=>Rt(i,s,bt())))}:{success:!0,data:o.value}},Bs=Jc(Wc),Yc=t=>async(e,r,n)=>{let s=n?Object.assign(n,{async:!0}):{async:!0},o=e._zod.run({value:r,issues:[]},s);return o instanceof Promise&&(o=await o),o.issues.length?{success:!1,error:new t(o.issues.map(i=>Rt(i,s,bt())))}:{success:!0,data:o.value}},Ai=Yc(Wc);var fm=/^[cC][^\s-]{8,}$/,mm=/^[0-9a-z]+$/,hm=/^[0-9A-HJKMNP-TV-Za-hjkmnp-tv-z]{26}$/,gm=/^[0-9a-vA-V]{20}$/,ym=/^[A-Za-z0-9]{27}$/,vm=/^[a-zA-Z0-9_-]{21}$/,_m=/^P(?:(\d+W)|(?!.*W)(?=\d|T\d)(\d+Y)?(\d+M)?(\d+D)?(T(?=\d)(\d+H)?(\d+M)?(\d+([.,]\d+)?S)?)?)$/;var bm=/^([0-9a-fA-F]{8}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{12})$/,Qc=t=>t?new RegExp(`^([0-9a-fA-F]{8}-[0-9a-fA-F]{4}-${t}[0-9a-fA-F]{3}-[89abAB][0-9a-fA-F]{3}-[0-9a-fA-F]{12})$`):/^([0-9a-fA-F]{8}-[0-9a-fA-F]{4}-[1-8][0-9a-fA-F]{3}-[89abAB][0-9a-fA-F]{3}-[0-9a-fA-F]{12}|00000000-0000-0000-0000-000000000000)$/;var wm=/^(?!\.)(?!.*\.\.)([A-Za-z0-9_'+\-\.]*)[A-Za-z0-9_+-]@([A-Za-z0-9][A-Za-z0-9\-]*\.)+[A-Za-z]{2,}$/;var ak="^(\\p{Extended_Pictographic}|\\p{Emoji_Component})+$";function $m(){return new RegExp(ak,"u")}var xm=/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])$/,km=/^(([0-9a-fA-F]{1,4}:){7}[0-9a-fA-F]{1,4}|::|([0-9a-fA-F]{1,4})?::([0-9a-fA-F]{1,4}:?){0,6})$/,Sm=/^((25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\/([0-9]|[1-2][0-9]|3[0-2])$/,Pm=/^(([0-9a-fA-F]{1,4}:){7}[0-9a-fA-F]{1,4}|::|([0-9a-fA-F]{1,4})?::([0-9a-fA-F]{1,4}:?){0,6})\/(12[0-8]|1[01][0-9]|[1-9]?[0-9])$/,Em=/^$|^(?:[0-9a-zA-Z+/]{4})*(?:(?:[0-9a-zA-Z+/]{2}==)|(?:[0-9a-zA-Z+/]{3}=))?$/,Xc=/^[A-Za-z0-9_-]*$/,Tm=/^([a-zA-Z0-9-]+\.)*[a-zA-Z0-9-]+$/;var zm=/^\+(?:[0-9]){6,14}[0-9]$/,Cm="(?:(?:\\d\\d[2468][048]|\\d\\d[13579][26]|\\d\\d0[48]|[02468][048]00|[13579][26]00)-02-29|\\d{4}-(?:(?:0[13578]|1[02])-(?:0[1-9]|[12]\\d|3[01])|(?:0[469]|11)-(?:0[1-9]|[12]\\d|30)|(?:02)-(?:0[1-9]|1\\d|2[0-8])))",Im=new RegExp(`^${Cm}$`);function Rm(t){let e="(?:[01]\\d|2[0-3]):[0-5]\\d";return typeof t.precision=="number"?t.precision===-1?`${e}`:t.precision===0?`${e}:[0-5]\\d`:`${e}:[0-5]\\d\\.\\d{${t.precision}}`:`${e}(?::[0-5]\\d(?:\\.\\d+)?)?`}function Om(t){return new RegExp(`^${Rm(t)}$`)}function Nm(t){let e=Rm({precision:t.precision}),r=["Z"];t.local&&r.push(""),t.offset&&r.push("([+-]\\d{2}:\\d{2})");let n=`${e}(?:${r.join("|")})`;return new RegExp(`^${Cm}T(?:${n})$`)}var jm=t=>{let e=t?`[\\s\\S]{${t?.minimum??0},${t?.maximum??""}}`:"[\\s\\S]*";return new RegExp(`^${e}$`)};var Am=/^\d+$/,Mm=/^-?\d+(?:\.\d+)?/i,qm=/true|false/i,Dm=/null/i;var Zm=/^[^A-Z]*$/,Lm=/^[^a-z]*$/;var Ge=b("$ZodCheck",(t,e)=>{var r;t._zod??(t._zod={}),t._zod.def=e,(r=t._zod).onattach??(r.onattach=[])}),Vm={number:"number",bigint:"bigint",object:"date"},tu=b("$ZodCheckLessThan",(t,e)=>{Ge.init(t,e);let r=Vm[typeof e.value];t._zod.onattach.push(n=>{let s=n._zod.bag,o=(e.inclusive?s.maximum:s.exclusiveMaximum)??Number.POSITIVE_INFINITY;e.value<o&&(e.inclusive?s.maximum=e.value:s.exclusiveMaximum=e.value)}),t._zod.check=n=>{(e.inclusive?n.value<=e.value:n.value<e.value)||n.issues.push({origin:r,code:"too_big",maximum:e.value,input:n.value,inclusive:e.inclusive,inst:t,continue:!e.abort})}}),ru=b("$ZodCheckGreaterThan",(t,e)=>{Ge.init(t,e);let r=Vm[typeof e.value];t._zod.onattach.push(n=>{let s=n._zod.bag,o=(e.inclusive?s.minimum:s.exclusiveMinimum)??Number.NEGATIVE_INFINITY;e.value>o&&(e.inclusive?s.minimum=e.value:s.exclusiveMinimum=e.value)}),t._zod.check=n=>{(e.inclusive?n.value>=e.value:n.value>e.value)||n.issues.push({origin:r,code:"too_small",minimum:e.value,input:n.value,inclusive:e.inclusive,inst:t,continue:!e.abort})}}),Fm=b("$ZodCheckMultipleOf",(t,e)=>{Ge.init(t,e),t._zod.onattach.push(r=>{var n;(n=r._zod.bag).multipleOf??(n.multipleOf=e.value)}),t._zod.check=r=>{if(typeof r.value!=typeof e.value)throw new Error("Cannot mix number and bigint in multiple_of check.");(typeof r.value=="bigint"?r.value%e.value===BigInt(0):Vc(r.value,e.value)===0)||r.issues.push({origin:typeof r.value,code:"not_multiple_of",divisor:e.value,input:r.value,inst:t,continue:!e.abort})}}),Um=b("$ZodCheckNumberFormat",(t,e)=>{Ge.init(t,e),e.format=e.format||"float64";let r=e.format?.includes("int"),n=r?"int":"number",[s,o]=Bc[e.format];t._zod.onattach.push(i=>{let a=i._zod.bag;a.format=e.format,a.minimum=s,a.maximum=o,r&&(a.pattern=Am)}),t._zod.check=i=>{let a=i.value;if(r){if(!Number.isInteger(a)){i.issues.push({expected:n,format:e.format,code:"invalid_type",input:a,inst:t});return}if(!Number.isSafeInteger(a)){a>0?i.issues.push({input:a,code:"too_big",maximum:Number.MAX_SAFE_INTEGER,note:"Integers must be within the safe integer range.",inst:t,origin:n,continue:!e.abort}):i.issues.push({input:a,code:"too_small",minimum:Number.MIN_SAFE_INTEGER,note:"Integers must be within the safe integer range.",inst:t,origin:n,continue:!e.abort});return}}a<s&&i.issues.push({origin:"number",input:a,code:"too_small",minimum:s,inclusive:!0,inst:t,continue:!e.abort}),a>o&&i.issues.push({origin:"number",input:a,code:"too_big",maximum:o,inst:t})}});var Hm=b("$ZodCheckMaxLength",(t,e)=>{var r;Ge.init(t,e),(r=t._zod.def).when??(r.when=n=>{let s=n.value;return!Us(s)&&s.length!==void 0}),t._zod.onattach.push(n=>{let s=n._zod.bag.maximum??Number.POSITIVE_INFINITY;e.maximum<s&&(n._zod.bag.maximum=e.maximum)}),t._zod.check=n=>{let s=n.value;if(s.length<=e.maximum)return;let i=Ks(s);n.issues.push({origin:i,code:"too_big",maximum:e.maximum,inclusive:!0,input:s,inst:t,continue:!e.abort})}}),Km=b("$ZodCheckMinLength",(t,e)=>{var r;Ge.init(t,e),(r=t._zod.def).when??(r.when=n=>{let s=n.value;return!Us(s)&&s.length!==void 0}),t._zod.onattach.push(n=>{let s=n._zod.bag.minimum??Number.NEGATIVE_INFINITY;e.minimum>s&&(n._zod.bag.minimum=e.minimum)}),t._zod.check=n=>{let s=n.value;if(s.length>=e.minimum)return;let i=Ks(s);n.issues.push({origin:i,code:"too_small",minimum:e.minimum,inclusive:!0,input:s,inst:t,continue:!e.abort})}}),Bm=b("$ZodCheckLengthEquals",(t,e)=>{var r;Ge.init(t,e),(r=t._zod.def).when??(r.when=n=>{let s=n.value;return!Us(s)&&s.length!==void 0}),t._zod.onattach.push(n=>{let s=n._zod.bag;s.minimum=e.length,s.maximum=e.length,s.length=e.length}),t._zod.check=n=>{let s=n.value,o=s.length;if(o===e.length)return;let i=Ks(s),a=o>e.length;n.issues.push({origin:i,...a?{code:"too_big",maximum:e.length}:{code:"too_small",minimum:e.length},inclusive:!0,exact:!0,input:n.value,inst:t,continue:!e.abort})}}),Gs=b("$ZodCheckStringFormat",(t,e)=>{var r,n;Ge.init(t,e),t._zod.onattach.push(s=>{let o=s._zod.bag;o.format=e.format,e.pattern&&(o.patterns??(o.patterns=new Set),o.patterns.add(e.pattern))}),e.pattern?(r=t._zod).check??(r.check=s=>{e.pattern.lastIndex=0,!e.pattern.test(s.value)&&s.issues.push({origin:"string",code:"invalid_format",format:e.format,input:s.value,...e.pattern?{pattern:e.pattern.toString()}:{},inst:t,continue:!e.abort})}):(n=t._zod).check??(n.check=()=>{})}),Gm=b("$ZodCheckRegex",(t,e)=>{Gs.init(t,e),t._zod.check=r=>{e.pattern.lastIndex=0,!e.pattern.test(r.value)&&r.issues.push({origin:"string",code:"invalid_format",format:"regex",input:r.value,pattern:e.pattern.toString(),inst:t,continue:!e.abort})}}),Wm=b("$ZodCheckLowerCase",(t,e)=>{e.pattern??(e.pattern=Zm),Gs.init(t,e)}),Jm=b("$ZodCheckUpperCase",(t,e)=>{e.pattern??(e.pattern=Lm),Gs.init(t,e)}),Ym=b("$ZodCheckIncludes",(t,e)=>{Ge.init(t,e);let r=Ir(e.includes),n=new RegExp(typeof e.position=="number"?`^.{${e.position}}${r}`:r);e.pattern=n,t._zod.onattach.push(s=>{let o=s._zod.bag;o.patterns??(o.patterns=new Set),o.patterns.add(n)}),t._zod.check=s=>{s.value.includes(e.includes,e.position)||s.issues.push({origin:"string",code:"invalid_format",format:"includes",includes:e.includes,input:s.value,inst:t,continue:!e.abort})}}),Qm=b("$ZodCheckStartsWith",(t,e)=>{Ge.init(t,e);let r=new RegExp(`^${Ir(e.prefix)}.*`);e.pattern??(e.pattern=r),t._zod.onattach.push(n=>{let s=n._zod.bag;s.patterns??(s.patterns=new Set),s.patterns.add(r)}),t._zod.check=n=>{n.value.startsWith(e.prefix)||n.issues.push({origin:"string",code:"invalid_format",format:"starts_with",prefix:e.prefix,input:n.value,inst:t,continue:!e.abort})}}),Xm=b("$ZodCheckEndsWith",(t,e)=>{Ge.init(t,e);let r=new RegExp(`.*${Ir(e.suffix)}$`);e.pattern??(e.pattern=r),t._zod.onattach.push(n=>{let s=n._zod.bag;s.patterns??(s.patterns=new Set),s.patterns.add(r)}),t._zod.check=n=>{n.value.endsWith(e.suffix)||n.issues.push({origin:"string",code:"invalid_format",format:"ends_with",suffix:e.suffix,input:n.value,inst:t,continue:!e.abort})}});var eh=b("$ZodCheckOverwrite",(t,e)=>{Ge.init(t,e),t._zod.check=r=>{r.value=e.tx(r.value)}});var Mi=class{constructor(e=[]){this.content=[],this.indent=0,this&&(this.args=e)}indented(e){this.indent+=1,e(this),this.indent-=1}write(e){if(typeof e=="function"){e(this,{execution:"sync"}),e(this,{execution:"async"});return}let n=e.split(`
`).filter(i=>i),s=Math.min(...n.map(i=>i.length-i.trimStart().length)),o=n.map(i=>i.slice(s)).map(i=>" ".repeat(this.indent*2)+i);for(let i of o)this.content.push(i)}compile(){let e=Function,r=this?.args,s=[...(this?.content??[""]).map(o=>`  ${o}`)];return new e(...r,s.join(`
`))}};var rh={major:4,minor:0,patch:0};var be=b("$ZodType",(t,e)=>{var r;t??(t={}),t._zod.def=e,t._zod.bag=t._zod.bag||{},t._zod.version=rh;let n=[...t._zod.def.checks??[]];t._zod.traits.has("$ZodCheck")&&n.unshift(t);for(let s of n)for(let o of s._zod.onattach)o(t);if(n.length===0)(r=t._zod).deferred??(r.deferred=[]),t._zod.deferred?.push(()=>{t._zod.run=t._zod.parse});else{let s=(o,i,a)=>{let c=hn(o),u;for(let l of i){if(l._zod.def.when){if(!l._zod.def.when(o))continue}else if(c)continue;let d=o.issues.length,f=l._zod.check(o);if(f instanceof Promise&&a?.async===!1)throw new pr;if(u||f instanceof Promise)u=(u??Promise.resolve()).then(async()=>{await f,o.issues.length!==d&&(c||(c=hn(o,d)))});else{if(o.issues.length===d)continue;c||(c=hn(o,d))}}return u?u.then(()=>o):o};t._zod.run=(o,i)=>{let a=t._zod.parse(o,i);if(a instanceof Promise){if(i.async===!1)throw new pr;return a.then(c=>s(c,n,i))}return s(a,n,i)}}t["~standard"]={validate:s=>{try{let o=Bs(t,s);return o.success?{value:o.data}:{issues:o.error?.issues}}catch{return Ai(t,s).then(i=>i.success?{value:i.data}:{issues:i.error?.issues})}},vendor:"zod",version:1}}),Di=b("$ZodString",(t,e)=>{be.init(t,e),t._zod.pattern=[...t?._zod.bag?.patterns??[]].pop()??jm(t._zod.bag),t._zod.parse=(r,n)=>{if(e.coerce)try{r.value=String(r.value)}catch{}return typeof r.value=="string"||r.issues.push({expected:"string",code:"invalid_type",input:r.value,inst:t}),r}}),$e=b("$ZodStringFormat",(t,e)=>{Gs.init(t,e),Di.init(t,e)}),ph=b("$ZodGUID",(t,e)=>{e.pattern??(e.pattern=bm),$e.init(t,e)}),fh=b("$ZodUUID",(t,e)=>{if(e.version){let n={v1:1,v2:2,v3:3,v4:4,v5:5,v6:6,v7:7,v8:8}[e.version];if(n===void 0)throw new Error(`Invalid UUID version: "${e.version}"`);e.pattern??(e.pattern=Qc(n))}else e.pattern??(e.pattern=Qc());$e.init(t,e)}),mh=b("$ZodEmail",(t,e)=>{e.pattern??(e.pattern=wm),$e.init(t,e)}),hh=b("$ZodURL",(t,e)=>{$e.init(t,e),t._zod.check=r=>{try{let n=r.value,s=new URL(n),o=s.href;e.hostname&&(e.hostname.lastIndex=0,e.hostname.test(s.hostname)||r.issues.push({code:"invalid_format",format:"url",note:"Invalid hostname",pattern:Tm.source,input:r.value,inst:t,continue:!e.abort})),e.protocol&&(e.protocol.lastIndex=0,e.protocol.test(s.protocol.endsWith(":")?s.protocol.slice(0,-1):s.protocol)||r.issues.push({code:"invalid_format",format:"url",note:"Invalid protocol",pattern:e.protocol.source,input:r.value,inst:t,continue:!e.abort})),!n.endsWith("/")&&o.endsWith("/")?r.value=o.slice(0,-1):r.value=o;return}catch{r.issues.push({code:"invalid_format",format:"url",input:r.value,inst:t,continue:!e.abort})}}}),gh=b("$ZodEmoji",(t,e)=>{e.pattern??(e.pattern=$m()),$e.init(t,e)}),yh=b("$ZodNanoID",(t,e)=>{e.pattern??(e.pattern=vm),$e.init(t,e)}),vh=b("$ZodCUID",(t,e)=>{e.pattern??(e.pattern=fm),$e.init(t,e)}),_h=b("$ZodCUID2",(t,e)=>{e.pattern??(e.pattern=mm),$e.init(t,e)}),bh=b("$ZodULID",(t,e)=>{e.pattern??(e.pattern=hm),$e.init(t,e)}),wh=b("$ZodXID",(t,e)=>{e.pattern??(e.pattern=gm),$e.init(t,e)}),$h=b("$ZodKSUID",(t,e)=>{e.pattern??(e.pattern=ym),$e.init(t,e)}),xh=b("$ZodISODateTime",(t,e)=>{e.pattern??(e.pattern=Nm(e)),$e.init(t,e)}),kh=b("$ZodISODate",(t,e)=>{e.pattern??(e.pattern=Im),$e.init(t,e)}),Sh=b("$ZodISOTime",(t,e)=>{e.pattern??(e.pattern=Om(e)),$e.init(t,e)}),Ph=b("$ZodISODuration",(t,e)=>{e.pattern??(e.pattern=_m),$e.init(t,e)}),Eh=b("$ZodIPv4",(t,e)=>{e.pattern??(e.pattern=xm),$e.init(t,e),t._zod.onattach.push(r=>{let n=r._zod.bag;n.format="ipv4"})}),Th=b("$ZodIPv6",(t,e)=>{e.pattern??(e.pattern=km),$e.init(t,e),t._zod.onattach.push(r=>{let n=r._zod.bag;n.format="ipv6"}),t._zod.check=r=>{try{new URL(`http://[${r.value}]`)}catch{r.issues.push({code:"invalid_format",format:"ipv6",input:r.value,inst:t,continue:!e.abort})}}}),zh=b("$ZodCIDRv4",(t,e)=>{e.pattern??(e.pattern=Sm),$e.init(t,e)}),Ch=b("$ZodCIDRv6",(t,e)=>{e.pattern??(e.pattern=Pm),$e.init(t,e),t._zod.check=r=>{let[n,s]=r.value.split("/");try{if(!s)throw new Error;let o=Number(s);if(`${o}`!==s)throw new Error;if(o<0||o>128)throw new Error;new URL(`http://[${n}]`)}catch{r.issues.push({code:"invalid_format",format:"cidrv6",input:r.value,inst:t,continue:!e.abort})}}});function Ih(t){if(t==="")return!0;if(t.length%4!==0)return!1;try{return atob(t),!0}catch{return!1}}var Rh=b("$ZodBase64",(t,e)=>{e.pattern??(e.pattern=Em),$e.init(t,e),t._zod.onattach.push(r=>{r._zod.bag.contentEncoding="base64"}),t._zod.check=r=>{Ih(r.value)||r.issues.push({code:"invalid_format",format:"base64",input:r.value,inst:t,continue:!e.abort})}});function ck(t){if(!Xc.test(t))return!1;let e=t.replace(/[-_]/g,n=>n==="-"?"+":"/"),r=e.padEnd(Math.ceil(e.length/4)*4,"=");return Ih(r)}var Oh=b("$ZodBase64URL",(t,e)=>{e.pattern??(e.pattern=Xc),$e.init(t,e),t._zod.onattach.push(r=>{r._zod.bag.contentEncoding="base64url"}),t._zod.check=r=>{ck(r.value)||r.issues.push({code:"invalid_format",format:"base64url",input:r.value,inst:t,continue:!e.abort})}}),Nh=b("$ZodE164",(t,e)=>{e.pattern??(e.pattern=zm),$e.init(t,e)});function uk(t,e=null){try{let r=t.split(".");if(r.length!==3)return!1;let[n]=r;if(!n)return!1;let s=JSON.parse(atob(n));return!("typ"in s&&s?.typ!=="JWT"||!s.alg||e&&(!("alg"in s)||s.alg!==e))}catch{return!1}}var jh=b("$ZodJWT",(t,e)=>{$e.init(t,e),t._zod.check=r=>{uk(r.value,e.alg)||r.issues.push({code:"invalid_format",format:"jwt",input:r.value,inst:t,continue:!e.abort})}});var su=b("$ZodNumber",(t,e)=>{be.init(t,e),t._zod.pattern=t._zod.bag.pattern??Mm,t._zod.parse=(r,n)=>{if(e.coerce)try{r.value=Number(r.value)}catch{}let s=r.value;if(typeof s=="number"&&!Number.isNaN(s)&&Number.isFinite(s))return r;let o=typeof s=="number"?Number.isNaN(s)?"NaN":Number.isFinite(s)?void 0:"Infinity":void 0;return r.issues.push({expected:"number",code:"invalid_type",input:s,inst:t,...o?{received:o}:{}}),r}}),Ah=b("$ZodNumber",(t,e)=>{Um.init(t,e),su.init(t,e)}),Mh=b("$ZodBoolean",(t,e)=>{be.init(t,e),t._zod.pattern=qm,t._zod.parse=(r,n)=>{if(e.coerce)try{r.value=!!r.value}catch{}let s=r.value;return typeof s=="boolean"||r.issues.push({expected:"boolean",code:"invalid_type",input:s,inst:t}),r}});var qh=b("$ZodNull",(t,e)=>{be.init(t,e),t._zod.pattern=Dm,t._zod.values=new Set([null]),t._zod.parse=(r,n)=>{let s=r.value;return s===null||r.issues.push({expected:"null",code:"invalid_type",input:s,inst:t}),r}});var Dh=b("$ZodUnknown",(t,e)=>{be.init(t,e),t._zod.parse=r=>r}),Zh=b("$ZodNever",(t,e)=>{be.init(t,e),t._zod.parse=(r,n)=>(r.issues.push({expected:"never",code:"invalid_type",input:r.value,inst:t}),r)});function nh(t,e,r){t.issues.length&&e.issues.push(...Gt(r,t.issues)),e.value[r]=t.value}var Lh=b("$ZodArray",(t,e)=>{be.init(t,e),t._zod.parse=(r,n)=>{let s=r.value;if(!Array.isArray(s))return r.issues.push({expected:"array",code:"invalid_type",input:s,inst:t}),r;r.value=Array(s.length);let o=[];for(let i=0;i<s.length;i++){let a=s[i],c=e.element._zod.run({value:a,issues:[]},n);c instanceof Promise?o.push(c.then(u=>nh(u,r,i))):nh(c,r,i)}return o.length?Promise.all(o).then(()=>r):r}});function qi(t,e,r){t.issues.length&&e.issues.push(...Gt(r,t.issues)),e.value[r]=t.value}function sh(t,e,r,n){t.issues.length?n[r]===void 0?r in n?e.value[r]=void 0:e.value[r]=t.value:e.issues.push(...Gt(r,t.issues)):t.value===void 0?r in n&&(e.value[r]=void 0):e.value[r]=t.value}var Vh=b("$ZodObject",(t,e)=>{be.init(t,e);let r=Fs(()=>{let d=Object.keys(e.shape);for(let p of d)if(!(e.shape[p]instanceof be))throw new Error(`Invalid element at key "${p}": expected a Zod schema`);let f=Kc(e.shape);return{shape:e.shape,keys:d,keySet:new Set(d),numKeys:d.length,optionalKeys:new Set(f)}});_e(t._zod,"propValues",()=>{let d=e.shape,f={};for(let p in d){let m=d[p]._zod;if(m.values){f[p]??(f[p]=new Set);for(let h of m.values)f[p].add(h)}}return f});let n=d=>{let f=new Mi(["shape","payload","ctx"]),p=r.value,m=x=>{let $=mn(x);return`shape[${$}]._zod.run({ value: input[${$}], issues: [] }, ctx)`};f.write("const input = payload.value;");let h=Object.create(null),g=0;for(let x of p.keys)h[x]=`key_${g++}`;f.write("const newResult = {}");for(let x of p.keys)if(p.optionalKeys.has(x)){let $=h[x];f.write(`const ${$} = ${m(x)};`);let S=mn(x);f.write(`
        if (${$}.issues.length) {
          if (input[${S}] === undefined) {
            if (${S} in input) {
              newResult[${S}] = undefined;
            }
          } else {
            payload.issues = payload.issues.concat(
              ${$}.issues.map((iss) => ({
                ...iss,
                path: iss.path ? [${S}, ...iss.path] : [${S}],
              }))
            );
          }
        } else if (${$}.value === undefined) {
          if (${S} in input) newResult[${S}] = undefined;
        } else {
          newResult[${S}] = ${$}.value;
        }
        `)}else{let $=h[x];f.write(`const ${$} = ${m(x)};`),f.write(`
          if (${$}.issues.length) payload.issues = payload.issues.concat(${$}.issues.map(iss => ({
            ...iss,
            path: iss.path ? [${mn(x)}, ...iss.path] : [${mn(x)}]
          })));`),f.write(`newResult[${mn(x)}] = ${$}.value`)}f.write("payload.value = newResult;"),f.write("return payload;");let y=f.compile();return(x,$)=>y(d,x,$)},s,o=Wn,i=!Ii.jitless,c=i&&Uc.value,u=e.catchall,l;t._zod.parse=(d,f)=>{l??(l=r.value);let p=d.value;if(!o(p))return d.issues.push({expected:"object",code:"invalid_type",input:p,inst:t}),d;let m=[];if(i&&c&&f?.async===!1&&f.jitless!==!0)s||(s=n(e.shape)),d=s(d,f);else{d.value={};let $=l.shape;for(let S of l.keys){let w=$[S],D=w._zod.run({value:p[S],issues:[]},f),F=w._zod.optin==="optional"&&w._zod.optout==="optional";D instanceof Promise?m.push(D.then(Ce=>F?sh(Ce,d,S,p):qi(Ce,d,S))):F?sh(D,d,S,p):qi(D,d,S)}}if(!u)return m.length?Promise.all(m).then(()=>d):d;let h=[],g=l.keySet,y=u._zod,x=y.def.type;for(let $ of Object.keys(p)){if(g.has($))continue;if(x==="never"){h.push($);continue}let S=y.run({value:p[$],issues:[]},f);S instanceof Promise?m.push(S.then(w=>qi(w,d,$))):qi(S,d,$)}return h.length&&d.issues.push({code:"unrecognized_keys",keys:h,input:p,inst:t}),m.length?Promise.all(m).then(()=>d):d}});function oh(t,e,r,n){for(let s of t)if(s.issues.length===0)return e.value=s.value,e;return e.issues.push({code:"invalid_union",input:e.value,inst:r,errors:t.map(s=>s.issues.map(o=>Rt(o,n,bt())))}),e}var ou=b("$ZodUnion",(t,e)=>{be.init(t,e),_e(t._zod,"optin",()=>e.options.some(r=>r._zod.optin==="optional")?"optional":void 0),_e(t._zod,"optout",()=>e.options.some(r=>r._zod.optout==="optional")?"optional":void 0),_e(t._zod,"values",()=>{if(e.options.every(r=>r._zod.values))return new Set(e.options.flatMap(r=>Array.from(r._zod.values)))}),_e(t._zod,"pattern",()=>{if(e.options.every(r=>r._zod.pattern)){let r=e.options.map(n=>n._zod.pattern);return new RegExp(`^(${r.map(n=>Hs(n.source)).join("|")})$`)}}),t._zod.parse=(r,n)=>{let s=!1,o=[];for(let i of e.options){let a=i._zod.run({value:r.value,issues:[]},n);if(a instanceof Promise)o.push(a),s=!0;else{if(a.issues.length===0)return a;o.push(a)}}return s?Promise.all(o).then(i=>oh(i,r,t,n)):oh(o,r,t,n)}}),Fh=b("$ZodDiscriminatedUnion",(t,e)=>{ou.init(t,e);let r=t._zod.parse;_e(t._zod,"propValues",()=>{let s={};for(let o of e.options){let i=o._zod.propValues;if(!i||Object.keys(i).length===0)throw new Error(`Invalid discriminated union option at index "${e.options.indexOf(o)}"`);for(let[a,c]of Object.entries(i)){s[a]||(s[a]=new Set);for(let u of c)s[a].add(u)}}return s});let n=Fs(()=>{let s=e.options,o=new Map;for(let i of s){let a=i._zod.propValues[e.discriminator];if(!a||a.size===0)throw new Error(`Invalid discriminated union option at index "${e.options.indexOf(i)}"`);for(let c of a){if(o.has(c))throw new Error(`Duplicate discriminator value "${String(c)}"`);o.set(c,i)}}return o});t._zod.parse=(s,o)=>{let i=s.value;if(!Wn(i))return s.issues.push({code:"invalid_type",expected:"object",input:i,inst:t}),s;let a=n.value.get(i?.[e.discriminator]);return a?a._zod.run(s,o):e.unionFallback?r(s,o):(s.issues.push({code:"invalid_union",errors:[],note:"No matching discriminator",input:i,path:[e.discriminator],inst:t}),s)}}),Uh=b("$ZodIntersection",(t,e)=>{be.init(t,e),t._zod.parse=(r,n)=>{let s=r.value,o=e.left._zod.run({value:s,issues:[]},n),i=e.right._zod.run({value:s,issues:[]},n);return o instanceof Promise||i instanceof Promise?Promise.all([o,i]).then(([c,u])=>ih(r,c,u)):ih(r,o,i)}});function nu(t,e){if(t===e)return{valid:!0,data:t};if(t instanceof Date&&e instanceof Date&&+t==+e)return{valid:!0,data:t};if(Jn(t)&&Jn(e)){let r=Object.keys(e),n=Object.keys(t).filter(o=>r.indexOf(o)!==-1),s={...t,...e};for(let o of n){let i=nu(t[o],e[o]);if(!i.valid)return{valid:!1,mergeErrorPath:[o,...i.mergeErrorPath]};s[o]=i.data}return{valid:!0,data:s}}if(Array.isArray(t)&&Array.isArray(e)){if(t.length!==e.length)return{valid:!1,mergeErrorPath:[]};let r=[];for(let n=0;n<t.length;n++){let s=t[n],o=e[n],i=nu(s,o);if(!i.valid)return{valid:!1,mergeErrorPath:[n,...i.mergeErrorPath]};r.push(i.data)}return{valid:!0,data:r}}return{valid:!1,mergeErrorPath:[]}}function ih(t,e,r){if(e.issues.length&&t.issues.push(...e.issues),r.issues.length&&t.issues.push(...r.issues),hn(t))return t;let n=nu(e.value,r.value);if(!n.valid)throw new Error(`Unmergable intersection. Error path: ${JSON.stringify(n.mergeErrorPath)}`);return t.value=n.data,t}var Hh=b("$ZodRecord",(t,e)=>{be.init(t,e),t._zod.parse=(r,n)=>{let s=r.value;if(!Jn(s))return r.issues.push({expected:"record",code:"invalid_type",input:s,inst:t}),r;let o=[];if(e.keyType._zod.values){let i=e.keyType._zod.values;r.value={};for(let c of i)if(typeof c=="string"||typeof c=="number"||typeof c=="symbol"){let u=e.valueType._zod.run({value:s[c],issues:[]},n);u instanceof Promise?o.push(u.then(l=>{l.issues.length&&r.issues.push(...Gt(c,l.issues)),r.value[c]=l.value})):(u.issues.length&&r.issues.push(...Gt(c,u.issues)),r.value[c]=u.value)}let a;for(let c in s)i.has(c)||(a=a??[],a.push(c));a&&a.length>0&&r.issues.push({code:"unrecognized_keys",input:s,inst:t,keys:a})}else{r.value={};for(let i of Reflect.ownKeys(s)){if(i==="__proto__")continue;let a=e.keyType._zod.run({value:i,issues:[]},n);if(a instanceof Promise)throw new Error("Async schemas not supported in object keys currently");if(a.issues.length){r.issues.push({origin:"record",code:"invalid_key",issues:a.issues.map(u=>Rt(u,n,bt())),input:i,path:[i],inst:t}),r.value[a.value]=a.value;continue}let c=e.valueType._zod.run({value:s[i],issues:[]},n);c instanceof Promise?o.push(c.then(u=>{u.issues.length&&r.issues.push(...Gt(i,u.issues)),r.value[a.value]=u.value})):(c.issues.length&&r.issues.push(...Gt(i,c.issues)),r.value[a.value]=c.value)}}return o.length?Promise.all(o).then(()=>r):r}});var Kh=b("$ZodEnum",(t,e)=>{be.init(t,e);let r=Zc(e.entries);t._zod.values=new Set(r),t._zod.pattern=new RegExp(`^(${r.filter(n=>Hc.has(typeof n)).map(n=>typeof n=="string"?Ir(n):n.toString()).join("|")})$`),t._zod.parse=(n,s)=>{let o=n.value;return t._zod.values.has(o)||n.issues.push({code:"invalid_value",values:r,input:o,inst:t}),n}}),Bh=b("$ZodLiteral",(t,e)=>{be.init(t,e),t._zod.values=new Set(e.values),t._zod.pattern=new RegExp(`^(${e.values.map(r=>typeof r=="string"?Ir(r):r?r.toString():String(r)).join("|")})$`),t._zod.parse=(r,n)=>{let s=r.value;return t._zod.values.has(s)||r.issues.push({code:"invalid_value",values:e.values,input:s,inst:t}),r}});var Gh=b("$ZodTransform",(t,e)=>{be.init(t,e),t._zod.parse=(r,n)=>{let s=e.transform(r.value,r);if(n.async)return(s instanceof Promise?s:Promise.resolve(s)).then(i=>(r.value=i,r));if(s instanceof Promise)throw new pr;return r.value=s,r}}),Wh=b("$ZodOptional",(t,e)=>{be.init(t,e),t._zod.optin="optional",t._zod.optout="optional",_e(t._zod,"values",()=>e.innerType._zod.values?new Set([...e.innerType._zod.values,void 0]):void 0),_e(t._zod,"pattern",()=>{let r=e.innerType._zod.pattern;return r?new RegExp(`^(${Hs(r.source)})?$`):void 0}),t._zod.parse=(r,n)=>e.innerType._zod.optin==="optional"?e.innerType._zod.run(r,n):r.value===void 0?r:e.innerType._zod.run(r,n)}),Jh=b("$ZodNullable",(t,e)=>{be.init(t,e),_e(t._zod,"optin",()=>e.innerType._zod.optin),_e(t._zod,"optout",()=>e.innerType._zod.optout),_e(t._zod,"pattern",()=>{let r=e.innerType._zod.pattern;return r?new RegExp(`^(${Hs(r.source)}|null)$`):void 0}),_e(t._zod,"values",()=>e.innerType._zod.values?new Set([...e.innerType._zod.values,null]):void 0),t._zod.parse=(r,n)=>r.value===null?r:e.innerType._zod.run(r,n)}),Yh=b("$ZodDefault",(t,e)=>{be.init(t,e),t._zod.optin="optional",_e(t._zod,"values",()=>e.innerType._zod.values),t._zod.parse=(r,n)=>{if(r.value===void 0)return r.value=e.defaultValue,r;let s=e.innerType._zod.run(r,n);return s instanceof Promise?s.then(o=>ah(o,e)):ah(s,e)}});function ah(t,e){return t.value===void 0&&(t.value=e.defaultValue),t}var Qh=b("$ZodPrefault",(t,e)=>{be.init(t,e),t._zod.optin="optional",_e(t._zod,"values",()=>e.innerType._zod.values),t._zod.parse=(r,n)=>(r.value===void 0&&(r.value=e.defaultValue),e.innerType._zod.run(r,n))}),Xh=b("$ZodNonOptional",(t,e)=>{be.init(t,e),_e(t._zod,"values",()=>{let r=e.innerType._zod.values;return r?new Set([...r].filter(n=>n!==void 0)):void 0}),t._zod.parse=(r,n)=>{let s=e.innerType._zod.run(r,n);return s instanceof Promise?s.then(o=>ch(o,t)):ch(s,t)}});function ch(t,e){return!t.issues.length&&t.value===void 0&&t.issues.push({code:"invalid_type",expected:"nonoptional",input:t.value,inst:e}),t}var eg=b("$ZodCatch",(t,e)=>{be.init(t,e),t._zod.optin="optional",_e(t._zod,"optout",()=>e.innerType._zod.optout),_e(t._zod,"values",()=>e.innerType._zod.values),t._zod.parse=(r,n)=>{let s=e.innerType._zod.run(r,n);return s instanceof Promise?s.then(o=>(r.value=o.value,o.issues.length&&(r.value=e.catchValue({...r,error:{issues:o.issues.map(i=>Rt(i,n,bt()))},input:r.value}),r.issues=[]),r)):(r.value=s.value,s.issues.length&&(r.value=e.catchValue({...r,error:{issues:s.issues.map(o=>Rt(o,n,bt()))},input:r.value}),r.issues=[]),r)}});var tg=b("$ZodPipe",(t,e)=>{be.init(t,e),_e(t._zod,"values",()=>e.in._zod.values),_e(t._zod,"optin",()=>e.in._zod.optin),_e(t._zod,"optout",()=>e.out._zod.optout),t._zod.parse=(r,n)=>{let s=e.in._zod.run(r,n);return s instanceof Promise?s.then(o=>uh(o,e,n)):uh(s,e,n)}});function uh(t,e,r){return hn(t)?t:e.out._zod.run({value:t.value,issues:t.issues},r)}var rg=b("$ZodReadonly",(t,e)=>{be.init(t,e),_e(t._zod,"propValues",()=>e.innerType._zod.propValues),_e(t._zod,"values",()=>e.innerType._zod.values),_e(t._zod,"optin",()=>e.innerType._zod.optin),_e(t._zod,"optout",()=>e.innerType._zod.optout),t._zod.parse=(r,n)=>{let s=e.innerType._zod.run(r,n);return s instanceof Promise?s.then(lh):lh(s)}});function lh(t){return t.value=Object.freeze(t.value),t}var ng=b("$ZodCustom",(t,e)=>{Ge.init(t,e),be.init(t,e),t._zod.parse=(r,n)=>r,t._zod.check=r=>{let n=r.value,s=e.fn(n);if(s instanceof Promise)return s.then(o=>dh(o,r,n,t));dh(s,r,n,t)}});function dh(t,e,r,n){if(!t){let s={code:"custom",input:r,inst:n,path:[...n._zod.def.path??[]],continue:!n._zod.def.abort};n._zod.def.params&&(s.params=n._zod.def.params),e.issues.push(Gc(s))}}var lk=t=>{let e=typeof t;switch(e){case"number":return Number.isNaN(t)?"NaN":"number";case"object":{if(Array.isArray(t))return"array";if(t===null)return"null";if(Object.getPrototypeOf(t)!==Object.prototype&&t.constructor)return t.constructor.name}}return e},dk=()=>{let t={string:{unit:"characters",verb:"to have"},file:{unit:"bytes",verb:"to have"},array:{unit:"items",verb:"to have"},set:{unit:"items",verb:"to have"}};function e(n){return t[n]??null}let r={regex:"input",email:"email address",url:"URL",emoji:"emoji",uuid:"UUID",uuidv4:"UUIDv4",uuidv6:"UUIDv6",nanoid:"nanoid",guid:"GUID",cuid:"cuid",cuid2:"cuid2",ulid:"ULID",xid:"XID",ksuid:"KSUID",datetime:"ISO datetime",date:"ISO date",time:"ISO time",duration:"ISO duration",ipv4:"IPv4 address",ipv6:"IPv6 address",cidrv4:"IPv4 range",cidrv6:"IPv6 range",base64:"base64-encoded string",base64url:"base64url-encoded string",json_string:"JSON string",e164:"E.164 number",jwt:"JWT",template_literal:"input"};return n=>{switch(n.code){case"invalid_type":return`Invalid input: expected ${n.expected}, received ${lk(n.input)}`;case"invalid_value":return n.values.length===1?`Invalid input: expected ${Ni(n.values[0])}`:`Invalid option: expected one of ${Ri(n.values,"|")}`;case"too_big":{let s=n.inclusive?"<=":"<",o=e(n.origin);return o?`Too big: expected ${n.origin??"value"} to have ${s}${n.maximum.toString()} ${o.unit??"elements"}`:`Too big: expected ${n.origin??"value"} to be ${s}${n.maximum.toString()}`}case"too_small":{let s=n.inclusive?">=":">",o=e(n.origin);return o?`Too small: expected ${n.origin} to have ${s}${n.minimum.toString()} ${o.unit}`:`Too small: expected ${n.origin} to be ${s}${n.minimum.toString()}`}case"invalid_format":{let s=n;return s.format==="starts_with"?`Invalid string: must start with "${s.prefix}"`:s.format==="ends_with"?`Invalid string: must end with "${s.suffix}"`:s.format==="includes"?`Invalid string: must include "${s.includes}"`:s.format==="regex"?`Invalid string: must match pattern ${s.pattern}`:`Invalid ${r[s.format]??n.format}`}case"not_multiple_of":return`Invalid number: must be a multiple of ${n.divisor}`;case"unrecognized_keys":return`Unrecognized key${n.keys.length>1?"s":""}: ${Ri(n.keys,", ")}`;case"invalid_key":return`Invalid key in ${n.origin}`;case"invalid_union":return"Invalid input";case"invalid_element":return`Invalid value in ${n.origin}`;default:return"Invalid input"}}};function sg(){return{localeError:dk()}}var iu=class{constructor(){this._map=new Map,this._idmap=new Map}add(e,...r){let n=r[0];if(this._map.set(e,n),n&&typeof n=="object"&&"id"in n){if(this._idmap.has(n.id))throw new Error(`ID ${n.id} already exists in the registry`);this._idmap.set(n.id,e)}return this}clear(){return this._map=new Map,this._idmap=new Map,this}remove(e){let r=this._map.get(e);return r&&typeof r=="object"&&"id"in r&&this._idmap.delete(r.id),this._map.delete(e),this}get(e){let r=e._zod.parent;if(r){let n={...this.get(r)??{}};return delete n.id,{...n,...this._map.get(e)}}return this._map.get(e)}has(e){return this._map.has(e)}};function pk(){return new iu}var Ws=pk();function og(t,e){return new t({type:"string",...M(e)})}function ig(t,e){return new t({type:"string",format:"email",check:"string_format",abort:!1,...M(e)})}function au(t,e){return new t({type:"string",format:"guid",check:"string_format",abort:!1,...M(e)})}function ag(t,e){return new t({type:"string",format:"uuid",check:"string_format",abort:!1,...M(e)})}function cg(t,e){return new t({type:"string",format:"uuid",check:"string_format",abort:!1,version:"v4",...M(e)})}function ug(t,e){return new t({type:"string",format:"uuid",check:"string_format",abort:!1,version:"v6",...M(e)})}function lg(t,e){return new t({type:"string",format:"uuid",check:"string_format",abort:!1,version:"v7",...M(e)})}function dg(t,e){return new t({type:"string",format:"url",check:"string_format",abort:!1,...M(e)})}function pg(t,e){return new t({type:"string",format:"emoji",check:"string_format",abort:!1,...M(e)})}function fg(t,e){return new t({type:"string",format:"nanoid",check:"string_format",abort:!1,...M(e)})}function mg(t,e){return new t({type:"string",format:"cuid",check:"string_format",abort:!1,...M(e)})}function hg(t,e){return new t({type:"string",format:"cuid2",check:"string_format",abort:!1,...M(e)})}function gg(t,e){return new t({type:"string",format:"ulid",check:"string_format",abort:!1,...M(e)})}function yg(t,e){return new t({type:"string",format:"xid",check:"string_format",abort:!1,...M(e)})}function vg(t,e){return new t({type:"string",format:"ksuid",check:"string_format",abort:!1,...M(e)})}function _g(t,e){return new t({type:"string",format:"ipv4",check:"string_format",abort:!1,...M(e)})}function bg(t,e){return new t({type:"string",format:"ipv6",check:"string_format",abort:!1,...M(e)})}function wg(t,e){return new t({type:"string",format:"cidrv4",check:"string_format",abort:!1,...M(e)})}function $g(t,e){return new t({type:"string",format:"cidrv6",check:"string_format",abort:!1,...M(e)})}function xg(t,e){return new t({type:"string",format:"base64",check:"string_format",abort:!1,...M(e)})}function kg(t,e){return new t({type:"string",format:"base64url",check:"string_format",abort:!1,...M(e)})}function Sg(t,e){return new t({type:"string",format:"e164",check:"string_format",abort:!1,...M(e)})}function Pg(t,e){return new t({type:"string",format:"jwt",check:"string_format",abort:!1,...M(e)})}function Eg(t,e){return new t({type:"string",format:"datetime",check:"string_format",offset:!1,local:!1,precision:null,...M(e)})}function Tg(t,e){return new t({type:"string",format:"date",check:"string_format",...M(e)})}function zg(t,e){return new t({type:"string",format:"time",check:"string_format",precision:null,...M(e)})}function Cg(t,e){return new t({type:"string",format:"duration",check:"string_format",...M(e)})}function Ig(t,e){return new t({type:"number",checks:[],...M(e)})}function Rg(t,e){return new t({type:"number",check:"number_format",abort:!1,format:"safeint",...M(e)})}function Og(t,e){return new t({type:"boolean",...M(e)})}function Ng(t,e){return new t({type:"null",...M(e)})}function jg(t){return new t({type:"unknown"})}function Ag(t,e){return new t({type:"never",...M(e)})}function Zi(t,e){return new tu({check:"less_than",...M(e),value:t,inclusive:!1})}function Js(t,e){return new tu({check:"less_than",...M(e),value:t,inclusive:!0})}function Li(t,e){return new ru({check:"greater_than",...M(e),value:t,inclusive:!1})}function Ys(t,e){return new ru({check:"greater_than",...M(e),value:t,inclusive:!0})}function Vi(t,e){return new Fm({check:"multiple_of",...M(e),value:t})}function Fi(t,e){return new Hm({check:"max_length",...M(e),maximum:t})}function Yn(t,e){return new Km({check:"min_length",...M(e),minimum:t})}function Ui(t,e){return new Bm({check:"length_equals",...M(e),length:t})}function cu(t,e){return new Gm({check:"string_format",format:"regex",...M(e),pattern:t})}function uu(t){return new Wm({check:"string_format",format:"lowercase",...M(t)})}function lu(t){return new Jm({check:"string_format",format:"uppercase",...M(t)})}function du(t,e){return new Ym({check:"string_format",format:"includes",...M(e),includes:t})}function pu(t,e){return new Qm({check:"string_format",format:"starts_with",...M(e),prefix:t})}function fu(t,e){return new Xm({check:"string_format",format:"ends_with",...M(e),suffix:t})}function gn(t){return new eh({check:"overwrite",tx:t})}function mu(t){return gn(e=>e.normalize(t))}function hu(){return gn(t=>t.trim())}function gu(){return gn(t=>t.toLowerCase())}function yu(){return gn(t=>t.toUpperCase())}function Mg(t,e,r){return new t({type:"array",element:e,...M(r)})}function qg(t,e,r){let n=M(r);return n.abort??(n.abort=!0),new t({type:"custom",check:"custom",fn:e,...n})}function Dg(t,e,r){return new t({type:"custom",check:"custom",fn:e,...M(r)})}function Qn(t){return!!t._zod}function Ot(t,e){return Qn(t)?Bs(t,e):t.safeParse(e)}function Hi(t){var e,r;if(!t)return;let n;if(Qn(t)?n=(r=(e=t._zod)===null||e===void 0?void 0:e.def)===null||r===void 0?void 0:r.shape:n=t.shape,!!n){if(typeof n=="function")try{return n()}catch{return}return n}}function Zg(t){var e;if(Qn(t)){let i=(e=t._zod)===null||e===void 0?void 0:e.def;if(i){if(i.value!==void 0)return i.value;if(Array.isArray(i.values)&&i.values.length>0)return i.values[0]}}let n=t._def;if(n){if(n.value!==void 0)return n.value;if(Array.isArray(n.values)&&n.values.length>0)return n.values[0]}let s=t.value;if(s!==void 0)return s}var Xs={};hi(Xs,{ZodISODate:()=>Vg,ZodISODateTime:()=>Lg,ZodISODuration:()=>Ug,ZodISOTime:()=>Fg,date:()=>_u,datetime:()=>vu,duration:()=>wu,time:()=>bu});var Lg=b("ZodISODateTime",(t,e)=>{xh.init(t,e),Te.init(t,e)});function vu(t){return Eg(Lg,t)}var Vg=b("ZodISODate",(t,e)=>{kh.init(t,e),Te.init(t,e)});function _u(t){return Tg(Vg,t)}var Fg=b("ZodISOTime",(t,e)=>{Sh.init(t,e),Te.init(t,e)});function bu(t){return zg(Fg,t)}var Ug=b("ZodISODuration",(t,e)=>{Ph.init(t,e),Te.init(t,e)});function wu(t){return Cg(Ug,t)}var Hg=(t,e)=>{ji.init(t,e),t.name="ZodError",Object.defineProperties(t,{format:{value:r=>lm(t,r)},flatten:{value:r=>um(t,r)},addIssue:{value:r=>t.issues.push(r)},addIssues:{value:r=>t.issues.push(...r)},isEmpty:{get(){return t.issues.length===0}}})},SD=b("ZodError",Hg),eo=b("ZodError",Hg,{Parent:Error});var Kg=dm(eo),Bg=pm(eo),Gg=Jc(eo),Wg=Yc(eo);var ze=b("ZodType",(t,e)=>(be.init(t,e),t.def=e,Object.defineProperty(t,"_def",{value:e}),t.check=(...r)=>t.clone({...e,checks:[...e.checks??[],...r.map(n=>typeof n=="function"?{_zod:{check:n,def:{check:"custom"},onattach:[]}}:n)]}),t.clone=(r,n)=>Bt(t,r,n),t.brand=()=>t,t.register=((r,n)=>(r.add(t,n),t)),t.parse=(r,n)=>Kg(t,r,n,{callee:t.parse}),t.safeParse=(r,n)=>Gg(t,r,n),t.parseAsync=async(r,n)=>Bg(t,r,n,{callee:t.parseAsync}),t.safeParseAsync=async(r,n)=>Wg(t,r,n),t.spa=t.safeParseAsync,t.refine=(r,n)=>t.check(uS(r,n)),t.superRefine=r=>t.check(lS(r)),t.overwrite=r=>t.check(gn(r)),t.optional=()=>I(t),t.nullable=()=>Qg(t),t.nullish=()=>I(Qg(t)),t.nonoptional=r=>rS(t,r),t.array=()=>re(t),t.or=r=>xe([t,r]),t.and=r=>Bi(t,r),t.transform=r=>xu(t,ny(r)),t.default=r=>Xk(t,r),t.prefault=r=>tS(t,r),t.catch=r=>sS(t,r),t.pipe=r=>xu(t,r),t.readonly=()=>aS(t),t.describe=r=>{let n=t.clone();return Ws.add(n,{description:r}),n},Object.defineProperty(t,"description",{get(){return Ws.get(t)?.description},configurable:!0}),t.meta=(...r)=>{if(r.length===0)return Ws.get(t);let n=t.clone();return Ws.add(n,r[0]),n},t.isOptional=()=>t.safeParse(void 0).success,t.isNullable=()=>t.safeParse(null).success,t)),Xg=b("_ZodString",(t,e)=>{Di.init(t,e),ze.init(t,e);let r=t._zod.bag;t.format=r.format??null,t.minLength=r.minimum??null,t.maxLength=r.maximum??null,t.regex=(...n)=>t.check(cu(...n)),t.includes=(...n)=>t.check(du(...n)),t.startsWith=(...n)=>t.check(pu(...n)),t.endsWith=(...n)=>t.check(fu(...n)),t.min=(...n)=>t.check(Yn(...n)),t.max=(...n)=>t.check(Fi(...n)),t.length=(...n)=>t.check(Ui(...n)),t.nonempty=(...n)=>t.check(Yn(1,...n)),t.lowercase=n=>t.check(uu(n)),t.uppercase=n=>t.check(lu(n)),t.trim=()=>t.check(hu()),t.normalize=(...n)=>t.check(mu(...n)),t.toLowerCase=()=>t.check(gu()),t.toUpperCase=()=>t.check(yu())}),wk=b("ZodString",(t,e)=>{Di.init(t,e),Xg.init(t,e),t.email=r=>t.check(ig($k,r)),t.url=r=>t.check(dg(xk,r)),t.jwt=r=>t.check(Pg(qk,r)),t.emoji=r=>t.check(pg(kk,r)),t.guid=r=>t.check(au(Jg,r)),t.uuid=r=>t.check(ag(Ki,r)),t.uuidv4=r=>t.check(cg(Ki,r)),t.uuidv6=r=>t.check(ug(Ki,r)),t.uuidv7=r=>t.check(lg(Ki,r)),t.nanoid=r=>t.check(fg(Sk,r)),t.guid=r=>t.check(au(Jg,r)),t.cuid=r=>t.check(mg(Pk,r)),t.cuid2=r=>t.check(hg(Ek,r)),t.ulid=r=>t.check(gg(Tk,r)),t.base64=r=>t.check(xg(jk,r)),t.base64url=r=>t.check(kg(Ak,r)),t.xid=r=>t.check(yg(zk,r)),t.ksuid=r=>t.check(vg(Ck,r)),t.ipv4=r=>t.check(_g(Ik,r)),t.ipv6=r=>t.check(bg(Rk,r)),t.cidrv4=r=>t.check(wg(Ok,r)),t.cidrv6=r=>t.check($g(Nk,r)),t.e164=r=>t.check(Sg(Mk,r)),t.datetime=r=>t.check(vu(r)),t.date=r=>t.check(_u(r)),t.time=r=>t.check(bu(r)),t.duration=r=>t.check(wu(r))});function _(t){return og(wk,t)}var Te=b("ZodStringFormat",(t,e)=>{$e.init(t,e),Xg.init(t,e)}),$k=b("ZodEmail",(t,e)=>{mh.init(t,e),Te.init(t,e)});var Jg=b("ZodGUID",(t,e)=>{ph.init(t,e),Te.init(t,e)});var Ki=b("ZodUUID",(t,e)=>{fh.init(t,e),Te.init(t,e)});var xk=b("ZodURL",(t,e)=>{hh.init(t,e),Te.init(t,e)});var kk=b("ZodEmoji",(t,e)=>{gh.init(t,e),Te.init(t,e)});var Sk=b("ZodNanoID",(t,e)=>{yh.init(t,e),Te.init(t,e)});var Pk=b("ZodCUID",(t,e)=>{vh.init(t,e),Te.init(t,e)});var Ek=b("ZodCUID2",(t,e)=>{_h.init(t,e),Te.init(t,e)});var Tk=b("ZodULID",(t,e)=>{bh.init(t,e),Te.init(t,e)});var zk=b("ZodXID",(t,e)=>{wh.init(t,e),Te.init(t,e)});var Ck=b("ZodKSUID",(t,e)=>{$h.init(t,e),Te.init(t,e)});var Ik=b("ZodIPv4",(t,e)=>{Eh.init(t,e),Te.init(t,e)});var Rk=b("ZodIPv6",(t,e)=>{Th.init(t,e),Te.init(t,e)});var Ok=b("ZodCIDRv4",(t,e)=>{zh.init(t,e),Te.init(t,e)});var Nk=b("ZodCIDRv6",(t,e)=>{Ch.init(t,e),Te.init(t,e)});var jk=b("ZodBase64",(t,e)=>{Rh.init(t,e),Te.init(t,e)});var Ak=b("ZodBase64URL",(t,e)=>{Oh.init(t,e),Te.init(t,e)});var Mk=b("ZodE164",(t,e)=>{Nh.init(t,e),Te.init(t,e)});var qk=b("ZodJWT",(t,e)=>{jh.init(t,e),Te.init(t,e)});var ey=b("ZodNumber",(t,e)=>{su.init(t,e),ze.init(t,e),t.gt=(n,s)=>t.check(Li(n,s)),t.gte=(n,s)=>t.check(Ys(n,s)),t.min=(n,s)=>t.check(Ys(n,s)),t.lt=(n,s)=>t.check(Zi(n,s)),t.lte=(n,s)=>t.check(Js(n,s)),t.max=(n,s)=>t.check(Js(n,s)),t.int=n=>t.check(Yg(n)),t.safe=n=>t.check(Yg(n)),t.positive=n=>t.check(Li(0,n)),t.nonnegative=n=>t.check(Ys(0,n)),t.negative=n=>t.check(Zi(0,n)),t.nonpositive=n=>t.check(Js(0,n)),t.multipleOf=(n,s)=>t.check(Vi(n,s)),t.step=(n,s)=>t.check(Vi(n,s)),t.finite=()=>t;let r=t._zod.bag;t.minValue=Math.max(r.minimum??Number.NEGATIVE_INFINITY,r.exclusiveMinimum??Number.NEGATIVE_INFINITY)??null,t.maxValue=Math.min(r.maximum??Number.POSITIVE_INFINITY,r.exclusiveMaximum??Number.POSITIVE_INFINITY)??null,t.isInt=(r.format??"").includes("int")||Number.isSafeInteger(r.multipleOf??.5),t.isFinite=!0,t.format=r.format??null});function he(t){return Ig(ey,t)}var Dk=b("ZodNumberFormat",(t,e)=>{Ah.init(t,e),ey.init(t,e)});function Yg(t){return Rg(Dk,t)}var Zk=b("ZodBoolean",(t,e)=>{Mh.init(t,e),ze.init(t,e)});function De(t){return Og(Zk,t)}var Lk=b("ZodNull",(t,e)=>{qh.init(t,e),ze.init(t,e)});function ku(t){return Ng(Lk,t)}var Vk=b("ZodUnknown",(t,e)=>{Dh.init(t,e),ze.init(t,e)});function Ne(){return jg(Vk)}var Fk=b("ZodNever",(t,e)=>{Zh.init(t,e),ze.init(t,e)});function Uk(t){return Ag(Fk,t)}var Hk=b("ZodArray",(t,e)=>{Lh.init(t,e),ze.init(t,e),t.element=e.element,t.min=(r,n)=>t.check(Yn(r,n)),t.nonempty=r=>t.check(Yn(1,r)),t.max=(r,n)=>t.check(Fi(r,n)),t.length=(r,n)=>t.check(Ui(r,n)),t.unwrap=()=>t.element});function re(t,e){return Mg(Hk,t,e)}var ty=b("ZodObject",(t,e)=>{Vh.init(t,e),ze.init(t,e),de.defineLazy(t,"shape",()=>e.shape),t.keyof=()=>Ze(Object.keys(t._zod.def.shape)),t.catchall=r=>t.clone({...t._zod.def,catchall:r}),t.passthrough=()=>t.clone({...t._zod.def,catchall:Ne()}),t.loose=()=>t.clone({...t._zod.def,catchall:Ne()}),t.strict=()=>t.clone({...t._zod.def,catchall:Uk()}),t.strip=()=>t.clone({...t._zod.def,catchall:void 0}),t.extend=r=>de.extend(t,r),t.merge=r=>de.merge(t,r),t.pick=r=>de.pick(t,r),t.omit=r=>de.omit(t,r),t.partial=(...r)=>de.partial(sy,t,r[0]),t.required=(...r)=>de.required(oy,t,r[0])});function P(t,e){let r={type:"object",get shape(){return de.assignProp(this,"shape",{...t}),this.shape},...de.normalizeParams(e)};return new ty(r)}function wt(t,e){return new ty({type:"object",get shape(){return de.assignProp(this,"shape",{...t}),this.shape},catchall:Ne(),...de.normalizeParams(e)})}var ry=b("ZodUnion",(t,e)=>{ou.init(t,e),ze.init(t,e),t.options=e.options});function xe(t,e){return new ry({type:"union",options:t,...de.normalizeParams(e)})}var Kk=b("ZodDiscriminatedUnion",(t,e)=>{ry.init(t,e),Fh.init(t,e)});function Su(t,e,r){return new Kk({type:"union",options:e,discriminator:t,...de.normalizeParams(r)})}var Bk=b("ZodIntersection",(t,e)=>{Uh.init(t,e),ze.init(t,e)});function Bi(t,e){return new Bk({type:"intersection",left:t,right:e})}var Gk=b("ZodRecord",(t,e)=>{Hh.init(t,e),ze.init(t,e),t.keyType=e.keyType,t.valueType=e.valueType});function je(t,e,r){return new Gk({type:"record",keyType:t,valueType:e,...de.normalizeParams(r)})}var $u=b("ZodEnum",(t,e)=>{Kh.init(t,e),ze.init(t,e),t.enum=e.entries,t.options=Object.values(e.entries);let r=new Set(Object.keys(e.entries));t.extract=(n,s)=>{let o={};for(let i of n)if(r.has(i))o[i]=e.entries[i];else throw new Error(`Key ${i} not found in enum`);return new $u({...e,checks:[],...de.normalizeParams(s),entries:o})},t.exclude=(n,s)=>{let o={...e.entries};for(let i of n)if(r.has(i))delete o[i];else throw new Error(`Key ${i} not found in enum`);return new $u({...e,checks:[],...de.normalizeParams(s),entries:o})}});function Ze(t,e){let r=Array.isArray(t)?Object.fromEntries(t.map(n=>[n,n])):t;return new $u({type:"enum",entries:r,...de.normalizeParams(e)})}var Wk=b("ZodLiteral",(t,e)=>{Bh.init(t,e),ze.init(t,e),t.values=new Set(e.values),Object.defineProperty(t,"value",{get(){if(e.values.length>1)throw new Error("This schema contains multiple valid literal values. Use `.values` instead.");return e.values[0]}})});function R(t,e){return new Wk({type:"literal",values:Array.isArray(t)?t:[t],...de.normalizeParams(e)})}var Jk=b("ZodTransform",(t,e)=>{Gh.init(t,e),ze.init(t,e),t._zod.parse=(r,n)=>{r.addIssue=o=>{if(typeof o=="string")r.issues.push(de.issue(o,r.value,e));else{let i=o;i.fatal&&(i.continue=!1),i.code??(i.code="custom"),i.input??(i.input=r.value),i.inst??(i.inst=t),i.continue??(i.continue=!0),r.issues.push(de.issue(i))}};let s=e.transform(r.value,r);return s instanceof Promise?s.then(o=>(r.value=o,r)):(r.value=s,r)}});function ny(t){return new Jk({type:"transform",transform:t})}var sy=b("ZodOptional",(t,e)=>{Wh.init(t,e),ze.init(t,e),t.unwrap=()=>t._zod.def.innerType});function I(t){return new sy({type:"optional",innerType:t})}var Yk=b("ZodNullable",(t,e)=>{Jh.init(t,e),ze.init(t,e),t.unwrap=()=>t._zod.def.innerType});function Qg(t){return new Yk({type:"nullable",innerType:t})}var Qk=b("ZodDefault",(t,e)=>{Yh.init(t,e),ze.init(t,e),t.unwrap=()=>t._zod.def.innerType,t.removeDefault=t.unwrap});function Xk(t,e){return new Qk({type:"default",innerType:t,get defaultValue(){return typeof e=="function"?e():e}})}var eS=b("ZodPrefault",(t,e)=>{Qh.init(t,e),ze.init(t,e),t.unwrap=()=>t._zod.def.innerType});function tS(t,e){return new eS({type:"prefault",innerType:t,get defaultValue(){return typeof e=="function"?e():e}})}var oy=b("ZodNonOptional",(t,e)=>{Xh.init(t,e),ze.init(t,e),t.unwrap=()=>t._zod.def.innerType});function rS(t,e){return new oy({type:"nonoptional",innerType:t,...de.normalizeParams(e)})}var nS=b("ZodCatch",(t,e)=>{eg.init(t,e),ze.init(t,e),t.unwrap=()=>t._zod.def.innerType,t.removeCatch=t.unwrap});function sS(t,e){return new nS({type:"catch",innerType:t,catchValue:typeof e=="function"?e:()=>e})}var oS=b("ZodPipe",(t,e)=>{tg.init(t,e),ze.init(t,e),t.in=e.in,t.out=e.out});function xu(t,e){return new oS({type:"pipe",in:t,out:e})}var iS=b("ZodReadonly",(t,e)=>{rg.init(t,e),ze.init(t,e)});function aS(t){return new iS({type:"readonly",innerType:t})}var iy=b("ZodCustom",(t,e)=>{ng.init(t,e),ze.init(t,e)});function cS(t){let e=new Ge({check:"custom"});return e._zod.check=t,e}function ay(t,e){return qg(iy,t??(()=>!0),e)}function uS(t,e={}){return Dg(iy,t,e)}function lS(t){let e=cS(r=>(r.addIssue=n=>{if(typeof n=="string")r.issues.push(de.issue(n,r.value,e._zod.def));else{let s=n;s.fatal&&(s.continue=!1),s.code??(s.code="custom"),s.input??(s.input=r.value),s.inst??(s.inst=e),s.continue??(s.continue=!e._zod.def.abort),r.issues.push(de.issue(s))}},t(r.value,r)));return e}function Pu(t,e){return xu(ny(t),e)}bt(sg());var Tu="2025-11-25";var cy=[Tu,"2025-06-18","2025-03-26","2024-11-05","2024-10-07"],Jt="io.modelcontextprotocol/related-task",Wi="2.0",Wt=ay(t=>t!==null&&(typeof t=="object"||typeof t=="function")),uy=xe([_(),he().int()]),ly=_(),dS=wt({ttl:xe([he(),ku()]).optional(),pollInterval:he().optional()}),zu=wt({taskId:_()}),pS=wt({progressToken:uy.optional(),[Jt]:zu.optional()}),ct=wt({task:dS.optional(),_meta:pS.optional()}),Le=P({method:_(),params:ct.optional()}),yn=wt({_meta:P({[Jt]:I(zu)}).passthrough().optional()}),$t=P({method:_(),params:yn.optional()}),We=wt({_meta:wt({[Jt]:zu.optional()}).optional()}),Ji=xe([_(),he().int()]),dy=P({jsonrpc:R(Wi),id:Ji,...Le.shape}).strict(),Cu=t=>dy.safeParse(t).success,py=P({jsonrpc:R(Wi),...$t.shape}).strict(),fy=t=>py.safeParse(t).success,my=P({jsonrpc:R(Wi),id:Ji,result:We}).strict(),to=t=>my.safeParse(t).success,Z;(function(t){t[t.ConnectionClosed=-32e3]="ConnectionClosed",t[t.RequestTimeout=-32001]="RequestTimeout",t[t.ParseError=-32700]="ParseError",t[t.InvalidRequest=-32600]="InvalidRequest",t[t.MethodNotFound=-32601]="MethodNotFound",t[t.InvalidParams=-32602]="InvalidParams",t[t.InternalError=-32603]="InternalError",t[t.UrlElicitationRequired=-32042]="UrlElicitationRequired"})(Z||(Z={}));var hy=P({jsonrpc:R(Wi),id:Ji,error:P({code:he().int(),message:_(),data:I(Ne())})}).strict(),gy=t=>hy.safeParse(t).success,yy=xe([dy,py,my,hy]),vn=We.strict(),fS=yn.extend({requestId:Ji,reason:_().optional()}),Yi=$t.extend({method:R("notifications/cancelled"),params:fS}),mS=P({src:_(),mimeType:_().optional(),sizes:re(_()).optional()}),ro=P({icons:re(mS).optional()}),Xn=P({name:_(),title:_().optional()}),vy=Xn.extend({...Xn.shape,...ro.shape,version:_(),websiteUrl:_().optional()}),hS=Bi(P({applyDefaults:De().optional()}),je(_(),Ne())),gS=Pu(t=>t&&typeof t=="object"&&!Array.isArray(t)&&Object.keys(t).length===0?{form:{}}:t,Bi(P({form:hS.optional(),url:Wt.optional()}),je(_(),Ne()).optional())),yS=P({list:I(P({}).passthrough()),cancel:I(P({}).passthrough()),requests:I(P({sampling:I(P({createMessage:I(P({}).passthrough())}).passthrough()),elicitation:I(P({create:I(P({}).passthrough())}).passthrough())}).passthrough())}).passthrough(),vS=P({list:I(P({}).passthrough()),cancel:I(P({}).passthrough()),requests:I(P({tools:I(P({call:I(P({}).passthrough())}).passthrough())}).passthrough())}).passthrough(),_S=P({experimental:je(_(),Wt).optional(),sampling:P({context:Wt.optional(),tools:Wt.optional()}).optional(),elicitation:gS.optional(),roots:P({listChanged:De().optional()}).optional(),tasks:I(yS)}),bS=ct.extend({protocolVersion:_(),capabilities:_S,clientInfo:vy}),wS=Le.extend({method:R("initialize"),params:bS});var $S=P({experimental:je(_(),Wt).optional(),logging:Wt.optional(),completions:Wt.optional(),prompts:I(P({listChanged:I(De())})),resources:P({subscribe:De().optional(),listChanged:De().optional()}).optional(),tools:P({listChanged:De().optional()}).optional(),tasks:I(vS)}).passthrough(),Iu=We.extend({protocolVersion:_(),capabilities:$S,serverInfo:vy,instructions:_().optional()}),xS=$t.extend({method:R("notifications/initialized")});var Qi=Le.extend({method:R("ping")}),kS=P({progress:he(),total:I(he()),message:I(_())}),SS=P({...yn.shape,...kS.shape,progressToken:uy}),Xi=$t.extend({method:R("notifications/progress"),params:SS}),PS=ct.extend({cursor:ly.optional()}),no=Le.extend({params:PS.optional()}),so=We.extend({nextCursor:I(ly)}),oo=P({taskId:_(),status:Ze(["working","input_required","completed","failed","cancelled"]),ttl:xe([he(),ku()]),createdAt:_(),lastUpdatedAt:_(),pollInterval:I(he()),statusMessage:I(_())}),_n=We.extend({task:oo}),ES=yn.merge(oo),io=$t.extend({method:R("notifications/tasks/status"),params:ES}),ea=Le.extend({method:R("tasks/get"),params:ct.extend({taskId:_()})}),ta=We.merge(oo),ra=Le.extend({method:R("tasks/result"),params:ct.extend({taskId:_()})}),na=no.extend({method:R("tasks/list")}),sa=so.extend({tasks:re(oo)}),_y=Le.extend({method:R("tasks/cancel"),params:ct.extend({taskId:_()})}),by=We.merge(oo),wy=P({uri:_(),mimeType:I(_()),_meta:je(_(),Ne()).optional()}),$y=wy.extend({text:_()}),Ru=_().refine(t=>{try{return atob(t),!0}catch{return!1}},{message:"Invalid Base64 string"}),xy=wy.extend({blob:Ru}),es=P({audience:re(Ze(["user","assistant"])).optional(),priority:he().min(0).max(1).optional(),lastModified:Xs.datetime({offset:!0}).optional()}),ky=P({...Xn.shape,...ro.shape,uri:_(),description:I(_()),mimeType:I(_()),annotations:es.optional(),_meta:I(wt({}))}),TS=P({...Xn.shape,...ro.shape,uriTemplate:_(),description:I(_()),mimeType:I(_()),annotations:es.optional(),_meta:I(wt({}))}),zS=no.extend({method:R("resources/list")}),Ou=so.extend({resources:re(ky)}),CS=no.extend({method:R("resources/templates/list")}),Nu=so.extend({resourceTemplates:re(TS)}),ju=ct.extend({uri:_()}),IS=ju,RS=Le.extend({method:R("resources/read"),params:IS}),Au=We.extend({contents:re(xe([$y,xy]))}),OS=$t.extend({method:R("notifications/resources/list_changed")}),NS=ju,jS=Le.extend({method:R("resources/subscribe"),params:NS}),AS=ju,MS=Le.extend({method:R("resources/unsubscribe"),params:AS}),qS=yn.extend({uri:_()}),DS=$t.extend({method:R("notifications/resources/updated"),params:qS}),ZS=P({name:_(),description:I(_()),required:I(De())}),LS=P({...Xn.shape,...ro.shape,description:I(_()),arguments:I(re(ZS)),_meta:I(wt({}))}),VS=no.extend({method:R("prompts/list")}),Mu=so.extend({prompts:re(LS)}),FS=ct.extend({name:_(),arguments:je(_(),_()).optional()}),US=Le.extend({method:R("prompts/get"),params:FS}),qu=P({type:R("text"),text:_(),annotations:es.optional(),_meta:je(_(),Ne()).optional()}),Du=P({type:R("image"),data:Ru,mimeType:_(),annotations:es.optional(),_meta:je(_(),Ne()).optional()}),Zu=P({type:R("audio"),data:Ru,mimeType:_(),annotations:es.optional(),_meta:je(_(),Ne()).optional()}),HS=P({type:R("tool_use"),name:_(),id:_(),input:P({}).passthrough(),_meta:I(P({}).passthrough())}).passthrough(),KS=P({type:R("resource"),resource:xe([$y,xy]),annotations:es.optional(),_meta:je(_(),Ne()).optional()}),BS=ky.extend({type:R("resource_link")}),Lu=xe([qu,Du,Zu,BS,KS]),GS=P({role:Ze(["user","assistant"]),content:Lu}),Vu=We.extend({description:I(_()),messages:re(GS)}),WS=$t.extend({method:R("notifications/prompts/list_changed")}),JS=P({title:_().optional(),readOnlyHint:De().optional(),destructiveHint:De().optional(),idempotentHint:De().optional(),openWorldHint:De().optional()}),YS=P({taskSupport:Ze(["required","optional","forbidden"]).optional()}),Sy=P({...Xn.shape,...ro.shape,description:_().optional(),inputSchema:P({type:R("object"),properties:je(_(),Wt).optional(),required:re(_()).optional()}).catchall(Ne()),outputSchema:P({type:R("object"),properties:je(_(),Wt).optional(),required:re(_()).optional()}).catchall(Ne()).optional(),annotations:I(JS),execution:I(YS),_meta:je(_(),Ne()).optional()}),QS=no.extend({method:R("tools/list")}),Fu=so.extend({tools:re(Sy)}),ts=We.extend({content:re(Lu).default([]),structuredContent:je(_(),Ne()).optional(),isError:I(De())}),vZ=ts.or(We.extend({toolResult:Ne()})),XS=ct.extend({name:_(),arguments:I(je(_(),Ne()))}),eP=Le.extend({method:R("tools/call"),params:XS}),tP=$t.extend({method:R("notifications/tools/list_changed")}),Py=Ze(["debug","info","notice","warning","error","critical","alert","emergency"]),rP=ct.extend({level:Py}),nP=Le.extend({method:R("logging/setLevel"),params:rP}),sP=yn.extend({level:Py,logger:_().optional(),data:Ne()}),oP=$t.extend({method:R("notifications/message"),params:sP}),iP=P({name:_().optional()}),aP=P({hints:I(re(iP)),costPriority:I(he().min(0).max(1)),speedPriority:I(he().min(0).max(1)),intelligencePriority:I(he().min(0).max(1))}),cP=P({mode:I(Ze(["auto","required","none"]))}),uP=P({type:R("tool_result"),toolUseId:_().describe("The unique identifier for the corresponding tool call."),content:re(Lu).default([]),structuredContent:P({}).passthrough().optional(),isError:I(De()),_meta:I(P({}).passthrough())}).passthrough(),lP=Su("type",[qu,Du,Zu]),Gi=Su("type",[qu,Du,Zu,HS,uP]),dP=P({role:Ze(["user","assistant"]),content:xe([Gi,re(Gi)]),_meta:I(P({}).passthrough())}).passthrough(),pP=ct.extend({messages:re(dP),modelPreferences:aP.optional(),systemPrompt:_().optional(),includeContext:Ze(["none","thisServer","allServers"]).optional(),temperature:he().optional(),maxTokens:he().int(),stopSequences:re(_()).optional(),metadata:Wt.optional(),tools:I(re(Sy)),toolChoice:I(cP)}),Uu=Le.extend({method:R("sampling/createMessage"),params:pP}),Hu=We.extend({model:_(),stopReason:I(Ze(["endTurn","stopSequence","maxTokens"]).or(_())),role:Ze(["user","assistant"]),content:lP}),fP=We.extend({model:_(),stopReason:I(Ze(["endTurn","stopSequence","maxTokens","toolUse"]).or(_())),role:Ze(["user","assistant"]),content:xe([Gi,re(Gi)])}),mP=P({type:R("boolean"),title:_().optional(),description:_().optional(),default:De().optional()}),hP=P({type:R("string"),title:_().optional(),description:_().optional(),minLength:he().optional(),maxLength:he().optional(),format:Ze(["email","uri","date","date-time"]).optional(),default:_().optional()}),gP=P({type:Ze(["number","integer"]),title:_().optional(),description:_().optional(),minimum:he().optional(),maximum:he().optional(),default:he().optional()}),yP=P({type:R("string"),title:_().optional(),description:_().optional(),enum:re(_()),default:_().optional()}),vP=P({type:R("string"),title:_().optional(),description:_().optional(),oneOf:re(P({const:_(),title:_()})),default:_().optional()}),_P=P({type:R("string"),title:_().optional(),description:_().optional(),enum:re(_()),enumNames:re(_()).optional(),default:_().optional()}),bP=xe([yP,vP]),wP=P({type:R("array"),title:_().optional(),description:_().optional(),minItems:he().optional(),maxItems:he().optional(),items:P({type:R("string"),enum:re(_())}),default:re(_()).optional()}),$P=P({type:R("array"),title:_().optional(),description:_().optional(),minItems:he().optional(),maxItems:he().optional(),items:P({anyOf:re(P({const:_(),title:_()}))}),default:re(_()).optional()}),xP=xe([wP,$P]),kP=xe([_P,bP,xP]),SP=xe([kP,mP,hP,gP]),PP=ct.extend({mode:R("form").optional(),message:_(),requestedSchema:P({type:R("object"),properties:je(_(),SP),required:re(_()).optional()})}),EP=ct.extend({mode:R("url"),message:_(),elicitationId:_(),url:_().url()}),TP=xe([PP,EP]),Ku=Le.extend({method:R("elicitation/create"),params:TP}),zP=yn.extend({elicitationId:_()}),CP=$t.extend({method:R("notifications/elicitation/complete"),params:zP}),Bu=We.extend({action:Ze(["accept","decline","cancel"]),content:Pu(t=>t===null?void 0:t,je(_(),xe([_(),he(),De(),re(_())])).optional())}),IP=P({type:R("ref/resource"),uri:_()});var RP=P({type:R("ref/prompt"),name:_()}),OP=ct.extend({ref:xe([RP,IP]),argument:P({name:_(),value:_()}),context:P({arguments:je(_(),_()).optional()}).optional()}),NP=Le.extend({method:R("completion/complete"),params:OP});var Gu=We.extend({completion:wt({values:re(_()).max(100),total:I(he().int()),hasMore:I(De())})}),jP=P({uri:_().startsWith("file://"),name:_().optional(),_meta:je(_(),Ne()).optional()}),AP=Le.extend({method:R("roots/list")}),MP=We.extend({roots:re(jP)}),qP=$t.extend({method:R("notifications/roots/list_changed")}),_Z=xe([Qi,wS,NP,nP,US,VS,zS,CS,RS,jS,MS,eP,QS,ea,ra,na]),bZ=xe([Yi,Xi,xS,qP,io]),wZ=xe([vn,Hu,fP,Bu,MP,ta,sa,_n]),$Z=xe([Qi,Uu,Ku,AP,ea,ra,na]),xZ=xe([Yi,Xi,oP,DS,OS,tP,WS,io,CP]),kZ=xe([vn,Iu,Gu,Vu,Mu,Ou,Nu,Au,ts,Fu,ta,sa,_n]),j=class t extends Error{constructor(e,r,n){super(`MCP error ${e}: ${r}`),this.code=e,this.data=n,this.name="McpError"}static fromError(e,r,n){if(e===Z.UrlElicitationRequired&&n){let s=n;if(s.elicitations)return new Eu(s.elicitations,r)}return new t(e,r,n)}},Eu=class extends j{constructor(e,r=`URL elicitation${e.length>1?"s":""} required`){super(Z.UrlElicitationRequired,r,{elicitations:e})}get elicitations(){var e,r;return(r=(e=this.data)===null||e===void 0?void 0:e.elicitations)!==null&&r!==void 0?r:[]}};function Rr(t){return t==="completed"||t==="failed"||t==="cancelled"}var n9=new Set("ABCDEFGHIJKLMNOPQRSTUVXYZabcdefghijklmnopqrstuvxyz0123456789");function Wu(t){let e=Hi(t),r=e?.method;if(!r)throw new Error("Schema is missing a method literal");let n=Zg(r);if(typeof n!="string")throw new Error("Schema method literal must be a string");return n}function Ju(t,e){let r=Ot(t,e);if(!r.success)throw r.error;return r.data}var UP=6e4,oa=class{constructor(e){this._options=e,this._requestMessageId=0,this._requestHandlers=new Map,this._requestHandlerAbortControllers=new Map,this._notificationHandlers=new Map,this._responseHandlers=new Map,this._progressHandlers=new Map,this._timeoutInfo=new Map,this._pendingDebouncedNotifications=new Set,this._taskProgressTokens=new Map,this._requestResolvers=new Map,this.setNotificationHandler(Yi,r=>{this._oncancel(r)}),this.setNotificationHandler(Xi,r=>{this._onprogress(r)}),this.setRequestHandler(Qi,r=>({})),this._taskStore=e?.taskStore,this._taskMessageQueue=e?.taskMessageQueue,this._taskStore&&(this.setRequestHandler(ea,async(r,n)=>{let s=await this._taskStore.getTask(r.params.taskId,n.sessionId);if(!s)throw new j(Z.InvalidParams,"Failed to retrieve task: Task not found");return{...s}}),this.setRequestHandler(ra,async(r,n)=>{let s=async()=>{var o;let i=r.params.taskId;if(this._taskMessageQueue){let c;for(;c=await this._taskMessageQueue.dequeue(i,n.sessionId);){if(c.type==="response"||c.type==="error"){let u=c.message,l=u.id,d=this._requestResolvers.get(l);if(d)if(this._requestResolvers.delete(l),c.type==="response")d(u);else{let f=u,p=new j(f.error.code,f.error.message,f.error.data);d(p)}else{let f=c.type==="response"?"Response":"Error";this._onerror(new Error(`${f} handler missing for request ${l}`))}continue}await((o=this._transport)===null||o===void 0?void 0:o.send(c.message,{relatedRequestId:n.requestId}))}}let a=await this._taskStore.getTask(i,n.sessionId);if(!a)throw new j(Z.InvalidParams,`Task not found: ${i}`);if(!Rr(a.status))return await this._waitForTaskUpdate(i,n.signal),await s();if(Rr(a.status)){let c=await this._taskStore.getTaskResult(i,n.sessionId);return this._clearTaskQueue(i),{...c,_meta:{...c._meta,[Jt]:{taskId:i}}}}return await s()};return await s()}),this.setRequestHandler(na,async(r,n)=>{var s;try{let{tasks:o,nextCursor:i}=await this._taskStore.listTasks((s=r.params)===null||s===void 0?void 0:s.cursor,n.sessionId);return{tasks:o,nextCursor:i,_meta:{}}}catch(o){throw new j(Z.InvalidParams,`Failed to list tasks: ${o instanceof Error?o.message:String(o)}`)}}),this.setRequestHandler(_y,async(r,n)=>{try{let s=await this._taskStore.getTask(r.params.taskId,n.sessionId);if(!s)throw new j(Z.InvalidParams,`Task not found: ${r.params.taskId}`);if(Rr(s.status))throw new j(Z.InvalidParams,`Cannot cancel task in terminal status: ${s.status}`);await this._taskStore.updateTaskStatus(r.params.taskId,"cancelled","Client cancelled task execution.",n.sessionId),this._clearTaskQueue(r.params.taskId);let o=await this._taskStore.getTask(r.params.taskId,n.sessionId);if(!o)throw new j(Z.InvalidParams,`Task not found after cancellation: ${r.params.taskId}`);return{_meta:{},...o}}catch(s){throw s instanceof j?s:new j(Z.InvalidRequest,`Failed to cancel task: ${s instanceof Error?s.message:String(s)}`)}}))}async _oncancel(e){let r=this._requestHandlerAbortControllers.get(e.params.requestId);r?.abort(e.params.reason)}_setupTimeout(e,r,n,s,o=!1){this._timeoutInfo.set(e,{timeoutId:setTimeout(s,r),startTime:Date.now(),timeout:r,maxTotalTimeout:n,resetTimeoutOnProgress:o,onTimeout:s})}_resetTimeout(e){let r=this._timeoutInfo.get(e);if(!r)return!1;let n=Date.now()-r.startTime;if(r.maxTotalTimeout&&n>=r.maxTotalTimeout)throw this._timeoutInfo.delete(e),j.fromError(Z.RequestTimeout,"Maximum total timeout exceeded",{maxTotalTimeout:r.maxTotalTimeout,totalElapsed:n});return clearTimeout(r.timeoutId),r.timeoutId=setTimeout(r.onTimeout,r.timeout),!0}_cleanupTimeout(e){let r=this._timeoutInfo.get(e);r&&(clearTimeout(r.timeoutId),this._timeoutInfo.delete(e))}async connect(e){var r,n,s;this._transport=e;let o=(r=this.transport)===null||r===void 0?void 0:r.onclose;this._transport.onclose=()=>{o?.(),this._onclose()};let i=(n=this.transport)===null||n===void 0?void 0:n.onerror;this._transport.onerror=c=>{i?.(c),this._onerror(c)};let a=(s=this._transport)===null||s===void 0?void 0:s.onmessage;this._transport.onmessage=(c,u)=>{a?.(c,u),to(c)||gy(c)?this._onresponse(c):Cu(c)?this._onrequest(c,u):fy(c)?this._onnotification(c):this._onerror(new Error(`Unknown message type: ${JSON.stringify(c)}`))},await this._transport.start()}_onclose(){var e;let r=this._responseHandlers;this._responseHandlers=new Map,this._progressHandlers.clear(),this._taskProgressTokens.clear(),this._pendingDebouncedNotifications.clear();let n=j.fromError(Z.ConnectionClosed,"Connection closed");this._transport=void 0,(e=this.onclose)===null||e===void 0||e.call(this);for(let s of r.values())s(n)}_onerror(e){var r;(r=this.onerror)===null||r===void 0||r.call(this,e)}_onnotification(e){var r;let n=(r=this._notificationHandlers.get(e.method))!==null&&r!==void 0?r:this.fallbackNotificationHandler;n!==void 0&&Promise.resolve().then(()=>n(e)).catch(s=>this._onerror(new Error(`Uncaught error in notification handler: ${s}`)))}_onrequest(e,r){var n,s,o,i,a,c;let u=(n=this._requestHandlers.get(e.method))!==null&&n!==void 0?n:this.fallbackRequestHandler,l=this._transport,d=(i=(o=(s=e.params)===null||s===void 0?void 0:s._meta)===null||o===void 0?void 0:o[Jt])===null||i===void 0?void 0:i.taskId;if(u===void 0){let g={jsonrpc:"2.0",id:e.id,error:{code:Z.MethodNotFound,message:"Method not found"}};d&&this._taskMessageQueue?this._enqueueTaskMessage(d,{type:"error",message:g,timestamp:Date.now()},l?.sessionId).catch(y=>this._onerror(new Error(`Failed to enqueue error response: ${y}`))):l?.send(g).catch(y=>this._onerror(new Error(`Failed to send an error response: ${y}`)));return}let f=new AbortController;this._requestHandlerAbortControllers.set(e.id,f);let p=(a=e.params)===null||a===void 0?void 0:a.task,m=this._taskStore?this.requestTaskStore(e,l?.sessionId):void 0,h={signal:f.signal,sessionId:l?.sessionId,_meta:(c=e.params)===null||c===void 0?void 0:c._meta,sendNotification:async g=>{let y={relatedRequestId:e.id};d&&(y.relatedTask={taskId:d}),await this.notification(g,y)},sendRequest:async(g,y,x)=>{var $,S;let w={...x,relatedRequestId:e.id};d&&!w.relatedTask&&(w.relatedTask={taskId:d});let D=(S=($=w.relatedTask)===null||$===void 0?void 0:$.taskId)!==null&&S!==void 0?S:d;return D&&m&&await m.updateTaskStatus(D,"input_required"),await this.request(g,y,w)},authInfo:r?.authInfo,requestId:e.id,requestInfo:r?.requestInfo,taskId:d,taskStore:m,taskRequestedTtl:p?.ttl,closeSSEStream:r?.closeSSEStream,closeStandaloneSSEStream:r?.closeStandaloneSSEStream};Promise.resolve().then(()=>{p&&this.assertTaskHandlerCapability(e.method)}).then(()=>u(e,h)).then(async g=>{if(f.signal.aborted)return;let y={result:g,jsonrpc:"2.0",id:e.id};d&&this._taskMessageQueue?await this._enqueueTaskMessage(d,{type:"response",message:y,timestamp:Date.now()},l?.sessionId):await l?.send(y)},async g=>{var y;if(f.signal.aborted)return;let x={jsonrpc:"2.0",id:e.id,error:{code:Number.isSafeInteger(g.code)?g.code:Z.InternalError,message:(y=g.message)!==null&&y!==void 0?y:"Internal error",...g.data!==void 0&&{data:g.data}}};d&&this._taskMessageQueue?await this._enqueueTaskMessage(d,{type:"error",message:x,timestamp:Date.now()},l?.sessionId):await l?.send(x)}).catch(g=>this._onerror(new Error(`Failed to send response: ${g}`))).finally(()=>{this._requestHandlerAbortControllers.delete(e.id)})}_onprogress(e){let{progressToken:r,...n}=e.params,s=Number(r),o=this._progressHandlers.get(s);if(!o){this._onerror(new Error(`Received a progress notification for an unknown token: ${JSON.stringify(e)}`));return}let i=this._responseHandlers.get(s),a=this._timeoutInfo.get(s);if(a&&i&&a.resetTimeoutOnProgress)try{this._resetTimeout(s)}catch(c){this._responseHandlers.delete(s),this._progressHandlers.delete(s),this._cleanupTimeout(s),i(c);return}o(n)}_onresponse(e){let r=Number(e.id),n=this._requestResolvers.get(r);if(n){if(this._requestResolvers.delete(r),to(e))n(e);else{let i=new j(e.error.code,e.error.message,e.error.data);n(i)}return}let s=this._responseHandlers.get(r);if(s===void 0){this._onerror(new Error(`Received a response for an unknown message ID: ${JSON.stringify(e)}`));return}this._responseHandlers.delete(r),this._cleanupTimeout(r);let o=!1;if(to(e)&&e.result&&typeof e.result=="object"){let i=e.result;if(i.task&&typeof i.task=="object"){let a=i.task;typeof a.taskId=="string"&&(o=!0,this._taskProgressTokens.set(a.taskId,r))}}if(o||this._progressHandlers.delete(r),to(e))s(e);else{let i=j.fromError(e.error.code,e.error.message,e.error.data);s(i)}}get transport(){return this._transport}async close(){var e;await((e=this._transport)===null||e===void 0?void 0:e.close())}async*requestStream(e,r,n){var s,o,i,a;let{task:c}=n??{};if(!c){try{yield{type:"result",result:await this.request(e,r,n)}}catch(l){yield{type:"error",error:l instanceof j?l:new j(Z.InternalError,String(l))}}return}let u;try{let l=await this.request(e,_n,n);if(l.task)u=l.task.taskId,yield{type:"taskCreated",task:l.task};else throw new j(Z.InternalError,"Task creation did not return a task");for(;;){let d=await this.getTask({taskId:u},n);if(yield{type:"taskStatus",task:d},Rr(d.status)){d.status==="completed"?yield{type:"result",result:await this.getTaskResult({taskId:u},r,n)}:d.status==="failed"?yield{type:"error",error:new j(Z.InternalError,`Task ${u} failed`)}:d.status==="cancelled"&&(yield{type:"error",error:new j(Z.InternalError,`Task ${u} was cancelled`)});return}if(d.status==="input_required"){yield{type:"result",result:await this.getTaskResult({taskId:u},r,n)};return}let f=(i=(s=d.pollInterval)!==null&&s!==void 0?s:(o=this._options)===null||o===void 0?void 0:o.defaultTaskPollInterval)!==null&&i!==void 0?i:1e3;await new Promise(p=>setTimeout(p,f)),(a=n?.signal)===null||a===void 0||a.throwIfAborted()}}catch(l){yield{type:"error",error:l instanceof j?l:new j(Z.InternalError,String(l))}}}request(e,r,n){let{relatedRequestId:s,resumptionToken:o,onresumptiontoken:i,task:a,relatedTask:c}=n??{};return new Promise((u,l)=>{var d,f,p,m,h,g,y;let x=H=>{l(H)};if(!this._transport){x(new Error("Not connected"));return}if(((d=this._options)===null||d===void 0?void 0:d.enforceStrictCapabilities)===!0)try{this.assertCapabilityForMethod(e.method),a&&this.assertTaskCapability(e.method)}catch(H){x(H);return}(f=n?.signal)===null||f===void 0||f.throwIfAborted();let $=this._requestMessageId++,S={...e,jsonrpc:"2.0",id:$};n?.onprogress&&(this._progressHandlers.set($,n.onprogress),S.params={...e.params,_meta:{...((p=e.params)===null||p===void 0?void 0:p._meta)||{},progressToken:$}}),a&&(S.params={...S.params,task:a}),c&&(S.params={...S.params,_meta:{...((m=S.params)===null||m===void 0?void 0:m._meta)||{},[Jt]:c}});let w=H=>{var we;this._responseHandlers.delete($),this._progressHandlers.delete($),this._cleanupTimeout($),(we=this._transport)===null||we===void 0||we.send({jsonrpc:"2.0",method:"notifications/cancelled",params:{requestId:$,reason:String(H)}},{relatedRequestId:s,resumptionToken:o,onresumptiontoken:i}).catch(Gr=>this._onerror(new Error(`Failed to send cancellation: ${Gr}`)));let Ae=H instanceof j?H:new j(Z.RequestTimeout,String(H));l(Ae)};this._responseHandlers.set($,H=>{var we;if(!(!((we=n?.signal)===null||we===void 0)&&we.aborted)){if(H instanceof Error)return l(H);try{let Ae=Ot(r,H.result);Ae.success?u(Ae.data):l(Ae.error)}catch(Ae){l(Ae)}}}),(h=n?.signal)===null||h===void 0||h.addEventListener("abort",()=>{var H;w((H=n?.signal)===null||H===void 0?void 0:H.reason)});let D=(g=n?.timeout)!==null&&g!==void 0?g:UP,F=()=>w(j.fromError(Z.RequestTimeout,"Request timed out",{timeout:D}));this._setupTimeout($,D,n?.maxTotalTimeout,F,(y=n?.resetTimeoutOnProgress)!==null&&y!==void 0?y:!1);let Ce=c?.taskId;if(Ce){let H=we=>{let Ae=this._responseHandlers.get($);Ae?Ae(we):this._onerror(new Error(`Response handler missing for side-channeled request ${$}`))};this._requestResolvers.set($,H),this._enqueueTaskMessage(Ce,{type:"request",message:S,timestamp:Date.now()}).catch(we=>{this._cleanupTimeout($),l(we)})}else this._transport.send(S,{relatedRequestId:s,resumptionToken:o,onresumptiontoken:i}).catch(H=>{this._cleanupTimeout($),l(H)})})}async getTask(e,r){return this.request({method:"tasks/get",params:e},ta,r)}async getTaskResult(e,r,n){return this.request({method:"tasks/result",params:e},r,n)}async listTasks(e,r){return this.request({method:"tasks/list",params:e},sa,r)}async cancelTask(e,r){return this.request({method:"tasks/cancel",params:e},by,r)}async notification(e,r){var n,s,o,i,a;if(!this._transport)throw new Error("Not connected");this.assertNotificationCapability(e.method);let c=(n=r?.relatedTask)===null||n===void 0?void 0:n.taskId;if(c){let f={...e,jsonrpc:"2.0",params:{...e.params,_meta:{...((s=e.params)===null||s===void 0?void 0:s._meta)||{},[Jt]:r.relatedTask}}};await this._enqueueTaskMessage(c,{type:"notification",message:f,timestamp:Date.now()});return}if(((i=(o=this._options)===null||o===void 0?void 0:o.debouncedNotificationMethods)!==null&&i!==void 0?i:[]).includes(e.method)&&!e.params&&!r?.relatedRequestId&&!r?.relatedTask){if(this._pendingDebouncedNotifications.has(e.method))return;this._pendingDebouncedNotifications.add(e.method),Promise.resolve().then(()=>{var f,p;if(this._pendingDebouncedNotifications.delete(e.method),!this._transport)return;let m={...e,jsonrpc:"2.0"};r?.relatedTask&&(m={...m,params:{...m.params,_meta:{...((f=m.params)===null||f===void 0?void 0:f._meta)||{},[Jt]:r.relatedTask}}}),(p=this._transport)===null||p===void 0||p.send(m,r).catch(h=>this._onerror(h))});return}let d={...e,jsonrpc:"2.0"};r?.relatedTask&&(d={...d,params:{...d.params,_meta:{...((a=d.params)===null||a===void 0?void 0:a._meta)||{},[Jt]:r.relatedTask}}}),await this._transport.send(d,r)}setRequestHandler(e,r){let n=Wu(e);this.assertRequestHandlerCapability(n),this._requestHandlers.set(n,(s,o)=>{let i=Ju(e,s);return Promise.resolve(r(i,o))})}removeRequestHandler(e){this._requestHandlers.delete(e)}assertCanSetRequestHandler(e){if(this._requestHandlers.has(e))throw new Error(`A request handler for ${e} already exists, which would be overridden`)}setNotificationHandler(e,r){let n=Wu(e);this._notificationHandlers.set(n,s=>{let o=Ju(e,s);return Promise.resolve(r(o))})}removeNotificationHandler(e){this._notificationHandlers.delete(e)}_cleanupTaskProgressHandler(e){let r=this._taskProgressTokens.get(e);r!==void 0&&(this._progressHandlers.delete(r),this._taskProgressTokens.delete(e))}async _enqueueTaskMessage(e,r,n){var s;if(!this._taskStore||!this._taskMessageQueue)throw new Error("Cannot enqueue task message: taskStore and taskMessageQueue are not configured");let o=(s=this._options)===null||s===void 0?void 0:s.maxTaskQueueSize;await this._taskMessageQueue.enqueue(e,r,n,o)}async _clearTaskQueue(e,r){if(this._taskMessageQueue){let n=await this._taskMessageQueue.dequeueAll(e,r);for(let s of n)if(s.type==="request"&&Cu(s.message)){let o=s.message.id,i=this._requestResolvers.get(o);i?(i(new j(Z.InternalError,"Task cancelled or completed")),this._requestResolvers.delete(o)):this._onerror(new Error(`Resolver missing for request ${o} during task ${e} cleanup`))}}}async _waitForTaskUpdate(e,r){var n,s,o;let i=(s=(n=this._options)===null||n===void 0?void 0:n.defaultTaskPollInterval)!==null&&s!==void 0?s:1e3;try{let a=await((o=this._taskStore)===null||o===void 0?void 0:o.getTask(e));a?.pollInterval&&(i=a.pollInterval)}catch{}return new Promise((a,c)=>{if(r.aborted){c(new j(Z.InvalidRequest,"Request cancelled"));return}let u=setTimeout(a,i);r.addEventListener("abort",()=>{clearTimeout(u),c(new j(Z.InvalidRequest,"Request cancelled"))},{once:!0})})}requestTaskStore(e,r){let n=this._taskStore;if(!n)throw new Error("No task store configured");return{createTask:async s=>{if(!e)throw new Error("No request provided");return await n.createTask(s,e.id,{method:e.method,params:e.params},r)},getTask:async s=>{let o=await n.getTask(s,r);if(!o)throw new j(Z.InvalidParams,"Failed to retrieve task: Task not found");return o},storeTaskResult:async(s,o,i)=>{await n.storeTaskResult(s,o,i,r);let a=await n.getTask(s,r);if(a){let c=io.parse({method:"notifications/tasks/status",params:a});await this.notification(c),Rr(a.status)&&this._cleanupTaskProgressHandler(s)}},getTaskResult:s=>n.getTaskResult(s,r),updateTaskStatus:async(s,o,i)=>{let a=await n.getTask(s,r);if(!a)throw new j(Z.InvalidParams,`Task "${s}" not found - it may have been cleaned up`);if(Rr(a.status))throw new j(Z.InvalidParams,`Cannot update task "${s}" from terminal status "${a.status}" to "${o}". Terminal states (completed, failed, cancelled) cannot transition to other states.`);await n.updateTaskStatus(s,o,i,r);let c=await n.getTask(s,r);if(c){let u=io.parse({method:"notifications/tasks/status",params:c});await this.notification(u),Rr(c.status)&&this._cleanupTaskProgressHandler(s)}},listTasks:s=>n.listTasks(s,r)}}};function Ey(t){return t!==null&&typeof t=="object"&&!Array.isArray(t)}function Ty(t,e){let r={...t};for(let n in e){let s=n,o=e[s];if(o===void 0)continue;let i=r[s];Ey(i)&&Ey(o)?r[s]={...i,...o}:r[s]=o}return r}var Tw=ve(e0(),1),zw=ve(Ew(),1);function TA(){let t=new Tw.Ajv({strict:!1,validateFormats:!0,validateSchema:!1,allErrors:!0});return(0,zw.default)(t),t}var _c=class{constructor(e){this._ajv=e??TA()}getValidator(e){var r;let n="$id"in e&&typeof e.$id=="string"?(r=this._ajv.getSchema(e.$id))!==null&&r!==void 0?r:this._ajv.compile(e):this._ajv.compile(e);return s=>n(s)?{valid:!0,data:s,errorMessage:void 0}:{valid:!1,data:void 0,errorMessage:this._ajv.errorsText(n.errors)}}};var bc=class{constructor(e){this._client=e}async*callToolStream(e,r=ts,n){var s;let o=this._client,i={...n,task:(s=n?.task)!==null&&s!==void 0?s:o.isToolTask(e.name)?{}:void 0},a=o.requestStream({method:"tools/call",params:e},r,i),c=o.getToolOutputValidator(e.name);for await(let u of a){if(u.type==="result"&&c){let l=u.result;if(!l.structuredContent&&!l.isError){yield{type:"error",error:new j(Z.InvalidRequest,`Tool ${e.name} has an output schema but did not return structured content`)};return}if(l.structuredContent)try{let d=c(l.structuredContent);if(!d.valid){yield{type:"error",error:new j(Z.InvalidParams,`Structured content does not match the tool's output schema: ${d.errorMessage}`)};return}}catch(d){if(d instanceof j){yield{type:"error",error:d};return}yield{type:"error",error:new j(Z.InvalidParams,`Failed to validate structured content: ${d instanceof Error?d.message:String(d)}`)};return}}yield u}}async getTask(e,r){return this._client.getTask({taskId:e},r)}async getTaskResult(e,r,n){return this._client.getTaskResult({taskId:e},r,n)}async listTasks(e,r){return this._client.listTasks(e?{cursor:e}:void 0,r)}async cancelTask(e,r){return this._client.cancelTask({taskId:e},r)}requestStream(e,r,n){return this._client.requestStream(e,r,n)}};function Cw(t,e,r){var n;if(!t)throw new Error(`${r} does not support task creation (required for ${e})`);switch(e){case"tools/call":if(!(!((n=t.tools)===null||n===void 0)&&n.call))throw new Error(`${r} does not support task creation for tools/call (required for ${e})`);break;default:break}}function Iw(t,e,r){var n,s;if(!t)throw new Error(`${r} does not support task creation (required for ${e})`);switch(e){case"sampling/createMessage":if(!(!((n=t.sampling)===null||n===void 0)&&n.createMessage))throw new Error(`${r} does not support task creation for sampling/createMessage (required for ${e})`);break;case"elicitation/create":if(!(!((s=t.elicitation)===null||s===void 0)&&s.create))throw new Error(`${r} does not support task creation for elicitation/create (required for ${e})`);break;default:break}}function wc(t,e){if(!(!t||e===null||typeof e!="object")){if(t.type==="object"&&t.properties&&typeof t.properties=="object"){let r=e,n=t.properties;for(let s of Object.keys(n)){let o=n[s];r[s]===void 0&&Object.prototype.hasOwnProperty.call(o,"default")&&(r[s]=o.default),r[s]!==void 0&&wc(o,r[s])}}if(Array.isArray(t.anyOf))for(let r of t.anyOf)wc(r,e);if(Array.isArray(t.oneOf))for(let r of t.oneOf)wc(r,e)}}function zA(t){if(!t)return{supportsFormMode:!1,supportsUrlMode:!1};let e=t.form!==void 0,r=t.url!==void 0;return{supportsFormMode:e||!e&&!r,supportsUrlMode:r}}var $c=class extends oa{constructor(e,r){var n,s;super(r),this._clientInfo=e,this._cachedToolOutputValidators=new Map,this._cachedKnownTaskTools=new Set,this._cachedRequiredTaskTools=new Set,this._capabilities=(n=r?.capabilities)!==null&&n!==void 0?n:{},this._jsonSchemaValidator=(s=r?.jsonSchemaValidator)!==null&&s!==void 0?s:new _c}get experimental(){return this._experimental||(this._experimental={tasks:new bc(this)}),this._experimental}registerCapabilities(e){if(this.transport)throw new Error("Cannot register capabilities after connecting to transport");this._capabilities=Ty(this._capabilities,e)}setRequestHandler(e,r){var n,s,o;let i=Hi(e),a=i?.method;if(!a)throw new Error("Schema is missing a method literal");let c;if(Qn(a)){let l=a,d=(n=l._zod)===null||n===void 0?void 0:n.def;c=(s=d?.value)!==null&&s!==void 0?s:l.value}else{let l=a,d=l._def;c=(o=d?.value)!==null&&o!==void 0?o:l.value}if(typeof c!="string")throw new Error("Schema method literal must be a string");let u=c;if(u==="elicitation/create"){let l=async(d,f)=>{var p,m,h;let g=Ot(Ku,d);if(!g.success){let H=g.error instanceof Error?g.error.message:String(g.error);throw new j(Z.InvalidParams,`Invalid elicitation request: ${H}`)}let{params:y}=g.data,x=(p=y.mode)!==null&&p!==void 0?p:"form",{supportsFormMode:$,supportsUrlMode:S}=zA(this._capabilities.elicitation);if(x==="form"&&!$)throw new j(Z.InvalidParams,"Client does not support form-mode elicitation requests");if(x==="url"&&!S)throw new j(Z.InvalidParams,"Client does not support URL-mode elicitation requests");let w=await Promise.resolve(r(d,f));if(y.task){let H=Ot(_n,w);if(!H.success){let we=H.error instanceof Error?H.error.message:String(H.error);throw new j(Z.InvalidParams,`Invalid task creation result: ${we}`)}return H.data}let D=Ot(Bu,w);if(!D.success){let H=D.error instanceof Error?D.error.message:String(D.error);throw new j(Z.InvalidParams,`Invalid elicitation result: ${H}`)}let F=D.data,Ce=x==="form"?y.requestedSchema:void 0;if(x==="form"&&F.action==="accept"&&F.content&&Ce&&!((h=(m=this._capabilities.elicitation)===null||m===void 0?void 0:m.form)===null||h===void 0)&&h.applyDefaults)try{wc(Ce,F.content)}catch{}return F};return super.setRequestHandler(e,l)}if(u==="sampling/createMessage"){let l=async(d,f)=>{let p=Ot(Uu,d);if(!p.success){let y=p.error instanceof Error?p.error.message:String(p.error);throw new j(Z.InvalidParams,`Invalid sampling request: ${y}`)}let{params:m}=p.data,h=await Promise.resolve(r(d,f));if(m.task){let y=Ot(_n,h);if(!y.success){let x=y.error instanceof Error?y.error.message:String(y.error);throw new j(Z.InvalidParams,`Invalid task creation result: ${x}`)}return y.data}let g=Ot(Hu,h);if(!g.success){let y=g.error instanceof Error?g.error.message:String(g.error);throw new j(Z.InvalidParams,`Invalid sampling result: ${y}`)}return g.data};return super.setRequestHandler(e,l)}return super.setRequestHandler(e,r)}assertCapability(e,r){var n;if(!(!((n=this._serverCapabilities)===null||n===void 0)&&n[e]))throw new Error(`Server does not support ${e} (required for ${r})`)}async connect(e,r){if(await super.connect(e),e.sessionId===void 0)try{let n=await this.request({method:"initialize",params:{protocolVersion:Tu,capabilities:this._capabilities,clientInfo:this._clientInfo}},Iu,r);if(n===void 0)throw new Error(`Server sent invalid initialize result: ${n}`);if(!cy.includes(n.protocolVersion))throw new Error(`Server's protocol version is not supported: ${n.protocolVersion}`);this._serverCapabilities=n.capabilities,this._serverVersion=n.serverInfo,e.setProtocolVersion&&e.setProtocolVersion(n.protocolVersion),this._instructions=n.instructions,await this.notification({method:"notifications/initialized"})}catch(n){throw this.close(),n}}getServerCapabilities(){return this._serverCapabilities}getServerVersion(){return this._serverVersion}getInstructions(){return this._instructions}assertCapabilityForMethod(e){var r,n,s,o,i;switch(e){case"logging/setLevel":if(!(!((r=this._serverCapabilities)===null||r===void 0)&&r.logging))throw new Error(`Server does not support logging (required for ${e})`);break;case"prompts/get":case"prompts/list":if(!(!((n=this._serverCapabilities)===null||n===void 0)&&n.prompts))throw new Error(`Server does not support prompts (required for ${e})`);break;case"resources/list":case"resources/templates/list":case"resources/read":case"resources/subscribe":case"resources/unsubscribe":if(!(!((s=this._serverCapabilities)===null||s===void 0)&&s.resources))throw new Error(`Server does not support resources (required for ${e})`);if(e==="resources/subscribe"&&!this._serverCapabilities.resources.subscribe)throw new Error(`Server does not support resource subscriptions (required for ${e})`);break;case"tools/call":case"tools/list":if(!(!((o=this._serverCapabilities)===null||o===void 0)&&o.tools))throw new Error(`Server does not support tools (required for ${e})`);break;case"completion/complete":if(!(!((i=this._serverCapabilities)===null||i===void 0)&&i.completions))throw new Error(`Server does not support completions (required for ${e})`);break;case"initialize":break;case"ping":break}}assertNotificationCapability(e){var r;switch(e){case"notifications/roots/list_changed":if(!(!((r=this._capabilities.roots)===null||r===void 0)&&r.listChanged))throw new Error(`Client does not support roots list changed notifications (required for ${e})`);break;case"notifications/initialized":break;case"notifications/cancelled":break;case"notifications/progress":break}}assertRequestHandlerCapability(e){if(this._capabilities)switch(e){case"sampling/createMessage":if(!this._capabilities.sampling)throw new Error(`Client does not support sampling capability (required for ${e})`);break;case"elicitation/create":if(!this._capabilities.elicitation)throw new Error(`Client does not support elicitation capability (required for ${e})`);break;case"roots/list":if(!this._capabilities.roots)throw new Error(`Client does not support roots capability (required for ${e})`);break;case"tasks/get":case"tasks/list":case"tasks/result":case"tasks/cancel":if(!this._capabilities.tasks)throw new Error(`Client does not support tasks capability (required for ${e})`);break;case"ping":break}}assertTaskCapability(e){var r,n;Cw((n=(r=this._serverCapabilities)===null||r===void 0?void 0:r.tasks)===null||n===void 0?void 0:n.requests,e,"Server")}assertTaskHandlerCapability(e){var r;this._capabilities&&Iw((r=this._capabilities.tasks)===null||r===void 0?void 0:r.requests,e,"Client")}async ping(e){return this.request({method:"ping"},vn,e)}async complete(e,r){return this.request({method:"completion/complete",params:e},Gu,r)}async setLoggingLevel(e,r){return this.request({method:"logging/setLevel",params:{level:e}},vn,r)}async getPrompt(e,r){return this.request({method:"prompts/get",params:e},Vu,r)}async listPrompts(e,r){return this.request({method:"prompts/list",params:e},Mu,r)}async listResources(e,r){return this.request({method:"resources/list",params:e},Ou,r)}async listResourceTemplates(e,r){return this.request({method:"resources/templates/list",params:e},Nu,r)}async readResource(e,r){return this.request({method:"resources/read",params:e},Au,r)}async subscribeResource(e,r){return this.request({method:"resources/subscribe",params:e},vn,r)}async unsubscribeResource(e,r){return this.request({method:"resources/unsubscribe",params:e},vn,r)}async callTool(e,r=ts,n){if(this.isToolTaskRequired(e.name))throw new j(Z.InvalidRequest,`Tool "${e.name}" requires task-based execution. Use client.experimental.tasks.callToolStream() instead.`);let s=await this.request({method:"tools/call",params:e},r,n),o=this.getToolOutputValidator(e.name);if(o){if(!s.structuredContent&&!s.isError)throw new j(Z.InvalidRequest,`Tool ${e.name} has an output schema but did not return structured content`);if(s.structuredContent)try{let i=o(s.structuredContent);if(!i.valid)throw new j(Z.InvalidParams,`Structured content does not match the tool's output schema: ${i.errorMessage}`)}catch(i){throw i instanceof j?i:new j(Z.InvalidParams,`Failed to validate structured content: ${i instanceof Error?i.message:String(i)}`)}}return s}isToolTask(e){var r,n,s,o;return!((o=(s=(n=(r=this._serverCapabilities)===null||r===void 0?void 0:r.tasks)===null||n===void 0?void 0:n.requests)===null||s===void 0?void 0:s.tools)===null||o===void 0)&&o.call?this._cachedKnownTaskTools.has(e):!1}isToolTaskRequired(e){return this._cachedRequiredTaskTools.has(e)}cacheToolMetadata(e){var r;this._cachedToolOutputValidators.clear(),this._cachedKnownTaskTools.clear(),this._cachedRequiredTaskTools.clear();for(let n of e){if(n.outputSchema){let o=this._jsonSchemaValidator.getValidator(n.outputSchema);this._cachedToolOutputValidators.set(n.name,o)}let s=(r=n.execution)===null||r===void 0?void 0:r.taskSupport;(s==="required"||s==="optional")&&this._cachedKnownTaskTools.add(n.name),s==="required"&&this._cachedRequiredTaskTools.add(n.name)}}getToolOutputValidator(e){return this._cachedToolOutputValidators.get(e)}async listTools(e,r){let n=await this.request({method:"tools/list",params:e},Fu,r);return this.cacheToolMetadata(n.tools),n}async sendRootsListChanged(){return this.notification({method:"notifications/roots/list_changed"})}};var w$=ve(_$(),1),pi=ve(require("node:process"),1),$$=require("node:stream");var kc=class{append(e){this._buffer=this._buffer?Buffer.concat([this._buffer,e]):e}readMessage(){if(!this._buffer)return null;let e=this._buffer.indexOf(`
`);if(e===-1)return null;let r=this._buffer.toString("utf8",0,e).replace(/\r$/,"");return this._buffer=this._buffer.subarray(e+1),rM(r)}clear(){this._buffer=void 0}};function rM(t){return yy.parse(JSON.parse(t))}function b$(t){return JSON.stringify(t)+`
`}var nM=pi.default.platform==="win32"?["APPDATA","HOMEDRIVE","HOMEPATH","LOCALAPPDATA","PATH","PROCESSOR_ARCHITECTURE","SYSTEMDRIVE","SYSTEMROOT","TEMP","USERNAME","USERPROFILE","PROGRAMFILES"]:["HOME","LOGNAME","PATH","SHELL","TERM","USER"];function sM(){let t={};for(let e of nM){let r=pi.default.env[e];r!==void 0&&(r.startsWith("()")||(t[e]=r))}return t}var Sc=class{constructor(e){this._readBuffer=new kc,this._stderrStream=null,this._serverParams=e,(e.stderr==="pipe"||e.stderr==="overlapped")&&(this._stderrStream=new $$.PassThrough)}async start(){if(this._process)throw new Error("StdioClientTransport already started! If using Client class, note that connect() calls start() automatically.");return new Promise((e,r)=>{var n,s,o,i,a;this._process=(0,w$.default)(this._serverParams.command,(n=this._serverParams.args)!==null&&n!==void 0?n:[],{env:{...sM(),...this._serverParams.env},stdio:["pipe","pipe",(s=this._serverParams.stderr)!==null&&s!==void 0?s:"inherit"],shell:!1,windowsHide:pi.default.platform==="win32"&&oM(),cwd:this._serverParams.cwd}),this._process.on("error",c=>{var u;r(c),(u=this.onerror)===null||u===void 0||u.call(this,c)}),this._process.on("spawn",()=>{e()}),this._process.on("close",c=>{var u;this._process=void 0,(u=this.onclose)===null||u===void 0||u.call(this)}),(o=this._process.stdin)===null||o===void 0||o.on("error",c=>{var u;(u=this.onerror)===null||u===void 0||u.call(this,c)}),(i=this._process.stdout)===null||i===void 0||i.on("data",c=>{this._readBuffer.append(c),this.processReadBuffer()}),(a=this._process.stdout)===null||a===void 0||a.on("error",c=>{var u;(u=this.onerror)===null||u===void 0||u.call(this,c)}),this._stderrStream&&this._process.stderr&&this._process.stderr.pipe(this._stderrStream)})}get stderr(){var e,r;return this._stderrStream?this._stderrStream:(r=(e=this._process)===null||e===void 0?void 0:e.stderr)!==null&&r!==void 0?r:null}get pid(){var e,r;return(r=(e=this._process)===null||e===void 0?void 0:e.pid)!==null&&r!==void 0?r:null}processReadBuffer(){for(var e,r;;)try{let n=this._readBuffer.readMessage();if(n===null)break;(e=this.onmessage)===null||e===void 0||e.call(this,n)}catch(n){(r=this.onerror)===null||r===void 0||r.call(this,n)}}async close(){var e;if(this._process){let r=this._process;this._process=void 0;let n=new Promise(s=>{r.once("close",()=>{s()})});try{(e=r.stdin)===null||e===void 0||e.end()}catch{}if(await Promise.race([n,new Promise(s=>setTimeout(s,2e3).unref())]),r.exitCode===null){try{r.kill("SIGTERM")}catch{}await Promise.race([n,new Promise(s=>setTimeout(s,2e3).unref())])}if(r.exitCode===null)try{r.kill("SIGKILL")}catch{}}this._readBuffer.clear()}send(e){return new Promise(r=>{var n;if(!(!((n=this._process)===null||n===void 0)&&n.stdin))throw new Error("Not connected");let s=b$(e);this._process.stdin.write(s)?r():this._process.stdin.once("drain",r)})}};function oM(){return"type"in pi.default}function Pc(t){if(!t||typeof t!="object")return T.any();let e=t.type;switch(e){case"string":let r=T.string();return t.enum?T.enum(t.enum):r;case"number":case"integer":let n=T.number();return e==="integer"&&(n=n.int()),n;case"boolean":return T.boolean();case"array":return t.items?T.array(Pc(t.items)):T.array(T.any());case"object":if(t.properties){let s={},o=new Set(t.required||[]);for(let[i,a]of Object.entries(t.properties)){let c=Pc(a);o.has(i)||(c=c.optional()),s[i]=c}return t.additionalProperties!==!1?T.object(s).passthrough():T.object(s)}return T.object({}).passthrough();default:return T.any()}}var Ec=class{constructor(e,r){this.gateway=e;this.context=r;this.clients=new Map;this.serverStates=new Map;this.resources=new Map;this.prompts=new Map;this.disposables=[];this.eventListeners=[];this.disposables.push(Ns.workspace.onDidChangeConfiguration(n=>{n.affectsConfiguration("vibey.mcpServers")&&this.reloadServers()}))}async initialize(){await this.reloadServers()}addEventListener(e){this.eventListeners.push(e)}removeEventListener(e){let r=this.eventListeners.indexOf(e);r>=0&&this.eventListeners.splice(r,1)}emitEvent(e){for(let r of this.eventListeners)try{r(e)}catch(n){console.error("[MCP] Event listener error:",n)}}getServerStates(){return Array.from(this.serverStates.values())}getServerState(e){return this.serverStates.get(e)}getResources(e){return e?this.resources.get(e)||[]:Array.from(this.resources.values()).flat()}getPrompts(e){return e?this.prompts.get(e)||[]:Array.from(this.prompts.values()).flat()}async readResource(e){for(let[r,n]of this.resources.entries())if(n.find(o=>o.uri===e)){let o=this.clients.get(r);if(!o)throw new Error(`Server ${r} not connected`);let i=await o.readResource({uri:e});if(i.contents&&i.contents.length>0){let a=i.contents[0];return"text"in a?a.text:JSON.stringify(a)}return""}throw new Error(`Resource not found: ${e}`)}async getPrompt(e,r){for(let[n,s]of this.prompts.entries())if(s.find(i=>i.name===e)){let i=this.clients.get(n);if(!i)throw new Error(`Server ${n} not connected`);let a=await i.getPrompt({name:e,arguments:r});return a.messages&&a.messages.length>0?a.messages.map(c=>typeof c.content=="string"?c.content:c.content&&"text"in c.content?c.content.text:JSON.stringify(c.content)).join(`
`):""}throw new Error(`Prompt not found: ${e}`)}async dispose(){this.disposables.forEach(e=>e.dispose());for(let[e]of this.clients.entries())await this.disconnectServer(e);this.clients.clear(),this.serverStates.clear(),this.resources.clear(),this.prompts.clear()}async reconnectServer(e){let r=this.serverStates.get(e);if(!r)throw new Error(`Server ${e} not configured`);await this.disconnectServer(e),await this.connectToServer(e,r.config)}async reloadServers(){console.log("[MCP] Reloading servers...");let r=Ns.workspace.getConfiguration("vibey").get("mcpServers")||{},n=new Set(Object.keys(r));for(let s of this.clients.keys())n.has(s)||await this.disconnectServer(s);for(let[s,o]of Object.entries(r)){let i=this.serverStates.get(s),a=i&&JSON.stringify(i.config)!==JSON.stringify(o);if(!i||a){i&&await this.disconnectServer(s);try{await this.connectToServer(s,o)}catch(c){console.error(`[MCP] Error connecting to ${s}:`,c),this.updateServerState(s,{name:s,config:o,status:"error",error:c.message,toolCount:0,resourceCount:0,promptCount:0,registeredTools:[]})}}}}updateServerState(e,r){this.serverStates.set(e,r)}async disconnectServer(e){let r=this.serverStates.get(e),n=this.clients.get(e);if(r)for(let s of r.registeredTools)this.gateway.unregisterTool(s);if(n){try{await n.close()}catch(s){console.error(`[MCP] Error closing client ${e}:`,s)}this.clients.delete(e)}this.serverStates.delete(e),this.resources.delete(e),this.prompts.delete(e),this.emitEvent({type:"server-disconnected",serverName:e}),console.log(`[MCP] Disconnected from ${e}`)}async connectToServer(e,r){console.log(`[MCP] Connecting to ${e}...`,r),this.updateServerState(e,{name:e,config:r,status:"connecting",toolCount:0,resourceCount:0,promptCount:0,registeredTools:[]});try{let n=new Sc({command:r.command,args:r.args||[],env:r.env}),s=new $c({name:"VibeyClient",version:"0.1.3"},{capabilities:{sampling:{}}});await s.connect(n),this.clients.set(e,s);let o=[],i=0,a=0,c=0;try{let u=await s.listTools();if(u.tools)for(let l of u.tools){let d=this.adaptMcpTool(e,s,l);this.gateway.registerTool(d),o.push(l.name),i++,console.log(`[MCP] Registered tool: ${l.name} from ${e}`)}}catch(u){console.warn(`[MCP] Failed to list tools from ${e}:`,u)}try{let u=await s.listResources();if(u.resources){let l=u.resources.map(d=>({uri:d.uri,name:d.name,description:d.description,mimeType:d.mimeType}));this.resources.set(e,l),a=l.length,console.log(`[MCP] Discovered ${a} resources from ${e}`)}}catch{console.log(`[MCP] Server ${e} does not support resources`)}try{let u=await s.listPrompts();if(u.prompts){let l=u.prompts.map(d=>({name:d.name,description:d.description,arguments:d.arguments?.map(f=>({name:f.name,description:f.description,required:f.required}))}));this.prompts.set(e,l),c=l.length,console.log(`[MCP] Discovered ${c} prompts from ${e}`)}}catch{console.log(`[MCP] Server ${e} does not support prompts`)}this.updateServerState(e,{name:e,config:r,status:"connected",connectedAt:Date.now(),toolCount:i,resourceCount:a,promptCount:c,registeredTools:o}),this.emitEvent({type:"server-connected",serverName:e}),this.emitEvent({type:"tools-updated",serverName:e,data:{count:i}}),Ns.window.showInformationMessage(`MCP: Connected to ${e} (${i} tools, ${a} resources)`)}catch(n){throw console.error(`[MCP] Failed to connect to ${e}:`,n),this.updateServerState(e,{name:e,config:r,status:"error",error:n.message,toolCount:0,resourceCount:0,promptCount:0,registeredTools:[]}),this.emitEvent({type:"server-error",serverName:e,data:{error:n.message}}),Ns.window.showErrorMessage(`MCP: Failed to connect to ${e}: ${n.message}`),n}}adaptMcpTool(e,r,n){return{name:n.name,description:n.description||`Tool from MCP server: ${e}`,parameters:Pc(n.inputSchema),execute:async s=>{let o=await r.callTool({name:n.name,arguments:s});if(o.isError){let i=this.extractContent(o.content);throw new Error(i||"Tool execution failed")}return this.extractContent(o.content)}}}extractContent(e){return e?Array.isArray(e)?e.map(r=>typeof r=="string"?r:r.type==="text"?r.text:r.type==="image"?`[Image: ${r.mimeType||"unknown"}]`:r.type==="resource"?`[Resource: ${r.resource?.uri||"unknown"}]`:JSON.stringify(r)).join(`
`):JSON.stringify(e):""}};var Cf=ve(require("crypto"));var x$=[{id:"tool_success_rate",name:"Tool Success Rate",description:"Percentage of tool executions that succeed",category:"performance",unit:"%",aggregation:"rate",higherIsBetter:!0},{id:"task_completion_rate",name:"Task Completion Rate",description:"Percentage of tasks completed successfully",category:"performance",unit:"%",aggregation:"rate",higherIsBetter:!0},{id:"avg_task_duration",name:"Average Task Duration",description:"Average time to complete a task",category:"efficiency",unit:"minutes",aggregation:"avg",higherIsBetter:!1},{id:"turns_per_task",name:"Turns Per Task",description:"Average LLM turns needed to complete a task",category:"efficiency",aggregation:"avg",higherIsBetter:!1},{id:"error_recovery_rate",name:"Error Recovery Rate",description:"Percentage of errors successfully recovered from",category:"quality",unit:"%",aggregation:"rate",higherIsBetter:!0},{id:"security_violations",name:"Security Violations",description:"Number of blocked security violations",category:"security",aggregation:"count",higherIsBetter:!1},{id:"learnings_applied",name:"Learnings Applied",description:"Number of past learnings successfully applied",category:"learning",aggregation:"count",higherIsBetter:!0},{id:"tokens_sent",name:"Tokens Sent",description:"Total tokens sent to LLM in prompts",category:"efficiency",unit:"tokens",aggregation:"sum",higherIsBetter:!1},{id:"tokens_received",name:"Tokens Received",description:"Total tokens received from LLM responses",category:"efficiency",unit:"tokens",aggregation:"sum",higherIsBetter:!1}];var Tc=class t{constructor(e,r=t.DEFAULT_CONFIG){this.context=e;this.config=r;this.dataPoints=[];this.decisions=[];this.learnings=[];this.metrics=new Map;this.snapshots=[];for(let n of x$)this.metrics.set(n.id,n);this.loadState()}static{this.STORAGE_KEY="vibey.metrics.data"}static{this.DEFAULT_CONFIG={retentionDays:30,snapshotInterval:24,enableDetailedLogging:!0}}record(e,r,n,s){if(!this.metrics.get(e)){console.warn(`Unknown metric: ${e}`);return}this.dataPoints.push({metricId:e,value:r,timestamp:Date.now(),context:n,tags:s}),this.pruneOldData(),this.saveState()}recordDecision(e){let r={id:Cf.randomUUID(),timestamp:Date.now(),...e};return this.decisions.push(r),this.saveState(),r.id}updateDecisionOutcome(e,r){let n=this.decisions.find(s=>s.id===e);n&&(n.outcome=r,this.saveState())}addLearning(e){let r={id:Cf.randomUUID(),timestamp:Date.now(),appliedCount:0,...e};return this.learnings.push(r),this.saveState(),r.id}recordLearningApplied(e,r){let n=this.learnings.find(s=>s.id===e);if(n){n.appliedCount++;let s=n.successRate??0,o=n.appliedCount-1;n.successRate=o>0?(s*o+(r?1:0))/n.appliedCount:r?1:0,this.saveState()}}getSummary(e,r=24){let n=this.metrics.get(e);if(!n)return;let s=Date.now(),o=s-r*60*60*1e3,i=o-r*60*60*1e3,a=this.dataPoints.filter(m=>m.metricId===e&&m.timestamp>=o),c=this.dataPoints.filter(m=>m.metricId===e&&m.timestamp>=i&&m.timestamp<o),u=this.aggregate(a,n.aggregation),l=c.length>0?this.aggregate(c,n.aggregation):void 0,d="stable",f,p;return l!==void 0&&l!==0&&(f=u-l,p=f/l*100,Math.abs(p)>5&&(d=f>0?"up":"down")),{metricId:e,name:n.name,category:n.category,currentValue:u,previousValue:l,change:f,changePercent:p,trend:d,dataPoints:a.length,period:{start:o,end:s}}}getAllSummaries(e=24){return Array.from(this.metrics.keys()).map(r=>this.getSummary(r,e)).filter(r=>r!==void 0)}createSnapshot(){let e=this.getAllSummaries(),r=[],n=[],s=[];for(let c of e){let u=this.metrics.get(c.metricId),l=c.trend==="up"&&u.higherIsBetter||c.trend==="down"&&!u.higherIsBetter,d=c.trend==="down"&&u.higherIsBetter||c.trend==="up"&&!u.higherIsBetter;l?r.push(`${u.name} is improving (${c.changePercent?.toFixed(1)}%)`):d&&(n.push(`${u.name} is declining (${c.changePercent?.toFixed(1)}%)`),s.push(`Investigate ${u.name} decline and identify root cause`))}let o=e.filter(c=>c.dataPoints>0),i=o.length>0?o.reduce((c,u)=>{let l=this.metrics.get(u.metricId),d=u.currentValue;return l.aggregation==="rate"&&(d=u.currentValue*100),c+Math.min(100,Math.max(0,d))},0)/o.length:50,a={timestamp:Date.now(),metrics:e,overallScore:Math.round(i),strengths:r,weaknesses:n,recommendations:s};return this.snapshots.push(a),this.saveState(),a}getLatestSnapshot(){return this.snapshots[this.snapshots.length-1]}getLearnings(e){let r=[...this.learnings];return e&&(r=r.filter(n=>n.category===e)),r.sort((n,s)=>s.confidence-n.confidence)}getRecentDecisions(e=20){return this.decisions.slice(-e).sort((r,n)=>n.timestamp-r.timestamp)}aggregate(e,r){if(e.length===0)return 0;let n=e.map(s=>s.value);switch(r){case"sum":return n.reduce((o,i)=>o+i,0);case"avg":return n.reduce((o,i)=>o+i,0)/n.length;case"min":return Math.min(...n);case"max":return Math.max(...n);case"count":return n.length;case"rate":return n.filter(o=>o===1).length/n.length;default:return n[n.length-1]}}pruneOldData(){let e=Date.now()-this.config.retentionDays*24*60*60*1e3;this.dataPoints=this.dataPoints.filter(r=>r.timestamp>=e),this.decisions=this.decisions.filter(r=>r.timestamp>=e),this.snapshots=this.snapshots.filter(r=>r.timestamp>=e)}async saveState(){let e={dataPoints:this.dataPoints,decisions:this.decisions,learnings:this.learnings,snapshots:this.snapshots};await this.context.globalState.update(t.STORAGE_KEY,e)}loadState(){let e=this.context.globalState.get(t.STORAGE_KEY);e&&(this.dataPoints=e.dataPoints||[],this.decisions=e.decisions||[],this.learnings=e.learnings||[],this.snapshots=e.snapshots||[])}clearAllData(){this.dataPoints=[],this.decisions=[],this.learnings=[],this.snapshots=[],this.saveState()}};var xr,fi,If;function iM(t){console.log("Vibey is now active!");let e=pe.workspace.workspaceFolders?pe.workspace.workspaceFolders[0].uri.fsPath:process.cwd();console.log("Vibey Workspace Root:",e),If=new Tc(t);let r=new wi(e),n=new bi(r),s=new Ti;Qf(r,e).forEach(w=>n.registerTool(w)),Xf(r,e).forEach(w=>n.registerTool(w)),n.registerTool(em(s));let a=k$.join(t.extensionPath,"src","ui","media","vibey-terminal.svg");fi=new Zs(e,t,a),nm(fi).forEach(w=>n.registerTool(w)),sm().forEach(w=>n.registerTool(w)),xr=new Ec(n,t),xr.initialize().catch(w=>{console.error("[Vibey] Failed to initialize MCP service:",w)});let l=new _i,d=new vi(l,n,e),f=new Ci(t,e),p=pe.extensions.getExtension("vibey.vibey");p&&p.exports&&(p.exports.metricsCollector=If);let m=new Ds(t.extensionUri,d,s,f);t.subscriptions.push(pe.window.registerWebviewViewProvider(Ds.viewType,m)),t.subscriptions.push(pe.window.registerWebviewViewProvider("vibey.chatViewAux",m));let h=pe.commands.registerCommand("vibey.start",()=>{pe.commands.executeCommand("workbench.view.extension.vibey-sidebar")}),g=pe.commands.registerCommand("vibey.openSettings",()=>{pe.commands.executeCommand("workbench.action.openSettings","vibey")}),y=pe.commands.registerCommand("vibey.selectModel",async()=>{try{let w=await l.listModels();if(w.length===0){pe.window.showErrorMessage("No Ollama models found. Is Ollama running?");return}let D=await pe.window.showQuickPick(w,{placeHolder:"Select an Ollama model"});D&&(await pe.workspace.getConfiguration("vibey").update("model",D,pe.ConfigurationTarget.Global),pe.window.showInformationMessage(`Vibey model set to: ${D}`))}catch(w){pe.window.showErrorMessage(`Failed to select model: ${w.message}`)}}),x=pe.commands.registerCommand("vibey.mcpStatus",()=>{if(!xr){pe.window.showErrorMessage("MCP service not initialized");return}let w=xr.getServerStates();if(w.length===0){pe.window.showInformationMessage("No MCP servers configured. Add servers in settings (vibey.mcpServers)");return}let D=w.map(F=>`${F.status==="connected"?"\u2705":F.status==="error"?"\u274C":"\u23F3"} ${F.name}: ${F.toolCount} tools, ${F.resourceCount} resources${F.error?` (${F.error})`:""}`);pe.window.showInformationMessage(`MCP Servers:
${D.join(`
`)}`)}),$=pe.commands.registerCommand("vibey.mcpReload",async()=>{if(!xr){pe.window.showErrorMessage("MCP service not initialized");return}pe.window.showInformationMessage("Reloading MCP servers..."),await xr.reloadServers()}),S=pe.commands.registerCommand("vibey.mcpListTools",()=>{let w=n.getToolDefinitions(),D=w.map(F=>F.name).sort();pe.window.showQuickPick(D,{placeHolder:"Available tools (built-in + MCP)",canPickMany:!1}).then(F=>{if(F){let Ce=w.find(H=>H.name===F);Ce&&pe.window.showInformationMessage(`${Ce.name}: ${Ce.description}`)}})});t.subscriptions.push(h),t.subscriptions.push(g),t.subscriptions.push(y),t.subscriptions.push(x),t.subscriptions.push($),t.subscriptions.push(S)}function Zn(){return If}async function aM(){xr&&(await xr.dispose(),xr=void 0),fi&&(fi.dispose(),fi=void 0)}0&&(module.exports={activate,deactivate,getMetricsCollector});
