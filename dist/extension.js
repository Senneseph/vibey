"use strict";var P$=Object.create;var mi=Object.defineProperty;var E$=Object.getOwnPropertyDescriptor;var T$=Object.getOwnPropertyNames;var z$=Object.getPrototypeOf,C$=Object.prototype.hasOwnProperty;var v=(t,e)=>()=>(e||t((e={exports:{}}).exports,e),e.exports),hi=(t,e)=>{for(var r in e)mi(t,r,{get:e[r],enumerable:!0})},Of=(t,e,r,n)=>{if(e&&typeof e=="object"||typeof e=="function")for(let s of T$(e))!C$.call(t,s)&&s!==r&&mi(t,s,{get:()=>e[s],enumerable:!(n=E$(e,s))||n.enumerable});return t};var ve=(t,e,r)=>(r=t!=null?P$(z$(t)):{},Of(e||!t||!t.__esModule?mi(r,"default",{value:t,enumerable:!0}):r,t)),I$=t=>Of(mi({},"__esModule",{value:!0}),t);var lo=v(ae=>{"use strict";Object.defineProperty(ae,"__esModule",{value:!0});ae.regexpCode=ae.getEsmExportName=ae.getProperty=ae.safeStringify=ae.stringify=ae.strConcat=ae.addCodeArg=ae.str=ae._=ae.nil=ae._Code=ae.Name=ae.IDENTIFIER=ae._CodeOrName=void 0;var co=class{};ae._CodeOrName=co;ae.IDENTIFIER=/^[a-z$_][a-z$_0-9]*$/i;var bn=class extends co{constructor(e){if(super(),!ae.IDENTIFIER.test(e))throw new Error("CodeGen: name must be a valid identifier");this.str=e}toString(){return this.str}emptyStr(){return!1}get names(){return{[this.str]:1}}};ae.Name=bn;var xt=class extends co{constructor(e){super(),this._items=typeof e=="string"?[e]:e}toString(){return this.str}emptyStr(){if(this._items.length>1)return!1;let e=this._items[0];return e===""||e==='""'}get str(){var e;return(e=this._str)!==null&&e!==void 0?e:this._str=this._items.reduce((r,n)=>`${r}${n}`,"")}get names(){var e;return(e=this._names)!==null&&e!==void 0?e:this._names=this._items.reduce((r,n)=>(n instanceof bn&&(r[n.str]=(r[n.str]||0)+1),r),{})}};ae._Code=xt;ae.nil=new xt("");function Cy(t,...e){let r=[t[0]],n=0;for(;n<e.length;)Xu(r,e[n]),r.push(t[++n]);return new xt(r)}ae._=Cy;var Qu=new xt("+");function Iy(t,...e){let r=[uo(t[0])],n=0;for(;n<e.length;)r.push(Qu),Xu(r,e[n]),r.push(Qu,uo(t[++n]));return KP(r),new xt(r)}ae.str=Iy;function Xu(t,e){e instanceof xt?t.push(...e._items):e instanceof bn?t.push(e):t.push(WP(e))}ae.addCodeArg=Xu;function KP(t){let e=1;for(;e<t.length-1;){if(t[e]===Qu){let r=BP(t[e-1],t[e+1]);if(r!==void 0){t.splice(e-1,3,r);continue}t[e++]="+"}e++}}function BP(t,e){if(e==='""')return t;if(t==='""')return e;if(typeof t=="string")return e instanceof bn||t[t.length-1]!=='"'?void 0:typeof e!="string"?`${t.slice(0,-1)}${e}"`:e[0]==='"'?t.slice(0,-1)+e.slice(1):void 0;if(typeof e=="string"&&e[0]==='"'&&!(t instanceof bn))return`"${t}${e.slice(1)}`}function GP(t,e){return e.emptyStr()?t:t.emptyStr()?e:Iy`${t}${e}`}ae.strConcat=GP;function WP(t){return typeof t=="number"||typeof t=="boolean"||t===null?t:uo(Array.isArray(t)?t.join(","):t)}function JP(t){return new xt(uo(t))}ae.stringify=JP;function uo(t){return JSON.stringify(t).replace(/\u2028/g,"\\u2028").replace(/\u2029/g,"\\u2029")}ae.safeStringify=uo;function YP(t){return typeof t=="string"&&ae.IDENTIFIER.test(t)?new xt(`.${t}`):Cy`[${t}]`}ae.getProperty=YP;function QP(t){if(typeof t=="string"&&ae.IDENTIFIER.test(t))return new xt(`${t}`);throw new Error(`CodeGen: invalid export name: ${t}, use explicit $id name mapping`)}ae.getEsmExportName=QP;function XP(t){return new xt(t.toString())}ae.regexpCode=XP});var rl=v(lt=>{"use strict";Object.defineProperty(lt,"__esModule",{value:!0});lt.ValueScope=lt.ValueScopeName=lt.Scope=lt.varKinds=lt.UsedValueState=void 0;var ut=lo(),el=class extends Error{constructor(e){super(`CodeGen: "code" for ${e} not defined`),this.value=e.value}},aa;(function(t){t[t.Started=0]="Started",t[t.Completed=1]="Completed"})(aa||(lt.UsedValueState=aa={}));lt.varKinds={const:new ut.Name("const"),let:new ut.Name("let"),var:new ut.Name("var")};var ca=class{constructor({prefixes:e,parent:r}={}){this._names={},this._prefixes=e,this._parent=r}toName(e){return e instanceof ut.Name?e:this.name(e)}name(e){return new ut.Name(this._newName(e))}_newName(e){let r=this._names[e]||this._nameGroup(e);return`${e}${r.index++}`}_nameGroup(e){var r,n;if(!((n=(r=this._parent)===null||r===void 0?void 0:r._prefixes)===null||n===void 0)&&n.has(e)||this._prefixes&&!this._prefixes.has(e))throw new Error(`CodeGen: prefix "${e}" is not allowed in this scope`);return this._names[e]={prefix:e,index:0}}};lt.Scope=ca;var ua=class extends ut.Name{constructor(e,r){super(r),this.prefix=e}setValue(e,{property:r,itemIndex:n}){this.value=e,this.scopePath=(0,ut._)`.${new ut.Name(r)}[${n}]`}};lt.ValueScopeName=ua;var eE=(0,ut._)`\n`,tl=class extends ca{constructor(e){super(e),this._values={},this._scope=e.scope,this.opts={...e,_n:e.lines?eE:ut.nil}}get(){return this._scope}name(e){return new ua(e,this._newName(e))}value(e,r){var n;if(r.ref===void 0)throw new Error("CodeGen: ref must be passed in value");let s=this.toName(e),{prefix:o}=s,i=(n=r.key)!==null&&n!==void 0?n:r.ref,a=this._values[o];if(a){let l=a.get(i);if(l)return l}else a=this._values[o]=new Map;a.set(i,s);let c=this._scope[o]||(this._scope[o]=[]),u=c.length;return c[u]=r.ref,s.setValue(r,{property:o,itemIndex:u}),s}getValue(e,r){let n=this._values[e];if(n)return n.get(r)}scopeRefs(e,r=this._values){return this._reduceValues(r,n=>{if(n.scopePath===void 0)throw new Error(`CodeGen: name "${n}" has no value`);return(0,ut._)`${e}${n.scopePath}`})}scopeCode(e=this._values,r,n){return this._reduceValues(e,s=>{if(s.value===void 0)throw new Error(`CodeGen: name "${s}" has no value`);return s.value.code},r,n)}_reduceValues(e,r,n={},s){let o=ut.nil;for(let i in e){let a=e[i];if(!a)continue;let c=n[i]=n[i]||new Map;a.forEach(u=>{if(c.has(u))return;c.set(u,aa.Started);let l=r(u);if(l){let d=this.opts.es5?lt.varKinds.var:lt.varKinds.const;o=(0,ut._)`${o}${d} ${u} = ${l};${this.opts._n}`}else if(l=s?.(u))o=(0,ut._)`${o}${l}${this.opts._n}`;else throw new el(u);c.set(u,aa.Completed)})}return o}};lt.ValueScope=tl});var Q=v(J=>{"use strict";Object.defineProperty(J,"__esModule",{value:!0});J.or=J.and=J.not=J.CodeGen=J.operators=J.varKinds=J.ValueScopeName=J.ValueScope=J.Scope=J.Name=J.regexpCode=J.stringify=J.getProperty=J.nil=J.strConcat=J.str=J._=void 0;var ne=lo(),Nt=rl(),Or=lo();Object.defineProperty(J,"_",{enumerable:!0,get:function(){return Or._}});Object.defineProperty(J,"str",{enumerable:!0,get:function(){return Or.str}});Object.defineProperty(J,"strConcat",{enumerable:!0,get:function(){return Or.strConcat}});Object.defineProperty(J,"nil",{enumerable:!0,get:function(){return Or.nil}});Object.defineProperty(J,"getProperty",{enumerable:!0,get:function(){return Or.getProperty}});Object.defineProperty(J,"stringify",{enumerable:!0,get:function(){return Or.stringify}});Object.defineProperty(J,"regexpCode",{enumerable:!0,get:function(){return Or.regexpCode}});Object.defineProperty(J,"Name",{enumerable:!0,get:function(){return Or.Name}});var fa=rl();Object.defineProperty(J,"Scope",{enumerable:!0,get:function(){return fa.Scope}});Object.defineProperty(J,"ValueScope",{enumerable:!0,get:function(){return fa.ValueScope}});Object.defineProperty(J,"ValueScopeName",{enumerable:!0,get:function(){return fa.ValueScopeName}});Object.defineProperty(J,"varKinds",{enumerable:!0,get:function(){return fa.varKinds}});J.operators={GT:new ne._Code(">"),GTE:new ne._Code(">="),LT:new ne._Code("<"),LTE:new ne._Code("<="),EQ:new ne._Code("==="),NEQ:new ne._Code("!=="),NOT:new ne._Code("!"),OR:new ne._Code("||"),AND:new ne._Code("&&"),ADD:new ne._Code("+")};var mr=class{optimizeNodes(){return this}optimizeNames(e,r){return this}},nl=class extends mr{constructor(e,r,n){super(),this.varKind=e,this.name=r,this.rhs=n}render({es5:e,_n:r}){let n=e?Nt.varKinds.var:this.varKind,s=this.rhs===void 0?"":` = ${this.rhs}`;return`${n} ${this.name}${s};`+r}optimizeNames(e,r){if(e[this.name.str])return this.rhs&&(this.rhs=ns(this.rhs,e,r)),this}get names(){return this.rhs instanceof ne._CodeOrName?this.rhs.names:{}}},la=class extends mr{constructor(e,r,n){super(),this.lhs=e,this.rhs=r,this.sideEffects=n}render({_n:e}){return`${this.lhs} = ${this.rhs};`+e}optimizeNames(e,r){if(!(this.lhs instanceof ne.Name&&!e[this.lhs.str]&&!this.sideEffects))return this.rhs=ns(this.rhs,e,r),this}get names(){let e=this.lhs instanceof ne.Name?{}:{...this.lhs.names};return pa(e,this.rhs)}},sl=class extends la{constructor(e,r,n,s){super(e,n,s),this.op=r}render({_n:e}){return`${this.lhs} ${this.op}= ${this.rhs};`+e}},ol=class extends mr{constructor(e){super(),this.label=e,this.names={}}render({_n:e}){return`${this.label}:`+e}},il=class extends mr{constructor(e){super(),this.label=e,this.names={}}render({_n:e}){return`break${this.label?` ${this.label}`:""};`+e}},al=class extends mr{constructor(e){super(),this.error=e}render({_n:e}){return`throw ${this.error};`+e}get names(){return this.error.names}},cl=class extends mr{constructor(e){super(),this.code=e}render({_n:e}){return`${this.code};`+e}optimizeNodes(){return`${this.code}`?this:void 0}optimizeNames(e,r){return this.code=ns(this.code,e,r),this}get names(){return this.code instanceof ne._CodeOrName?this.code.names:{}}},po=class extends mr{constructor(e=[]){super(),this.nodes=e}render(e){return this.nodes.reduce((r,n)=>r+n.render(e),"")}optimizeNodes(){let{nodes:e}=this,r=e.length;for(;r--;){let n=e[r].optimizeNodes();Array.isArray(n)?e.splice(r,1,...n):n?e[r]=n:e.splice(r,1)}return e.length>0?this:void 0}optimizeNames(e,r){let{nodes:n}=this,s=n.length;for(;s--;){let o=n[s];o.optimizeNames(e,r)||(tE(e,o.names),n.splice(s,1))}return n.length>0?this:void 0}get names(){return this.nodes.reduce((e,r)=>xn(e,r.names),{})}},hr=class extends po{render(e){return"{"+e._n+super.render(e)+"}"+e._n}},ul=class extends po{},rs=class extends hr{};rs.kind="else";var wn=class t extends hr{constructor(e,r){super(r),this.condition=e}render(e){let r=`if(${this.condition})`+super.render(e);return this.else&&(r+="else "+this.else.render(e)),r}optimizeNodes(){super.optimizeNodes();let e=this.condition;if(e===!0)return this.nodes;let r=this.else;if(r){let n=r.optimizeNodes();r=this.else=Array.isArray(n)?new rs(n):n}if(r)return e===!1?r instanceof t?r:r.nodes:this.nodes.length?this:new t(Ry(e),r instanceof t?[r]:r.nodes);if(!(e===!1||!this.nodes.length))return this}optimizeNames(e,r){var n;if(this.else=(n=this.else)===null||n===void 0?void 0:n.optimizeNames(e,r),!!(super.optimizeNames(e,r)||this.else))return this.condition=ns(this.condition,e,r),this}get names(){let e=super.names;return pa(e,this.condition),this.else&&xn(e,this.else.names),e}};wn.kind="if";var $n=class extends hr{};$n.kind="for";var ll=class extends $n{constructor(e){super(),this.iteration=e}render(e){return`for(${this.iteration})`+super.render(e)}optimizeNames(e,r){if(super.optimizeNames(e,r))return this.iteration=ns(this.iteration,e,r),this}get names(){return xn(super.names,this.iteration.names)}},dl=class extends $n{constructor(e,r,n,s){super(),this.varKind=e,this.name=r,this.from=n,this.to=s}render(e){let r=e.es5?Nt.varKinds.var:this.varKind,{name:n,from:s,to:o}=this;return`for(${r} ${n}=${s}; ${n}<${o}; ${n}++)`+super.render(e)}get names(){let e=pa(super.names,this.from);return pa(e,this.to)}},da=class extends $n{constructor(e,r,n,s){super(),this.loop=e,this.varKind=r,this.name=n,this.iterable=s}render(e){return`for(${this.varKind} ${this.name} ${this.loop} ${this.iterable})`+super.render(e)}optimizeNames(e,r){if(super.optimizeNames(e,r))return this.iterable=ns(this.iterable,e,r),this}get names(){return xn(super.names,this.iterable.names)}},fo=class extends hr{constructor(e,r,n){super(),this.name=e,this.args=r,this.async=n}render(e){return`${this.async?"async ":""}function ${this.name}(${this.args})`+super.render(e)}};fo.kind="func";var mo=class extends po{render(e){return"return "+super.render(e)}};mo.kind="return";var pl=class extends hr{render(e){let r="try"+super.render(e);return this.catch&&(r+=this.catch.render(e)),this.finally&&(r+=this.finally.render(e)),r}optimizeNodes(){var e,r;return super.optimizeNodes(),(e=this.catch)===null||e===void 0||e.optimizeNodes(),(r=this.finally)===null||r===void 0||r.optimizeNodes(),this}optimizeNames(e,r){var n,s;return super.optimizeNames(e,r),(n=this.catch)===null||n===void 0||n.optimizeNames(e,r),(s=this.finally)===null||s===void 0||s.optimizeNames(e,r),this}get names(){let e=super.names;return this.catch&&xn(e,this.catch.names),this.finally&&xn(e,this.finally.names),e}},ho=class extends hr{constructor(e){super(),this.error=e}render(e){return`catch(${this.error})`+super.render(e)}};ho.kind="catch";var go=class extends hr{render(e){return"finally"+super.render(e)}};go.kind="finally";var fl=class{constructor(e,r={}){this._values={},this._blockStarts=[],this._constants={},this.opts={...r,_n:r.lines?`
`:""},this._extScope=e,this._scope=new Nt.Scope({parent:e}),this._nodes=[new ul]}toString(){return this._root.render(this.opts)}name(e){return this._scope.name(e)}scopeName(e){return this._extScope.name(e)}scopeValue(e,r){let n=this._extScope.value(e,r);return(this._values[n.prefix]||(this._values[n.prefix]=new Set)).add(n),n}getScopeValue(e,r){return this._extScope.getValue(e,r)}scopeRefs(e){return this._extScope.scopeRefs(e,this._values)}scopeCode(){return this._extScope.scopeCode(this._values)}_def(e,r,n,s){let o=this._scope.toName(r);return n!==void 0&&s&&(this._constants[o.str]=n),this._leafNode(new nl(e,o,n)),o}const(e,r,n){return this._def(Nt.varKinds.const,e,r,n)}let(e,r,n){return this._def(Nt.varKinds.let,e,r,n)}var(e,r,n){return this._def(Nt.varKinds.var,e,r,n)}assign(e,r,n){return this._leafNode(new la(e,r,n))}add(e,r){return this._leafNode(new sl(e,J.operators.ADD,r))}code(e){return typeof e=="function"?e():e!==ne.nil&&this._leafNode(new cl(e)),this}object(...e){let r=["{"];for(let[n,s]of e)r.length>1&&r.push(","),r.push(n),(n!==s||this.opts.es5)&&(r.push(":"),(0,ne.addCodeArg)(r,s));return r.push("}"),new ne._Code(r)}if(e,r,n){if(this._blockNode(new wn(e)),r&&n)this.code(r).else().code(n).endIf();else if(r)this.code(r).endIf();else if(n)throw new Error('CodeGen: "else" body without "then" body');return this}elseIf(e){return this._elseNode(new wn(e))}else(){return this._elseNode(new rs)}endIf(){return this._endBlockNode(wn,rs)}_for(e,r){return this._blockNode(e),r&&this.code(r).endFor(),this}for(e,r){return this._for(new ll(e),r)}forRange(e,r,n,s,o=this.opts.es5?Nt.varKinds.var:Nt.varKinds.let){let i=this._scope.toName(e);return this._for(new dl(o,i,r,n),()=>s(i))}forOf(e,r,n,s=Nt.varKinds.const){let o=this._scope.toName(e);if(this.opts.es5){let i=r instanceof ne.Name?r:this.var("_arr",r);return this.forRange("_i",0,(0,ne._)`${i}.length`,a=>{this.var(o,(0,ne._)`${i}[${a}]`),n(o)})}return this._for(new da("of",s,o,r),()=>n(o))}forIn(e,r,n,s=this.opts.es5?Nt.varKinds.var:Nt.varKinds.const){if(this.opts.ownProperties)return this.forOf(e,(0,ne._)`Object.keys(${r})`,n);let o=this._scope.toName(e);return this._for(new da("in",s,o,r),()=>n(o))}endFor(){return this._endBlockNode($n)}label(e){return this._leafNode(new ol(e))}break(e){return this._leafNode(new il(e))}return(e){let r=new mo;if(this._blockNode(r),this.code(e),r.nodes.length!==1)throw new Error('CodeGen: "return" should have one node');return this._endBlockNode(mo)}try(e,r,n){if(!r&&!n)throw new Error('CodeGen: "try" without "catch" and "finally"');let s=new pl;if(this._blockNode(s),this.code(e),r){let o=this.name("e");this._currNode=s.catch=new ho(o),r(o)}return n&&(this._currNode=s.finally=new go,this.code(n)),this._endBlockNode(ho,go)}throw(e){return this._leafNode(new al(e))}block(e,r){return this._blockStarts.push(this._nodes.length),e&&this.code(e).endBlock(r),this}endBlock(e){let r=this._blockStarts.pop();if(r===void 0)throw new Error("CodeGen: not in self-balancing block");let n=this._nodes.length-r;if(n<0||e!==void 0&&n!==e)throw new Error(`CodeGen: wrong number of nodes: ${n} vs ${e} expected`);return this._nodes.length=r,this}func(e,r=ne.nil,n,s){return this._blockNode(new fo(e,r,n)),s&&this.code(s).endFunc(),this}endFunc(){return this._endBlockNode(fo)}optimize(e=1){for(;e-- >0;)this._root.optimizeNodes(),this._root.optimizeNames(this._root.names,this._constants)}_leafNode(e){return this._currNode.nodes.push(e),this}_blockNode(e){this._currNode.nodes.push(e),this._nodes.push(e)}_endBlockNode(e,r){let n=this._currNode;if(n instanceof e||r&&n instanceof r)return this._nodes.pop(),this;throw new Error(`CodeGen: not in block "${r?`${e.kind}/${r.kind}`:e.kind}"`)}_elseNode(e){let r=this._currNode;if(!(r instanceof wn))throw new Error('CodeGen: "else" without "if"');return this._currNode=r.else=e,this}get _root(){return this._nodes[0]}get _currNode(){let e=this._nodes;return e[e.length-1]}set _currNode(e){let r=this._nodes;r[r.length-1]=e}};J.CodeGen=fl;function xn(t,e){for(let r in e)t[r]=(t[r]||0)+(e[r]||0);return t}function pa(t,e){return e instanceof ne._CodeOrName?xn(t,e.names):t}function ns(t,e,r){if(t instanceof ne.Name)return n(t);if(!s(t))return t;return new ne._Code(t._items.reduce((o,i)=>(i instanceof ne.Name&&(i=n(i)),i instanceof ne._Code?o.push(...i._items):o.push(i),o),[]));function n(o){let i=r[o.str];return i===void 0||e[o.str]!==1?o:(delete e[o.str],i)}function s(o){return o instanceof ne._Code&&o._items.some(i=>i instanceof ne.Name&&e[i.str]===1&&r[i.str]!==void 0)}}function tE(t,e){for(let r in e)t[r]=(t[r]||0)-(e[r]||0)}function Ry(t){return typeof t=="boolean"||typeof t=="number"||t===null?!t:(0,ne._)`!${ml(t)}`}J.not=Ry;var rE=Oy(J.operators.AND);function nE(...t){return t.reduce(rE)}J.and=nE;var sE=Oy(J.operators.OR);function oE(...t){return t.reduce(sE)}J.or=oE;function Oy(t){return(e,r)=>e===ne.nil?r:r===ne.nil?e:(0,ne._)`${ml(e)} ${t} ${ml(r)}`}function ml(t){return t instanceof ne.Name?t:(0,ne._)`(${t})`}});var ce=v(X=>{"use strict";Object.defineProperty(X,"__esModule",{value:!0});X.checkStrictMode=X.getErrorPath=X.Type=X.useFunc=X.setEvaluated=X.evaluatedPropsToName=X.mergeEvaluated=X.eachItem=X.unescapeJsonPointer=X.escapeJsonPointer=X.escapeFragment=X.unescapeFragment=X.schemaRefOrVal=X.schemaHasRulesButRef=X.schemaHasRules=X.checkUnknownRules=X.alwaysValidSchema=X.toHash=void 0;var ge=Q(),iE=lo();function aE(t){let e={};for(let r of t)e[r]=!0;return e}X.toHash=aE;function cE(t,e){return typeof e=="boolean"?e:Object.keys(e).length===0?!0:(Ay(t,e),!My(e,t.self.RULES.all))}X.alwaysValidSchema=cE;function Ay(t,e=t.schema){let{opts:r,self:n}=t;if(!r.strictSchema||typeof e=="boolean")return;let s=n.RULES.keywords;for(let o in e)s[o]||Zy(t,`unknown keyword: "${o}"`)}X.checkUnknownRules=Ay;function My(t,e){if(typeof t=="boolean")return!t;for(let r in t)if(e[r])return!0;return!1}X.schemaHasRules=My;function uE(t,e){if(typeof t=="boolean")return!t;for(let r in t)if(r!=="$ref"&&e.all[r])return!0;return!1}X.schemaHasRulesButRef=uE;function lE({topSchemaRef:t,schemaPath:e},r,n,s){if(!s){if(typeof r=="number"||typeof r=="boolean")return r;if(typeof r=="string")return(0,ge._)`${r}`}return(0,ge._)`${t}${e}${(0,ge.getProperty)(n)}`}X.schemaRefOrVal=lE;function dE(t){return qy(decodeURIComponent(t))}X.unescapeFragment=dE;function pE(t){return encodeURIComponent(gl(t))}X.escapeFragment=pE;function gl(t){return typeof t=="number"?`${t}`:t.replace(/~/g,"~0").replace(/\//g,"~1")}X.escapeJsonPointer=gl;function qy(t){return t.replace(/~1/g,"/").replace(/~0/g,"~")}X.unescapeJsonPointer=qy;function fE(t,e){if(Array.isArray(t))for(let r of t)e(r);else e(t)}X.eachItem=fE;function Ny({mergeNames:t,mergeToName:e,mergeValues:r,resultToName:n}){return(s,o,i,a)=>{let c=i===void 0?o:i instanceof ge.Name?(o instanceof ge.Name?t(s,o,i):e(s,o,i),i):o instanceof ge.Name?(e(s,i,o),o):r(o,i);return a===ge.Name&&!(c instanceof ge.Name)?n(s,c):c}}X.mergeEvaluated={props:Ny({mergeNames:(t,e,r)=>t.if((0,ge._)`${r} !== true && ${e} !== undefined`,()=>{t.if((0,ge._)`${e} === true`,()=>t.assign(r,!0),()=>t.assign(r,(0,ge._)`${r} || {}`).code((0,ge._)`Object.assign(${r}, ${e})`))}),mergeToName:(t,e,r)=>t.if((0,ge._)`${r} !== true`,()=>{e===!0?t.assign(r,!0):(t.assign(r,(0,ge._)`${r} || {}`),yl(t,r,e))}),mergeValues:(t,e)=>t===!0?!0:{...t,...e},resultToName:Dy}),items:Ny({mergeNames:(t,e,r)=>t.if((0,ge._)`${r} !== true && ${e} !== undefined`,()=>t.assign(r,(0,ge._)`${e} === true ? true : ${r} > ${e} ? ${r} : ${e}`)),mergeToName:(t,e,r)=>t.if((0,ge._)`${r} !== true`,()=>t.assign(r,e===!0?!0:(0,ge._)`${r} > ${e} ? ${r} : ${e}`)),mergeValues:(t,e)=>t===!0?!0:Math.max(t,e),resultToName:(t,e)=>t.var("items",e)})};function Dy(t,e){if(e===!0)return t.var("props",!0);let r=t.var("props",(0,ge._)`{}`);return e!==void 0&&yl(t,r,e),r}X.evaluatedPropsToName=Dy;function yl(t,e,r){Object.keys(r).forEach(n=>t.assign((0,ge._)`${e}${(0,ge.getProperty)(n)}`,!0))}X.setEvaluated=yl;var jy={};function mE(t,e){return t.scopeValue("func",{ref:e,code:jy[e.code]||(jy[e.code]=new iE._Code(e.code))})}X.useFunc=mE;var hl;(function(t){t[t.Num=0]="Num",t[t.Str=1]="Str"})(hl||(X.Type=hl={}));function hE(t,e,r){if(t instanceof ge.Name){let n=e===hl.Num;return r?n?(0,ge._)`"[" + ${t} + "]"`:(0,ge._)`"['" + ${t} + "']"`:n?(0,ge._)`"/" + ${t}`:(0,ge._)`"/" + ${t}.replace(/~/g, "~0").replace(/\\//g, "~1")`}return r?(0,ge.getProperty)(t).toString():"/"+gl(t)}X.getErrorPath=hE;function Zy(t,e,r=t.opts.strictSchema){if(r){if(e=`strict mode: ${e}`,r===!0)throw new Error(e);t.self.logger.warn(e)}}X.checkStrictMode=Zy});var gr=v(vl=>{"use strict";Object.defineProperty(vl,"__esModule",{value:!0});var Je=Q(),gE={data:new Je.Name("data"),valCxt:new Je.Name("valCxt"),instancePath:new Je.Name("instancePath"),parentData:new Je.Name("parentData"),parentDataProperty:new Je.Name("parentDataProperty"),rootData:new Je.Name("rootData"),dynamicAnchors:new Je.Name("dynamicAnchors"),vErrors:new Je.Name("vErrors"),errors:new Je.Name("errors"),this:new Je.Name("this"),self:new Je.Name("self"),scope:new Je.Name("scope"),json:new Je.Name("json"),jsonPos:new Je.Name("jsonPos"),jsonLen:new Je.Name("jsonLen"),jsonPart:new Je.Name("jsonPart")};vl.default=gE});var yo=v(Ye=>{"use strict";Object.defineProperty(Ye,"__esModule",{value:!0});Ye.extendErrors=Ye.resetErrorsCount=Ye.reportExtraError=Ye.reportError=Ye.keyword$DataError=Ye.keywordError=void 0;var oe=Q(),ma=ce(),rt=gr();Ye.keywordError={message:({keyword:t})=>(0,oe.str)`must pass "${t}" keyword validation`};Ye.keyword$DataError={message:({keyword:t,schemaType:e})=>e?(0,oe.str)`"${t}" keyword must be ${e} ($data)`:(0,oe.str)`"${t}" keyword is invalid ($data)`};function yE(t,e=Ye.keywordError,r,n){let{it:s}=t,{gen:o,compositeRule:i,allErrors:a}=s,c=Fy(t,e,r);n??(i||a)?Ly(o,c):Vy(s,(0,oe._)`[${c}]`)}Ye.reportError=yE;function vE(t,e=Ye.keywordError,r){let{it:n}=t,{gen:s,compositeRule:o,allErrors:i}=n,a=Fy(t,e,r);Ly(s,a),o||i||Vy(n,rt.default.vErrors)}Ye.reportExtraError=vE;function _E(t,e){t.assign(rt.default.errors,e),t.if((0,oe._)`${rt.default.vErrors} !== null`,()=>t.if(e,()=>t.assign((0,oe._)`${rt.default.vErrors}.length`,e),()=>t.assign(rt.default.vErrors,null)))}Ye.resetErrorsCount=_E;function bE({gen:t,keyword:e,schemaValue:r,data:n,errsCount:s,it:o}){if(s===void 0)throw new Error("ajv implementation error");let i=t.name("err");t.forRange("i",s,rt.default.errors,a=>{t.const(i,(0,oe._)`${rt.default.vErrors}[${a}]`),t.if((0,oe._)`${i}.instancePath === undefined`,()=>t.assign((0,oe._)`${i}.instancePath`,(0,oe.strConcat)(rt.default.instancePath,o.errorPath))),t.assign((0,oe._)`${i}.schemaPath`,(0,oe.str)`${o.errSchemaPath}/${e}`),o.opts.verbose&&(t.assign((0,oe._)`${i}.schema`,r),t.assign((0,oe._)`${i}.data`,n))})}Ye.extendErrors=bE;function Ly(t,e){let r=t.const("err",e);t.if((0,oe._)`${rt.default.vErrors} === null`,()=>t.assign(rt.default.vErrors,(0,oe._)`[${r}]`),(0,oe._)`${rt.default.vErrors}.push(${r})`),t.code((0,oe._)`${rt.default.errors}++`)}function Vy(t,e){let{gen:r,validateName:n,schemaEnv:s}=t;s.$async?r.throw((0,oe._)`new ${t.ValidationError}(${e})`):(r.assign((0,oe._)`${n}.errors`,e),r.return(!1))}var kn={keyword:new oe.Name("keyword"),schemaPath:new oe.Name("schemaPath"),params:new oe.Name("params"),propertyName:new oe.Name("propertyName"),message:new oe.Name("message"),schema:new oe.Name("schema"),parentSchema:new oe.Name("parentSchema")};function Fy(t,e,r){let{createErrors:n}=t.it;return n===!1?(0,oe._)`{}`:wE(t,e,r)}function wE(t,e,r={}){let{gen:n,it:s}=t,o=[$E(s,r),xE(t,r)];return kE(t,e,o),n.object(...o)}function $E({errorPath:t},{instancePath:e}){let r=e?(0,oe.str)`${t}${(0,ma.getErrorPath)(e,ma.Type.Str)}`:t;return[rt.default.instancePath,(0,oe.strConcat)(rt.default.instancePath,r)]}function xE({keyword:t,it:{errSchemaPath:e}},{schemaPath:r,parentSchema:n}){let s=n?e:(0,oe.str)`${e}/${t}`;return r&&(s=(0,oe.str)`${s}${(0,ma.getErrorPath)(r,ma.Type.Str)}`),[kn.schemaPath,s]}function kE(t,{params:e,message:r},n){let{keyword:s,data:o,schemaValue:i,it:a}=t,{opts:c,propertyName:u,topSchemaRef:l,schemaPath:d}=a;n.push([kn.keyword,s],[kn.params,typeof e=="function"?e(t):e||(0,oe._)`{}`]),c.messages&&n.push([kn.message,typeof r=="function"?r(t):r]),c.verbose&&n.push([kn.schema,i],[kn.parentSchema,(0,oe._)`${l}${d}`],[rt.default.data,o]),u&&n.push([kn.propertyName,u])}});var Hy=v(ss=>{"use strict";Object.defineProperty(ss,"__esModule",{value:!0});ss.boolOrEmptySchema=ss.topBoolOrEmptySchema=void 0;var SE=yo(),PE=Q(),EE=gr(),TE={message:"boolean schema is false"};function zE(t){let{gen:e,schema:r,validateName:n}=t;r===!1?Uy(t,!1):typeof r=="object"&&r.$async===!0?e.return(EE.default.data):(e.assign((0,PE._)`${n}.errors`,null),e.return(!0))}ss.topBoolOrEmptySchema=zE;function CE(t,e){let{gen:r,schema:n}=t;n===!1?(r.var(e,!1),Uy(t)):r.var(e,!0)}ss.boolOrEmptySchema=CE;function Uy(t,e){let{gen:r,data:n}=t,s={gen:r,keyword:"false schema",data:n,schema:!1,schemaCode:!1,schemaValue:!1,params:{},it:t};(0,SE.reportError)(s,TE,void 0,e)}});var _l=v(os=>{"use strict";Object.defineProperty(os,"__esModule",{value:!0});os.getRules=os.isJSONType=void 0;var IE=["string","number","integer","boolean","null","object","array"],RE=new Set(IE);function OE(t){return typeof t=="string"&&RE.has(t)}os.isJSONType=OE;function NE(){let t={number:{type:"number",rules:[]},string:{type:"string",rules:[]},array:{type:"array",rules:[]},object:{type:"object",rules:[]}};return{types:{...t,integer:!0,boolean:!0,null:!0},rules:[{rules:[]},t.number,t.string,t.array,t.object],post:{rules:[]},all:{},keywords:{}}}os.getRules=NE});var bl=v(Nr=>{"use strict";Object.defineProperty(Nr,"__esModule",{value:!0});Nr.shouldUseRule=Nr.shouldUseGroup=Nr.schemaHasRulesForType=void 0;function jE({schema:t,self:e},r){let n=e.RULES.types[r];return n&&n!==!0&&Ky(t,n)}Nr.schemaHasRulesForType=jE;function Ky(t,e){return e.rules.some(r=>By(t,r))}Nr.shouldUseGroup=Ky;function By(t,e){var r;return t[e.keyword]!==void 0||((r=e.definition.implements)===null||r===void 0?void 0:r.some(n=>t[n]!==void 0))}Nr.shouldUseRule=By});var vo=v(Qe=>{"use strict";Object.defineProperty(Qe,"__esModule",{value:!0});Qe.reportTypeError=Qe.checkDataTypes=Qe.checkDataType=Qe.coerceAndCheckDataType=Qe.getJSONTypes=Qe.getSchemaTypes=Qe.DataType=void 0;var AE=_l(),ME=bl(),qE=yo(),K=Q(),Gy=ce(),is;(function(t){t[t.Correct=0]="Correct",t[t.Wrong=1]="Wrong"})(is||(Qe.DataType=is={}));function DE(t){let e=Wy(t.type);if(e.includes("null")){if(t.nullable===!1)throw new Error("type: null contradicts nullable: false")}else{if(!e.length&&t.nullable!==void 0)throw new Error('"nullable" cannot be used without "type"');t.nullable===!0&&e.push("null")}return e}Qe.getSchemaTypes=DE;function Wy(t){let e=Array.isArray(t)?t:t?[t]:[];if(e.every(AE.isJSONType))return e;throw new Error("type must be JSONType or JSONType[]: "+e.join(","))}Qe.getJSONTypes=Wy;function ZE(t,e){let{gen:r,data:n,opts:s}=t,o=LE(e,s.coerceTypes),i=e.length>0&&!(o.length===0&&e.length===1&&(0,ME.schemaHasRulesForType)(t,e[0]));if(i){let a=$l(e,n,s.strictNumbers,is.Wrong);r.if(a,()=>{o.length?VE(t,e,o):xl(t)})}return i}Qe.coerceAndCheckDataType=ZE;var Jy=new Set(["string","number","integer","boolean","null"]);function LE(t,e){return e?t.filter(r=>Jy.has(r)||e==="array"&&r==="array"):[]}function VE(t,e,r){let{gen:n,data:s,opts:o}=t,i=n.let("dataType",(0,K._)`typeof ${s}`),a=n.let("coerced",(0,K._)`undefined`);o.coerceTypes==="array"&&n.if((0,K._)`${i} == 'object' && Array.isArray(${s}) && ${s}.length == 1`,()=>n.assign(s,(0,K._)`${s}[0]`).assign(i,(0,K._)`typeof ${s}`).if($l(e,s,o.strictNumbers),()=>n.assign(a,s))),n.if((0,K._)`${a} !== undefined`);for(let u of r)(Jy.has(u)||u==="array"&&o.coerceTypes==="array")&&c(u);n.else(),xl(t),n.endIf(),n.if((0,K._)`${a} !== undefined`,()=>{n.assign(s,a),FE(t,a)});function c(u){switch(u){case"string":n.elseIf((0,K._)`${i} == "number" || ${i} == "boolean"`).assign(a,(0,K._)`"" + ${s}`).elseIf((0,K._)`${s} === null`).assign(a,(0,K._)`""`);return;case"number":n.elseIf((0,K._)`${i} == "boolean" || ${s} === null
              || (${i} == "string" && ${s} && ${s} == +${s})`).assign(a,(0,K._)`+${s}`);return;case"integer":n.elseIf((0,K._)`${i} === "boolean" || ${s} === null
              || (${i} === "string" && ${s} && ${s} == +${s} && !(${s} % 1))`).assign(a,(0,K._)`+${s}`);return;case"boolean":n.elseIf((0,K._)`${s} === "false" || ${s} === 0 || ${s} === null`).assign(a,!1).elseIf((0,K._)`${s} === "true" || ${s} === 1`).assign(a,!0);return;case"null":n.elseIf((0,K._)`${s} === "" || ${s} === 0 || ${s} === false`),n.assign(a,null);return;case"array":n.elseIf((0,K._)`${i} === "string" || ${i} === "number"
              || ${i} === "boolean" || ${s} === null`).assign(a,(0,K._)`[${s}]`)}}}function FE({gen:t,parentData:e,parentDataProperty:r},n){t.if((0,K._)`${e} !== undefined`,()=>t.assign((0,K._)`${e}[${r}]`,n))}function wl(t,e,r,n=is.Correct){let s=n===is.Correct?K.operators.EQ:K.operators.NEQ,o;switch(t){case"null":return(0,K._)`${e} ${s} null`;case"array":o=(0,K._)`Array.isArray(${e})`;break;case"object":o=(0,K._)`${e} && typeof ${e} == "object" && !Array.isArray(${e})`;break;case"integer":o=i((0,K._)`!(${e} % 1) && !isNaN(${e})`);break;case"number":o=i();break;default:return(0,K._)`typeof ${e} ${s} ${t}`}return n===is.Correct?o:(0,K.not)(o);function i(a=K.nil){return(0,K.and)((0,K._)`typeof ${e} == "number"`,a,r?(0,K._)`isFinite(${e})`:K.nil)}}Qe.checkDataType=wl;function $l(t,e,r,n){if(t.length===1)return wl(t[0],e,r,n);let s,o=(0,Gy.toHash)(t);if(o.array&&o.object){let i=(0,K._)`typeof ${e} != "object"`;s=o.null?i:(0,K._)`!${e} || ${i}`,delete o.null,delete o.array,delete o.object}else s=K.nil;o.number&&delete o.integer;for(let i in o)s=(0,K.and)(s,wl(i,e,r,n));return s}Qe.checkDataTypes=$l;var UE={message:({schema:t})=>`must be ${t}`,params:({schema:t,schemaValue:e})=>typeof t=="string"?(0,K._)`{type: ${t}}`:(0,K._)`{type: ${e}}`};function xl(t){let e=HE(t);(0,qE.reportError)(e,UE)}Qe.reportTypeError=xl;function HE(t){let{gen:e,data:r,schema:n}=t,s=(0,Gy.schemaRefOrVal)(t,n,"type");return{gen:e,keyword:"type",data:r,schema:n.type,schemaCode:s,schemaValue:s,parentSchema:n,params:{},it:t}}});var Qy=v(ha=>{"use strict";Object.defineProperty(ha,"__esModule",{value:!0});ha.assignDefaults=void 0;var as=Q(),KE=ce();function BE(t,e){let{properties:r,items:n}=t.schema;if(e==="object"&&r)for(let s in r)Yy(t,s,r[s].default);else e==="array"&&Array.isArray(n)&&n.forEach((s,o)=>Yy(t,o,s.default))}ha.assignDefaults=BE;function Yy(t,e,r){let{gen:n,compositeRule:s,data:o,opts:i}=t;if(r===void 0)return;let a=(0,as._)`${o}${(0,as.getProperty)(e)}`;if(s){(0,KE.checkStrictMode)(t,`default is ignored for: ${a}`);return}let c=(0,as._)`${a} === undefined`;i.useDefaults==="empty"&&(c=(0,as._)`${c} || ${a} === null || ${a} === ""`),n.if(c,(0,as._)`${a} = ${(0,as.stringify)(r)}`)}});var kt=v(fe=>{"use strict";Object.defineProperty(fe,"__esModule",{value:!0});fe.validateUnion=fe.validateArray=fe.usePattern=fe.callValidateCode=fe.schemaProperties=fe.allSchemaProperties=fe.noPropertyInData=fe.propertyInData=fe.isOwnProperty=fe.hasPropFunc=fe.reportMissingProp=fe.checkMissingProp=fe.checkReportMissingProp=void 0;var ke=Q(),kl=ce(),jr=gr(),GE=ce();function WE(t,e){let{gen:r,data:n,it:s}=t;r.if(Pl(r,n,e,s.opts.ownProperties),()=>{t.setParams({missingProperty:(0,ke._)`${e}`},!0),t.error()})}fe.checkReportMissingProp=WE;function JE({gen:t,data:e,it:{opts:r}},n,s){return(0,ke.or)(...n.map(o=>(0,ke.and)(Pl(t,e,o,r.ownProperties),(0,ke._)`${s} = ${o}`)))}fe.checkMissingProp=JE;function YE(t,e){t.setParams({missingProperty:e},!0),t.error()}fe.reportMissingProp=YE;function Xy(t){return t.scopeValue("func",{ref:Object.prototype.hasOwnProperty,code:(0,ke._)`Object.prototype.hasOwnProperty`})}fe.hasPropFunc=Xy;function Sl(t,e,r){return(0,ke._)`${Xy(t)}.call(${e}, ${r})`}fe.isOwnProperty=Sl;function QE(t,e,r,n){let s=(0,ke._)`${e}${(0,ke.getProperty)(r)} !== undefined`;return n?(0,ke._)`${s} && ${Sl(t,e,r)}`:s}fe.propertyInData=QE;function Pl(t,e,r,n){let s=(0,ke._)`${e}${(0,ke.getProperty)(r)} === undefined`;return n?(0,ke.or)(s,(0,ke.not)(Sl(t,e,r))):s}fe.noPropertyInData=Pl;function ev(t){return t?Object.keys(t).filter(e=>e!=="__proto__"):[]}fe.allSchemaProperties=ev;function XE(t,e){return ev(e).filter(r=>!(0,kl.alwaysValidSchema)(t,e[r]))}fe.schemaProperties=XE;function eT({schemaCode:t,data:e,it:{gen:r,topSchemaRef:n,schemaPath:s,errorPath:o},it:i},a,c,u){let l=u?(0,ke._)`${t}, ${e}, ${n}${s}`:e,d=[[jr.default.instancePath,(0,ke.strConcat)(jr.default.instancePath,o)],[jr.default.parentData,i.parentData],[jr.default.parentDataProperty,i.parentDataProperty],[jr.default.rootData,jr.default.rootData]];i.opts.dynamicRef&&d.push([jr.default.dynamicAnchors,jr.default.dynamicAnchors]);let f=(0,ke._)`${l}, ${r.object(...d)}`;return c!==ke.nil?(0,ke._)`${a}.call(${c}, ${f})`:(0,ke._)`${a}(${f})`}fe.callValidateCode=eT;var tT=(0,ke._)`new RegExp`;function rT({gen:t,it:{opts:e}},r){let n=e.unicodeRegExp?"u":"",{regExp:s}=e.code,o=s(r,n);return t.scopeValue("pattern",{key:o.toString(),ref:o,code:(0,ke._)`${s.code==="new RegExp"?tT:(0,GE.useFunc)(t,s)}(${r}, ${n})`})}fe.usePattern=rT;function nT(t){let{gen:e,data:r,keyword:n,it:s}=t,o=e.name("valid");if(s.allErrors){let a=e.let("valid",!0);return i(()=>e.assign(a,!1)),a}return e.var(o,!0),i(()=>e.break()),o;function i(a){let c=e.const("len",(0,ke._)`${r}.length`);e.forRange("i",0,c,u=>{t.subschema({keyword:n,dataProp:u,dataPropType:kl.Type.Num},o),e.if((0,ke.not)(o),a)})}}fe.validateArray=nT;function sT(t){let{gen:e,schema:r,keyword:n,it:s}=t;if(!Array.isArray(r))throw new Error("ajv implementation error");if(r.some(c=>(0,kl.alwaysValidSchema)(s,c))&&!s.opts.unevaluated)return;let i=e.let("valid",!1),a=e.name("_valid");e.block(()=>r.forEach((c,u)=>{let l=t.subschema({keyword:n,schemaProp:u,compositeRule:!0},a);e.assign(i,(0,ke._)`${i} || ${a}`),t.mergeValidEvaluated(l,a)||e.if((0,ke.not)(i))})),t.result(i,()=>t.reset(),()=>t.error(!0))}fe.validateUnion=sT});var nv=v(Yt=>{"use strict";Object.defineProperty(Yt,"__esModule",{value:!0});Yt.validateKeywordUsage=Yt.validSchemaType=Yt.funcKeywordCode=Yt.macroKeywordCode=void 0;var nt=Q(),Sn=gr(),oT=kt(),iT=yo();function aT(t,e){let{gen:r,keyword:n,schema:s,parentSchema:o,it:i}=t,a=e.macro.call(i.self,s,o,i),c=rv(r,n,a);i.opts.validateSchema!==!1&&i.self.validateSchema(a,!0);let u=r.name("valid");t.subschema({schema:a,schemaPath:nt.nil,errSchemaPath:`${i.errSchemaPath}/${n}`,topSchemaRef:c,compositeRule:!0},u),t.pass(u,()=>t.error(!0))}Yt.macroKeywordCode=aT;function cT(t,e){var r;let{gen:n,keyword:s,schema:o,parentSchema:i,$data:a,it:c}=t;lT(c,e);let u=!a&&e.compile?e.compile.call(c.self,o,i,c):e.validate,l=rv(n,s,u),d=n.let("valid");t.block$data(d,f),t.ok((r=e.valid)!==null&&r!==void 0?r:d);function f(){if(e.errors===!1)h(),e.modifying&&tv(t),g(()=>t.error());else{let y=e.async?p():m();e.modifying&&tv(t),g(()=>uT(t,y))}}function p(){let y=n.let("ruleErrs",null);return n.try(()=>h((0,nt._)`await `),x=>n.assign(d,!1).if((0,nt._)`${x} instanceof ${c.ValidationError}`,()=>n.assign(y,(0,nt._)`${x}.errors`),()=>n.throw(x))),y}function m(){let y=(0,nt._)`${l}.errors`;return n.assign(y,null),h(nt.nil),y}function h(y=e.async?(0,nt._)`await `:nt.nil){let x=c.opts.passContext?Sn.default.this:Sn.default.self,$=!("compile"in e&&!a||e.schema===!1);n.assign(d,(0,nt._)`${y}${(0,oT.callValidateCode)(t,l,x,$)}`,e.modifying)}function g(y){var x;n.if((0,nt.not)((x=e.valid)!==null&&x!==void 0?x:d),y)}}Yt.funcKeywordCode=cT;function tv(t){let{gen:e,data:r,it:n}=t;e.if(n.parentData,()=>e.assign(r,(0,nt._)`${n.parentData}[${n.parentDataProperty}]`))}function uT(t,e){let{gen:r}=t;r.if((0,nt._)`Array.isArray(${e})`,()=>{r.assign(Sn.default.vErrors,(0,nt._)`${Sn.default.vErrors} === null ? ${e} : ${Sn.default.vErrors}.concat(${e})`).assign(Sn.default.errors,(0,nt._)`${Sn.default.vErrors}.length`),(0,iT.extendErrors)(t)},()=>t.error())}function lT({schemaEnv:t},e){if(e.async&&!t.$async)throw new Error("async keyword in sync schema")}function rv(t,e,r){if(r===void 0)throw new Error(`keyword "${e}" failed to compile`);return t.scopeValue("keyword",typeof r=="function"?{ref:r}:{ref:r,code:(0,nt.stringify)(r)})}function dT(t,e,r=!1){return!e.length||e.some(n=>n==="array"?Array.isArray(t):n==="object"?t&&typeof t=="object"&&!Array.isArray(t):typeof t==n||r&&typeof t>"u")}Yt.validSchemaType=dT;function pT({schema:t,opts:e,self:r,errSchemaPath:n},s,o){if(Array.isArray(s.keyword)?!s.keyword.includes(o):s.keyword!==o)throw new Error("ajv implementation error");let i=s.dependencies;if(i?.some(a=>!Object.prototype.hasOwnProperty.call(t,a)))throw new Error(`parent schema must have dependencies of ${o}: ${i.join(",")}`);if(s.validateSchema&&!s.validateSchema(t[o])){let c=`keyword "${o}" value is invalid at path "${n}": `+r.errorsText(s.validateSchema.errors);if(e.validateSchema==="log")r.logger.error(c);else throw new Error(c)}}Yt.validateKeywordUsage=pT});var ov=v(Ar=>{"use strict";Object.defineProperty(Ar,"__esModule",{value:!0});Ar.extendSubschemaMode=Ar.extendSubschemaData=Ar.getSubschema=void 0;var Qt=Q(),sv=ce();function fT(t,{keyword:e,schemaProp:r,schema:n,schemaPath:s,errSchemaPath:o,topSchemaRef:i}){if(e!==void 0&&n!==void 0)throw new Error('both "keyword" and "schema" passed, only one allowed');if(e!==void 0){let a=t.schema[e];return r===void 0?{schema:a,schemaPath:(0,Qt._)`${t.schemaPath}${(0,Qt.getProperty)(e)}`,errSchemaPath:`${t.errSchemaPath}/${e}`}:{schema:a[r],schemaPath:(0,Qt._)`${t.schemaPath}${(0,Qt.getProperty)(e)}${(0,Qt.getProperty)(r)}`,errSchemaPath:`${t.errSchemaPath}/${e}/${(0,sv.escapeFragment)(r)}`}}if(n!==void 0){if(s===void 0||o===void 0||i===void 0)throw new Error('"schemaPath", "errSchemaPath" and "topSchemaRef" are required with "schema"');return{schema:n,schemaPath:s,topSchemaRef:i,errSchemaPath:o}}throw new Error('either "keyword" or "schema" must be passed')}Ar.getSubschema=fT;function mT(t,e,{dataProp:r,dataPropType:n,data:s,dataTypes:o,propertyName:i}){if(s!==void 0&&r!==void 0)throw new Error('both "data" and "dataProp" passed, only one allowed');let{gen:a}=e;if(r!==void 0){let{errorPath:u,dataPathArr:l,opts:d}=e,f=a.let("data",(0,Qt._)`${e.data}${(0,Qt.getProperty)(r)}`,!0);c(f),t.errorPath=(0,Qt.str)`${u}${(0,sv.getErrorPath)(r,n,d.jsPropertySyntax)}`,t.parentDataProperty=(0,Qt._)`${r}`,t.dataPathArr=[...l,t.parentDataProperty]}if(s!==void 0){let u=s instanceof Qt.Name?s:a.let("data",s,!0);c(u),i!==void 0&&(t.propertyName=i)}o&&(t.dataTypes=o);function c(u){t.data=u,t.dataLevel=e.dataLevel+1,t.dataTypes=[],e.definedProperties=new Set,t.parentData=e.data,t.dataNames=[...e.dataNames,u]}}Ar.extendSubschemaData=mT;function hT(t,{jtdDiscriminator:e,jtdMetadata:r,compositeRule:n,createErrors:s,allErrors:o}){n!==void 0&&(t.compositeRule=n),s!==void 0&&(t.createErrors=s),o!==void 0&&(t.allErrors=o),t.jtdDiscriminator=e,t.jtdMetadata=r}Ar.extendSubschemaMode=hT});var _o=v((_2,iv)=>{"use strict";iv.exports=function t(e,r){if(e===r)return!0;if(e&&r&&typeof e=="object"&&typeof r=="object"){if(e.constructor!==r.constructor)return!1;var n,s,o;if(Array.isArray(e)){if(n=e.length,n!=r.length)return!1;for(s=n;s--!==0;)if(!t(e[s],r[s]))return!1;return!0}if(e.constructor===RegExp)return e.source===r.source&&e.flags===r.flags;if(e.valueOf!==Object.prototype.valueOf)return e.valueOf()===r.valueOf();if(e.toString!==Object.prototype.toString)return e.toString()===r.toString();if(o=Object.keys(e),n=o.length,n!==Object.keys(r).length)return!1;for(s=n;s--!==0;)if(!Object.prototype.hasOwnProperty.call(r,o[s]))return!1;for(s=n;s--!==0;){var i=o[s];if(!t(e[i],r[i]))return!1}return!0}return e!==e&&r!==r}});var cv=v((b2,av)=>{"use strict";var Mr=av.exports=function(t,e,r){typeof e=="function"&&(r=e,e={}),r=e.cb||r;var n=typeof r=="function"?r:r.pre||function(){},s=r.post||function(){};ga(e,n,s,t,"",t)};Mr.keywords={additionalItems:!0,items:!0,contains:!0,additionalProperties:!0,propertyNames:!0,not:!0,if:!0,then:!0,else:!0};Mr.arrayKeywords={items:!0,allOf:!0,anyOf:!0,oneOf:!0};Mr.propsKeywords={$defs:!0,definitions:!0,properties:!0,patternProperties:!0,dependencies:!0};Mr.skipKeywords={default:!0,enum:!0,const:!0,required:!0,maximum:!0,minimum:!0,exclusiveMaximum:!0,exclusiveMinimum:!0,multipleOf:!0,maxLength:!0,minLength:!0,pattern:!0,format:!0,maxItems:!0,minItems:!0,uniqueItems:!0,maxProperties:!0,minProperties:!0};function ga(t,e,r,n,s,o,i,a,c,u){if(n&&typeof n=="object"&&!Array.isArray(n)){e(n,s,o,i,a,c,u);for(var l in n){var d=n[l];if(Array.isArray(d)){if(l in Mr.arrayKeywords)for(var f=0;f<d.length;f++)ga(t,e,r,d[f],s+"/"+l+"/"+f,o,s,l,n,f)}else if(l in Mr.propsKeywords){if(d&&typeof d=="object")for(var p in d)ga(t,e,r,d[p],s+"/"+l+"/"+gT(p),o,s,l,n,p)}else(l in Mr.keywords||t.allKeys&&!(l in Mr.skipKeywords))&&ga(t,e,r,d,s+"/"+l,o,s,l,n)}r(n,s,o,i,a,c,u)}}function gT(t){return t.replace(/~/g,"~0").replace(/\//g,"~1")}});var bo=v(dt=>{"use strict";Object.defineProperty(dt,"__esModule",{value:!0});dt.getSchemaRefs=dt.resolveUrl=dt.normalizeId=dt._getFullPath=dt.getFullPath=dt.inlineRef=void 0;var yT=ce(),vT=_o(),_T=cv(),bT=new Set(["type","format","pattern","maxLength","minLength","maxProperties","minProperties","maxItems","minItems","maximum","minimum","uniqueItems","multipleOf","required","enum","const"]);function wT(t,e=!0){return typeof t=="boolean"?!0:e===!0?!El(t):e?uv(t)<=e:!1}dt.inlineRef=wT;var $T=new Set(["$ref","$recursiveRef","$recursiveAnchor","$dynamicRef","$dynamicAnchor"]);function El(t){for(let e in t){if($T.has(e))return!0;let r=t[e];if(Array.isArray(r)&&r.some(El)||typeof r=="object"&&El(r))return!0}return!1}function uv(t){let e=0;for(let r in t){if(r==="$ref")return 1/0;if(e++,!bT.has(r)&&(typeof t[r]=="object"&&(0,yT.eachItem)(t[r],n=>e+=uv(n)),e===1/0))return 1/0}return e}function lv(t,e="",r){r!==!1&&(e=cs(e));let n=t.parse(e);return dv(t,n)}dt.getFullPath=lv;function dv(t,e){return t.serialize(e).split("#")[0]+"#"}dt._getFullPath=dv;var xT=/#\/?$/;function cs(t){return t?t.replace(xT,""):""}dt.normalizeId=cs;function kT(t,e,r){return r=cs(r),t.resolve(e,r)}dt.resolveUrl=kT;var ST=/^[a-z_][-a-z0-9._]*$/i;function PT(t,e){if(typeof t=="boolean")return{};let{schemaId:r,uriResolver:n}=this.opts,s=cs(t[r]||e),o={"":s},i=lv(n,s,!1),a={},c=new Set;return _T(t,{allKeys:!0},(d,f,p,m)=>{if(m===void 0)return;let h=i+f,g=o[m];typeof d[r]=="string"&&(g=y.call(this,d[r])),x.call(this,d.$anchor),x.call(this,d.$dynamicAnchor),o[f]=g;function y($){let S=this.opts.uriResolver.resolve;if($=cs(g?S(g,$):$),c.has($))throw l($);c.add($);let w=this.refs[$];return typeof w=="string"&&(w=this.refs[w]),typeof w=="object"?u(d,w.schema,$):$!==cs(h)&&($[0]==="#"?(u(d,a[$],$),a[$]=d):this.refs[$]=h),$}function x($){if(typeof $=="string"){if(!ST.test($))throw new Error(`invalid anchor "${$}"`);y.call(this,`#${$}`)}}}),a;function u(d,f,p){if(f!==void 0&&!vT(d,f))throw l(p)}function l(d){return new Error(`reference "${d}" resolves to more than one schema`)}}dt.getSchemaRefs=PT});var xo=v(qr=>{"use strict";Object.defineProperty(qr,"__esModule",{value:!0});qr.getData=qr.KeywordCxt=qr.validateFunctionCode=void 0;var gv=Hy(),pv=vo(),zl=bl(),ya=vo(),ET=Qy(),$o=nv(),Tl=ov(),O=Q(),L=gr(),TT=bo(),yr=ce(),wo=yo();function zT(t){if(_v(t)&&(bv(t),vv(t))){RT(t);return}yv(t,()=>(0,gv.topBoolOrEmptySchema)(t))}qr.validateFunctionCode=zT;function yv({gen:t,validateName:e,schema:r,schemaEnv:n,opts:s},o){s.code.es5?t.func(e,(0,O._)`${L.default.data}, ${L.default.valCxt}`,n.$async,()=>{t.code((0,O._)`"use strict"; ${fv(r,s)}`),IT(t,s),t.code(o)}):t.func(e,(0,O._)`${L.default.data}, ${CT(s)}`,n.$async,()=>t.code(fv(r,s)).code(o))}function CT(t){return(0,O._)`{${L.default.instancePath}="", ${L.default.parentData}, ${L.default.parentDataProperty}, ${L.default.rootData}=${L.default.data}${t.dynamicRef?(0,O._)`, ${L.default.dynamicAnchors}={}`:O.nil}}={}`}function IT(t,e){t.if(L.default.valCxt,()=>{t.var(L.default.instancePath,(0,O._)`${L.default.valCxt}.${L.default.instancePath}`),t.var(L.default.parentData,(0,O._)`${L.default.valCxt}.${L.default.parentData}`),t.var(L.default.parentDataProperty,(0,O._)`${L.default.valCxt}.${L.default.parentDataProperty}`),t.var(L.default.rootData,(0,O._)`${L.default.valCxt}.${L.default.rootData}`),e.dynamicRef&&t.var(L.default.dynamicAnchors,(0,O._)`${L.default.valCxt}.${L.default.dynamicAnchors}`)},()=>{t.var(L.default.instancePath,(0,O._)`""`),t.var(L.default.parentData,(0,O._)`undefined`),t.var(L.default.parentDataProperty,(0,O._)`undefined`),t.var(L.default.rootData,L.default.data),e.dynamicRef&&t.var(L.default.dynamicAnchors,(0,O._)`{}`)})}function RT(t){let{schema:e,opts:r,gen:n}=t;yv(t,()=>{r.$comment&&e.$comment&&$v(t),MT(t),n.let(L.default.vErrors,null),n.let(L.default.errors,0),r.unevaluated&&OT(t),wv(t),ZT(t)})}function OT(t){let{gen:e,validateName:r}=t;t.evaluated=e.const("evaluated",(0,O._)`${r}.evaluated`),e.if((0,O._)`${t.evaluated}.dynamicProps`,()=>e.assign((0,O._)`${t.evaluated}.props`,(0,O._)`undefined`)),e.if((0,O._)`${t.evaluated}.dynamicItems`,()=>e.assign((0,O._)`${t.evaluated}.items`,(0,O._)`undefined`))}function fv(t,e){let r=typeof t=="object"&&t[e.schemaId];return r&&(e.code.source||e.code.process)?(0,O._)`/*# sourceURL=${r} */`:O.nil}function NT(t,e){if(_v(t)&&(bv(t),vv(t))){jT(t,e);return}(0,gv.boolOrEmptySchema)(t,e)}function vv({schema:t,self:e}){if(typeof t=="boolean")return!t;for(let r in t)if(e.RULES.all[r])return!0;return!1}function _v(t){return typeof t.schema!="boolean"}function jT(t,e){let{schema:r,gen:n,opts:s}=t;s.$comment&&r.$comment&&$v(t),qT(t),DT(t);let o=n.const("_errs",L.default.errors);wv(t,o),n.var(e,(0,O._)`${o} === ${L.default.errors}`)}function bv(t){(0,yr.checkUnknownRules)(t),AT(t)}function wv(t,e){if(t.opts.jtd)return mv(t,[],!1,e);let r=(0,pv.getSchemaTypes)(t.schema),n=(0,pv.coerceAndCheckDataType)(t,r);mv(t,r,!n,e)}function AT(t){let{schema:e,errSchemaPath:r,opts:n,self:s}=t;e.$ref&&n.ignoreKeywordsWithRef&&(0,yr.schemaHasRulesButRef)(e,s.RULES)&&s.logger.warn(`$ref: keywords ignored in schema at path "${r}"`)}function MT(t){let{schema:e,opts:r}=t;e.default!==void 0&&r.useDefaults&&r.strictSchema&&(0,yr.checkStrictMode)(t,"default is ignored in the schema root")}function qT(t){let e=t.schema[t.opts.schemaId];e&&(t.baseId=(0,TT.resolveUrl)(t.opts.uriResolver,t.baseId,e))}function DT(t){if(t.schema.$async&&!t.schemaEnv.$async)throw new Error("async schema in sync schema")}function $v({gen:t,schemaEnv:e,schema:r,errSchemaPath:n,opts:s}){let o=r.$comment;if(s.$comment===!0)t.code((0,O._)`${L.default.self}.logger.log(${o})`);else if(typeof s.$comment=="function"){let i=(0,O.str)`${n}/$comment`,a=t.scopeValue("root",{ref:e.root});t.code((0,O._)`${L.default.self}.opts.$comment(${o}, ${i}, ${a}.schema)`)}}function ZT(t){let{gen:e,schemaEnv:r,validateName:n,ValidationError:s,opts:o}=t;r.$async?e.if((0,O._)`${L.default.errors} === 0`,()=>e.return(L.default.data),()=>e.throw((0,O._)`new ${s}(${L.default.vErrors})`)):(e.assign((0,O._)`${n}.errors`,L.default.vErrors),o.unevaluated&&LT(t),e.return((0,O._)`${L.default.errors} === 0`))}function LT({gen:t,evaluated:e,props:r,items:n}){r instanceof O.Name&&t.assign((0,O._)`${e}.props`,r),n instanceof O.Name&&t.assign((0,O._)`${e}.items`,n)}function mv(t,e,r,n){let{gen:s,schema:o,data:i,allErrors:a,opts:c,self:u}=t,{RULES:l}=u;if(o.$ref&&(c.ignoreKeywordsWithRef||!(0,yr.schemaHasRulesButRef)(o,l))){s.block(()=>kv(t,"$ref",l.all.$ref.definition));return}c.jtd||VT(t,e),s.block(()=>{for(let f of l.rules)d(f);d(l.post)});function d(f){(0,zl.shouldUseGroup)(o,f)&&(f.type?(s.if((0,ya.checkDataType)(f.type,i,c.strictNumbers)),hv(t,f),e.length===1&&e[0]===f.type&&r&&(s.else(),(0,ya.reportTypeError)(t)),s.endIf()):hv(t,f),a||s.if((0,O._)`${L.default.errors} === ${n||0}`))}}function hv(t,e){let{gen:r,schema:n,opts:{useDefaults:s}}=t;s&&(0,ET.assignDefaults)(t,e.type),r.block(()=>{for(let o of e.rules)(0,zl.shouldUseRule)(n,o)&&kv(t,o.keyword,o.definition,e.type)})}function VT(t,e){t.schemaEnv.meta||!t.opts.strictTypes||(FT(t,e),t.opts.allowUnionTypes||UT(t,e),HT(t,t.dataTypes))}function FT(t,e){if(e.length){if(!t.dataTypes.length){t.dataTypes=e;return}e.forEach(r=>{xv(t.dataTypes,r)||Cl(t,`type "${r}" not allowed by context "${t.dataTypes.join(",")}"`)}),BT(t,e)}}function UT(t,e){e.length>1&&!(e.length===2&&e.includes("null"))&&Cl(t,"use allowUnionTypes to allow union type keyword")}function HT(t,e){let r=t.self.RULES.all;for(let n in r){let s=r[n];if(typeof s=="object"&&(0,zl.shouldUseRule)(t.schema,s)){let{type:o}=s.definition;o.length&&!o.some(i=>KT(e,i))&&Cl(t,`missing type "${o.join(",")}" for keyword "${n}"`)}}}function KT(t,e){return t.includes(e)||e==="number"&&t.includes("integer")}function xv(t,e){return t.includes(e)||e==="integer"&&t.includes("number")}function BT(t,e){let r=[];for(let n of t.dataTypes)xv(e,n)?r.push(n):e.includes("integer")&&n==="number"&&r.push("integer");t.dataTypes=r}function Cl(t,e){let r=t.schemaEnv.baseId+t.errSchemaPath;e+=` at "${r}" (strictTypes)`,(0,yr.checkStrictMode)(t,e,t.opts.strictTypes)}var va=class{constructor(e,r,n){if((0,$o.validateKeywordUsage)(e,r,n),this.gen=e.gen,this.allErrors=e.allErrors,this.keyword=n,this.data=e.data,this.schema=e.schema[n],this.$data=r.$data&&e.opts.$data&&this.schema&&this.schema.$data,this.schemaValue=(0,yr.schemaRefOrVal)(e,this.schema,n,this.$data),this.schemaType=r.schemaType,this.parentSchema=e.schema,this.params={},this.it=e,this.def=r,this.$data)this.schemaCode=e.gen.const("vSchema",Sv(this.$data,e));else if(this.schemaCode=this.schemaValue,!(0,$o.validSchemaType)(this.schema,r.schemaType,r.allowUndefined))throw new Error(`${n} value must be ${JSON.stringify(r.schemaType)}`);("code"in r?r.trackErrors:r.errors!==!1)&&(this.errsCount=e.gen.const("_errs",L.default.errors))}result(e,r,n){this.failResult((0,O.not)(e),r,n)}failResult(e,r,n){this.gen.if(e),n?n():this.error(),r?(this.gen.else(),r(),this.allErrors&&this.gen.endIf()):this.allErrors?this.gen.endIf():this.gen.else()}pass(e,r){this.failResult((0,O.not)(e),void 0,r)}fail(e){if(e===void 0){this.error(),this.allErrors||this.gen.if(!1);return}this.gen.if(e),this.error(),this.allErrors?this.gen.endIf():this.gen.else()}fail$data(e){if(!this.$data)return this.fail(e);let{schemaCode:r}=this;this.fail((0,O._)`${r} !== undefined && (${(0,O.or)(this.invalid$data(),e)})`)}error(e,r,n){if(r){this.setParams(r),this._error(e,n),this.setParams({});return}this._error(e,n)}_error(e,r){(e?wo.reportExtraError:wo.reportError)(this,this.def.error,r)}$dataError(){(0,wo.reportError)(this,this.def.$dataError||wo.keyword$DataError)}reset(){if(this.errsCount===void 0)throw new Error('add "trackErrors" to keyword definition');(0,wo.resetErrorsCount)(this.gen,this.errsCount)}ok(e){this.allErrors||this.gen.if(e)}setParams(e,r){r?Object.assign(this.params,e):this.params=e}block$data(e,r,n=O.nil){this.gen.block(()=>{this.check$data(e,n),r()})}check$data(e=O.nil,r=O.nil){if(!this.$data)return;let{gen:n,schemaCode:s,schemaType:o,def:i}=this;n.if((0,O.or)((0,O._)`${s} === undefined`,r)),e!==O.nil&&n.assign(e,!0),(o.length||i.validateSchema)&&(n.elseIf(this.invalid$data()),this.$dataError(),e!==O.nil&&n.assign(e,!1)),n.else()}invalid$data(){let{gen:e,schemaCode:r,schemaType:n,def:s,it:o}=this;return(0,O.or)(i(),a());function i(){if(n.length){if(!(r instanceof O.Name))throw new Error("ajv implementation error");let c=Array.isArray(n)?n:[n];return(0,O._)`${(0,ya.checkDataTypes)(c,r,o.opts.strictNumbers,ya.DataType.Wrong)}`}return O.nil}function a(){if(s.validateSchema){let c=e.scopeValue("validate$data",{ref:s.validateSchema});return(0,O._)`!${c}(${r})`}return O.nil}}subschema(e,r){let n=(0,Tl.getSubschema)(this.it,e);(0,Tl.extendSubschemaData)(n,this.it,e),(0,Tl.extendSubschemaMode)(n,e);let s={...this.it,...n,items:void 0,props:void 0};return NT(s,r),s}mergeEvaluated(e,r){let{it:n,gen:s}=this;n.opts.unevaluated&&(n.props!==!0&&e.props!==void 0&&(n.props=yr.mergeEvaluated.props(s,e.props,n.props,r)),n.items!==!0&&e.items!==void 0&&(n.items=yr.mergeEvaluated.items(s,e.items,n.items,r)))}mergeValidEvaluated(e,r){let{it:n,gen:s}=this;if(n.opts.unevaluated&&(n.props!==!0||n.items!==!0))return s.if(r,()=>this.mergeEvaluated(e,O.Name)),!0}};qr.KeywordCxt=va;function kv(t,e,r,n){let s=new va(t,r,e);"code"in r?r.code(s,n):s.$data&&r.validate?(0,$o.funcKeywordCode)(s,r):"macro"in r?(0,$o.macroKeywordCode)(s,r):(r.compile||r.validate)&&(0,$o.funcKeywordCode)(s,r)}var GT=/^\/(?:[^~]|~0|~1)*$/,WT=/^([0-9]+)(#|\/(?:[^~]|~0|~1)*)?$/;function Sv(t,{dataLevel:e,dataNames:r,dataPathArr:n}){let s,o;if(t==="")return L.default.rootData;if(t[0]==="/"){if(!GT.test(t))throw new Error(`Invalid JSON-pointer: ${t}`);s=t,o=L.default.rootData}else{let u=WT.exec(t);if(!u)throw new Error(`Invalid JSON-pointer: ${t}`);let l=+u[1];if(s=u[2],s==="#"){if(l>=e)throw new Error(c("property/index",l));return n[e-l]}if(l>e)throw new Error(c("data",l));if(o=r[e-l],!s)return o}let i=o,a=s.split("/");for(let u of a)u&&(o=(0,O._)`${o}${(0,O.getProperty)((0,yr.unescapeJsonPointer)(u))}`,i=(0,O._)`${i} && ${o}`);return i;function c(u,l){return`Cannot access ${u} ${l} levels up, current level is ${e}`}}qr.getData=Sv});var _a=v(Rl=>{"use strict";Object.defineProperty(Rl,"__esModule",{value:!0});var Il=class extends Error{constructor(e){super("validation failed"),this.errors=e,this.ajv=this.validation=!0}};Rl.default=Il});var ko=v(jl=>{"use strict";Object.defineProperty(jl,"__esModule",{value:!0});var Ol=bo(),Nl=class extends Error{constructor(e,r,n,s){super(s||`can't resolve reference ${n} from id ${r}`),this.missingRef=(0,Ol.resolveUrl)(e,r,n),this.missingSchema=(0,Ol.normalizeId)((0,Ol.getFullPath)(e,this.missingRef))}};jl.default=Nl});var wa=v(St=>{"use strict";Object.defineProperty(St,"__esModule",{value:!0});St.resolveSchema=St.getCompilingSchema=St.resolveRef=St.compileSchema=St.SchemaEnv=void 0;var jt=Q(),JT=_a(),Pn=gr(),At=bo(),Pv=ce(),YT=xo(),us=class{constructor(e){var r;this.refs={},this.dynamicAnchors={};let n;typeof e.schema=="object"&&(n=e.schema),this.schema=e.schema,this.schemaId=e.schemaId,this.root=e.root||this,this.baseId=(r=e.baseId)!==null&&r!==void 0?r:(0,At.normalizeId)(n?.[e.schemaId||"$id"]),this.schemaPath=e.schemaPath,this.localRefs=e.localRefs,this.meta=e.meta,this.$async=n?.$async,this.refs={}}};St.SchemaEnv=us;function Ml(t){let e=Ev.call(this,t);if(e)return e;let r=(0,At.getFullPath)(this.opts.uriResolver,t.root.baseId),{es5:n,lines:s}=this.opts.code,{ownProperties:o}=this.opts,i=new jt.CodeGen(this.scope,{es5:n,lines:s,ownProperties:o}),a;t.$async&&(a=i.scopeValue("Error",{ref:JT.default,code:(0,jt._)`require("ajv/dist/runtime/validation_error").default`}));let c=i.scopeName("validate");t.validateName=c;let u={gen:i,allErrors:this.opts.allErrors,data:Pn.default.data,parentData:Pn.default.parentData,parentDataProperty:Pn.default.parentDataProperty,dataNames:[Pn.default.data],dataPathArr:[jt.nil],dataLevel:0,dataTypes:[],definedProperties:new Set,topSchemaRef:i.scopeValue("schema",this.opts.code.source===!0?{ref:t.schema,code:(0,jt.stringify)(t.schema)}:{ref:t.schema}),validateName:c,ValidationError:a,schema:t.schema,schemaEnv:t,rootId:r,baseId:t.baseId||r,schemaPath:jt.nil,errSchemaPath:t.schemaPath||(this.opts.jtd?"":"#"),errorPath:(0,jt._)`""`,opts:this.opts,self:this},l;try{this._compilations.add(t),(0,YT.validateFunctionCode)(u),i.optimize(this.opts.code.optimize);let d=i.toString();l=`${i.scopeRefs(Pn.default.scope)}return ${d}`,this.opts.code.process&&(l=this.opts.code.process(l,t));let p=new Function(`${Pn.default.self}`,`${Pn.default.scope}`,l)(this,this.scope.get());if(this.scope.value(c,{ref:p}),p.errors=null,p.schema=t.schema,p.schemaEnv=t,t.$async&&(p.$async=!0),this.opts.code.source===!0&&(p.source={validateName:c,validateCode:d,scopeValues:i._values}),this.opts.unevaluated){let{props:m,items:h}=u;p.evaluated={props:m instanceof jt.Name?void 0:m,items:h instanceof jt.Name?void 0:h,dynamicProps:m instanceof jt.Name,dynamicItems:h instanceof jt.Name},p.source&&(p.source.evaluated=(0,jt.stringify)(p.evaluated))}return t.validate=p,t}catch(d){throw delete t.validate,delete t.validateName,l&&this.logger.error("Error compiling schema, function code:",l),d}finally{this._compilations.delete(t)}}St.compileSchema=Ml;function QT(t,e,r){var n;r=(0,At.resolveUrl)(this.opts.uriResolver,e,r);let s=t.refs[r];if(s)return s;let o=tz.call(this,t,r);if(o===void 0){let i=(n=t.localRefs)===null||n===void 0?void 0:n[r],{schemaId:a}=this.opts;i&&(o=new us({schema:i,schemaId:a,root:t,baseId:e}))}if(o!==void 0)return t.refs[r]=XT.call(this,o)}St.resolveRef=QT;function XT(t){return(0,At.inlineRef)(t.schema,this.opts.inlineRefs)?t.schema:t.validate?t:Ml.call(this,t)}function Ev(t){for(let e of this._compilations)if(ez(e,t))return e}St.getCompilingSchema=Ev;function ez(t,e){return t.schema===e.schema&&t.root===e.root&&t.baseId===e.baseId}function tz(t,e){let r;for(;typeof(r=this.refs[e])=="string";)e=r;return r||this.schemas[e]||ba.call(this,t,e)}function ba(t,e){let r=this.opts.uriResolver.parse(e),n=(0,At._getFullPath)(this.opts.uriResolver,r),s=(0,At.getFullPath)(this.opts.uriResolver,t.baseId,void 0);if(Object.keys(t.schema).length>0&&n===s)return Al.call(this,r,t);let o=(0,At.normalizeId)(n),i=this.refs[o]||this.schemas[o];if(typeof i=="string"){let a=ba.call(this,t,i);return typeof a?.schema!="object"?void 0:Al.call(this,r,a)}if(typeof i?.schema=="object"){if(i.validate||Ml.call(this,i),o===(0,At.normalizeId)(e)){let{schema:a}=i,{schemaId:c}=this.opts,u=a[c];return u&&(s=(0,At.resolveUrl)(this.opts.uriResolver,s,u)),new us({schema:a,schemaId:c,root:t,baseId:s})}return Al.call(this,r,i)}}St.resolveSchema=ba;var rz=new Set(["properties","patternProperties","enum","dependencies","definitions"]);function Al(t,{baseId:e,schema:r,root:n}){var s;if(((s=t.fragment)===null||s===void 0?void 0:s[0])!=="/")return;for(let a of t.fragment.slice(1).split("/")){if(typeof r=="boolean")return;let c=r[(0,Pv.unescapeFragment)(a)];if(c===void 0)return;r=c;let u=typeof r=="object"&&r[this.opts.schemaId];!rz.has(a)&&u&&(e=(0,At.resolveUrl)(this.opts.uriResolver,e,u))}let o;if(typeof r!="boolean"&&r.$ref&&!(0,Pv.schemaHasRulesButRef)(r,this.RULES)){let a=(0,At.resolveUrl)(this.opts.uriResolver,e,r.$ref);o=ba.call(this,n,a)}let{schemaId:i}=this.opts;if(o=o||new us({schema:r,schemaId:i,root:n,baseId:e}),o.schema!==o.root.schema)return o}});var Tv=v((P2,nz)=>{nz.exports={$id:"https://raw.githubusercontent.com/ajv-validator/ajv/master/lib/refs/data.json#",description:"Meta-schema for $data reference (JSON AnySchema extension proposal)",type:"object",required:["$data"],properties:{$data:{type:"string",anyOf:[{format:"relative-json-pointer"},{format:"json-pointer"}]}},additionalProperties:!1}});var Dl=v((E2,Rv)=>{"use strict";var sz=RegExp.prototype.test.bind(/^[\da-f]{8}-[\da-f]{4}-[\da-f]{4}-[\da-f]{4}-[\da-f]{12}$/iu),Cv=RegExp.prototype.test.bind(/^(?:(?:25[0-5]|2[0-4]\d|1\d{2}|[1-9]\d|\d)\.){3}(?:25[0-5]|2[0-4]\d|1\d{2}|[1-9]\d|\d)$/u);function ql(t){let e="",r=0,n=0;for(n=0;n<t.length;n++)if(r=t[n].charCodeAt(0),r!==48){if(!(r>=48&&r<=57||r>=65&&r<=70||r>=97&&r<=102))return"";e+=t[n];break}for(n+=1;n<t.length;n++){if(r=t[n].charCodeAt(0),!(r>=48&&r<=57||r>=65&&r<=70||r>=97&&r<=102))return"";e+=t[n]}return e}var oz=RegExp.prototype.test.bind(/[^!"$&'()*+,\-.;=_`a-z{}~]/u);function zv(t){return t.length=0,!0}function iz(t,e,r){if(t.length){let n=ql(t);if(n!=="")e.push(n);else return r.error=!0,!1;t.length=0}return!0}function az(t){let e=0,r={error:!1,address:"",zone:""},n=[],s=[],o=!1,i=!1,a=iz;for(let c=0;c<t.length;c++){let u=t[c];if(!(u==="["||u==="]"))if(u===":"){if(o===!0&&(i=!0),!a(s,n,r))break;if(++e>7){r.error=!0;break}c>0&&t[c-1]===":"&&(o=!0),n.push(":");continue}else if(u==="%"){if(!a(s,n,r))break;a=zv}else{s.push(u);continue}}return s.length&&(a===zv?r.zone=s.join(""):i?n.push(s.join("")):n.push(ql(s))),r.address=n.join(""),r}function Iv(t){if(cz(t,":")<2)return{host:t,isIPV6:!1};let e=az(t);if(e.error)return{host:t,isIPV6:!1};{let r=e.address,n=e.address;return e.zone&&(r+="%"+e.zone,n+="%25"+e.zone),{host:r,isIPV6:!0,escapedHost:n}}}function cz(t,e){let r=0;for(let n=0;n<t.length;n++)t[n]===e&&r++;return r}function uz(t){let e=t,r=[],n=-1,s=0;for(;s=e.length;){if(s===1){if(e===".")break;if(e==="/"){r.push("/");break}else{r.push(e);break}}else if(s===2){if(e[0]==="."){if(e[1]===".")break;if(e[1]==="/"){e=e.slice(2);continue}}else if(e[0]==="/"&&(e[1]==="."||e[1]==="/")){r.push("/");break}}else if(s===3&&e==="/.."){r.length!==0&&r.pop(),r.push("/");break}if(e[0]==="."){if(e[1]==="."){if(e[2]==="/"){e=e.slice(3);continue}}else if(e[1]==="/"){e=e.slice(2);continue}}else if(e[0]==="/"&&e[1]==="."){if(e[2]==="/"){e=e.slice(2);continue}else if(e[2]==="."&&e[3]==="/"){e=e.slice(3),r.length!==0&&r.pop();continue}}if((n=e.indexOf("/",1))===-1){r.push(e);break}else r.push(e.slice(0,n)),e=e.slice(n)}return r.join("")}function lz(t,e){let r=e!==!0?escape:unescape;return t.scheme!==void 0&&(t.scheme=r(t.scheme)),t.userinfo!==void 0&&(t.userinfo=r(t.userinfo)),t.host!==void 0&&(t.host=r(t.host)),t.path!==void 0&&(t.path=r(t.path)),t.query!==void 0&&(t.query=r(t.query)),t.fragment!==void 0&&(t.fragment=r(t.fragment)),t}function dz(t){let e=[];if(t.userinfo!==void 0&&(e.push(t.userinfo),e.push("@")),t.host!==void 0){let r=unescape(t.host);if(!Cv(r)){let n=Iv(r);n.isIPV6===!0?r=`[${n.escapedHost}]`:r=t.host}e.push(r)}return(typeof t.port=="number"||typeof t.port=="string")&&(e.push(":"),e.push(String(t.port))),e.length?e.join(""):void 0}Rv.exports={nonSimpleDomain:oz,recomposeAuthority:dz,normalizeComponentEncoding:lz,removeDotSegments:uz,isIPv4:Cv,isUUID:sz,normalizeIPv6:Iv,stringArrayToHexStripped:ql}});var Mv=v((T2,Av)=>{"use strict";var{isUUID:pz}=Dl(),fz=/([\da-z][\d\-a-z]{0,31}):((?:[\w!$'()*+,\-.:;=@]|%[\da-f]{2})+)/iu,mz=["http","https","ws","wss","urn","urn:uuid"];function hz(t){return mz.indexOf(t)!==-1}function Zl(t){return t.secure===!0?!0:t.secure===!1?!1:t.scheme?t.scheme.length===3&&(t.scheme[0]==="w"||t.scheme[0]==="W")&&(t.scheme[1]==="s"||t.scheme[1]==="S")&&(t.scheme[2]==="s"||t.scheme[2]==="S"):!1}function Ov(t){return t.host||(t.error=t.error||"HTTP URIs must have a host."),t}function Nv(t){let e=String(t.scheme).toLowerCase()==="https";return(t.port===(e?443:80)||t.port==="")&&(t.port=void 0),t.path||(t.path="/"),t}function gz(t){return t.secure=Zl(t),t.resourceName=(t.path||"/")+(t.query?"?"+t.query:""),t.path=void 0,t.query=void 0,t}function yz(t){if((t.port===(Zl(t)?443:80)||t.port==="")&&(t.port=void 0),typeof t.secure=="boolean"&&(t.scheme=t.secure?"wss":"ws",t.secure=void 0),t.resourceName){let[e,r]=t.resourceName.split("?");t.path=e&&e!=="/"?e:void 0,t.query=r,t.resourceName=void 0}return t.fragment=void 0,t}function vz(t,e){if(!t.path)return t.error="URN can not be parsed",t;let r=t.path.match(fz);if(r){let n=e.scheme||t.scheme||"urn";t.nid=r[1].toLowerCase(),t.nss=r[2];let s=`${n}:${e.nid||t.nid}`,o=Ll(s);t.path=void 0,o&&(t=o.parse(t,e))}else t.error=t.error||"URN can not be parsed.";return t}function _z(t,e){if(t.nid===void 0)throw new Error("URN without nid cannot be serialized");let r=e.scheme||t.scheme||"urn",n=t.nid.toLowerCase(),s=`${r}:${e.nid||n}`,o=Ll(s);o&&(t=o.serialize(t,e));let i=t,a=t.nss;return i.path=`${n||e.nid}:${a}`,e.skipEscape=!0,i}function bz(t,e){let r=t;return r.uuid=r.nss,r.nss=void 0,!e.tolerant&&(!r.uuid||!pz(r.uuid))&&(r.error=r.error||"UUID is not valid."),r}function wz(t){let e=t;return e.nss=(t.uuid||"").toLowerCase(),e}var jv={scheme:"http",domainHost:!0,parse:Ov,serialize:Nv},$z={scheme:"https",domainHost:jv.domainHost,parse:Ov,serialize:Nv},$a={scheme:"ws",domainHost:!0,parse:gz,serialize:yz},xz={scheme:"wss",domainHost:$a.domainHost,parse:$a.parse,serialize:$a.serialize},kz={scheme:"urn",parse:vz,serialize:_z,skipNormalize:!0},Sz={scheme:"urn:uuid",parse:bz,serialize:wz,skipNormalize:!0},xa={http:jv,https:$z,ws:$a,wss:xz,urn:kz,"urn:uuid":Sz};Object.setPrototypeOf(xa,null);function Ll(t){return t&&(xa[t]||xa[t.toLowerCase()])||void 0}Av.exports={wsIsSecure:Zl,SCHEMES:xa,isValidSchemeName:hz,getSchemeHandler:Ll}});var Fl=v((z2,Sa)=>{"use strict";var{normalizeIPv6:Pz,removeDotSegments:So,recomposeAuthority:Ez,normalizeComponentEncoding:ka,isIPv4:Tz,nonSimpleDomain:zz}=Dl(),{SCHEMES:Cz,getSchemeHandler:qv}=Mv();function Iz(t,e){return typeof t=="string"?t=Xt(vr(t,e),e):typeof t=="object"&&(t=vr(Xt(t,e),e)),t}function Rz(t,e,r){let n=r?Object.assign({scheme:"null"},r):{scheme:"null"},s=Dv(vr(t,n),vr(e,n),n,!0);return n.skipEscape=!0,Xt(s,n)}function Dv(t,e,r,n){let s={};return n||(t=vr(Xt(t,r),r),e=vr(Xt(e,r),r)),r=r||{},!r.tolerant&&e.scheme?(s.scheme=e.scheme,s.userinfo=e.userinfo,s.host=e.host,s.port=e.port,s.path=So(e.path||""),s.query=e.query):(e.userinfo!==void 0||e.host!==void 0||e.port!==void 0?(s.userinfo=e.userinfo,s.host=e.host,s.port=e.port,s.path=So(e.path||""),s.query=e.query):(e.path?(e.path[0]==="/"?s.path=So(e.path):((t.userinfo!==void 0||t.host!==void 0||t.port!==void 0)&&!t.path?s.path="/"+e.path:t.path?s.path=t.path.slice(0,t.path.lastIndexOf("/")+1)+e.path:s.path=e.path,s.path=So(s.path)),s.query=e.query):(s.path=t.path,e.query!==void 0?s.query=e.query:s.query=t.query),s.userinfo=t.userinfo,s.host=t.host,s.port=t.port),s.scheme=t.scheme),s.fragment=e.fragment,s}function Oz(t,e,r){return typeof t=="string"?(t=unescape(t),t=Xt(ka(vr(t,r),!0),{...r,skipEscape:!0})):typeof t=="object"&&(t=Xt(ka(t,!0),{...r,skipEscape:!0})),typeof e=="string"?(e=unescape(e),e=Xt(ka(vr(e,r),!0),{...r,skipEscape:!0})):typeof e=="object"&&(e=Xt(ka(e,!0),{...r,skipEscape:!0})),t.toLowerCase()===e.toLowerCase()}function Xt(t,e){let r={host:t.host,scheme:t.scheme,userinfo:t.userinfo,port:t.port,path:t.path,query:t.query,nid:t.nid,nss:t.nss,uuid:t.uuid,fragment:t.fragment,reference:t.reference,resourceName:t.resourceName,secure:t.secure,error:""},n=Object.assign({},e),s=[],o=qv(n.scheme||r.scheme);o&&o.serialize&&o.serialize(r,n),r.path!==void 0&&(n.skipEscape?r.path=unescape(r.path):(r.path=escape(r.path),r.scheme!==void 0&&(r.path=r.path.split("%3A").join(":")))),n.reference!=="suffix"&&r.scheme&&s.push(r.scheme,":");let i=Ez(r);if(i!==void 0&&(n.reference!=="suffix"&&s.push("//"),s.push(i),r.path&&r.path[0]!=="/"&&s.push("/")),r.path!==void 0){let a=r.path;!n.absolutePath&&(!o||!o.absolutePath)&&(a=So(a)),i===void 0&&a[0]==="/"&&a[1]==="/"&&(a="/%2F"+a.slice(2)),s.push(a)}return r.query!==void 0&&s.push("?",r.query),r.fragment!==void 0&&s.push("#",r.fragment),s.join("")}var Nz=/^(?:([^#/:?]+):)?(?:\/\/((?:([^#/?@]*)@)?(\[[^#/?\]]+\]|[^#/:?]*)(?::(\d*))?))?([^#?]*)(?:\?([^#]*))?(?:#((?:.|[\n\r])*))?/u;function vr(t,e){let r=Object.assign({},e),n={scheme:void 0,userinfo:void 0,host:"",port:void 0,path:"",query:void 0,fragment:void 0},s=!1;r.reference==="suffix"&&(r.scheme?t=r.scheme+":"+t:t="//"+t);let o=t.match(Nz);if(o){if(n.scheme=o[1],n.userinfo=o[3],n.host=o[4],n.port=parseInt(o[5],10),n.path=o[6]||"",n.query=o[7],n.fragment=o[8],isNaN(n.port)&&(n.port=o[5]),n.host)if(Tz(n.host)===!1){let c=Pz(n.host);n.host=c.host.toLowerCase(),s=c.isIPV6}else s=!0;n.scheme===void 0&&n.userinfo===void 0&&n.host===void 0&&n.port===void 0&&n.query===void 0&&!n.path?n.reference="same-document":n.scheme===void 0?n.reference="relative":n.fragment===void 0?n.reference="absolute":n.reference="uri",r.reference&&r.reference!=="suffix"&&r.reference!==n.reference&&(n.error=n.error||"URI is not a "+r.reference+" reference.");let i=qv(r.scheme||n.scheme);if(!r.unicodeSupport&&(!i||!i.unicodeSupport)&&n.host&&(r.domainHost||i&&i.domainHost)&&s===!1&&zz(n.host))try{n.host=URL.domainToASCII(n.host.toLowerCase())}catch(a){n.error=n.error||"Host's domain name can not be converted to ASCII: "+a}(!i||i&&!i.skipNormalize)&&(t.indexOf("%")!==-1&&(n.scheme!==void 0&&(n.scheme=unescape(n.scheme)),n.host!==void 0&&(n.host=unescape(n.host))),n.path&&(n.path=escape(unescape(n.path))),n.fragment&&(n.fragment=encodeURI(decodeURIComponent(n.fragment)))),i&&i.parse&&i.parse(n,r)}else n.error=n.error||"URI can not be parsed.";return n}var Vl={SCHEMES:Cz,normalize:Iz,resolve:Rz,resolveComponent:Dv,equal:Oz,serialize:Xt,parse:vr};Sa.exports=Vl;Sa.exports.default=Vl;Sa.exports.fastUri=Vl});var Lv=v(Ul=>{"use strict";Object.defineProperty(Ul,"__esModule",{value:!0});var Zv=Fl();Zv.code='require("ajv/dist/runtime/uri").default';Ul.default=Zv});var Wv=v(Fe=>{"use strict";Object.defineProperty(Fe,"__esModule",{value:!0});Fe.CodeGen=Fe.Name=Fe.nil=Fe.stringify=Fe.str=Fe._=Fe.KeywordCxt=void 0;var jz=xo();Object.defineProperty(Fe,"KeywordCxt",{enumerable:!0,get:function(){return jz.KeywordCxt}});var ls=Q();Object.defineProperty(Fe,"_",{enumerable:!0,get:function(){return ls._}});Object.defineProperty(Fe,"str",{enumerable:!0,get:function(){return ls.str}});Object.defineProperty(Fe,"stringify",{enumerable:!0,get:function(){return ls.stringify}});Object.defineProperty(Fe,"nil",{enumerable:!0,get:function(){return ls.nil}});Object.defineProperty(Fe,"Name",{enumerable:!0,get:function(){return ls.Name}});Object.defineProperty(Fe,"CodeGen",{enumerable:!0,get:function(){return ls.CodeGen}});var Az=_a(),Kv=ko(),Mz=_l(),Po=wa(),qz=Q(),Eo=bo(),Pa=vo(),Kl=ce(),Vv=Tv(),Dz=Lv(),Bv=(t,e)=>new RegExp(t,e);Bv.code="new RegExp";var Zz=["removeAdditional","useDefaults","coerceTypes"],Lz=new Set(["validate","serialize","parse","wrapper","root","schema","keyword","pattern","formats","validate$data","func","obj","Error"]),Vz={errorDataPath:"",format:"`validateFormats: false` can be used instead.",nullable:'"nullable" keyword is supported by default.',jsonPointers:"Deprecated jsPropertySyntax can be used instead.",extendRefs:"Deprecated ignoreKeywordsWithRef can be used instead.",missingRefs:"Pass empty schema with $id that should be ignored to ajv.addSchema.",processCode:"Use option `code: {process: (code, schemaEnv: object) => string}`",sourceCode:"Use option `code: {source: true}`",strictDefaults:"It is default now, see option `strict`.",strictKeywords:"It is default now, see option `strict`.",uniqueItems:'"uniqueItems" keyword is always validated.',unknownFormats:"Disable strict mode or pass `true` to `ajv.addFormat` (or `formats` option).",cache:"Map is used as cache, schema object as key.",serialize:"Map is used as cache, schema object as key.",ajvErrors:"It is default now."},Fz={ignoreKeywordsWithRef:"",jsPropertySyntax:"",unicode:'"minLength"/"maxLength" account for unicode characters by default.'},Fv=200;function Uz(t){var e,r,n,s,o,i,a,c,u,l,d,f,p,m,h,g,y,x,$,S,w,D,F,Ce,H;let we=t.strict,Ae=(e=t.code)===null||e===void 0?void 0:e.optimize,Gr=Ae===!0||Ae===void 0?1:Ae||0,js=(n=(r=t.code)===null||r===void 0?void 0:r.regExp)!==null&&n!==void 0?n:Bv,Cc=(s=t.uriResolver)!==null&&s!==void 0?s:Dz.default;return{strictSchema:(i=(o=t.strictSchema)!==null&&o!==void 0?o:we)!==null&&i!==void 0?i:!0,strictNumbers:(c=(a=t.strictNumbers)!==null&&a!==void 0?a:we)!==null&&c!==void 0?c:!0,strictTypes:(l=(u=t.strictTypes)!==null&&u!==void 0?u:we)!==null&&l!==void 0?l:"log",strictTuples:(f=(d=t.strictTuples)!==null&&d!==void 0?d:we)!==null&&f!==void 0?f:"log",strictRequired:(m=(p=t.strictRequired)!==null&&p!==void 0?p:we)!==null&&m!==void 0?m:!1,code:t.code?{...t.code,optimize:Gr,regExp:js}:{optimize:Gr,regExp:js},loopRequired:(h=t.loopRequired)!==null&&h!==void 0?h:Fv,loopEnum:(g=t.loopEnum)!==null&&g!==void 0?g:Fv,meta:(y=t.meta)!==null&&y!==void 0?y:!0,messages:(x=t.messages)!==null&&x!==void 0?x:!0,inlineRefs:($=t.inlineRefs)!==null&&$!==void 0?$:!0,schemaId:(S=t.schemaId)!==null&&S!==void 0?S:"$id",addUsedSchema:(w=t.addUsedSchema)!==null&&w!==void 0?w:!0,validateSchema:(D=t.validateSchema)!==null&&D!==void 0?D:!0,validateFormats:(F=t.validateFormats)!==null&&F!==void 0?F:!0,unicodeRegExp:(Ce=t.unicodeRegExp)!==null&&Ce!==void 0?Ce:!0,int32range:(H=t.int32range)!==null&&H!==void 0?H:!0,uriResolver:Cc}}var To=class{constructor(e={}){this.schemas={},this.refs={},this.formats={},this._compilations=new Set,this._loading={},this._cache=new Map,e=this.opts={...e,...Uz(e)};let{es5:r,lines:n}=this.opts.code;this.scope=new qz.ValueScope({scope:{},prefixes:Lz,es5:r,lines:n}),this.logger=Jz(e.logger);let s=e.validateFormats;e.validateFormats=!1,this.RULES=(0,Mz.getRules)(),Uv.call(this,Vz,e,"NOT SUPPORTED"),Uv.call(this,Fz,e,"DEPRECATED","warn"),this._metaOpts=Gz.call(this),e.formats&&Kz.call(this),this._addVocabularies(),this._addDefaultMetaSchema(),e.keywords&&Bz.call(this,e.keywords),typeof e.meta=="object"&&this.addMetaSchema(e.meta),Hz.call(this),e.validateFormats=s}_addVocabularies(){this.addKeyword("$async")}_addDefaultMetaSchema(){let{$data:e,meta:r,schemaId:n}=this.opts,s=Vv;n==="id"&&(s={...Vv},s.id=s.$id,delete s.$id),r&&e&&this.addMetaSchema(s,s[n],!1)}defaultMeta(){let{meta:e,schemaId:r}=this.opts;return this.opts.defaultMeta=typeof e=="object"?e[r]||e:void 0}validate(e,r){let n;if(typeof e=="string"){if(n=this.getSchema(e),!n)throw new Error(`no schema with key or ref "${e}"`)}else n=this.compile(e);let s=n(r);return"$async"in n||(this.errors=n.errors),s}compile(e,r){let n=this._addSchema(e,r);return n.validate||this._compileSchemaEnv(n)}compileAsync(e,r){if(typeof this.opts.loadSchema!="function")throw new Error("options.loadSchema should be a function");let{loadSchema:n}=this.opts;return s.call(this,e,r);async function s(l,d){await o.call(this,l.$schema);let f=this._addSchema(l,d);return f.validate||i.call(this,f)}async function o(l){l&&!this.getSchema(l)&&await s.call(this,{$ref:l},!0)}async function i(l){try{return this._compileSchemaEnv(l)}catch(d){if(!(d instanceof Kv.default))throw d;return a.call(this,d),await c.call(this,d.missingSchema),i.call(this,l)}}function a({missingSchema:l,missingRef:d}){if(this.refs[l])throw new Error(`AnySchema ${l} is loaded but ${d} cannot be resolved`)}async function c(l){let d=await u.call(this,l);this.refs[l]||await o.call(this,d.$schema),this.refs[l]||this.addSchema(d,l,r)}async function u(l){let d=this._loading[l];if(d)return d;try{return await(this._loading[l]=n(l))}finally{delete this._loading[l]}}}addSchema(e,r,n,s=this.opts.validateSchema){if(Array.isArray(e)){for(let i of e)this.addSchema(i,void 0,n,s);return this}let o;if(typeof e=="object"){let{schemaId:i}=this.opts;if(o=e[i],o!==void 0&&typeof o!="string")throw new Error(`schema ${i} must be string`)}return r=(0,Eo.normalizeId)(r||o),this._checkUnique(r),this.schemas[r]=this._addSchema(e,n,r,s,!0),this}addMetaSchema(e,r,n=this.opts.validateSchema){return this.addSchema(e,r,!0,n),this}validateSchema(e,r){if(typeof e=="boolean")return!0;let n;if(n=e.$schema,n!==void 0&&typeof n!="string")throw new Error("$schema must be a string");if(n=n||this.opts.defaultMeta||this.defaultMeta(),!n)return this.logger.warn("meta-schema not available"),this.errors=null,!0;let s=this.validate(n,e);if(!s&&r){let o="schema is invalid: "+this.errorsText();if(this.opts.validateSchema==="log")this.logger.error(o);else throw new Error(o)}return s}getSchema(e){let r;for(;typeof(r=Hv.call(this,e))=="string";)e=r;if(r===void 0){let{schemaId:n}=this.opts,s=new Po.SchemaEnv({schema:{},schemaId:n});if(r=Po.resolveSchema.call(this,s,e),!r)return;this.refs[e]=r}return r.validate||this._compileSchemaEnv(r)}removeSchema(e){if(e instanceof RegExp)return this._removeAllSchemas(this.schemas,e),this._removeAllSchemas(this.refs,e),this;switch(typeof e){case"undefined":return this._removeAllSchemas(this.schemas),this._removeAllSchemas(this.refs),this._cache.clear(),this;case"string":{let r=Hv.call(this,e);return typeof r=="object"&&this._cache.delete(r.schema),delete this.schemas[e],delete this.refs[e],this}case"object":{let r=e;this._cache.delete(r);let n=e[this.opts.schemaId];return n&&(n=(0,Eo.normalizeId)(n),delete this.schemas[n],delete this.refs[n]),this}default:throw new Error("ajv.removeSchema: invalid parameter")}}addVocabulary(e){for(let r of e)this.addKeyword(r);return this}addKeyword(e,r){let n;if(typeof e=="string")n=e,typeof r=="object"&&(this.logger.warn("these parameters are deprecated, see docs for addKeyword"),r.keyword=n);else if(typeof e=="object"&&r===void 0){if(r=e,n=r.keyword,Array.isArray(n)&&!n.length)throw new Error("addKeywords: keyword must be string or non-empty array")}else throw new Error("invalid addKeywords parameters");if(Qz.call(this,n,r),!r)return(0,Kl.eachItem)(n,o=>Hl.call(this,o)),this;eC.call(this,r);let s={...r,type:(0,Pa.getJSONTypes)(r.type),schemaType:(0,Pa.getJSONTypes)(r.schemaType)};return(0,Kl.eachItem)(n,s.type.length===0?o=>Hl.call(this,o,s):o=>s.type.forEach(i=>Hl.call(this,o,s,i))),this}getKeyword(e){let r=this.RULES.all[e];return typeof r=="object"?r.definition:!!r}removeKeyword(e){let{RULES:r}=this;delete r.keywords[e],delete r.all[e];for(let n of r.rules){let s=n.rules.findIndex(o=>o.keyword===e);s>=0&&n.rules.splice(s,1)}return this}addFormat(e,r){return typeof r=="string"&&(r=new RegExp(r)),this.formats[e]=r,this}errorsText(e=this.errors,{separator:r=", ",dataVar:n="data"}={}){return!e||e.length===0?"No errors":e.map(s=>`${n}${s.instancePath} ${s.message}`).reduce((s,o)=>s+r+o)}$dataMetaSchema(e,r){let n=this.RULES.all;e=JSON.parse(JSON.stringify(e));for(let s of r){let o=s.split("/").slice(1),i=e;for(let a of o)i=i[a];for(let a in n){let c=n[a];if(typeof c!="object")continue;let{$data:u}=c.definition,l=i[a];u&&l&&(i[a]=Gv(l))}}return e}_removeAllSchemas(e,r){for(let n in e){let s=e[n];(!r||r.test(n))&&(typeof s=="string"?delete e[n]:s&&!s.meta&&(this._cache.delete(s.schema),delete e[n]))}}_addSchema(e,r,n,s=this.opts.validateSchema,o=this.opts.addUsedSchema){let i,{schemaId:a}=this.opts;if(typeof e=="object")i=e[a];else{if(this.opts.jtd)throw new Error("schema must be object");if(typeof e!="boolean")throw new Error("schema must be object or boolean")}let c=this._cache.get(e);if(c!==void 0)return c;n=(0,Eo.normalizeId)(i||n);let u=Eo.getSchemaRefs.call(this,e,n);return c=new Po.SchemaEnv({schema:e,schemaId:a,meta:r,baseId:n,localRefs:u}),this._cache.set(c.schema,c),o&&!n.startsWith("#")&&(n&&this._checkUnique(n),this.refs[n]=c),s&&this.validateSchema(e,!0),c}_checkUnique(e){if(this.schemas[e]||this.refs[e])throw new Error(`schema with key or id "${e}" already exists`)}_compileSchemaEnv(e){if(e.meta?this._compileMetaSchema(e):Po.compileSchema.call(this,e),!e.validate)throw new Error("ajv implementation error");return e.validate}_compileMetaSchema(e){let r=this.opts;this.opts=this._metaOpts;try{Po.compileSchema.call(this,e)}finally{this.opts=r}}};To.ValidationError=Az.default;To.MissingRefError=Kv.default;Fe.default=To;function Uv(t,e,r,n="error"){for(let s in t){let o=s;o in e&&this.logger[n](`${r}: option ${s}. ${t[o]}`)}}function Hv(t){return t=(0,Eo.normalizeId)(t),this.schemas[t]||this.refs[t]}function Hz(){let t=this.opts.schemas;if(t)if(Array.isArray(t))this.addSchema(t);else for(let e in t)this.addSchema(t[e],e)}function Kz(){for(let t in this.opts.formats){let e=this.opts.formats[t];e&&this.addFormat(t,e)}}function Bz(t){if(Array.isArray(t)){this.addVocabulary(t);return}this.logger.warn("keywords option as map is deprecated, pass array");for(let e in t){let r=t[e];r.keyword||(r.keyword=e),this.addKeyword(r)}}function Gz(){let t={...this.opts};for(let e of Zz)delete t[e];return t}var Wz={log(){},warn(){},error(){}};function Jz(t){if(t===!1)return Wz;if(t===void 0)return console;if(t.log&&t.warn&&t.error)return t;throw new Error("logger must implement log, warn and error methods")}var Yz=/^[a-z_$][a-z0-9_$:-]*$/i;function Qz(t,e){let{RULES:r}=this;if((0,Kl.eachItem)(t,n=>{if(r.keywords[n])throw new Error(`Keyword ${n} is already defined`);if(!Yz.test(n))throw new Error(`Keyword ${n} has invalid name`)}),!!e&&e.$data&&!("code"in e||"validate"in e))throw new Error('$data keyword must have "code" or "validate" function')}function Hl(t,e,r){var n;let s=e?.post;if(r&&s)throw new Error('keyword with "post" flag cannot have "type"');let{RULES:o}=this,i=s?o.post:o.rules.find(({type:c})=>c===r);if(i||(i={type:r,rules:[]},o.rules.push(i)),o.keywords[t]=!0,!e)return;let a={keyword:t,definition:{...e,type:(0,Pa.getJSONTypes)(e.type),schemaType:(0,Pa.getJSONTypes)(e.schemaType)}};e.before?Xz.call(this,i,a,e.before):i.rules.push(a),o.all[t]=a,(n=e.implements)===null||n===void 0||n.forEach(c=>this.addKeyword(c))}function Xz(t,e,r){let n=t.rules.findIndex(s=>s.keyword===r);n>=0?t.rules.splice(n,0,e):(t.rules.push(e),this.logger.warn(`rule ${r} is not defined`))}function eC(t){let{metaSchema:e}=t;e!==void 0&&(t.$data&&this.opts.$data&&(e=Gv(e)),t.validateSchema=this.compile(e,!0))}var tC={$ref:"https://raw.githubusercontent.com/ajv-validator/ajv/master/lib/refs/data.json#"};function Gv(t){return{anyOf:[t,tC]}}});var Jv=v(Bl=>{"use strict";Object.defineProperty(Bl,"__esModule",{value:!0});var rC={keyword:"id",code(){throw new Error('NOT SUPPORTED: keyword "id", use "$id" for schema ID')}};Bl.default=rC});var e_=v(En=>{"use strict";Object.defineProperty(En,"__esModule",{value:!0});En.callRef=En.getValidate=void 0;var nC=ko(),Yv=kt(),pt=Q(),ds=gr(),Qv=wa(),Ea=ce(),sC={keyword:"$ref",schemaType:"string",code(t){let{gen:e,schema:r,it:n}=t,{baseId:s,schemaEnv:o,validateName:i,opts:a,self:c}=n,{root:u}=o;if((r==="#"||r==="#/")&&s===u.baseId)return d();let l=Qv.resolveRef.call(c,u,s,r);if(l===void 0)throw new nC.default(n.opts.uriResolver,s,r);if(l instanceof Qv.SchemaEnv)return f(l);return p(l);function d(){if(o===u)return Ta(t,i,o,o.$async);let m=e.scopeValue("root",{ref:u});return Ta(t,(0,pt._)`${m}.validate`,u,u.$async)}function f(m){let h=Xv(t,m);Ta(t,h,m,m.$async)}function p(m){let h=e.scopeValue("schema",a.code.source===!0?{ref:m,code:(0,pt.stringify)(m)}:{ref:m}),g=e.name("valid"),y=t.subschema({schema:m,dataTypes:[],schemaPath:pt.nil,topSchemaRef:h,errSchemaPath:r},g);t.mergeEvaluated(y),t.ok(g)}}};function Xv(t,e){let{gen:r}=t;return e.validate?r.scopeValue("validate",{ref:e.validate}):(0,pt._)`${r.scopeValue("wrapper",{ref:e})}.validate`}En.getValidate=Xv;function Ta(t,e,r,n){let{gen:s,it:o}=t,{allErrors:i,schemaEnv:a,opts:c}=o,u=c.passContext?ds.default.this:pt.nil;n?l():d();function l(){if(!a.$async)throw new Error("async schema referenced by sync schema");let m=s.let("valid");s.try(()=>{s.code((0,pt._)`await ${(0,Yv.callValidateCode)(t,e,u)}`),p(e),i||s.assign(m,!0)},h=>{s.if((0,pt._)`!(${h} instanceof ${o.ValidationError})`,()=>s.throw(h)),f(h),i||s.assign(m,!1)}),t.ok(m)}function d(){t.result((0,Yv.callValidateCode)(t,e,u),()=>p(e),()=>f(e))}function f(m){let h=(0,pt._)`${m}.errors`;s.assign(ds.default.vErrors,(0,pt._)`${ds.default.vErrors} === null ? ${h} : ${ds.default.vErrors}.concat(${h})`),s.assign(ds.default.errors,(0,pt._)`${ds.default.vErrors}.length`)}function p(m){var h;if(!o.opts.unevaluated)return;let g=(h=r?.validate)===null||h===void 0?void 0:h.evaluated;if(o.props!==!0)if(g&&!g.dynamicProps)g.props!==void 0&&(o.props=Ea.mergeEvaluated.props(s,g.props,o.props));else{let y=s.var("props",(0,pt._)`${m}.evaluated.props`);o.props=Ea.mergeEvaluated.props(s,y,o.props,pt.Name)}if(o.items!==!0)if(g&&!g.dynamicItems)g.items!==void 0&&(o.items=Ea.mergeEvaluated.items(s,g.items,o.items));else{let y=s.var("items",(0,pt._)`${m}.evaluated.items`);o.items=Ea.mergeEvaluated.items(s,y,o.items,pt.Name)}}}En.callRef=Ta;En.default=sC});var t_=v(Gl=>{"use strict";Object.defineProperty(Gl,"__esModule",{value:!0});var oC=Jv(),iC=e_(),aC=["$schema","$id","$defs","$vocabulary",{keyword:"$comment"},"definitions",oC.default,iC.default];Gl.default=aC});var r_=v(Wl=>{"use strict";Object.defineProperty(Wl,"__esModule",{value:!0});var za=Q(),Dr=za.operators,Ca={maximum:{okStr:"<=",ok:Dr.LTE,fail:Dr.GT},minimum:{okStr:">=",ok:Dr.GTE,fail:Dr.LT},exclusiveMaximum:{okStr:"<",ok:Dr.LT,fail:Dr.GTE},exclusiveMinimum:{okStr:">",ok:Dr.GT,fail:Dr.LTE}},cC={message:({keyword:t,schemaCode:e})=>(0,za.str)`must be ${Ca[t].okStr} ${e}`,params:({keyword:t,schemaCode:e})=>(0,za._)`{comparison: ${Ca[t].okStr}, limit: ${e}}`},uC={keyword:Object.keys(Ca),type:"number",schemaType:"number",$data:!0,error:cC,code(t){let{keyword:e,data:r,schemaCode:n}=t;t.fail$data((0,za._)`${r} ${Ca[e].fail} ${n} || isNaN(${r})`)}};Wl.default=uC});var n_=v(Jl=>{"use strict";Object.defineProperty(Jl,"__esModule",{value:!0});var zo=Q(),lC={message:({schemaCode:t})=>(0,zo.str)`must be multiple of ${t}`,params:({schemaCode:t})=>(0,zo._)`{multipleOf: ${t}}`},dC={keyword:"multipleOf",type:"number",schemaType:"number",$data:!0,error:lC,code(t){let{gen:e,data:r,schemaCode:n,it:s}=t,o=s.opts.multipleOfPrecision,i=e.let("res"),a=o?(0,zo._)`Math.abs(Math.round(${i}) - ${i}) > 1e-${o}`:(0,zo._)`${i} !== parseInt(${i})`;t.fail$data((0,zo._)`(${n} === 0 || (${i} = ${r}/${n}, ${a}))`)}};Jl.default=dC});var o_=v(Yl=>{"use strict";Object.defineProperty(Yl,"__esModule",{value:!0});function s_(t){let e=t.length,r=0,n=0,s;for(;n<e;)r++,s=t.charCodeAt(n++),s>=55296&&s<=56319&&n<e&&(s=t.charCodeAt(n),(s&64512)===56320&&n++);return r}Yl.default=s_;s_.code='require("ajv/dist/runtime/ucs2length").default'});var i_=v(Ql=>{"use strict";Object.defineProperty(Ql,"__esModule",{value:!0});var Tn=Q(),pC=ce(),fC=o_(),mC={message({keyword:t,schemaCode:e}){let r=t==="maxLength"?"more":"fewer";return(0,Tn.str)`must NOT have ${r} than ${e} characters`},params:({schemaCode:t})=>(0,Tn._)`{limit: ${t}}`},hC={keyword:["maxLength","minLength"],type:"string",schemaType:"number",$data:!0,error:mC,code(t){let{keyword:e,data:r,schemaCode:n,it:s}=t,o=e==="maxLength"?Tn.operators.GT:Tn.operators.LT,i=s.opts.unicode===!1?(0,Tn._)`${r}.length`:(0,Tn._)`${(0,pC.useFunc)(t.gen,fC.default)}(${r})`;t.fail$data((0,Tn._)`${i} ${o} ${n}`)}};Ql.default=hC});var a_=v(Xl=>{"use strict";Object.defineProperty(Xl,"__esModule",{value:!0});var gC=kt(),Ia=Q(),yC={message:({schemaCode:t})=>(0,Ia.str)`must match pattern "${t}"`,params:({schemaCode:t})=>(0,Ia._)`{pattern: ${t}}`},vC={keyword:"pattern",type:"string",schemaType:"string",$data:!0,error:yC,code(t){let{data:e,$data:r,schema:n,schemaCode:s,it:o}=t,i=o.opts.unicodeRegExp?"u":"",a=r?(0,Ia._)`(new RegExp(${s}, ${i}))`:(0,gC.usePattern)(t,n);t.fail$data((0,Ia._)`!${a}.test(${e})`)}};Xl.default=vC});var c_=v(ed=>{"use strict";Object.defineProperty(ed,"__esModule",{value:!0});var Co=Q(),_C={message({keyword:t,schemaCode:e}){let r=t==="maxProperties"?"more":"fewer";return(0,Co.str)`must NOT have ${r} than ${e} properties`},params:({schemaCode:t})=>(0,Co._)`{limit: ${t}}`},bC={keyword:["maxProperties","minProperties"],type:"object",schemaType:"number",$data:!0,error:_C,code(t){let{keyword:e,data:r,schemaCode:n}=t,s=e==="maxProperties"?Co.operators.GT:Co.operators.LT;t.fail$data((0,Co._)`Object.keys(${r}).length ${s} ${n}`)}};ed.default=bC});var u_=v(td=>{"use strict";Object.defineProperty(td,"__esModule",{value:!0});var Io=kt(),Ro=Q(),wC=ce(),$C={message:({params:{missingProperty:t}})=>(0,Ro.str)`must have required property '${t}'`,params:({params:{missingProperty:t}})=>(0,Ro._)`{missingProperty: ${t}}`},xC={keyword:"required",type:"object",schemaType:"array",$data:!0,error:$C,code(t){let{gen:e,schema:r,schemaCode:n,data:s,$data:o,it:i}=t,{opts:a}=i;if(!o&&r.length===0)return;let c=r.length>=a.loopRequired;if(i.allErrors?u():l(),a.strictRequired){let p=t.parentSchema.properties,{definedProperties:m}=t.it;for(let h of r)if(p?.[h]===void 0&&!m.has(h)){let g=i.schemaEnv.baseId+i.errSchemaPath,y=`required property "${h}" is not defined at "${g}" (strictRequired)`;(0,wC.checkStrictMode)(i,y,i.opts.strictRequired)}}function u(){if(c||o)t.block$data(Ro.nil,d);else for(let p of r)(0,Io.checkReportMissingProp)(t,p)}function l(){let p=e.let("missing");if(c||o){let m=e.let("valid",!0);t.block$data(m,()=>f(p,m)),t.ok(m)}else e.if((0,Io.checkMissingProp)(t,r,p)),(0,Io.reportMissingProp)(t,p),e.else()}function d(){e.forOf("prop",n,p=>{t.setParams({missingProperty:p}),e.if((0,Io.noPropertyInData)(e,s,p,a.ownProperties),()=>t.error())})}function f(p,m){t.setParams({missingProperty:p}),e.forOf(p,n,()=>{e.assign(m,(0,Io.propertyInData)(e,s,p,a.ownProperties)),e.if((0,Ro.not)(m),()=>{t.error(),e.break()})},Ro.nil)}}};td.default=xC});var l_=v(rd=>{"use strict";Object.defineProperty(rd,"__esModule",{value:!0});var Oo=Q(),kC={message({keyword:t,schemaCode:e}){let r=t==="maxItems"?"more":"fewer";return(0,Oo.str)`must NOT have ${r} than ${e} items`},params:({schemaCode:t})=>(0,Oo._)`{limit: ${t}}`},SC={keyword:["maxItems","minItems"],type:"array",schemaType:"number",$data:!0,error:kC,code(t){let{keyword:e,data:r,schemaCode:n}=t,s=e==="maxItems"?Oo.operators.GT:Oo.operators.LT;t.fail$data((0,Oo._)`${r}.length ${s} ${n}`)}};rd.default=SC});var Ra=v(nd=>{"use strict";Object.defineProperty(nd,"__esModule",{value:!0});var d_=_o();d_.code='require("ajv/dist/runtime/equal").default';nd.default=d_});var p_=v(od=>{"use strict";Object.defineProperty(od,"__esModule",{value:!0});var sd=vo(),Ue=Q(),PC=ce(),EC=Ra(),TC={message:({params:{i:t,j:e}})=>(0,Ue.str)`must NOT have duplicate items (items ## ${e} and ${t} are identical)`,params:({params:{i:t,j:e}})=>(0,Ue._)`{i: ${t}, j: ${e}}`},zC={keyword:"uniqueItems",type:"array",schemaType:"boolean",$data:!0,error:TC,code(t){let{gen:e,data:r,$data:n,schema:s,parentSchema:o,schemaCode:i,it:a}=t;if(!n&&!s)return;let c=e.let("valid"),u=o.items?(0,sd.getSchemaTypes)(o.items):[];t.block$data(c,l,(0,Ue._)`${i} === false`),t.ok(c);function l(){let m=e.let("i",(0,Ue._)`${r}.length`),h=e.let("j");t.setParams({i:m,j:h}),e.assign(c,!0),e.if((0,Ue._)`${m} > 1`,()=>(d()?f:p)(m,h))}function d(){return u.length>0&&!u.some(m=>m==="object"||m==="array")}function f(m,h){let g=e.name("item"),y=(0,sd.checkDataTypes)(u,g,a.opts.strictNumbers,sd.DataType.Wrong),x=e.const("indices",(0,Ue._)`{}`);e.for((0,Ue._)`;${m}--;`,()=>{e.let(g,(0,Ue._)`${r}[${m}]`),e.if(y,(0,Ue._)`continue`),u.length>1&&e.if((0,Ue._)`typeof ${g} == "string"`,(0,Ue._)`${g} += "_"`),e.if((0,Ue._)`typeof ${x}[${g}] == "number"`,()=>{e.assign(h,(0,Ue._)`${x}[${g}]`),t.error(),e.assign(c,!1).break()}).code((0,Ue._)`${x}[${g}] = ${m}`)})}function p(m,h){let g=(0,PC.useFunc)(e,EC.default),y=e.name("outer");e.label(y).for((0,Ue._)`;${m}--;`,()=>e.for((0,Ue._)`${h} = ${m}; ${h}--;`,()=>e.if((0,Ue._)`${g}(${r}[${m}], ${r}[${h}])`,()=>{t.error(),e.assign(c,!1).break(y)})))}}};od.default=zC});var f_=v(ad=>{"use strict";Object.defineProperty(ad,"__esModule",{value:!0});var id=Q(),CC=ce(),IC=Ra(),RC={message:"must be equal to constant",params:({schemaCode:t})=>(0,id._)`{allowedValue: ${t}}`},OC={keyword:"const",$data:!0,error:RC,code(t){let{gen:e,data:r,$data:n,schemaCode:s,schema:o}=t;n||o&&typeof o=="object"?t.fail$data((0,id._)`!${(0,CC.useFunc)(e,IC.default)}(${r}, ${s})`):t.fail((0,id._)`${o} !== ${r}`)}};ad.default=OC});var m_=v(cd=>{"use strict";Object.defineProperty(cd,"__esModule",{value:!0});var No=Q(),NC=ce(),jC=Ra(),AC={message:"must be equal to one of the allowed values",params:({schemaCode:t})=>(0,No._)`{allowedValues: ${t}}`},MC={keyword:"enum",schemaType:"array",$data:!0,error:AC,code(t){let{gen:e,data:r,$data:n,schema:s,schemaCode:o,it:i}=t;if(!n&&s.length===0)throw new Error("enum must have non-empty array");let a=s.length>=i.opts.loopEnum,c,u=()=>c??(c=(0,NC.useFunc)(e,jC.default)),l;if(a||n)l=e.let("valid"),t.block$data(l,d);else{if(!Array.isArray(s))throw new Error("ajv implementation error");let p=e.const("vSchema",o);l=(0,No.or)(...s.map((m,h)=>f(p,h)))}t.pass(l);function d(){e.assign(l,!1),e.forOf("v",o,p=>e.if((0,No._)`${u()}(${r}, ${p})`,()=>e.assign(l,!0).break()))}function f(p,m){let h=s[m];return typeof h=="object"&&h!==null?(0,No._)`${u()}(${r}, ${p}[${m}])`:(0,No._)`${r} === ${h}`}}};cd.default=MC});var h_=v(ud=>{"use strict";Object.defineProperty(ud,"__esModule",{value:!0});var qC=r_(),DC=n_(),ZC=i_(),LC=a_(),VC=c_(),FC=u_(),UC=l_(),HC=p_(),KC=f_(),BC=m_(),GC=[qC.default,DC.default,ZC.default,LC.default,VC.default,FC.default,UC.default,HC.default,{keyword:"type",schemaType:["string","array"]},{keyword:"nullable",schemaType:"boolean"},KC.default,BC.default];ud.default=GC});var dd=v(jo=>{"use strict";Object.defineProperty(jo,"__esModule",{value:!0});jo.validateAdditionalItems=void 0;var zn=Q(),ld=ce(),WC={message:({params:{len:t}})=>(0,zn.str)`must NOT have more than ${t} items`,params:({params:{len:t}})=>(0,zn._)`{limit: ${t}}`},JC={keyword:"additionalItems",type:"array",schemaType:["boolean","object"],before:"uniqueItems",error:WC,code(t){let{parentSchema:e,it:r}=t,{items:n}=e;if(!Array.isArray(n)){(0,ld.checkStrictMode)(r,'"additionalItems" is ignored when "items" is not an array of schemas');return}g_(t,n)}};function g_(t,e){let{gen:r,schema:n,data:s,keyword:o,it:i}=t;i.items=!0;let a=r.const("len",(0,zn._)`${s}.length`);if(n===!1)t.setParams({len:e.length}),t.pass((0,zn._)`${a} <= ${e.length}`);else if(typeof n=="object"&&!(0,ld.alwaysValidSchema)(i,n)){let u=r.var("valid",(0,zn._)`${a} <= ${e.length}`);r.if((0,zn.not)(u),()=>c(u)),t.ok(u)}function c(u){r.forRange("i",e.length,a,l=>{t.subschema({keyword:o,dataProp:l,dataPropType:ld.Type.Num},u),i.allErrors||r.if((0,zn.not)(u),()=>r.break())})}}jo.validateAdditionalItems=g_;jo.default=JC});var pd=v(Ao=>{"use strict";Object.defineProperty(Ao,"__esModule",{value:!0});Ao.validateTuple=void 0;var y_=Q(),Oa=ce(),YC=kt(),QC={keyword:"items",type:"array",schemaType:["object","array","boolean"],before:"uniqueItems",code(t){let{schema:e,it:r}=t;if(Array.isArray(e))return v_(t,"additionalItems",e);r.items=!0,!(0,Oa.alwaysValidSchema)(r,e)&&t.ok((0,YC.validateArray)(t))}};function v_(t,e,r=t.schema){let{gen:n,parentSchema:s,data:o,keyword:i,it:a}=t;l(s),a.opts.unevaluated&&r.length&&a.items!==!0&&(a.items=Oa.mergeEvaluated.items(n,r.length,a.items));let c=n.name("valid"),u=n.const("len",(0,y_._)`${o}.length`);r.forEach((d,f)=>{(0,Oa.alwaysValidSchema)(a,d)||(n.if((0,y_._)`${u} > ${f}`,()=>t.subschema({keyword:i,schemaProp:f,dataProp:f},c)),t.ok(c))});function l(d){let{opts:f,errSchemaPath:p}=a,m=r.length,h=m===d.minItems&&(m===d.maxItems||d[e]===!1);if(f.strictTuples&&!h){let g=`"${i}" is ${m}-tuple, but minItems or maxItems/${e} are not specified or different at path "${p}"`;(0,Oa.checkStrictMode)(a,g,f.strictTuples)}}}Ao.validateTuple=v_;Ao.default=QC});var __=v(fd=>{"use strict";Object.defineProperty(fd,"__esModule",{value:!0});var XC=pd(),eI={keyword:"prefixItems",type:"array",schemaType:["array"],before:"uniqueItems",code:t=>(0,XC.validateTuple)(t,"items")};fd.default=eI});var w_=v(md=>{"use strict";Object.defineProperty(md,"__esModule",{value:!0});var b_=Q(),tI=ce(),rI=kt(),nI=dd(),sI={message:({params:{len:t}})=>(0,b_.str)`must NOT have more than ${t} items`,params:({params:{len:t}})=>(0,b_._)`{limit: ${t}}`},oI={keyword:"items",type:"array",schemaType:["object","boolean"],before:"uniqueItems",error:sI,code(t){let{schema:e,parentSchema:r,it:n}=t,{prefixItems:s}=r;n.items=!0,!(0,tI.alwaysValidSchema)(n,e)&&(s?(0,nI.validateAdditionalItems)(t,s):t.ok((0,rI.validateArray)(t)))}};md.default=oI});var $_=v(hd=>{"use strict";Object.defineProperty(hd,"__esModule",{value:!0});var Pt=Q(),Na=ce(),iI={message:({params:{min:t,max:e}})=>e===void 0?(0,Pt.str)`must contain at least ${t} valid item(s)`:(0,Pt.str)`must contain at least ${t} and no more than ${e} valid item(s)`,params:({params:{min:t,max:e}})=>e===void 0?(0,Pt._)`{minContains: ${t}}`:(0,Pt._)`{minContains: ${t}, maxContains: ${e}}`},aI={keyword:"contains",type:"array",schemaType:["object","boolean"],before:"uniqueItems",trackErrors:!0,error:iI,code(t){let{gen:e,schema:r,parentSchema:n,data:s,it:o}=t,i,a,{minContains:c,maxContains:u}=n;o.opts.next?(i=c===void 0?1:c,a=u):i=1;let l=e.const("len",(0,Pt._)`${s}.length`);if(t.setParams({min:i,max:a}),a===void 0&&i===0){(0,Na.checkStrictMode)(o,'"minContains" == 0 without "maxContains": "contains" keyword ignored');return}if(a!==void 0&&i>a){(0,Na.checkStrictMode)(o,'"minContains" > "maxContains" is always invalid'),t.fail();return}if((0,Na.alwaysValidSchema)(o,r)){let h=(0,Pt._)`${l} >= ${i}`;a!==void 0&&(h=(0,Pt._)`${h} && ${l} <= ${a}`),t.pass(h);return}o.items=!0;let d=e.name("valid");a===void 0&&i===1?p(d,()=>e.if(d,()=>e.break())):i===0?(e.let(d,!0),a!==void 0&&e.if((0,Pt._)`${s}.length > 0`,f)):(e.let(d,!1),f()),t.result(d,()=>t.reset());function f(){let h=e.name("_valid"),g=e.let("count",0);p(h,()=>e.if(h,()=>m(g)))}function p(h,g){e.forRange("i",0,l,y=>{t.subschema({keyword:"contains",dataProp:y,dataPropType:Na.Type.Num,compositeRule:!0},h),g()})}function m(h){e.code((0,Pt._)`${h}++`),a===void 0?e.if((0,Pt._)`${h} >= ${i}`,()=>e.assign(d,!0).break()):(e.if((0,Pt._)`${h} > ${a}`,()=>e.assign(d,!1).break()),i===1?e.assign(d,!0):e.if((0,Pt._)`${h} >= ${i}`,()=>e.assign(d,!0)))}}};hd.default=aI});var S_=v(er=>{"use strict";Object.defineProperty(er,"__esModule",{value:!0});er.validateSchemaDeps=er.validatePropertyDeps=er.error=void 0;var gd=Q(),cI=ce(),Mo=kt();er.error={message:({params:{property:t,depsCount:e,deps:r}})=>{let n=e===1?"property":"properties";return(0,gd.str)`must have ${n} ${r} when property ${t} is present`},params:({params:{property:t,depsCount:e,deps:r,missingProperty:n}})=>(0,gd._)`{property: ${t},
    missingProperty: ${n},
    depsCount: ${e},
    deps: ${r}}`};var uI={keyword:"dependencies",type:"object",schemaType:"object",error:er.error,code(t){let[e,r]=lI(t);x_(t,e),k_(t,r)}};function lI({schema:t}){let e={},r={};for(let n in t){if(n==="__proto__")continue;let s=Array.isArray(t[n])?e:r;s[n]=t[n]}return[e,r]}function x_(t,e=t.schema){let{gen:r,data:n,it:s}=t;if(Object.keys(e).length===0)return;let o=r.let("missing");for(let i in e){let a=e[i];if(a.length===0)continue;let c=(0,Mo.propertyInData)(r,n,i,s.opts.ownProperties);t.setParams({property:i,depsCount:a.length,deps:a.join(", ")}),s.allErrors?r.if(c,()=>{for(let u of a)(0,Mo.checkReportMissingProp)(t,u)}):(r.if((0,gd._)`${c} && (${(0,Mo.checkMissingProp)(t,a,o)})`),(0,Mo.reportMissingProp)(t,o),r.else())}}er.validatePropertyDeps=x_;function k_(t,e=t.schema){let{gen:r,data:n,keyword:s,it:o}=t,i=r.name("valid");for(let a in e)(0,cI.alwaysValidSchema)(o,e[a])||(r.if((0,Mo.propertyInData)(r,n,a,o.opts.ownProperties),()=>{let c=t.subschema({keyword:s,schemaProp:a},i);t.mergeValidEvaluated(c,i)},()=>r.var(i,!0)),t.ok(i))}er.validateSchemaDeps=k_;er.default=uI});var E_=v(yd=>{"use strict";Object.defineProperty(yd,"__esModule",{value:!0});var P_=Q(),dI=ce(),pI={message:"property name must be valid",params:({params:t})=>(0,P_._)`{propertyName: ${t.propertyName}}`},fI={keyword:"propertyNames",type:"object",schemaType:["object","boolean"],error:pI,code(t){let{gen:e,schema:r,data:n,it:s}=t;if((0,dI.alwaysValidSchema)(s,r))return;let o=e.name("valid");e.forIn("key",n,i=>{t.setParams({propertyName:i}),t.subschema({keyword:"propertyNames",data:i,dataTypes:["string"],propertyName:i,compositeRule:!0},o),e.if((0,P_.not)(o),()=>{t.error(!0),s.allErrors||e.break()})}),t.ok(o)}};yd.default=fI});var _d=v(vd=>{"use strict";Object.defineProperty(vd,"__esModule",{value:!0});var ja=kt(),Mt=Q(),mI=gr(),Aa=ce(),hI={message:"must NOT have additional properties",params:({params:t})=>(0,Mt._)`{additionalProperty: ${t.additionalProperty}}`},gI={keyword:"additionalProperties",type:["object"],schemaType:["boolean","object"],allowUndefined:!0,trackErrors:!0,error:hI,code(t){let{gen:e,schema:r,parentSchema:n,data:s,errsCount:o,it:i}=t;if(!o)throw new Error("ajv implementation error");let{allErrors:a,opts:c}=i;if(i.props=!0,c.removeAdditional!=="all"&&(0,Aa.alwaysValidSchema)(i,r))return;let u=(0,ja.allSchemaProperties)(n.properties),l=(0,ja.allSchemaProperties)(n.patternProperties);d(),t.ok((0,Mt._)`${o} === ${mI.default.errors}`);function d(){e.forIn("key",s,g=>{!u.length&&!l.length?m(g):e.if(f(g),()=>m(g))})}function f(g){let y;if(u.length>8){let x=(0,Aa.schemaRefOrVal)(i,n.properties,"properties");y=(0,ja.isOwnProperty)(e,x,g)}else u.length?y=(0,Mt.or)(...u.map(x=>(0,Mt._)`${g} === ${x}`)):y=Mt.nil;return l.length&&(y=(0,Mt.or)(y,...l.map(x=>(0,Mt._)`${(0,ja.usePattern)(t,x)}.test(${g})`))),(0,Mt.not)(y)}function p(g){e.code((0,Mt._)`delete ${s}[${g}]`)}function m(g){if(c.removeAdditional==="all"||c.removeAdditional&&r===!1){p(g);return}if(r===!1){t.setParams({additionalProperty:g}),t.error(),a||e.break();return}if(typeof r=="object"&&!(0,Aa.alwaysValidSchema)(i,r)){let y=e.name("valid");c.removeAdditional==="failing"?(h(g,y,!1),e.if((0,Mt.not)(y),()=>{t.reset(),p(g)})):(h(g,y),a||e.if((0,Mt.not)(y),()=>e.break()))}}function h(g,y,x){let $={keyword:"additionalProperties",dataProp:g,dataPropType:Aa.Type.Str};x===!1&&Object.assign($,{compositeRule:!0,createErrors:!1,allErrors:!1}),t.subschema($,y)}}};vd.default=gI});var C_=v(wd=>{"use strict";Object.defineProperty(wd,"__esModule",{value:!0});var yI=xo(),T_=kt(),bd=ce(),z_=_d(),vI={keyword:"properties",type:"object",schemaType:"object",code(t){let{gen:e,schema:r,parentSchema:n,data:s,it:o}=t;o.opts.removeAdditional==="all"&&n.additionalProperties===void 0&&z_.default.code(new yI.KeywordCxt(o,z_.default,"additionalProperties"));let i=(0,T_.allSchemaProperties)(r);for(let d of i)o.definedProperties.add(d);o.opts.unevaluated&&i.length&&o.props!==!0&&(o.props=bd.mergeEvaluated.props(e,(0,bd.toHash)(i),o.props));let a=i.filter(d=>!(0,bd.alwaysValidSchema)(o,r[d]));if(a.length===0)return;let c=e.name("valid");for(let d of a)u(d)?l(d):(e.if((0,T_.propertyInData)(e,s,d,o.opts.ownProperties)),l(d),o.allErrors||e.else().var(c,!0),e.endIf()),t.it.definedProperties.add(d),t.ok(c);function u(d){return o.opts.useDefaults&&!o.compositeRule&&r[d].default!==void 0}function l(d){t.subschema({keyword:"properties",schemaProp:d,dataProp:d},c)}}};wd.default=vI});var N_=v($d=>{"use strict";Object.defineProperty($d,"__esModule",{value:!0});var I_=kt(),Ma=Q(),R_=ce(),O_=ce(),_I={keyword:"patternProperties",type:"object",schemaType:"object",code(t){let{gen:e,schema:r,data:n,parentSchema:s,it:o}=t,{opts:i}=o,a=(0,I_.allSchemaProperties)(r),c=a.filter(h=>(0,R_.alwaysValidSchema)(o,r[h]));if(a.length===0||c.length===a.length&&(!o.opts.unevaluated||o.props===!0))return;let u=i.strictSchema&&!i.allowMatchingProperties&&s.properties,l=e.name("valid");o.props!==!0&&!(o.props instanceof Ma.Name)&&(o.props=(0,O_.evaluatedPropsToName)(e,o.props));let{props:d}=o;f();function f(){for(let h of a)u&&p(h),o.allErrors?m(h):(e.var(l,!0),m(h),e.if(l))}function p(h){for(let g in u)new RegExp(h).test(g)&&(0,R_.checkStrictMode)(o,`property ${g} matches pattern ${h} (use allowMatchingProperties)`)}function m(h){e.forIn("key",n,g=>{e.if((0,Ma._)`${(0,I_.usePattern)(t,h)}.test(${g})`,()=>{let y=c.includes(h);y||t.subschema({keyword:"patternProperties",schemaProp:h,dataProp:g,dataPropType:O_.Type.Str},l),o.opts.unevaluated&&d!==!0?e.assign((0,Ma._)`${d}[${g}]`,!0):!y&&!o.allErrors&&e.if((0,Ma.not)(l),()=>e.break())})})}}};$d.default=_I});var j_=v(xd=>{"use strict";Object.defineProperty(xd,"__esModule",{value:!0});var bI=ce(),wI={keyword:"not",schemaType:["object","boolean"],trackErrors:!0,code(t){let{gen:e,schema:r,it:n}=t;if((0,bI.alwaysValidSchema)(n,r)){t.fail();return}let s=e.name("valid");t.subschema({keyword:"not",compositeRule:!0,createErrors:!1,allErrors:!1},s),t.failResult(s,()=>t.reset(),()=>t.error())},error:{message:"must NOT be valid"}};xd.default=wI});var A_=v(kd=>{"use strict";Object.defineProperty(kd,"__esModule",{value:!0});var $I=kt(),xI={keyword:"anyOf",schemaType:"array",trackErrors:!0,code:$I.validateUnion,error:{message:"must match a schema in anyOf"}};kd.default=xI});var M_=v(Sd=>{"use strict";Object.defineProperty(Sd,"__esModule",{value:!0});var qa=Q(),kI=ce(),SI={message:"must match exactly one schema in oneOf",params:({params:t})=>(0,qa._)`{passingSchemas: ${t.passing}}`},PI={keyword:"oneOf",schemaType:"array",trackErrors:!0,error:SI,code(t){let{gen:e,schema:r,parentSchema:n,it:s}=t;if(!Array.isArray(r))throw new Error("ajv implementation error");if(s.opts.discriminator&&n.discriminator)return;let o=r,i=e.let("valid",!1),a=e.let("passing",null),c=e.name("_valid");t.setParams({passing:a}),e.block(u),t.result(i,()=>t.reset(),()=>t.error(!0));function u(){o.forEach((l,d)=>{let f;(0,kI.alwaysValidSchema)(s,l)?e.var(c,!0):f=t.subschema({keyword:"oneOf",schemaProp:d,compositeRule:!0},c),d>0&&e.if((0,qa._)`${c} && ${i}`).assign(i,!1).assign(a,(0,qa._)`[${a}, ${d}]`).else(),e.if(c,()=>{e.assign(i,!0),e.assign(a,d),f&&t.mergeEvaluated(f,qa.Name)})})}}};Sd.default=PI});var q_=v(Pd=>{"use strict";Object.defineProperty(Pd,"__esModule",{value:!0});var EI=ce(),TI={keyword:"allOf",schemaType:"array",code(t){let{gen:e,schema:r,it:n}=t;if(!Array.isArray(r))throw new Error("ajv implementation error");let s=e.name("valid");r.forEach((o,i)=>{if((0,EI.alwaysValidSchema)(n,o))return;let a=t.subschema({keyword:"allOf",schemaProp:i},s);t.ok(s),t.mergeEvaluated(a)})}};Pd.default=TI});var L_=v(Ed=>{"use strict";Object.defineProperty(Ed,"__esModule",{value:!0});var Da=Q(),Z_=ce(),zI={message:({params:t})=>(0,Da.str)`must match "${t.ifClause}" schema`,params:({params:t})=>(0,Da._)`{failingKeyword: ${t.ifClause}}`},CI={keyword:"if",schemaType:["object","boolean"],trackErrors:!0,error:zI,code(t){let{gen:e,parentSchema:r,it:n}=t;r.then===void 0&&r.else===void 0&&(0,Z_.checkStrictMode)(n,'"if" without "then" and "else" is ignored');let s=D_(n,"then"),o=D_(n,"else");if(!s&&!o)return;let i=e.let("valid",!0),a=e.name("_valid");if(c(),t.reset(),s&&o){let l=e.let("ifClause");t.setParams({ifClause:l}),e.if(a,u("then",l),u("else",l))}else s?e.if(a,u("then")):e.if((0,Da.not)(a),u("else"));t.pass(i,()=>t.error(!0));function c(){let l=t.subschema({keyword:"if",compositeRule:!0,createErrors:!1,allErrors:!1},a);t.mergeEvaluated(l)}function u(l,d){return()=>{let f=t.subschema({keyword:l},a);e.assign(i,a),t.mergeValidEvaluated(f,i),d?e.assign(d,(0,Da._)`${l}`):t.setParams({ifClause:l})}}}};function D_(t,e){let r=t.schema[e];return r!==void 0&&!(0,Z_.alwaysValidSchema)(t,r)}Ed.default=CI});var V_=v(Td=>{"use strict";Object.defineProperty(Td,"__esModule",{value:!0});var II=ce(),RI={keyword:["then","else"],schemaType:["object","boolean"],code({keyword:t,parentSchema:e,it:r}){e.if===void 0&&(0,II.checkStrictMode)(r,`"${t}" without "if" is ignored`)}};Td.default=RI});var F_=v(zd=>{"use strict";Object.defineProperty(zd,"__esModule",{value:!0});var OI=dd(),NI=__(),jI=pd(),AI=w_(),MI=$_(),qI=S_(),DI=E_(),ZI=_d(),LI=C_(),VI=N_(),FI=j_(),UI=A_(),HI=M_(),KI=q_(),BI=L_(),GI=V_();function WI(t=!1){let e=[FI.default,UI.default,HI.default,KI.default,BI.default,GI.default,DI.default,ZI.default,qI.default,LI.default,VI.default];return t?e.push(NI.default,AI.default):e.push(OI.default,jI.default),e.push(MI.default),e}zd.default=WI});var U_=v(Cd=>{"use strict";Object.defineProperty(Cd,"__esModule",{value:!0});var Re=Q(),JI={message:({schemaCode:t})=>(0,Re.str)`must match format "${t}"`,params:({schemaCode:t})=>(0,Re._)`{format: ${t}}`},YI={keyword:"format",type:["number","string"],schemaType:"string",$data:!0,error:JI,code(t,e){let{gen:r,data:n,$data:s,schema:o,schemaCode:i,it:a}=t,{opts:c,errSchemaPath:u,schemaEnv:l,self:d}=a;if(!c.validateFormats)return;s?f():p();function f(){let m=r.scopeValue("formats",{ref:d.formats,code:c.code.formats}),h=r.const("fDef",(0,Re._)`${m}[${i}]`),g=r.let("fType"),y=r.let("format");r.if((0,Re._)`typeof ${h} == "object" && !(${h} instanceof RegExp)`,()=>r.assign(g,(0,Re._)`${h}.type || "string"`).assign(y,(0,Re._)`${h}.validate`),()=>r.assign(g,(0,Re._)`"string"`).assign(y,h)),t.fail$data((0,Re.or)(x(),$()));function x(){return c.strictSchema===!1?Re.nil:(0,Re._)`${i} && !${y}`}function $(){let S=l.$async?(0,Re._)`(${h}.async ? await ${y}(${n}) : ${y}(${n}))`:(0,Re._)`${y}(${n})`,w=(0,Re._)`(typeof ${y} == "function" ? ${S} : ${y}.test(${n}))`;return(0,Re._)`${y} && ${y} !== true && ${g} === ${e} && !${w}`}}function p(){let m=d.formats[o];if(!m){x();return}if(m===!0)return;let[h,g,y]=$(m);h===e&&t.pass(S());function x(){if(c.strictSchema===!1){d.logger.warn(w());return}throw new Error(w());function w(){return`unknown format "${o}" ignored in schema at path "${u}"`}}function $(w){let D=w instanceof RegExp?(0,Re.regexpCode)(w):c.code.formats?(0,Re._)`${c.code.formats}${(0,Re.getProperty)(o)}`:void 0,F=r.scopeValue("formats",{key:o,ref:w,code:D});return typeof w=="object"&&!(w instanceof RegExp)?[w.type||"string",w.validate,(0,Re._)`${F}.validate`]:["string",w,F]}function S(){if(typeof m=="object"&&!(m instanceof RegExp)&&m.async){if(!l.$async)throw new Error("async format in sync schema");return(0,Re._)`await ${y}(${n})`}return typeof g=="function"?(0,Re._)`${y}(${n})`:(0,Re._)`${y}.test(${n})`}}}};Cd.default=YI});var H_=v(Id=>{"use strict";Object.defineProperty(Id,"__esModule",{value:!0});var QI=U_(),XI=[QI.default];Id.default=XI});var K_=v(ps=>{"use strict";Object.defineProperty(ps,"__esModule",{value:!0});ps.contentVocabulary=ps.metadataVocabulary=void 0;ps.metadataVocabulary=["title","description","default","deprecated","readOnly","writeOnly","examples"];ps.contentVocabulary=["contentMediaType","contentEncoding","contentSchema"]});var G_=v(Rd=>{"use strict";Object.defineProperty(Rd,"__esModule",{value:!0});var eR=t_(),tR=h_(),rR=F_(),nR=H_(),B_=K_(),sR=[eR.default,tR.default,(0,rR.default)(),nR.default,B_.metadataVocabulary,B_.contentVocabulary];Rd.default=sR});var J_=v(Za=>{"use strict";Object.defineProperty(Za,"__esModule",{value:!0});Za.DiscrError=void 0;var W_;(function(t){t.Tag="tag",t.Mapping="mapping"})(W_||(Za.DiscrError=W_={}))});var Q_=v(Nd=>{"use strict";Object.defineProperty(Nd,"__esModule",{value:!0});var fs=Q(),Od=J_(),Y_=wa(),oR=ko(),iR=ce(),aR={message:({params:{discrError:t,tagName:e}})=>t===Od.DiscrError.Tag?`tag "${e}" must be string`:`value of tag "${e}" must be in oneOf`,params:({params:{discrError:t,tag:e,tagName:r}})=>(0,fs._)`{error: ${t}, tag: ${r}, tagValue: ${e}}`},cR={keyword:"discriminator",type:"object",schemaType:"object",error:aR,code(t){let{gen:e,data:r,schema:n,parentSchema:s,it:o}=t,{oneOf:i}=s;if(!o.opts.discriminator)throw new Error("discriminator: requires discriminator option");let a=n.propertyName;if(typeof a!="string")throw new Error("discriminator: requires propertyName");if(n.mapping)throw new Error("discriminator: mapping is not supported");if(!i)throw new Error("discriminator: requires oneOf keyword");let c=e.let("valid",!1),u=e.const("tag",(0,fs._)`${r}${(0,fs.getProperty)(a)}`);e.if((0,fs._)`typeof ${u} == "string"`,()=>l(),()=>t.error(!1,{discrError:Od.DiscrError.Tag,tag:u,tagName:a})),t.ok(c);function l(){let p=f();e.if(!1);for(let m in p)e.elseIf((0,fs._)`${u} === ${m}`),e.assign(c,d(p[m]));e.else(),t.error(!1,{discrError:Od.DiscrError.Mapping,tag:u,tagName:a}),e.endIf()}function d(p){let m=e.name("valid"),h=t.subschema({keyword:"oneOf",schemaProp:p},m);return t.mergeEvaluated(h,fs.Name),m}function f(){var p;let m={},h=y(s),g=!0;for(let S=0;S<i.length;S++){let w=i[S];if(w?.$ref&&!(0,iR.schemaHasRulesButRef)(w,o.self.RULES)){let F=w.$ref;if(w=Y_.resolveRef.call(o.self,o.schemaEnv.root,o.baseId,F),w instanceof Y_.SchemaEnv&&(w=w.schema),w===void 0)throw new oR.default(o.opts.uriResolver,o.baseId,F)}let D=(p=w?.properties)===null||p===void 0?void 0:p[a];if(typeof D!="object")throw new Error(`discriminator: oneOf subschemas (or referenced schemas) must have "properties/${a}"`);g=g&&(h||y(w)),x(D,S)}if(!g)throw new Error(`discriminator: "${a}" must be required`);return m;function y({required:S}){return Array.isArray(S)&&S.includes(a)}function x(S,w){if(S.const)$(S.const,w);else if(S.enum)for(let D of S.enum)$(D,w);else throw new Error(`discriminator: "properties/${a}" must have "const" or "enum"`)}function $(S,w){if(typeof S!="string"||S in m)throw new Error(`discriminator: "${a}" values must be unique strings`);m[S]=w}}}};Nd.default=cR});var X_=v((yV,uR)=>{uR.exports={$schema:"http://json-schema.org/draft-07/schema#",$id:"http://json-schema.org/draft-07/schema#",title:"Core schema meta-schema",definitions:{schemaArray:{type:"array",minItems:1,items:{$ref:"#"}},nonNegativeInteger:{type:"integer",minimum:0},nonNegativeIntegerDefault0:{allOf:[{$ref:"#/definitions/nonNegativeInteger"},{default:0}]},simpleTypes:{enum:["array","boolean","integer","null","number","object","string"]},stringArray:{type:"array",items:{type:"string"},uniqueItems:!0,default:[]}},type:["object","boolean"],properties:{$id:{type:"string",format:"uri-reference"},$schema:{type:"string",format:"uri"},$ref:{type:"string",format:"uri-reference"},$comment:{type:"string"},title:{type:"string"},description:{type:"string"},default:!0,readOnly:{type:"boolean",default:!1},examples:{type:"array",items:!0},multipleOf:{type:"number",exclusiveMinimum:0},maximum:{type:"number"},exclusiveMaximum:{type:"number"},minimum:{type:"number"},exclusiveMinimum:{type:"number"},maxLength:{$ref:"#/definitions/nonNegativeInteger"},minLength:{$ref:"#/definitions/nonNegativeIntegerDefault0"},pattern:{type:"string",format:"regex"},additionalItems:{$ref:"#"},items:{anyOf:[{$ref:"#"},{$ref:"#/definitions/schemaArray"}],default:!0},maxItems:{$ref:"#/definitions/nonNegativeInteger"},minItems:{$ref:"#/definitions/nonNegativeIntegerDefault0"},uniqueItems:{type:"boolean",default:!1},contains:{$ref:"#"},maxProperties:{$ref:"#/definitions/nonNegativeInteger"},minProperties:{$ref:"#/definitions/nonNegativeIntegerDefault0"},required:{$ref:"#/definitions/stringArray"},additionalProperties:{$ref:"#"},definitions:{type:"object",additionalProperties:{$ref:"#"},default:{}},properties:{type:"object",additionalProperties:{$ref:"#"},default:{}},patternProperties:{type:"object",additionalProperties:{$ref:"#"},propertyNames:{format:"regex"},default:{}},dependencies:{type:"object",additionalProperties:{anyOf:[{$ref:"#"},{$ref:"#/definitions/stringArray"}]}},propertyNames:{$ref:"#"},const:!0,enum:{type:"array",items:!0,minItems:1,uniqueItems:!0},type:{anyOf:[{$ref:"#/definitions/simpleTypes"},{type:"array",items:{$ref:"#/definitions/simpleTypes"},minItems:1,uniqueItems:!0}]},format:{type:"string"},contentMediaType:{type:"string"},contentEncoding:{type:"string"},if:{$ref:"#"},then:{$ref:"#"},else:{$ref:"#"},allOf:{$ref:"#/definitions/schemaArray"},anyOf:{$ref:"#/definitions/schemaArray"},oneOf:{$ref:"#/definitions/schemaArray"},not:{$ref:"#"}},default:!0}});var t0=v((Se,jd)=>{"use strict";Object.defineProperty(Se,"__esModule",{value:!0});Se.MissingRefError=Se.ValidationError=Se.CodeGen=Se.Name=Se.nil=Se.stringify=Se.str=Se._=Se.KeywordCxt=Se.Ajv=void 0;var lR=Wv(),dR=G_(),pR=Q_(),e0=X_(),fR=["/properties"],La="http://json-schema.org/draft-07/schema",ms=class extends lR.default{_addVocabularies(){super._addVocabularies(),dR.default.forEach(e=>this.addVocabulary(e)),this.opts.discriminator&&this.addKeyword(pR.default)}_addDefaultMetaSchema(){if(super._addDefaultMetaSchema(),!this.opts.meta)return;let e=this.opts.$data?this.$dataMetaSchema(e0,fR):e0;this.addMetaSchema(e,La,!1),this.refs["http://json-schema.org/schema"]=La}defaultMeta(){return this.opts.defaultMeta=super.defaultMeta()||(this.getSchema(La)?La:void 0)}};Se.Ajv=ms;jd.exports=Se=ms;jd.exports.Ajv=ms;Object.defineProperty(Se,"__esModule",{value:!0});Se.default=ms;var mR=xo();Object.defineProperty(Se,"KeywordCxt",{enumerable:!0,get:function(){return mR.KeywordCxt}});var hs=Q();Object.defineProperty(Se,"_",{enumerable:!0,get:function(){return hs._}});Object.defineProperty(Se,"str",{enumerable:!0,get:function(){return hs.str}});Object.defineProperty(Se,"stringify",{enumerable:!0,get:function(){return hs.stringify}});Object.defineProperty(Se,"nil",{enumerable:!0,get:function(){return hs.nil}});Object.defineProperty(Se,"Name",{enumerable:!0,get:function(){return hs.Name}});Object.defineProperty(Se,"CodeGen",{enumerable:!0,get:function(){return hs.CodeGen}});var hR=_a();Object.defineProperty(Se,"ValidationError",{enumerable:!0,get:function(){return hR.default}});var gR=ko();Object.defineProperty(Se,"MissingRefError",{enumerable:!0,get:function(){return gR.default}})});var u0=v(rr=>{"use strict";Object.defineProperty(rr,"__esModule",{value:!0});rr.formatNames=rr.fastFormats=rr.fullFormats=void 0;function tr(t,e){return{validate:t,compare:e}}rr.fullFormats={date:tr(o0,Dd),time:tr(Md(!0),Zd),"date-time":tr(r0(!0),a0),"iso-time":tr(Md(),i0),"iso-date-time":tr(r0(),c0),duration:/^P(?!$)((\d+Y)?(\d+M)?(\d+D)?(T(?=\d)(\d+H)?(\d+M)?(\d+S)?)?|(\d+W)?)$/,uri:$R,"uri-reference":/^(?:[a-z][a-z0-9+\-.]*:)?(?:\/?\/(?:(?:[a-z0-9\-._~!$&'()*+,;=:]|%[0-9a-f]{2})*@)?(?:\[(?:(?:(?:(?:[0-9a-f]{1,4}:){6}|::(?:[0-9a-f]{1,4}:){5}|(?:[0-9a-f]{1,4})?::(?:[0-9a-f]{1,4}:){4}|(?:(?:[0-9a-f]{1,4}:){0,1}[0-9a-f]{1,4})?::(?:[0-9a-f]{1,4}:){3}|(?:(?:[0-9a-f]{1,4}:){0,2}[0-9a-f]{1,4})?::(?:[0-9a-f]{1,4}:){2}|(?:(?:[0-9a-f]{1,4}:){0,3}[0-9a-f]{1,4})?::[0-9a-f]{1,4}:|(?:(?:[0-9a-f]{1,4}:){0,4}[0-9a-f]{1,4})?::)(?:[0-9a-f]{1,4}:[0-9a-f]{1,4}|(?:(?:25[0-5]|2[0-4]\d|[01]?\d\d?)\.){3}(?:25[0-5]|2[0-4]\d|[01]?\d\d?))|(?:(?:[0-9a-f]{1,4}:){0,5}[0-9a-f]{1,4})?::[0-9a-f]{1,4}|(?:(?:[0-9a-f]{1,4}:){0,6}[0-9a-f]{1,4})?::)|[Vv][0-9a-f]+\.[a-z0-9\-._~!$&'()*+,;=:]+)\]|(?:(?:25[0-5]|2[0-4]\d|[01]?\d\d?)\.){3}(?:25[0-5]|2[0-4]\d|[01]?\d\d?)|(?:[a-z0-9\-._~!$&'"()*+,;=]|%[0-9a-f]{2})*)(?::\d*)?(?:\/(?:[a-z0-9\-._~!$&'"()*+,;=:@]|%[0-9a-f]{2})*)*|\/(?:(?:[a-z0-9\-._~!$&'"()*+,;=:@]|%[0-9a-f]{2})+(?:\/(?:[a-z0-9\-._~!$&'"()*+,;=:@]|%[0-9a-f]{2})*)*)?|(?:[a-z0-9\-._~!$&'"()*+,;=:@]|%[0-9a-f]{2})+(?:\/(?:[a-z0-9\-._~!$&'"()*+,;=:@]|%[0-9a-f]{2})*)*)?(?:\?(?:[a-z0-9\-._~!$&'"()*+,;=:@/?]|%[0-9a-f]{2})*)?(?:#(?:[a-z0-9\-._~!$&'"()*+,;=:@/?]|%[0-9a-f]{2})*)?$/i,"uri-template":/^(?:(?:[^\x00-\x20"'<>%\\^`{|}]|%[0-9a-f]{2})|\{[+#./;?&=,!@|]?(?:[a-z0-9_]|%[0-9a-f]{2})+(?::[1-9][0-9]{0,3}|\*)?(?:,(?:[a-z0-9_]|%[0-9a-f]{2})+(?::[1-9][0-9]{0,3}|\*)?)*\})*$/i,url:/^(?:https?|ftp):\/\/(?:\S+(?::\S*)?@)?(?:(?!(?:10|127)(?:\.\d{1,3}){3})(?!(?:169\.254|192\.168)(?:\.\d{1,3}){2})(?!172\.(?:1[6-9]|2\d|3[0-1])(?:\.\d{1,3}){2})(?:[1-9]\d?|1\d\d|2[01]\d|22[0-3])(?:\.(?:1?\d{1,2}|2[0-4]\d|25[0-5])){2}(?:\.(?:[1-9]\d?|1\d\d|2[0-4]\d|25[0-4]))|(?:(?:[a-z0-9\u{00a1}-\u{ffff}]+-)*[a-z0-9\u{00a1}-\u{ffff}]+)(?:\.(?:[a-z0-9\u{00a1}-\u{ffff}]+-)*[a-z0-9\u{00a1}-\u{ffff}]+)*(?:\.(?:[a-z\u{00a1}-\u{ffff}]{2,})))(?::\d{2,5})?(?:\/[^\s]*)?$/iu,email:/^[a-z0-9!#$%&'*+/=?^_`{|}~-]+(?:\.[a-z0-9!#$%&'*+/=?^_`{|}~-]+)*@(?:[a-z0-9](?:[a-z0-9-]*[a-z0-9])?\.)+[a-z0-9](?:[a-z0-9-]*[a-z0-9])?$/i,hostname:/^(?=.{1,253}\.?$)[a-z0-9](?:[a-z0-9-]{0,61}[a-z0-9])?(?:\.[a-z0-9](?:[-0-9a-z]{0,61}[0-9a-z])?)*\.?$/i,ipv4:/^(?:(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)\.){3}(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)$/,ipv6:/^((([0-9a-f]{1,4}:){7}([0-9a-f]{1,4}|:))|(([0-9a-f]{1,4}:){6}(:[0-9a-f]{1,4}|((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3})|:))|(([0-9a-f]{1,4}:){5}(((:[0-9a-f]{1,4}){1,2})|:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3})|:))|(([0-9a-f]{1,4}:){4}(((:[0-9a-f]{1,4}){1,3})|((:[0-9a-f]{1,4})?:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(([0-9a-f]{1,4}:){3}(((:[0-9a-f]{1,4}){1,4})|((:[0-9a-f]{1,4}){0,2}:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(([0-9a-f]{1,4}:){2}(((:[0-9a-f]{1,4}){1,5})|((:[0-9a-f]{1,4}){0,3}:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(([0-9a-f]{1,4}:){1}(((:[0-9a-f]{1,4}){1,6})|((:[0-9a-f]{1,4}){0,4}:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(:(((:[0-9a-f]{1,4}){1,7})|((:[0-9a-f]{1,4}){0,5}:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:)))$/i,regex:zR,uuid:/^(?:urn:uuid:)?[0-9a-f]{8}-(?:[0-9a-f]{4}-){3}[0-9a-f]{12}$/i,"json-pointer":/^(?:\/(?:[^~/]|~0|~1)*)*$/,"json-pointer-uri-fragment":/^#(?:\/(?:[a-z0-9_\-.!$&'()*+,;:=@]|%[0-9a-f]{2}|~0|~1)*)*$/i,"relative-json-pointer":/^(?:0|[1-9][0-9]*)(?:#|(?:\/(?:[^~/]|~0|~1)*)*)$/,byte:xR,int32:{type:"number",validate:PR},int64:{type:"number",validate:ER},float:{type:"number",validate:s0},double:{type:"number",validate:s0},password:!0,binary:!0};rr.fastFormats={...rr.fullFormats,date:tr(/^\d\d\d\d-[0-1]\d-[0-3]\d$/,Dd),time:tr(/^(?:[0-2]\d:[0-5]\d:[0-5]\d|23:59:60)(?:\.\d+)?(?:z|[+-]\d\d(?::?\d\d)?)$/i,Zd),"date-time":tr(/^\d\d\d\d-[0-1]\d-[0-3]\dt(?:[0-2]\d:[0-5]\d:[0-5]\d|23:59:60)(?:\.\d+)?(?:z|[+-]\d\d(?::?\d\d)?)$/i,a0),"iso-time":tr(/^(?:[0-2]\d:[0-5]\d:[0-5]\d|23:59:60)(?:\.\d+)?(?:z|[+-]\d\d(?::?\d\d)?)?$/i,i0),"iso-date-time":tr(/^\d\d\d\d-[0-1]\d-[0-3]\d[t\s](?:[0-2]\d:[0-5]\d:[0-5]\d|23:59:60)(?:\.\d+)?(?:z|[+-]\d\d(?::?\d\d)?)?$/i,c0),uri:/^(?:[a-z][a-z0-9+\-.]*:)(?:\/?\/)?[^\s]*$/i,"uri-reference":/^(?:(?:[a-z][a-z0-9+\-.]*:)?\/?\/)?(?:[^\\\s#][^\s#]*)?(?:#[^\\\s]*)?$/i,email:/^[a-z0-9.!#$%&'*+/=?^_`{|}~-]+@[a-z0-9](?:[a-z0-9-]{0,61}[a-z0-9])?(?:\.[a-z0-9](?:[a-z0-9-]{0,61}[a-z0-9])?)*$/i};rr.formatNames=Object.keys(rr.fullFormats);function yR(t){return t%4===0&&(t%100!==0||t%400===0)}var vR=/^(\d\d\d\d)-(\d\d)-(\d\d)$/,_R=[0,31,28,31,30,31,30,31,31,30,31,30,31];function o0(t){let e=vR.exec(t);if(!e)return!1;let r=+e[1],n=+e[2],s=+e[3];return n>=1&&n<=12&&s>=1&&s<=(n===2&&yR(r)?29:_R[n])}function Dd(t,e){if(t&&e)return t>e?1:t<e?-1:0}var Ad=/^(\d\d):(\d\d):(\d\d(?:\.\d+)?)(z|([+-])(\d\d)(?::?(\d\d))?)?$/i;function Md(t){return function(r){let n=Ad.exec(r);if(!n)return!1;let s=+n[1],o=+n[2],i=+n[3],a=n[4],c=n[5]==="-"?-1:1,u=+(n[6]||0),l=+(n[7]||0);if(u>23||l>59||t&&!a)return!1;if(s<=23&&o<=59&&i<60)return!0;let d=o-l*c,f=s-u*c-(d<0?1:0);return(f===23||f===-1)&&(d===59||d===-1)&&i<61}}function Zd(t,e){if(!(t&&e))return;let r=new Date("2020-01-01T"+t).valueOf(),n=new Date("2020-01-01T"+e).valueOf();if(r&&n)return r-n}function i0(t,e){if(!(t&&e))return;let r=Ad.exec(t),n=Ad.exec(e);if(r&&n)return t=r[1]+r[2]+r[3],e=n[1]+n[2]+n[3],t>e?1:t<e?-1:0}var qd=/t|\s/i;function r0(t){let e=Md(t);return function(n){let s=n.split(qd);return s.length===2&&o0(s[0])&&e(s[1])}}function a0(t,e){if(!(t&&e))return;let r=new Date(t).valueOf(),n=new Date(e).valueOf();if(r&&n)return r-n}function c0(t,e){if(!(t&&e))return;let[r,n]=t.split(qd),[s,o]=e.split(qd),i=Dd(r,s);if(i!==void 0)return i||Zd(n,o)}var bR=/\/|:/,wR=/^(?:[a-z][a-z0-9+\-.]*:)(?:\/?\/(?:(?:[a-z0-9\-._~!$&'()*+,;=:]|%[0-9a-f]{2})*@)?(?:\[(?:(?:(?:(?:[0-9a-f]{1,4}:){6}|::(?:[0-9a-f]{1,4}:){5}|(?:[0-9a-f]{1,4})?::(?:[0-9a-f]{1,4}:){4}|(?:(?:[0-9a-f]{1,4}:){0,1}[0-9a-f]{1,4})?::(?:[0-9a-f]{1,4}:){3}|(?:(?:[0-9a-f]{1,4}:){0,2}[0-9a-f]{1,4})?::(?:[0-9a-f]{1,4}:){2}|(?:(?:[0-9a-f]{1,4}:){0,3}[0-9a-f]{1,4})?::[0-9a-f]{1,4}:|(?:(?:[0-9a-f]{1,4}:){0,4}[0-9a-f]{1,4})?::)(?:[0-9a-f]{1,4}:[0-9a-f]{1,4}|(?:(?:25[0-5]|2[0-4]\d|[01]?\d\d?)\.){3}(?:25[0-5]|2[0-4]\d|[01]?\d\d?))|(?:(?:[0-9a-f]{1,4}:){0,5}[0-9a-f]{1,4})?::[0-9a-f]{1,4}|(?:(?:[0-9a-f]{1,4}:){0,6}[0-9a-f]{1,4})?::)|[Vv][0-9a-f]+\.[a-z0-9\-._~!$&'()*+,;=:]+)\]|(?:(?:25[0-5]|2[0-4]\d|[01]?\d\d?)\.){3}(?:25[0-5]|2[0-4]\d|[01]?\d\d?)|(?:[a-z0-9\-._~!$&'()*+,;=]|%[0-9a-f]{2})*)(?::\d*)?(?:\/(?:[a-z0-9\-._~!$&'()*+,;=:@]|%[0-9a-f]{2})*)*|\/(?:(?:[a-z0-9\-._~!$&'()*+,;=:@]|%[0-9a-f]{2})+(?:\/(?:[a-z0-9\-._~!$&'()*+,;=:@]|%[0-9a-f]{2})*)*)?|(?:[a-z0-9\-._~!$&'()*+,;=:@]|%[0-9a-f]{2})+(?:\/(?:[a-z0-9\-._~!$&'()*+,;=:@]|%[0-9a-f]{2})*)*)(?:\?(?:[a-z0-9\-._~!$&'()*+,;=:@/?]|%[0-9a-f]{2})*)?(?:#(?:[a-z0-9\-._~!$&'()*+,;=:@/?]|%[0-9a-f]{2})*)?$/i;function $R(t){return bR.test(t)&&wR.test(t)}var n0=/^(?:[A-Za-z0-9+/]{4})*(?:[A-Za-z0-9+/]{2}==|[A-Za-z0-9+/]{3}=)?$/gm;function xR(t){return n0.lastIndex=0,n0.test(t)}var kR=-(2**31),SR=2**31-1;function PR(t){return Number.isInteger(t)&&t<=SR&&t>=kR}function ER(t){return Number.isInteger(t)}function s0(){return!0}var TR=/[^\\]\\Z/;function zR(t){if(TR.test(t))return!1;try{return new RegExp(t),!0}catch{return!1}}});var Zo=v(ue=>{"use strict";Object.defineProperty(ue,"__esModule",{value:!0});ue.regexpCode=ue.getEsmExportName=ue.getProperty=ue.safeStringify=ue.stringify=ue.strConcat=ue.addCodeArg=ue.str=ue._=ue.nil=ue._Code=ue.Name=ue.IDENTIFIER=ue._CodeOrName=void 0;var qo=class{};ue._CodeOrName=qo;ue.IDENTIFIER=/^[a-z$_][a-z$_0-9]*$/i;var Cn=class extends qo{constructor(e){if(super(),!ue.IDENTIFIER.test(e))throw new Error("CodeGen: name must be a valid identifier");this.str=e}toString(){return this.str}emptyStr(){return!1}get names(){return{[this.str]:1}}};ue.Name=Cn;var Et=class extends qo{constructor(e){super(),this._items=typeof e=="string"?[e]:e}toString(){return this.str}emptyStr(){if(this._items.length>1)return!1;let e=this._items[0];return e===""||e==='""'}get str(){var e;return(e=this._str)!==null&&e!==void 0?e:this._str=this._items.reduce((r,n)=>`${r}${n}`,"")}get names(){var e;return(e=this._names)!==null&&e!==void 0?e:this._names=this._items.reduce((r,n)=>(n instanceof Cn&&(r[n.str]=(r[n.str]||0)+1),r),{})}};ue._Code=Et;ue.nil=new Et("");function l0(t,...e){let r=[t[0]],n=0;for(;n<e.length;)Vd(r,e[n]),r.push(t[++n]);return new Et(r)}ue._=l0;var Ld=new Et("+");function d0(t,...e){let r=[Do(t[0])],n=0;for(;n<e.length;)r.push(Ld),Vd(r,e[n]),r.push(Ld,Do(t[++n]));return CR(r),new Et(r)}ue.str=d0;function Vd(t,e){e instanceof Et?t.push(...e._items):e instanceof Cn?t.push(e):t.push(OR(e))}ue.addCodeArg=Vd;function CR(t){let e=1;for(;e<t.length-1;){if(t[e]===Ld){let r=IR(t[e-1],t[e+1]);if(r!==void 0){t.splice(e-1,3,r);continue}t[e++]="+"}e++}}function IR(t,e){if(e==='""')return t;if(t==='""')return e;if(typeof t=="string")return e instanceof Cn||t[t.length-1]!=='"'?void 0:typeof e!="string"?`${t.slice(0,-1)}${e}"`:e[0]==='"'?t.slice(0,-1)+e.slice(1):void 0;if(typeof e=="string"&&e[0]==='"'&&!(t instanceof Cn))return`"${t}${e.slice(1)}`}function RR(t,e){return e.emptyStr()?t:t.emptyStr()?e:d0`${t}${e}`}ue.strConcat=RR;function OR(t){return typeof t=="number"||typeof t=="boolean"||t===null?t:Do(Array.isArray(t)?t.join(","):t)}function NR(t){return new Et(Do(t))}ue.stringify=NR;function Do(t){return JSON.stringify(t).replace(/\u2028/g,"\\u2028").replace(/\u2029/g,"\\u2029")}ue.safeStringify=Do;function jR(t){return typeof t=="string"&&ue.IDENTIFIER.test(t)?new Et(`.${t}`):l0`[${t}]`}ue.getProperty=jR;function AR(t){if(typeof t=="string"&&ue.IDENTIFIER.test(t))return new Et(`${t}`);throw new Error(`CodeGen: invalid export name: ${t}, use explicit $id name mapping`)}ue.getEsmExportName=AR;function MR(t){return new Et(t.toString())}ue.regexpCode=MR});var Hd=v(mt=>{"use strict";Object.defineProperty(mt,"__esModule",{value:!0});mt.ValueScope=mt.ValueScopeName=mt.Scope=mt.varKinds=mt.UsedValueState=void 0;var ft=Zo(),Fd=class extends Error{constructor(e){super(`CodeGen: "code" for ${e} not defined`),this.value=e.value}},Va;(function(t){t[t.Started=0]="Started",t[t.Completed=1]="Completed"})(Va||(mt.UsedValueState=Va={}));mt.varKinds={const:new ft.Name("const"),let:new ft.Name("let"),var:new ft.Name("var")};var Fa=class{constructor({prefixes:e,parent:r}={}){this._names={},this._prefixes=e,this._parent=r}toName(e){return e instanceof ft.Name?e:this.name(e)}name(e){return new ft.Name(this._newName(e))}_newName(e){let r=this._names[e]||this._nameGroup(e);return`${e}${r.index++}`}_nameGroup(e){var r,n;if(!((n=(r=this._parent)===null||r===void 0?void 0:r._prefixes)===null||n===void 0)&&n.has(e)||this._prefixes&&!this._prefixes.has(e))throw new Error(`CodeGen: prefix "${e}" is not allowed in this scope`);return this._names[e]={prefix:e,index:0}}};mt.Scope=Fa;var Ua=class extends ft.Name{constructor(e,r){super(r),this.prefix=e}setValue(e,{property:r,itemIndex:n}){this.value=e,this.scopePath=(0,ft._)`.${new ft.Name(r)}[${n}]`}};mt.ValueScopeName=Ua;var qR=(0,ft._)`\n`,Ud=class extends Fa{constructor(e){super(e),this._values={},this._scope=e.scope,this.opts={...e,_n:e.lines?qR:ft.nil}}get(){return this._scope}name(e){return new Ua(e,this._newName(e))}value(e,r){var n;if(r.ref===void 0)throw new Error("CodeGen: ref must be passed in value");let s=this.toName(e),{prefix:o}=s,i=(n=r.key)!==null&&n!==void 0?n:r.ref,a=this._values[o];if(a){let l=a.get(i);if(l)return l}else a=this._values[o]=new Map;a.set(i,s);let c=this._scope[o]||(this._scope[o]=[]),u=c.length;return c[u]=r.ref,s.setValue(r,{property:o,itemIndex:u}),s}getValue(e,r){let n=this._values[e];if(n)return n.get(r)}scopeRefs(e,r=this._values){return this._reduceValues(r,n=>{if(n.scopePath===void 0)throw new Error(`CodeGen: name "${n}" has no value`);return(0,ft._)`${e}${n.scopePath}`})}scopeCode(e=this._values,r,n){return this._reduceValues(e,s=>{if(s.value===void 0)throw new Error(`CodeGen: name "${s}" has no value`);return s.value.code},r,n)}_reduceValues(e,r,n={},s){let o=ft.nil;for(let i in e){let a=e[i];if(!a)continue;let c=n[i]=n[i]||new Map;a.forEach(u=>{if(c.has(u))return;c.set(u,Va.Started);let l=r(u);if(l){let d=this.opts.es5?mt.varKinds.var:mt.varKinds.const;o=(0,ft._)`${o}${d} ${u} = ${l};${this.opts._n}`}else if(l=s?.(u))o=(0,ft._)`${o}${l}${this.opts._n}`;else throw new Fd(u);c.set(u,Va.Completed)})}return o}};mt.ValueScope=Ud});var W=v(Y=>{"use strict";Object.defineProperty(Y,"__esModule",{value:!0});Y.or=Y.and=Y.not=Y.CodeGen=Y.operators=Y.varKinds=Y.ValueScopeName=Y.ValueScope=Y.Scope=Y.Name=Y.regexpCode=Y.stringify=Y.getProperty=Y.nil=Y.strConcat=Y.str=Y._=void 0;var se=Zo(),qt=Hd(),Zr=Zo();Object.defineProperty(Y,"_",{enumerable:!0,get:function(){return Zr._}});Object.defineProperty(Y,"str",{enumerable:!0,get:function(){return Zr.str}});Object.defineProperty(Y,"strConcat",{enumerable:!0,get:function(){return Zr.strConcat}});Object.defineProperty(Y,"nil",{enumerable:!0,get:function(){return Zr.nil}});Object.defineProperty(Y,"getProperty",{enumerable:!0,get:function(){return Zr.getProperty}});Object.defineProperty(Y,"stringify",{enumerable:!0,get:function(){return Zr.stringify}});Object.defineProperty(Y,"regexpCode",{enumerable:!0,get:function(){return Zr.regexpCode}});Object.defineProperty(Y,"Name",{enumerable:!0,get:function(){return Zr.Name}});var Ga=Hd();Object.defineProperty(Y,"Scope",{enumerable:!0,get:function(){return Ga.Scope}});Object.defineProperty(Y,"ValueScope",{enumerable:!0,get:function(){return Ga.ValueScope}});Object.defineProperty(Y,"ValueScopeName",{enumerable:!0,get:function(){return Ga.ValueScopeName}});Object.defineProperty(Y,"varKinds",{enumerable:!0,get:function(){return Ga.varKinds}});Y.operators={GT:new se._Code(">"),GTE:new se._Code(">="),LT:new se._Code("<"),LTE:new se._Code("<="),EQ:new se._Code("==="),NEQ:new se._Code("!=="),NOT:new se._Code("!"),OR:new se._Code("||"),AND:new se._Code("&&"),ADD:new se._Code("+")};var _r=class{optimizeNodes(){return this}optimizeNames(e,r){return this}},Kd=class extends _r{constructor(e,r,n){super(),this.varKind=e,this.name=r,this.rhs=n}render({es5:e,_n:r}){let n=e?qt.varKinds.var:this.varKind,s=this.rhs===void 0?"":` = ${this.rhs}`;return`${n} ${this.name}${s};`+r}optimizeNames(e,r){if(e[this.name.str])return this.rhs&&(this.rhs=ys(this.rhs,e,r)),this}get names(){return this.rhs instanceof se._CodeOrName?this.rhs.names:{}}},Ha=class extends _r{constructor(e,r,n){super(),this.lhs=e,this.rhs=r,this.sideEffects=n}render({_n:e}){return`${this.lhs} = ${this.rhs};`+e}optimizeNames(e,r){if(!(this.lhs instanceof se.Name&&!e[this.lhs.str]&&!this.sideEffects))return this.rhs=ys(this.rhs,e,r),this}get names(){let e=this.lhs instanceof se.Name?{}:{...this.lhs.names};return Ba(e,this.rhs)}},Bd=class extends Ha{constructor(e,r,n,s){super(e,n,s),this.op=r}render({_n:e}){return`${this.lhs} ${this.op}= ${this.rhs};`+e}},Gd=class extends _r{constructor(e){super(),this.label=e,this.names={}}render({_n:e}){return`${this.label}:`+e}},Wd=class extends _r{constructor(e){super(),this.label=e,this.names={}}render({_n:e}){return`break${this.label?` ${this.label}`:""};`+e}},Jd=class extends _r{constructor(e){super(),this.error=e}render({_n:e}){return`throw ${this.error};`+e}get names(){return this.error.names}},Yd=class extends _r{constructor(e){super(),this.code=e}render({_n:e}){return`${this.code};`+e}optimizeNodes(){return`${this.code}`?this:void 0}optimizeNames(e,r){return this.code=ys(this.code,e,r),this}get names(){return this.code instanceof se._CodeOrName?this.code.names:{}}},Lo=class extends _r{constructor(e=[]){super(),this.nodes=e}render(e){return this.nodes.reduce((r,n)=>r+n.render(e),"")}optimizeNodes(){let{nodes:e}=this,r=e.length;for(;r--;){let n=e[r].optimizeNodes();Array.isArray(n)?e.splice(r,1,...n):n?e[r]=n:e.splice(r,1)}return e.length>0?this:void 0}optimizeNames(e,r){let{nodes:n}=this,s=n.length;for(;s--;){let o=n[s];o.optimizeNames(e,r)||(DR(e,o.names),n.splice(s,1))}return n.length>0?this:void 0}get names(){return this.nodes.reduce((e,r)=>On(e,r.names),{})}},br=class extends Lo{render(e){return"{"+e._n+super.render(e)+"}"+e._n}},Qd=class extends Lo{},gs=class extends br{};gs.kind="else";var In=class t extends br{constructor(e,r){super(r),this.condition=e}render(e){let r=`if(${this.condition})`+super.render(e);return this.else&&(r+="else "+this.else.render(e)),r}optimizeNodes(){super.optimizeNodes();let e=this.condition;if(e===!0)return this.nodes;let r=this.else;if(r){let n=r.optimizeNodes();r=this.else=Array.isArray(n)?new gs(n):n}if(r)return e===!1?r instanceof t?r:r.nodes:this.nodes.length?this:new t(p0(e),r instanceof t?[r]:r.nodes);if(!(e===!1||!this.nodes.length))return this}optimizeNames(e,r){var n;if(this.else=(n=this.else)===null||n===void 0?void 0:n.optimizeNames(e,r),!!(super.optimizeNames(e,r)||this.else))return this.condition=ys(this.condition,e,r),this}get names(){let e=super.names;return Ba(e,this.condition),this.else&&On(e,this.else.names),e}};In.kind="if";var Rn=class extends br{};Rn.kind="for";var Xd=class extends Rn{constructor(e){super(),this.iteration=e}render(e){return`for(${this.iteration})`+super.render(e)}optimizeNames(e,r){if(super.optimizeNames(e,r))return this.iteration=ys(this.iteration,e,r),this}get names(){return On(super.names,this.iteration.names)}},ep=class extends Rn{constructor(e,r,n,s){super(),this.varKind=e,this.name=r,this.from=n,this.to=s}render(e){let r=e.es5?qt.varKinds.var:this.varKind,{name:n,from:s,to:o}=this;return`for(${r} ${n}=${s}; ${n}<${o}; ${n}++)`+super.render(e)}get names(){let e=Ba(super.names,this.from);return Ba(e,this.to)}},Ka=class extends Rn{constructor(e,r,n,s){super(),this.loop=e,this.varKind=r,this.name=n,this.iterable=s}render(e){return`for(${this.varKind} ${this.name} ${this.loop} ${this.iterable})`+super.render(e)}optimizeNames(e,r){if(super.optimizeNames(e,r))return this.iterable=ys(this.iterable,e,r),this}get names(){return On(super.names,this.iterable.names)}},Vo=class extends br{constructor(e,r,n){super(),this.name=e,this.args=r,this.async=n}render(e){return`${this.async?"async ":""}function ${this.name}(${this.args})`+super.render(e)}};Vo.kind="func";var Fo=class extends Lo{render(e){return"return "+super.render(e)}};Fo.kind="return";var tp=class extends br{render(e){let r="try"+super.render(e);return this.catch&&(r+=this.catch.render(e)),this.finally&&(r+=this.finally.render(e)),r}optimizeNodes(){var e,r;return super.optimizeNodes(),(e=this.catch)===null||e===void 0||e.optimizeNodes(),(r=this.finally)===null||r===void 0||r.optimizeNodes(),this}optimizeNames(e,r){var n,s;return super.optimizeNames(e,r),(n=this.catch)===null||n===void 0||n.optimizeNames(e,r),(s=this.finally)===null||s===void 0||s.optimizeNames(e,r),this}get names(){let e=super.names;return this.catch&&On(e,this.catch.names),this.finally&&On(e,this.finally.names),e}},Uo=class extends br{constructor(e){super(),this.error=e}render(e){return`catch(${this.error})`+super.render(e)}};Uo.kind="catch";var Ho=class extends br{render(e){return"finally"+super.render(e)}};Ho.kind="finally";var rp=class{constructor(e,r={}){this._values={},this._blockStarts=[],this._constants={},this.opts={...r,_n:r.lines?`
`:""},this._extScope=e,this._scope=new qt.Scope({parent:e}),this._nodes=[new Qd]}toString(){return this._root.render(this.opts)}name(e){return this._scope.name(e)}scopeName(e){return this._extScope.name(e)}scopeValue(e,r){let n=this._extScope.value(e,r);return(this._values[n.prefix]||(this._values[n.prefix]=new Set)).add(n),n}getScopeValue(e,r){return this._extScope.getValue(e,r)}scopeRefs(e){return this._extScope.scopeRefs(e,this._values)}scopeCode(){return this._extScope.scopeCode(this._values)}_def(e,r,n,s){let o=this._scope.toName(r);return n!==void 0&&s&&(this._constants[o.str]=n),this._leafNode(new Kd(e,o,n)),o}const(e,r,n){return this._def(qt.varKinds.const,e,r,n)}let(e,r,n){return this._def(qt.varKinds.let,e,r,n)}var(e,r,n){return this._def(qt.varKinds.var,e,r,n)}assign(e,r,n){return this._leafNode(new Ha(e,r,n))}add(e,r){return this._leafNode(new Bd(e,Y.operators.ADD,r))}code(e){return typeof e=="function"?e():e!==se.nil&&this._leafNode(new Yd(e)),this}object(...e){let r=["{"];for(let[n,s]of e)r.length>1&&r.push(","),r.push(n),(n!==s||this.opts.es5)&&(r.push(":"),(0,se.addCodeArg)(r,s));return r.push("}"),new se._Code(r)}if(e,r,n){if(this._blockNode(new In(e)),r&&n)this.code(r).else().code(n).endIf();else if(r)this.code(r).endIf();else if(n)throw new Error('CodeGen: "else" body without "then" body');return this}elseIf(e){return this._elseNode(new In(e))}else(){return this._elseNode(new gs)}endIf(){return this._endBlockNode(In,gs)}_for(e,r){return this._blockNode(e),r&&this.code(r).endFor(),this}for(e,r){return this._for(new Xd(e),r)}forRange(e,r,n,s,o=this.opts.es5?qt.varKinds.var:qt.varKinds.let){let i=this._scope.toName(e);return this._for(new ep(o,i,r,n),()=>s(i))}forOf(e,r,n,s=qt.varKinds.const){let o=this._scope.toName(e);if(this.opts.es5){let i=r instanceof se.Name?r:this.var("_arr",r);return this.forRange("_i",0,(0,se._)`${i}.length`,a=>{this.var(o,(0,se._)`${i}[${a}]`),n(o)})}return this._for(new Ka("of",s,o,r),()=>n(o))}forIn(e,r,n,s=this.opts.es5?qt.varKinds.var:qt.varKinds.const){if(this.opts.ownProperties)return this.forOf(e,(0,se._)`Object.keys(${r})`,n);let o=this._scope.toName(e);return this._for(new Ka("in",s,o,r),()=>n(o))}endFor(){return this._endBlockNode(Rn)}label(e){return this._leafNode(new Gd(e))}break(e){return this._leafNode(new Wd(e))}return(e){let r=new Fo;if(this._blockNode(r),this.code(e),r.nodes.length!==1)throw new Error('CodeGen: "return" should have one node');return this._endBlockNode(Fo)}try(e,r,n){if(!r&&!n)throw new Error('CodeGen: "try" without "catch" and "finally"');let s=new tp;if(this._blockNode(s),this.code(e),r){let o=this.name("e");this._currNode=s.catch=new Uo(o),r(o)}return n&&(this._currNode=s.finally=new Ho,this.code(n)),this._endBlockNode(Uo,Ho)}throw(e){return this._leafNode(new Jd(e))}block(e,r){return this._blockStarts.push(this._nodes.length),e&&this.code(e).endBlock(r),this}endBlock(e){let r=this._blockStarts.pop();if(r===void 0)throw new Error("CodeGen: not in self-balancing block");let n=this._nodes.length-r;if(n<0||e!==void 0&&n!==e)throw new Error(`CodeGen: wrong number of nodes: ${n} vs ${e} expected`);return this._nodes.length=r,this}func(e,r=se.nil,n,s){return this._blockNode(new Vo(e,r,n)),s&&this.code(s).endFunc(),this}endFunc(){return this._endBlockNode(Vo)}optimize(e=1){for(;e-- >0;)this._root.optimizeNodes(),this._root.optimizeNames(this._root.names,this._constants)}_leafNode(e){return this._currNode.nodes.push(e),this}_blockNode(e){this._currNode.nodes.push(e),this._nodes.push(e)}_endBlockNode(e,r){let n=this._currNode;if(n instanceof e||r&&n instanceof r)return this._nodes.pop(),this;throw new Error(`CodeGen: not in block "${r?`${e.kind}/${r.kind}`:e.kind}"`)}_elseNode(e){let r=this._currNode;if(!(r instanceof In))throw new Error('CodeGen: "else" without "if"');return this._currNode=r.else=e,this}get _root(){return this._nodes[0]}get _currNode(){let e=this._nodes;return e[e.length-1]}set _currNode(e){let r=this._nodes;r[r.length-1]=e}};Y.CodeGen=rp;function On(t,e){for(let r in e)t[r]=(t[r]||0)+(e[r]||0);return t}function Ba(t,e){return e instanceof se._CodeOrName?On(t,e.names):t}function ys(t,e,r){if(t instanceof se.Name)return n(t);if(!s(t))return t;return new se._Code(t._items.reduce((o,i)=>(i instanceof se.Name&&(i=n(i)),i instanceof se._Code?o.push(...i._items):o.push(i),o),[]));function n(o){let i=r[o.str];return i===void 0||e[o.str]!==1?o:(delete e[o.str],i)}function s(o){return o instanceof se._Code&&o._items.some(i=>i instanceof se.Name&&e[i.str]===1&&r[i.str]!==void 0)}}function DR(t,e){for(let r in e)t[r]=(t[r]||0)-(e[r]||0)}function p0(t){return typeof t=="boolean"||typeof t=="number"||t===null?!t:(0,se._)`!${np(t)}`}Y.not=p0;var ZR=f0(Y.operators.AND);function LR(...t){return t.reduce(ZR)}Y.and=LR;var VR=f0(Y.operators.OR);function FR(...t){return t.reduce(VR)}Y.or=FR;function f0(t){return(e,r)=>e===se.nil?r:r===se.nil?e:(0,se._)`${np(e)} ${t} ${np(r)}`}function np(t){return t instanceof se.Name?t:(0,se._)`(${t})`}});var le=v(ee=>{"use strict";Object.defineProperty(ee,"__esModule",{value:!0});ee.checkStrictMode=ee.getErrorPath=ee.Type=ee.useFunc=ee.setEvaluated=ee.evaluatedPropsToName=ee.mergeEvaluated=ee.eachItem=ee.unescapeJsonPointer=ee.escapeJsonPointer=ee.escapeFragment=ee.unescapeFragment=ee.schemaRefOrVal=ee.schemaHasRulesButRef=ee.schemaHasRules=ee.checkUnknownRules=ee.alwaysValidSchema=ee.toHash=void 0;var ye=W(),UR=Zo();function HR(t){let e={};for(let r of t)e[r]=!0;return e}ee.toHash=HR;function KR(t,e){return typeof e=="boolean"?e:Object.keys(e).length===0?!0:(g0(t,e),!y0(e,t.self.RULES.all))}ee.alwaysValidSchema=KR;function g0(t,e=t.schema){let{opts:r,self:n}=t;if(!r.strictSchema||typeof e=="boolean")return;let s=n.RULES.keywords;for(let o in e)s[o]||b0(t,`unknown keyword: "${o}"`)}ee.checkUnknownRules=g0;function y0(t,e){if(typeof t=="boolean")return!t;for(let r in t)if(e[r])return!0;return!1}ee.schemaHasRules=y0;function BR(t,e){if(typeof t=="boolean")return!t;for(let r in t)if(r!=="$ref"&&e.all[r])return!0;return!1}ee.schemaHasRulesButRef=BR;function GR({topSchemaRef:t,schemaPath:e},r,n,s){if(!s){if(typeof r=="number"||typeof r=="boolean")return r;if(typeof r=="string")return(0,ye._)`${r}`}return(0,ye._)`${t}${e}${(0,ye.getProperty)(n)}`}ee.schemaRefOrVal=GR;function WR(t){return v0(decodeURIComponent(t))}ee.unescapeFragment=WR;function JR(t){return encodeURIComponent(op(t))}ee.escapeFragment=JR;function op(t){return typeof t=="number"?`${t}`:t.replace(/~/g,"~0").replace(/\//g,"~1")}ee.escapeJsonPointer=op;function v0(t){return t.replace(/~1/g,"/").replace(/~0/g,"~")}ee.unescapeJsonPointer=v0;function YR(t,e){if(Array.isArray(t))for(let r of t)e(r);else e(t)}ee.eachItem=YR;function m0({mergeNames:t,mergeToName:e,mergeValues:r,resultToName:n}){return(s,o,i,a)=>{let c=i===void 0?o:i instanceof ye.Name?(o instanceof ye.Name?t(s,o,i):e(s,o,i),i):o instanceof ye.Name?(e(s,i,o),o):r(o,i);return a===ye.Name&&!(c instanceof ye.Name)?n(s,c):c}}ee.mergeEvaluated={props:m0({mergeNames:(t,e,r)=>t.if((0,ye._)`${r} !== true && ${e} !== undefined`,()=>{t.if((0,ye._)`${e} === true`,()=>t.assign(r,!0),()=>t.assign(r,(0,ye._)`${r} || {}`).code((0,ye._)`Object.assign(${r}, ${e})`))}),mergeToName:(t,e,r)=>t.if((0,ye._)`${r} !== true`,()=>{e===!0?t.assign(r,!0):(t.assign(r,(0,ye._)`${r} || {}`),ip(t,r,e))}),mergeValues:(t,e)=>t===!0?!0:{...t,...e},resultToName:_0}),items:m0({mergeNames:(t,e,r)=>t.if((0,ye._)`${r} !== true && ${e} !== undefined`,()=>t.assign(r,(0,ye._)`${e} === true ? true : ${r} > ${e} ? ${r} : ${e}`)),mergeToName:(t,e,r)=>t.if((0,ye._)`${r} !== true`,()=>t.assign(r,e===!0?!0:(0,ye._)`${r} > ${e} ? ${r} : ${e}`)),mergeValues:(t,e)=>t===!0?!0:Math.max(t,e),resultToName:(t,e)=>t.var("items",e)})};function _0(t,e){if(e===!0)return t.var("props",!0);let r=t.var("props",(0,ye._)`{}`);return e!==void 0&&ip(t,r,e),r}ee.evaluatedPropsToName=_0;function ip(t,e,r){Object.keys(r).forEach(n=>t.assign((0,ye._)`${e}${(0,ye.getProperty)(n)}`,!0))}ee.setEvaluated=ip;var h0={};function QR(t,e){return t.scopeValue("func",{ref:e,code:h0[e.code]||(h0[e.code]=new UR._Code(e.code))})}ee.useFunc=QR;var sp;(function(t){t[t.Num=0]="Num",t[t.Str=1]="Str"})(sp||(ee.Type=sp={}));function XR(t,e,r){if(t instanceof ye.Name){let n=e===sp.Num;return r?n?(0,ye._)`"[" + ${t} + "]"`:(0,ye._)`"['" + ${t} + "']"`:n?(0,ye._)`"/" + ${t}`:(0,ye._)`"/" + ${t}.replace(/~/g, "~0").replace(/\\//g, "~1")`}return r?(0,ye.getProperty)(t).toString():"/"+op(t)}ee.getErrorPath=XR;function b0(t,e,r=t.opts.strictSchema){if(r){if(e=`strict mode: ${e}`,r===!0)throw new Error(e);t.self.logger.warn(e)}}ee.checkStrictMode=b0});var wr=v(ap=>{"use strict";Object.defineProperty(ap,"__esModule",{value:!0});var Xe=W(),eO={data:new Xe.Name("data"),valCxt:new Xe.Name("valCxt"),instancePath:new Xe.Name("instancePath"),parentData:new Xe.Name("parentData"),parentDataProperty:new Xe.Name("parentDataProperty"),rootData:new Xe.Name("rootData"),dynamicAnchors:new Xe.Name("dynamicAnchors"),vErrors:new Xe.Name("vErrors"),errors:new Xe.Name("errors"),this:new Xe.Name("this"),self:new Xe.Name("self"),scope:new Xe.Name("scope"),json:new Xe.Name("json"),jsonPos:new Xe.Name("jsonPos"),jsonLen:new Xe.Name("jsonLen"),jsonPart:new Xe.Name("jsonPart")};ap.default=eO});var Ko=v(et=>{"use strict";Object.defineProperty(et,"__esModule",{value:!0});et.extendErrors=et.resetErrorsCount=et.reportExtraError=et.reportError=et.keyword$DataError=et.keywordError=void 0;var ie=W(),Wa=le(),st=wr();et.keywordError={message:({keyword:t})=>(0,ie.str)`must pass "${t}" keyword validation`};et.keyword$DataError={message:({keyword:t,schemaType:e})=>e?(0,ie.str)`"${t}" keyword must be ${e} ($data)`:(0,ie.str)`"${t}" keyword is invalid ($data)`};function tO(t,e=et.keywordError,r,n){let{it:s}=t,{gen:o,compositeRule:i,allErrors:a}=s,c=x0(t,e,r);n??(i||a)?w0(o,c):$0(s,(0,ie._)`[${c}]`)}et.reportError=tO;function rO(t,e=et.keywordError,r){let{it:n}=t,{gen:s,compositeRule:o,allErrors:i}=n,a=x0(t,e,r);w0(s,a),o||i||$0(n,st.default.vErrors)}et.reportExtraError=rO;function nO(t,e){t.assign(st.default.errors,e),t.if((0,ie._)`${st.default.vErrors} !== null`,()=>t.if(e,()=>t.assign((0,ie._)`${st.default.vErrors}.length`,e),()=>t.assign(st.default.vErrors,null)))}et.resetErrorsCount=nO;function sO({gen:t,keyword:e,schemaValue:r,data:n,errsCount:s,it:o}){if(s===void 0)throw new Error("ajv implementation error");let i=t.name("err");t.forRange("i",s,st.default.errors,a=>{t.const(i,(0,ie._)`${st.default.vErrors}[${a}]`),t.if((0,ie._)`${i}.instancePath === undefined`,()=>t.assign((0,ie._)`${i}.instancePath`,(0,ie.strConcat)(st.default.instancePath,o.errorPath))),t.assign((0,ie._)`${i}.schemaPath`,(0,ie.str)`${o.errSchemaPath}/${e}`),o.opts.verbose&&(t.assign((0,ie._)`${i}.schema`,r),t.assign((0,ie._)`${i}.data`,n))})}et.extendErrors=sO;function w0(t,e){let r=t.const("err",e);t.if((0,ie._)`${st.default.vErrors} === null`,()=>t.assign(st.default.vErrors,(0,ie._)`[${r}]`),(0,ie._)`${st.default.vErrors}.push(${r})`),t.code((0,ie._)`${st.default.errors}++`)}function $0(t,e){let{gen:r,validateName:n,schemaEnv:s}=t;s.$async?r.throw((0,ie._)`new ${t.ValidationError}(${e})`):(r.assign((0,ie._)`${n}.errors`,e),r.return(!1))}var Nn={keyword:new ie.Name("keyword"),schemaPath:new ie.Name("schemaPath"),params:new ie.Name("params"),propertyName:new ie.Name("propertyName"),message:new ie.Name("message"),schema:new ie.Name("schema"),parentSchema:new ie.Name("parentSchema")};function x0(t,e,r){let{createErrors:n}=t.it;return n===!1?(0,ie._)`{}`:oO(t,e,r)}function oO(t,e,r={}){let{gen:n,it:s}=t,o=[iO(s,r),aO(t,r)];return cO(t,e,o),n.object(...o)}function iO({errorPath:t},{instancePath:e}){let r=e?(0,ie.str)`${t}${(0,Wa.getErrorPath)(e,Wa.Type.Str)}`:t;return[st.default.instancePath,(0,ie.strConcat)(st.default.instancePath,r)]}function aO({keyword:t,it:{errSchemaPath:e}},{schemaPath:r,parentSchema:n}){let s=n?e:(0,ie.str)`${e}/${t}`;return r&&(s=(0,ie.str)`${s}${(0,Wa.getErrorPath)(r,Wa.Type.Str)}`),[Nn.schemaPath,s]}function cO(t,{params:e,message:r},n){let{keyword:s,data:o,schemaValue:i,it:a}=t,{opts:c,propertyName:u,topSchemaRef:l,schemaPath:d}=a;n.push([Nn.keyword,s],[Nn.params,typeof e=="function"?e(t):e||(0,ie._)`{}`]),c.messages&&n.push([Nn.message,typeof r=="function"?r(t):r]),c.verbose&&n.push([Nn.schema,i],[Nn.parentSchema,(0,ie._)`${l}${d}`],[st.default.data,o]),u&&n.push([Nn.propertyName,u])}});var S0=v(vs=>{"use strict";Object.defineProperty(vs,"__esModule",{value:!0});vs.boolOrEmptySchema=vs.topBoolOrEmptySchema=void 0;var uO=Ko(),lO=W(),dO=wr(),pO={message:"boolean schema is false"};function fO(t){let{gen:e,schema:r,validateName:n}=t;r===!1?k0(t,!1):typeof r=="object"&&r.$async===!0?e.return(dO.default.data):(e.assign((0,lO._)`${n}.errors`,null),e.return(!0))}vs.topBoolOrEmptySchema=fO;function mO(t,e){let{gen:r,schema:n}=t;n===!1?(r.var(e,!1),k0(t)):r.var(e,!0)}vs.boolOrEmptySchema=mO;function k0(t,e){let{gen:r,data:n}=t,s={gen:r,keyword:"false schema",data:n,schema:!1,schemaCode:!1,schemaValue:!1,params:{},it:t};(0,uO.reportError)(s,pO,void 0,e)}});var cp=v(_s=>{"use strict";Object.defineProperty(_s,"__esModule",{value:!0});_s.getRules=_s.isJSONType=void 0;var hO=["string","number","integer","boolean","null","object","array"],gO=new Set(hO);function yO(t){return typeof t=="string"&&gO.has(t)}_s.isJSONType=yO;function vO(){let t={number:{type:"number",rules:[]},string:{type:"string",rules:[]},array:{type:"array",rules:[]},object:{type:"object",rules:[]}};return{types:{...t,integer:!0,boolean:!0,null:!0},rules:[{rules:[]},t.number,t.string,t.array,t.object],post:{rules:[]},all:{},keywords:{}}}_s.getRules=vO});var up=v(Lr=>{"use strict";Object.defineProperty(Lr,"__esModule",{value:!0});Lr.shouldUseRule=Lr.shouldUseGroup=Lr.schemaHasRulesForType=void 0;function _O({schema:t,self:e},r){let n=e.RULES.types[r];return n&&n!==!0&&P0(t,n)}Lr.schemaHasRulesForType=_O;function P0(t,e){return e.rules.some(r=>E0(t,r))}Lr.shouldUseGroup=P0;function E0(t,e){var r;return t[e.keyword]!==void 0||((r=e.definition.implements)===null||r===void 0?void 0:r.some(n=>t[n]!==void 0))}Lr.shouldUseRule=E0});var Bo=v(tt=>{"use strict";Object.defineProperty(tt,"__esModule",{value:!0});tt.reportTypeError=tt.checkDataTypes=tt.checkDataType=tt.coerceAndCheckDataType=tt.getJSONTypes=tt.getSchemaTypes=tt.DataType=void 0;var bO=cp(),wO=up(),$O=Ko(),B=W(),T0=le(),bs;(function(t){t[t.Correct=0]="Correct",t[t.Wrong=1]="Wrong"})(bs||(tt.DataType=bs={}));function xO(t){let e=z0(t.type);if(e.includes("null")){if(t.nullable===!1)throw new Error("type: null contradicts nullable: false")}else{if(!e.length&&t.nullable!==void 0)throw new Error('"nullable" cannot be used without "type"');t.nullable===!0&&e.push("null")}return e}tt.getSchemaTypes=xO;function z0(t){let e=Array.isArray(t)?t:t?[t]:[];if(e.every(bO.isJSONType))return e;throw new Error("type must be JSONType or JSONType[]: "+e.join(","))}tt.getJSONTypes=z0;function kO(t,e){let{gen:r,data:n,opts:s}=t,o=SO(e,s.coerceTypes),i=e.length>0&&!(o.length===0&&e.length===1&&(0,wO.schemaHasRulesForType)(t,e[0]));if(i){let a=dp(e,n,s.strictNumbers,bs.Wrong);r.if(a,()=>{o.length?PO(t,e,o):pp(t)})}return i}tt.coerceAndCheckDataType=kO;var C0=new Set(["string","number","integer","boolean","null"]);function SO(t,e){return e?t.filter(r=>C0.has(r)||e==="array"&&r==="array"):[]}function PO(t,e,r){let{gen:n,data:s,opts:o}=t,i=n.let("dataType",(0,B._)`typeof ${s}`),a=n.let("coerced",(0,B._)`undefined`);o.coerceTypes==="array"&&n.if((0,B._)`${i} == 'object' && Array.isArray(${s}) && ${s}.length == 1`,()=>n.assign(s,(0,B._)`${s}[0]`).assign(i,(0,B._)`typeof ${s}`).if(dp(e,s,o.strictNumbers),()=>n.assign(a,s))),n.if((0,B._)`${a} !== undefined`);for(let u of r)(C0.has(u)||u==="array"&&o.coerceTypes==="array")&&c(u);n.else(),pp(t),n.endIf(),n.if((0,B._)`${a} !== undefined`,()=>{n.assign(s,a),EO(t,a)});function c(u){switch(u){case"string":n.elseIf((0,B._)`${i} == "number" || ${i} == "boolean"`).assign(a,(0,B._)`"" + ${s}`).elseIf((0,B._)`${s} === null`).assign(a,(0,B._)`""`);return;case"number":n.elseIf((0,B._)`${i} == "boolean" || ${s} === null
              || (${i} == "string" && ${s} && ${s} == +${s})`).assign(a,(0,B._)`+${s}`);return;case"integer":n.elseIf((0,B._)`${i} === "boolean" || ${s} === null
              || (${i} === "string" && ${s} && ${s} == +${s} && !(${s} % 1))`).assign(a,(0,B._)`+${s}`);return;case"boolean":n.elseIf((0,B._)`${s} === "false" || ${s} === 0 || ${s} === null`).assign(a,!1).elseIf((0,B._)`${s} === "true" || ${s} === 1`).assign(a,!0);return;case"null":n.elseIf((0,B._)`${s} === "" || ${s} === 0 || ${s} === false`),n.assign(a,null);return;case"array":n.elseIf((0,B._)`${i} === "string" || ${i} === "number"
              || ${i} === "boolean" || ${s} === null`).assign(a,(0,B._)`[${s}]`)}}}function EO({gen:t,parentData:e,parentDataProperty:r},n){t.if((0,B._)`${e} !== undefined`,()=>t.assign((0,B._)`${e}[${r}]`,n))}function lp(t,e,r,n=bs.Correct){let s=n===bs.Correct?B.operators.EQ:B.operators.NEQ,o;switch(t){case"null":return(0,B._)`${e} ${s} null`;case"array":o=(0,B._)`Array.isArray(${e})`;break;case"object":o=(0,B._)`${e} && typeof ${e} == "object" && !Array.isArray(${e})`;break;case"integer":o=i((0,B._)`!(${e} % 1) && !isNaN(${e})`);break;case"number":o=i();break;default:return(0,B._)`typeof ${e} ${s} ${t}`}return n===bs.Correct?o:(0,B.not)(o);function i(a=B.nil){return(0,B.and)((0,B._)`typeof ${e} == "number"`,a,r?(0,B._)`isFinite(${e})`:B.nil)}}tt.checkDataType=lp;function dp(t,e,r,n){if(t.length===1)return lp(t[0],e,r,n);let s,o=(0,T0.toHash)(t);if(o.array&&o.object){let i=(0,B._)`typeof ${e} != "object"`;s=o.null?i:(0,B._)`!${e} || ${i}`,delete o.null,delete o.array,delete o.object}else s=B.nil;o.number&&delete o.integer;for(let i in o)s=(0,B.and)(s,lp(i,e,r,n));return s}tt.checkDataTypes=dp;var TO={message:({schema:t})=>`must be ${t}`,params:({schema:t,schemaValue:e})=>typeof t=="string"?(0,B._)`{type: ${t}}`:(0,B._)`{type: ${e}}`};function pp(t){let e=zO(t);(0,$O.reportError)(e,TO)}tt.reportTypeError=pp;function zO(t){let{gen:e,data:r,schema:n}=t,s=(0,T0.schemaRefOrVal)(t,n,"type");return{gen:e,keyword:"type",data:r,schema:n.type,schemaCode:s,schemaValue:s,parentSchema:n,params:{},it:t}}});var R0=v(Ja=>{"use strict";Object.defineProperty(Ja,"__esModule",{value:!0});Ja.assignDefaults=void 0;var ws=W(),CO=le();function IO(t,e){let{properties:r,items:n}=t.schema;if(e==="object"&&r)for(let s in r)I0(t,s,r[s].default);else e==="array"&&Array.isArray(n)&&n.forEach((s,o)=>I0(t,o,s.default))}Ja.assignDefaults=IO;function I0(t,e,r){let{gen:n,compositeRule:s,data:o,opts:i}=t;if(r===void 0)return;let a=(0,ws._)`${o}${(0,ws.getProperty)(e)}`;if(s){(0,CO.checkStrictMode)(t,`default is ignored for: ${a}`);return}let c=(0,ws._)`${a} === undefined`;i.useDefaults==="empty"&&(c=(0,ws._)`${c} || ${a} === null || ${a} === ""`),n.if(c,(0,ws._)`${a} = ${(0,ws.stringify)(r)}`)}});var Tt=v(me=>{"use strict";Object.defineProperty(me,"__esModule",{value:!0});me.validateUnion=me.validateArray=me.usePattern=me.callValidateCode=me.schemaProperties=me.allSchemaProperties=me.noPropertyInData=me.propertyInData=me.isOwnProperty=me.hasPropFunc=me.reportMissingProp=me.checkMissingProp=me.checkReportMissingProp=void 0;var Pe=W(),fp=le(),Vr=wr(),RO=le();function OO(t,e){let{gen:r,data:n,it:s}=t;r.if(hp(r,n,e,s.opts.ownProperties),()=>{t.setParams({missingProperty:(0,Pe._)`${e}`},!0),t.error()})}me.checkReportMissingProp=OO;function NO({gen:t,data:e,it:{opts:r}},n,s){return(0,Pe.or)(...n.map(o=>(0,Pe.and)(hp(t,e,o,r.ownProperties),(0,Pe._)`${s} = ${o}`)))}me.checkMissingProp=NO;function jO(t,e){t.setParams({missingProperty:e},!0),t.error()}me.reportMissingProp=jO;function O0(t){return t.scopeValue("func",{ref:Object.prototype.hasOwnProperty,code:(0,Pe._)`Object.prototype.hasOwnProperty`})}me.hasPropFunc=O0;function mp(t,e,r){return(0,Pe._)`${O0(t)}.call(${e}, ${r})`}me.isOwnProperty=mp;function AO(t,e,r,n){let s=(0,Pe._)`${e}${(0,Pe.getProperty)(r)} !== undefined`;return n?(0,Pe._)`${s} && ${mp(t,e,r)}`:s}me.propertyInData=AO;function hp(t,e,r,n){let s=(0,Pe._)`${e}${(0,Pe.getProperty)(r)} === undefined`;return n?(0,Pe.or)(s,(0,Pe.not)(mp(t,e,r))):s}me.noPropertyInData=hp;function N0(t){return t?Object.keys(t).filter(e=>e!=="__proto__"):[]}me.allSchemaProperties=N0;function MO(t,e){return N0(e).filter(r=>!(0,fp.alwaysValidSchema)(t,e[r]))}me.schemaProperties=MO;function qO({schemaCode:t,data:e,it:{gen:r,topSchemaRef:n,schemaPath:s,errorPath:o},it:i},a,c,u){let l=u?(0,Pe._)`${t}, ${e}, ${n}${s}`:e,d=[[Vr.default.instancePath,(0,Pe.strConcat)(Vr.default.instancePath,o)],[Vr.default.parentData,i.parentData],[Vr.default.parentDataProperty,i.parentDataProperty],[Vr.default.rootData,Vr.default.rootData]];i.opts.dynamicRef&&d.push([Vr.default.dynamicAnchors,Vr.default.dynamicAnchors]);let f=(0,Pe._)`${l}, ${r.object(...d)}`;return c!==Pe.nil?(0,Pe._)`${a}.call(${c}, ${f})`:(0,Pe._)`${a}(${f})`}me.callValidateCode=qO;var DO=(0,Pe._)`new RegExp`;function ZO({gen:t,it:{opts:e}},r){let n=e.unicodeRegExp?"u":"",{regExp:s}=e.code,o=s(r,n);return t.scopeValue("pattern",{key:o.toString(),ref:o,code:(0,Pe._)`${s.code==="new RegExp"?DO:(0,RO.useFunc)(t,s)}(${r}, ${n})`})}me.usePattern=ZO;function LO(t){let{gen:e,data:r,keyword:n,it:s}=t,o=e.name("valid");if(s.allErrors){let a=e.let("valid",!0);return i(()=>e.assign(a,!1)),a}return e.var(o,!0),i(()=>e.break()),o;function i(a){let c=e.const("len",(0,Pe._)`${r}.length`);e.forRange("i",0,c,u=>{t.subschema({keyword:n,dataProp:u,dataPropType:fp.Type.Num},o),e.if((0,Pe.not)(o),a)})}}me.validateArray=LO;function VO(t){let{gen:e,schema:r,keyword:n,it:s}=t;if(!Array.isArray(r))throw new Error("ajv implementation error");if(r.some(c=>(0,fp.alwaysValidSchema)(s,c))&&!s.opts.unevaluated)return;let i=e.let("valid",!1),a=e.name("_valid");e.block(()=>r.forEach((c,u)=>{let l=t.subschema({keyword:n,schemaProp:u,compositeRule:!0},a);e.assign(i,(0,Pe._)`${i} || ${a}`),t.mergeValidEvaluated(l,a)||e.if((0,Pe.not)(i))})),t.result(i,()=>t.reset(),()=>t.error(!0))}me.validateUnion=VO});var M0=v(nr=>{"use strict";Object.defineProperty(nr,"__esModule",{value:!0});nr.validateKeywordUsage=nr.validSchemaType=nr.funcKeywordCode=nr.macroKeywordCode=void 0;var ot=W(),jn=wr(),FO=Tt(),UO=Ko();function HO(t,e){let{gen:r,keyword:n,schema:s,parentSchema:o,it:i}=t,a=e.macro.call(i.self,s,o,i),c=A0(r,n,a);i.opts.validateSchema!==!1&&i.self.validateSchema(a,!0);let u=r.name("valid");t.subschema({schema:a,schemaPath:ot.nil,errSchemaPath:`${i.errSchemaPath}/${n}`,topSchemaRef:c,compositeRule:!0},u),t.pass(u,()=>t.error(!0))}nr.macroKeywordCode=HO;function KO(t,e){var r;let{gen:n,keyword:s,schema:o,parentSchema:i,$data:a,it:c}=t;GO(c,e);let u=!a&&e.compile?e.compile.call(c.self,o,i,c):e.validate,l=A0(n,s,u),d=n.let("valid");t.block$data(d,f),t.ok((r=e.valid)!==null&&r!==void 0?r:d);function f(){if(e.errors===!1)h(),e.modifying&&j0(t),g(()=>t.error());else{let y=e.async?p():m();e.modifying&&j0(t),g(()=>BO(t,y))}}function p(){let y=n.let("ruleErrs",null);return n.try(()=>h((0,ot._)`await `),x=>n.assign(d,!1).if((0,ot._)`${x} instanceof ${c.ValidationError}`,()=>n.assign(y,(0,ot._)`${x}.errors`),()=>n.throw(x))),y}function m(){let y=(0,ot._)`${l}.errors`;return n.assign(y,null),h(ot.nil),y}function h(y=e.async?(0,ot._)`await `:ot.nil){let x=c.opts.passContext?jn.default.this:jn.default.self,$=!("compile"in e&&!a||e.schema===!1);n.assign(d,(0,ot._)`${y}${(0,FO.callValidateCode)(t,l,x,$)}`,e.modifying)}function g(y){var x;n.if((0,ot.not)((x=e.valid)!==null&&x!==void 0?x:d),y)}}nr.funcKeywordCode=KO;function j0(t){let{gen:e,data:r,it:n}=t;e.if(n.parentData,()=>e.assign(r,(0,ot._)`${n.parentData}[${n.parentDataProperty}]`))}function BO(t,e){let{gen:r}=t;r.if((0,ot._)`Array.isArray(${e})`,()=>{r.assign(jn.default.vErrors,(0,ot._)`${jn.default.vErrors} === null ? ${e} : ${jn.default.vErrors}.concat(${e})`).assign(jn.default.errors,(0,ot._)`${jn.default.vErrors}.length`),(0,UO.extendErrors)(t)},()=>t.error())}function GO({schemaEnv:t},e){if(e.async&&!t.$async)throw new Error("async keyword in sync schema")}function A0(t,e,r){if(r===void 0)throw new Error(`keyword "${e}" failed to compile`);return t.scopeValue("keyword",typeof r=="function"?{ref:r}:{ref:r,code:(0,ot.stringify)(r)})}function WO(t,e,r=!1){return!e.length||e.some(n=>n==="array"?Array.isArray(t):n==="object"?t&&typeof t=="object"&&!Array.isArray(t):typeof t==n||r&&typeof t>"u")}nr.validSchemaType=WO;function JO({schema:t,opts:e,self:r,errSchemaPath:n},s,o){if(Array.isArray(s.keyword)?!s.keyword.includes(o):s.keyword!==o)throw new Error("ajv implementation error");let i=s.dependencies;if(i?.some(a=>!Object.prototype.hasOwnProperty.call(t,a)))throw new Error(`parent schema must have dependencies of ${o}: ${i.join(",")}`);if(s.validateSchema&&!s.validateSchema(t[o])){let c=`keyword "${o}" value is invalid at path "${n}": `+r.errorsText(s.validateSchema.errors);if(e.validateSchema==="log")r.logger.error(c);else throw new Error(c)}}nr.validateKeywordUsage=JO});var D0=v(Fr=>{"use strict";Object.defineProperty(Fr,"__esModule",{value:!0});Fr.extendSubschemaMode=Fr.extendSubschemaData=Fr.getSubschema=void 0;var sr=W(),q0=le();function YO(t,{keyword:e,schemaProp:r,schema:n,schemaPath:s,errSchemaPath:o,topSchemaRef:i}){if(e!==void 0&&n!==void 0)throw new Error('both "keyword" and "schema" passed, only one allowed');if(e!==void 0){let a=t.schema[e];return r===void 0?{schema:a,schemaPath:(0,sr._)`${t.schemaPath}${(0,sr.getProperty)(e)}`,errSchemaPath:`${t.errSchemaPath}/${e}`}:{schema:a[r],schemaPath:(0,sr._)`${t.schemaPath}${(0,sr.getProperty)(e)}${(0,sr.getProperty)(r)}`,errSchemaPath:`${t.errSchemaPath}/${e}/${(0,q0.escapeFragment)(r)}`}}if(n!==void 0){if(s===void 0||o===void 0||i===void 0)throw new Error('"schemaPath", "errSchemaPath" and "topSchemaRef" are required with "schema"');return{schema:n,schemaPath:s,topSchemaRef:i,errSchemaPath:o}}throw new Error('either "keyword" or "schema" must be passed')}Fr.getSubschema=YO;function QO(t,e,{dataProp:r,dataPropType:n,data:s,dataTypes:o,propertyName:i}){if(s!==void 0&&r!==void 0)throw new Error('both "data" and "dataProp" passed, only one allowed');let{gen:a}=e;if(r!==void 0){let{errorPath:u,dataPathArr:l,opts:d}=e,f=a.let("data",(0,sr._)`${e.data}${(0,sr.getProperty)(r)}`,!0);c(f),t.errorPath=(0,sr.str)`${u}${(0,q0.getErrorPath)(r,n,d.jsPropertySyntax)}`,t.parentDataProperty=(0,sr._)`${r}`,t.dataPathArr=[...l,t.parentDataProperty]}if(s!==void 0){let u=s instanceof sr.Name?s:a.let("data",s,!0);c(u),i!==void 0&&(t.propertyName=i)}o&&(t.dataTypes=o);function c(u){t.data=u,t.dataLevel=e.dataLevel+1,t.dataTypes=[],e.definedProperties=new Set,t.parentData=e.data,t.dataNames=[...e.dataNames,u]}}Fr.extendSubschemaData=QO;function XO(t,{jtdDiscriminator:e,jtdMetadata:r,compositeRule:n,createErrors:s,allErrors:o}){n!==void 0&&(t.compositeRule=n),s!==void 0&&(t.createErrors=s),o!==void 0&&(t.allErrors=o),t.jtdDiscriminator=e,t.jtdMetadata=r}Fr.extendSubschemaMode=XO});var L0=v((OV,Z0)=>{"use strict";var Ur=Z0.exports=function(t,e,r){typeof e=="function"&&(r=e,e={}),r=e.cb||r;var n=typeof r=="function"?r:r.pre||function(){},s=r.post||function(){};Ya(e,n,s,t,"",t)};Ur.keywords={additionalItems:!0,items:!0,contains:!0,additionalProperties:!0,propertyNames:!0,not:!0,if:!0,then:!0,else:!0};Ur.arrayKeywords={items:!0,allOf:!0,anyOf:!0,oneOf:!0};Ur.propsKeywords={$defs:!0,definitions:!0,properties:!0,patternProperties:!0,dependencies:!0};Ur.skipKeywords={default:!0,enum:!0,const:!0,required:!0,maximum:!0,minimum:!0,exclusiveMaximum:!0,exclusiveMinimum:!0,multipleOf:!0,maxLength:!0,minLength:!0,pattern:!0,format:!0,maxItems:!0,minItems:!0,uniqueItems:!0,maxProperties:!0,minProperties:!0};function Ya(t,e,r,n,s,o,i,a,c,u){if(n&&typeof n=="object"&&!Array.isArray(n)){e(n,s,o,i,a,c,u);for(var l in n){var d=n[l];if(Array.isArray(d)){if(l in Ur.arrayKeywords)for(var f=0;f<d.length;f++)Ya(t,e,r,d[f],s+"/"+l+"/"+f,o,s,l,n,f)}else if(l in Ur.propsKeywords){if(d&&typeof d=="object")for(var p in d)Ya(t,e,r,d[p],s+"/"+l+"/"+eN(p),o,s,l,n,p)}else(l in Ur.keywords||t.allKeys&&!(l in Ur.skipKeywords))&&Ya(t,e,r,d,s+"/"+l,o,s,l,n)}r(n,s,o,i,a,c,u)}}function eN(t){return t.replace(/~/g,"~0").replace(/\//g,"~1")}});var Go=v(ht=>{"use strict";Object.defineProperty(ht,"__esModule",{value:!0});ht.getSchemaRefs=ht.resolveUrl=ht.normalizeId=ht._getFullPath=ht.getFullPath=ht.inlineRef=void 0;var tN=le(),rN=_o(),nN=L0(),sN=new Set(["type","format","pattern","maxLength","minLength","maxProperties","minProperties","maxItems","minItems","maximum","minimum","uniqueItems","multipleOf","required","enum","const"]);function oN(t,e=!0){return typeof t=="boolean"?!0:e===!0?!gp(t):e?V0(t)<=e:!1}ht.inlineRef=oN;var iN=new Set(["$ref","$recursiveRef","$recursiveAnchor","$dynamicRef","$dynamicAnchor"]);function gp(t){for(let e in t){if(iN.has(e))return!0;let r=t[e];if(Array.isArray(r)&&r.some(gp)||typeof r=="object"&&gp(r))return!0}return!1}function V0(t){let e=0;for(let r in t){if(r==="$ref")return 1/0;if(e++,!sN.has(r)&&(typeof t[r]=="object"&&(0,tN.eachItem)(t[r],n=>e+=V0(n)),e===1/0))return 1/0}return e}function F0(t,e="",r){r!==!1&&(e=$s(e));let n=t.parse(e);return U0(t,n)}ht.getFullPath=F0;function U0(t,e){return t.serialize(e).split("#")[0]+"#"}ht._getFullPath=U0;var aN=/#\/?$/;function $s(t){return t?t.replace(aN,""):""}ht.normalizeId=$s;function cN(t,e,r){return r=$s(r),t.resolve(e,r)}ht.resolveUrl=cN;var uN=/^[a-z_][-a-z0-9._]*$/i;function lN(t,e){if(typeof t=="boolean")return{};let{schemaId:r,uriResolver:n}=this.opts,s=$s(t[r]||e),o={"":s},i=F0(n,s,!1),a={},c=new Set;return nN(t,{allKeys:!0},(d,f,p,m)=>{if(m===void 0)return;let h=i+f,g=o[m];typeof d[r]=="string"&&(g=y.call(this,d[r])),x.call(this,d.$anchor),x.call(this,d.$dynamicAnchor),o[f]=g;function y($){let S=this.opts.uriResolver.resolve;if($=$s(g?S(g,$):$),c.has($))throw l($);c.add($);let w=this.refs[$];return typeof w=="string"&&(w=this.refs[w]),typeof w=="object"?u(d,w.schema,$):$!==$s(h)&&($[0]==="#"?(u(d,a[$],$),a[$]=d):this.refs[$]=h),$}function x($){if(typeof $=="string"){if(!uN.test($))throw new Error(`invalid anchor "${$}"`);y.call(this,`#${$}`)}}}),a;function u(d,f,p){if(f!==void 0&&!rN(d,f))throw l(p)}function l(d){return new Error(`reference "${d}" resolves to more than one schema`)}}ht.getSchemaRefs=lN});var Yo=v(Hr=>{"use strict";Object.defineProperty(Hr,"__esModule",{value:!0});Hr.getData=Hr.KeywordCxt=Hr.validateFunctionCode=void 0;var W0=S0(),H0=Bo(),vp=up(),Qa=Bo(),dN=R0(),Jo=M0(),yp=D0(),N=W(),V=wr(),pN=Go(),$r=le(),Wo=Ko();function fN(t){if(Q0(t)&&(X0(t),Y0(t))){gN(t);return}J0(t,()=>(0,W0.topBoolOrEmptySchema)(t))}Hr.validateFunctionCode=fN;function J0({gen:t,validateName:e,schema:r,schemaEnv:n,opts:s},o){s.code.es5?t.func(e,(0,N._)`${V.default.data}, ${V.default.valCxt}`,n.$async,()=>{t.code((0,N._)`"use strict"; ${K0(r,s)}`),hN(t,s),t.code(o)}):t.func(e,(0,N._)`${V.default.data}, ${mN(s)}`,n.$async,()=>t.code(K0(r,s)).code(o))}function mN(t){return(0,N._)`{${V.default.instancePath}="", ${V.default.parentData}, ${V.default.parentDataProperty}, ${V.default.rootData}=${V.default.data}${t.dynamicRef?(0,N._)`, ${V.default.dynamicAnchors}={}`:N.nil}}={}`}function hN(t,e){t.if(V.default.valCxt,()=>{t.var(V.default.instancePath,(0,N._)`${V.default.valCxt}.${V.default.instancePath}`),t.var(V.default.parentData,(0,N._)`${V.default.valCxt}.${V.default.parentData}`),t.var(V.default.parentDataProperty,(0,N._)`${V.default.valCxt}.${V.default.parentDataProperty}`),t.var(V.default.rootData,(0,N._)`${V.default.valCxt}.${V.default.rootData}`),e.dynamicRef&&t.var(V.default.dynamicAnchors,(0,N._)`${V.default.valCxt}.${V.default.dynamicAnchors}`)},()=>{t.var(V.default.instancePath,(0,N._)`""`),t.var(V.default.parentData,(0,N._)`undefined`),t.var(V.default.parentDataProperty,(0,N._)`undefined`),t.var(V.default.rootData,V.default.data),e.dynamicRef&&t.var(V.default.dynamicAnchors,(0,N._)`{}`)})}function gN(t){let{schema:e,opts:r,gen:n}=t;J0(t,()=>{r.$comment&&e.$comment&&tb(t),wN(t),n.let(V.default.vErrors,null),n.let(V.default.errors,0),r.unevaluated&&yN(t),eb(t),kN(t)})}function yN(t){let{gen:e,validateName:r}=t;t.evaluated=e.const("evaluated",(0,N._)`${r}.evaluated`),e.if((0,N._)`${t.evaluated}.dynamicProps`,()=>e.assign((0,N._)`${t.evaluated}.props`,(0,N._)`undefined`)),e.if((0,N._)`${t.evaluated}.dynamicItems`,()=>e.assign((0,N._)`${t.evaluated}.items`,(0,N._)`undefined`))}function K0(t,e){let r=typeof t=="object"&&t[e.schemaId];return r&&(e.code.source||e.code.process)?(0,N._)`/*# sourceURL=${r} */`:N.nil}function vN(t,e){if(Q0(t)&&(X0(t),Y0(t))){_N(t,e);return}(0,W0.boolOrEmptySchema)(t,e)}function Y0({schema:t,self:e}){if(typeof t=="boolean")return!t;for(let r in t)if(e.RULES.all[r])return!0;return!1}function Q0(t){return typeof t.schema!="boolean"}function _N(t,e){let{schema:r,gen:n,opts:s}=t;s.$comment&&r.$comment&&tb(t),$N(t),xN(t);let o=n.const("_errs",V.default.errors);eb(t,o),n.var(e,(0,N._)`${o} === ${V.default.errors}`)}function X0(t){(0,$r.checkUnknownRules)(t),bN(t)}function eb(t,e){if(t.opts.jtd)return B0(t,[],!1,e);let r=(0,H0.getSchemaTypes)(t.schema),n=(0,H0.coerceAndCheckDataType)(t,r);B0(t,r,!n,e)}function bN(t){let{schema:e,errSchemaPath:r,opts:n,self:s}=t;e.$ref&&n.ignoreKeywordsWithRef&&(0,$r.schemaHasRulesButRef)(e,s.RULES)&&s.logger.warn(`$ref: keywords ignored in schema at path "${r}"`)}function wN(t){let{schema:e,opts:r}=t;e.default!==void 0&&r.useDefaults&&r.strictSchema&&(0,$r.checkStrictMode)(t,"default is ignored in the schema root")}function $N(t){let e=t.schema[t.opts.schemaId];e&&(t.baseId=(0,pN.resolveUrl)(t.opts.uriResolver,t.baseId,e))}function xN(t){if(t.schema.$async&&!t.schemaEnv.$async)throw new Error("async schema in sync schema")}function tb({gen:t,schemaEnv:e,schema:r,errSchemaPath:n,opts:s}){let o=r.$comment;if(s.$comment===!0)t.code((0,N._)`${V.default.self}.logger.log(${o})`);else if(typeof s.$comment=="function"){let i=(0,N.str)`${n}/$comment`,a=t.scopeValue("root",{ref:e.root});t.code((0,N._)`${V.default.self}.opts.$comment(${o}, ${i}, ${a}.schema)`)}}function kN(t){let{gen:e,schemaEnv:r,validateName:n,ValidationError:s,opts:o}=t;r.$async?e.if((0,N._)`${V.default.errors} === 0`,()=>e.return(V.default.data),()=>e.throw((0,N._)`new ${s}(${V.default.vErrors})`)):(e.assign((0,N._)`${n}.errors`,V.default.vErrors),o.unevaluated&&SN(t),e.return((0,N._)`${V.default.errors} === 0`))}function SN({gen:t,evaluated:e,props:r,items:n}){r instanceof N.Name&&t.assign((0,N._)`${e}.props`,r),n instanceof N.Name&&t.assign((0,N._)`${e}.items`,n)}function B0(t,e,r,n){let{gen:s,schema:o,data:i,allErrors:a,opts:c,self:u}=t,{RULES:l}=u;if(o.$ref&&(c.ignoreKeywordsWithRef||!(0,$r.schemaHasRulesButRef)(o,l))){s.block(()=>nb(t,"$ref",l.all.$ref.definition));return}c.jtd||PN(t,e),s.block(()=>{for(let f of l.rules)d(f);d(l.post)});function d(f){(0,vp.shouldUseGroup)(o,f)&&(f.type?(s.if((0,Qa.checkDataType)(f.type,i,c.strictNumbers)),G0(t,f),e.length===1&&e[0]===f.type&&r&&(s.else(),(0,Qa.reportTypeError)(t)),s.endIf()):G0(t,f),a||s.if((0,N._)`${V.default.errors} === ${n||0}`))}}function G0(t,e){let{gen:r,schema:n,opts:{useDefaults:s}}=t;s&&(0,dN.assignDefaults)(t,e.type),r.block(()=>{for(let o of e.rules)(0,vp.shouldUseRule)(n,o)&&nb(t,o.keyword,o.definition,e.type)})}function PN(t,e){t.schemaEnv.meta||!t.opts.strictTypes||(EN(t,e),t.opts.allowUnionTypes||TN(t,e),zN(t,t.dataTypes))}function EN(t,e){if(e.length){if(!t.dataTypes.length){t.dataTypes=e;return}e.forEach(r=>{rb(t.dataTypes,r)||_p(t,`type "${r}" not allowed by context "${t.dataTypes.join(",")}"`)}),IN(t,e)}}function TN(t,e){e.length>1&&!(e.length===2&&e.includes("null"))&&_p(t,"use allowUnionTypes to allow union type keyword")}function zN(t,e){let r=t.self.RULES.all;for(let n in r){let s=r[n];if(typeof s=="object"&&(0,vp.shouldUseRule)(t.schema,s)){let{type:o}=s.definition;o.length&&!o.some(i=>CN(e,i))&&_p(t,`missing type "${o.join(",")}" for keyword "${n}"`)}}}function CN(t,e){return t.includes(e)||e==="number"&&t.includes("integer")}function rb(t,e){return t.includes(e)||e==="integer"&&t.includes("number")}function IN(t,e){let r=[];for(let n of t.dataTypes)rb(e,n)?r.push(n):e.includes("integer")&&n==="number"&&r.push("integer");t.dataTypes=r}function _p(t,e){let r=t.schemaEnv.baseId+t.errSchemaPath;e+=` at "${r}" (strictTypes)`,(0,$r.checkStrictMode)(t,e,t.opts.strictTypes)}var Xa=class{constructor(e,r,n){if((0,Jo.validateKeywordUsage)(e,r,n),this.gen=e.gen,this.allErrors=e.allErrors,this.keyword=n,this.data=e.data,this.schema=e.schema[n],this.$data=r.$data&&e.opts.$data&&this.schema&&this.schema.$data,this.schemaValue=(0,$r.schemaRefOrVal)(e,this.schema,n,this.$data),this.schemaType=r.schemaType,this.parentSchema=e.schema,this.params={},this.it=e,this.def=r,this.$data)this.schemaCode=e.gen.const("vSchema",sb(this.$data,e));else if(this.schemaCode=this.schemaValue,!(0,Jo.validSchemaType)(this.schema,r.schemaType,r.allowUndefined))throw new Error(`${n} value must be ${JSON.stringify(r.schemaType)}`);("code"in r?r.trackErrors:r.errors!==!1)&&(this.errsCount=e.gen.const("_errs",V.default.errors))}result(e,r,n){this.failResult((0,N.not)(e),r,n)}failResult(e,r,n){this.gen.if(e),n?n():this.error(),r?(this.gen.else(),r(),this.allErrors&&this.gen.endIf()):this.allErrors?this.gen.endIf():this.gen.else()}pass(e,r){this.failResult((0,N.not)(e),void 0,r)}fail(e){if(e===void 0){this.error(),this.allErrors||this.gen.if(!1);return}this.gen.if(e),this.error(),this.allErrors?this.gen.endIf():this.gen.else()}fail$data(e){if(!this.$data)return this.fail(e);let{schemaCode:r}=this;this.fail((0,N._)`${r} !== undefined && (${(0,N.or)(this.invalid$data(),e)})`)}error(e,r,n){if(r){this.setParams(r),this._error(e,n),this.setParams({});return}this._error(e,n)}_error(e,r){(e?Wo.reportExtraError:Wo.reportError)(this,this.def.error,r)}$dataError(){(0,Wo.reportError)(this,this.def.$dataError||Wo.keyword$DataError)}reset(){if(this.errsCount===void 0)throw new Error('add "trackErrors" to keyword definition');(0,Wo.resetErrorsCount)(this.gen,this.errsCount)}ok(e){this.allErrors||this.gen.if(e)}setParams(e,r){r?Object.assign(this.params,e):this.params=e}block$data(e,r,n=N.nil){this.gen.block(()=>{this.check$data(e,n),r()})}check$data(e=N.nil,r=N.nil){if(!this.$data)return;let{gen:n,schemaCode:s,schemaType:o,def:i}=this;n.if((0,N.or)((0,N._)`${s} === undefined`,r)),e!==N.nil&&n.assign(e,!0),(o.length||i.validateSchema)&&(n.elseIf(this.invalid$data()),this.$dataError(),e!==N.nil&&n.assign(e,!1)),n.else()}invalid$data(){let{gen:e,schemaCode:r,schemaType:n,def:s,it:o}=this;return(0,N.or)(i(),a());function i(){if(n.length){if(!(r instanceof N.Name))throw new Error("ajv implementation error");let c=Array.isArray(n)?n:[n];return(0,N._)`${(0,Qa.checkDataTypes)(c,r,o.opts.strictNumbers,Qa.DataType.Wrong)}`}return N.nil}function a(){if(s.validateSchema){let c=e.scopeValue("validate$data",{ref:s.validateSchema});return(0,N._)`!${c}(${r})`}return N.nil}}subschema(e,r){let n=(0,yp.getSubschema)(this.it,e);(0,yp.extendSubschemaData)(n,this.it,e),(0,yp.extendSubschemaMode)(n,e);let s={...this.it,...n,items:void 0,props:void 0};return vN(s,r),s}mergeEvaluated(e,r){let{it:n,gen:s}=this;n.opts.unevaluated&&(n.props!==!0&&e.props!==void 0&&(n.props=$r.mergeEvaluated.props(s,e.props,n.props,r)),n.items!==!0&&e.items!==void 0&&(n.items=$r.mergeEvaluated.items(s,e.items,n.items,r)))}mergeValidEvaluated(e,r){let{it:n,gen:s}=this;if(n.opts.unevaluated&&(n.props!==!0||n.items!==!0))return s.if(r,()=>this.mergeEvaluated(e,N.Name)),!0}};Hr.KeywordCxt=Xa;function nb(t,e,r,n){let s=new Xa(t,r,e);"code"in r?r.code(s,n):s.$data&&r.validate?(0,Jo.funcKeywordCode)(s,r):"macro"in r?(0,Jo.macroKeywordCode)(s,r):(r.compile||r.validate)&&(0,Jo.funcKeywordCode)(s,r)}var RN=/^\/(?:[^~]|~0|~1)*$/,ON=/^([0-9]+)(#|\/(?:[^~]|~0|~1)*)?$/;function sb(t,{dataLevel:e,dataNames:r,dataPathArr:n}){let s,o;if(t==="")return V.default.rootData;if(t[0]==="/"){if(!RN.test(t))throw new Error(`Invalid JSON-pointer: ${t}`);s=t,o=V.default.rootData}else{let u=ON.exec(t);if(!u)throw new Error(`Invalid JSON-pointer: ${t}`);let l=+u[1];if(s=u[2],s==="#"){if(l>=e)throw new Error(c("property/index",l));return n[e-l]}if(l>e)throw new Error(c("data",l));if(o=r[e-l],!s)return o}let i=o,a=s.split("/");for(let u of a)u&&(o=(0,N._)`${o}${(0,N.getProperty)((0,$r.unescapeJsonPointer)(u))}`,i=(0,N._)`${i} && ${o}`);return i;function c(u,l){return`Cannot access ${u} ${l} levels up, current level is ${e}`}}Hr.getData=sb});var ec=v(wp=>{"use strict";Object.defineProperty(wp,"__esModule",{value:!0});var bp=class extends Error{constructor(e){super("validation failed"),this.errors=e,this.ajv=this.validation=!0}};wp.default=bp});var Qo=v(kp=>{"use strict";Object.defineProperty(kp,"__esModule",{value:!0});var $p=Go(),xp=class extends Error{constructor(e,r,n,s){super(s||`can't resolve reference ${n} from id ${r}`),this.missingRef=(0,$p.resolveUrl)(e,r,n),this.missingSchema=(0,$p.normalizeId)((0,$p.getFullPath)(e,this.missingRef))}};kp.default=xp});var rc=v(zt=>{"use strict";Object.defineProperty(zt,"__esModule",{value:!0});zt.resolveSchema=zt.getCompilingSchema=zt.resolveRef=zt.compileSchema=zt.SchemaEnv=void 0;var Dt=W(),NN=ec(),An=wr(),Zt=Go(),ob=le(),jN=Yo(),xs=class{constructor(e){var r;this.refs={},this.dynamicAnchors={};let n;typeof e.schema=="object"&&(n=e.schema),this.schema=e.schema,this.schemaId=e.schemaId,this.root=e.root||this,this.baseId=(r=e.baseId)!==null&&r!==void 0?r:(0,Zt.normalizeId)(n?.[e.schemaId||"$id"]),this.schemaPath=e.schemaPath,this.localRefs=e.localRefs,this.meta=e.meta,this.$async=n?.$async,this.refs={}}};zt.SchemaEnv=xs;function Pp(t){let e=ib.call(this,t);if(e)return e;let r=(0,Zt.getFullPath)(this.opts.uriResolver,t.root.baseId),{es5:n,lines:s}=this.opts.code,{ownProperties:o}=this.opts,i=new Dt.CodeGen(this.scope,{es5:n,lines:s,ownProperties:o}),a;t.$async&&(a=i.scopeValue("Error",{ref:NN.default,code:(0,Dt._)`require("ajv/dist/runtime/validation_error").default`}));let c=i.scopeName("validate");t.validateName=c;let u={gen:i,allErrors:this.opts.allErrors,data:An.default.data,parentData:An.default.parentData,parentDataProperty:An.default.parentDataProperty,dataNames:[An.default.data],dataPathArr:[Dt.nil],dataLevel:0,dataTypes:[],definedProperties:new Set,topSchemaRef:i.scopeValue("schema",this.opts.code.source===!0?{ref:t.schema,code:(0,Dt.stringify)(t.schema)}:{ref:t.schema}),validateName:c,ValidationError:a,schema:t.schema,schemaEnv:t,rootId:r,baseId:t.baseId||r,schemaPath:Dt.nil,errSchemaPath:t.schemaPath||(this.opts.jtd?"":"#"),errorPath:(0,Dt._)`""`,opts:this.opts,self:this},l;try{this._compilations.add(t),(0,jN.validateFunctionCode)(u),i.optimize(this.opts.code.optimize);let d=i.toString();l=`${i.scopeRefs(An.default.scope)}return ${d}`,this.opts.code.process&&(l=this.opts.code.process(l,t));let p=new Function(`${An.default.self}`,`${An.default.scope}`,l)(this,this.scope.get());if(this.scope.value(c,{ref:p}),p.errors=null,p.schema=t.schema,p.schemaEnv=t,t.$async&&(p.$async=!0),this.opts.code.source===!0&&(p.source={validateName:c,validateCode:d,scopeValues:i._values}),this.opts.unevaluated){let{props:m,items:h}=u;p.evaluated={props:m instanceof Dt.Name?void 0:m,items:h instanceof Dt.Name?void 0:h,dynamicProps:m instanceof Dt.Name,dynamicItems:h instanceof Dt.Name},p.source&&(p.source.evaluated=(0,Dt.stringify)(p.evaluated))}return t.validate=p,t}catch(d){throw delete t.validate,delete t.validateName,l&&this.logger.error("Error compiling schema, function code:",l),d}finally{this._compilations.delete(t)}}zt.compileSchema=Pp;function AN(t,e,r){var n;r=(0,Zt.resolveUrl)(this.opts.uriResolver,e,r);let s=t.refs[r];if(s)return s;let o=DN.call(this,t,r);if(o===void 0){let i=(n=t.localRefs)===null||n===void 0?void 0:n[r],{schemaId:a}=this.opts;i&&(o=new xs({schema:i,schemaId:a,root:t,baseId:e}))}if(o!==void 0)return t.refs[r]=MN.call(this,o)}zt.resolveRef=AN;function MN(t){return(0,Zt.inlineRef)(t.schema,this.opts.inlineRefs)?t.schema:t.validate?t:Pp.call(this,t)}function ib(t){for(let e of this._compilations)if(qN(e,t))return e}zt.getCompilingSchema=ib;function qN(t,e){return t.schema===e.schema&&t.root===e.root&&t.baseId===e.baseId}function DN(t,e){let r;for(;typeof(r=this.refs[e])=="string";)e=r;return r||this.schemas[e]||tc.call(this,t,e)}function tc(t,e){let r=this.opts.uriResolver.parse(e),n=(0,Zt._getFullPath)(this.opts.uriResolver,r),s=(0,Zt.getFullPath)(this.opts.uriResolver,t.baseId,void 0);if(Object.keys(t.schema).length>0&&n===s)return Sp.call(this,r,t);let o=(0,Zt.normalizeId)(n),i=this.refs[o]||this.schemas[o];if(typeof i=="string"){let a=tc.call(this,t,i);return typeof a?.schema!="object"?void 0:Sp.call(this,r,a)}if(typeof i?.schema=="object"){if(i.validate||Pp.call(this,i),o===(0,Zt.normalizeId)(e)){let{schema:a}=i,{schemaId:c}=this.opts,u=a[c];return u&&(s=(0,Zt.resolveUrl)(this.opts.uriResolver,s,u)),new xs({schema:a,schemaId:c,root:t,baseId:s})}return Sp.call(this,r,i)}}zt.resolveSchema=tc;var ZN=new Set(["properties","patternProperties","enum","dependencies","definitions"]);function Sp(t,{baseId:e,schema:r,root:n}){var s;if(((s=t.fragment)===null||s===void 0?void 0:s[0])!=="/")return;for(let a of t.fragment.slice(1).split("/")){if(typeof r=="boolean")return;let c=r[(0,ob.unescapeFragment)(a)];if(c===void 0)return;r=c;let u=typeof r=="object"&&r[this.opts.schemaId];!ZN.has(a)&&u&&(e=(0,Zt.resolveUrl)(this.opts.uriResolver,e,u))}let o;if(typeof r!="boolean"&&r.$ref&&!(0,ob.schemaHasRulesButRef)(r,this.RULES)){let a=(0,Zt.resolveUrl)(this.opts.uriResolver,e,r.$ref);o=tc.call(this,n,a)}let{schemaId:i}=this.opts;if(o=o||new xs({schema:r,schemaId:i,root:n,baseId:e}),o.schema!==o.root.schema)return o}});var ab=v((DV,LN)=>{LN.exports={$id:"https://raw.githubusercontent.com/ajv-validator/ajv/master/lib/refs/data.json#",description:"Meta-schema for $data reference (JSON AnySchema extension proposal)",type:"object",required:["$data"],properties:{$data:{type:"string",anyOf:[{format:"relative-json-pointer"},{format:"json-pointer"}]}},additionalProperties:!1}});var ub=v(Ep=>{"use strict";Object.defineProperty(Ep,"__esModule",{value:!0});var cb=Fl();cb.code='require("ajv/dist/runtime/uri").default';Ep.default=cb});var yb=v(He=>{"use strict";Object.defineProperty(He,"__esModule",{value:!0});He.CodeGen=He.Name=He.nil=He.stringify=He.str=He._=He.KeywordCxt=void 0;var VN=Yo();Object.defineProperty(He,"KeywordCxt",{enumerable:!0,get:function(){return VN.KeywordCxt}});var ks=W();Object.defineProperty(He,"_",{enumerable:!0,get:function(){return ks._}});Object.defineProperty(He,"str",{enumerable:!0,get:function(){return ks.str}});Object.defineProperty(He,"stringify",{enumerable:!0,get:function(){return ks.stringify}});Object.defineProperty(He,"nil",{enumerable:!0,get:function(){return ks.nil}});Object.defineProperty(He,"Name",{enumerable:!0,get:function(){return ks.Name}});Object.defineProperty(He,"CodeGen",{enumerable:!0,get:function(){return ks.CodeGen}});var FN=ec(),mb=Qo(),UN=cp(),Xo=rc(),HN=W(),ei=Go(),nc=Bo(),zp=le(),lb=ab(),KN=ub(),hb=(t,e)=>new RegExp(t,e);hb.code="new RegExp";var BN=["removeAdditional","useDefaults","coerceTypes"],GN=new Set(["validate","serialize","parse","wrapper","root","schema","keyword","pattern","formats","validate$data","func","obj","Error"]),WN={errorDataPath:"",format:"`validateFormats: false` can be used instead.",nullable:'"nullable" keyword is supported by default.',jsonPointers:"Deprecated jsPropertySyntax can be used instead.",extendRefs:"Deprecated ignoreKeywordsWithRef can be used instead.",missingRefs:"Pass empty schema with $id that should be ignored to ajv.addSchema.",processCode:"Use option `code: {process: (code, schemaEnv: object) => string}`",sourceCode:"Use option `code: {source: true}`",strictDefaults:"It is default now, see option `strict`.",strictKeywords:"It is default now, see option `strict`.",uniqueItems:'"uniqueItems" keyword is always validated.',unknownFormats:"Disable strict mode or pass `true` to `ajv.addFormat` (or `formats` option).",cache:"Map is used as cache, schema object as key.",serialize:"Map is used as cache, schema object as key.",ajvErrors:"It is default now."},JN={ignoreKeywordsWithRef:"",jsPropertySyntax:"",unicode:'"minLength"/"maxLength" account for unicode characters by default.'},db=200;function YN(t){var e,r,n,s,o,i,a,c,u,l,d,f,p,m,h,g,y,x,$,S,w,D,F,Ce,H;let we=t.strict,Ae=(e=t.code)===null||e===void 0?void 0:e.optimize,Gr=Ae===!0||Ae===void 0?1:Ae||0,js=(n=(r=t.code)===null||r===void 0?void 0:r.regExp)!==null&&n!==void 0?n:hb,Cc=(s=t.uriResolver)!==null&&s!==void 0?s:KN.default;return{strictSchema:(i=(o=t.strictSchema)!==null&&o!==void 0?o:we)!==null&&i!==void 0?i:!0,strictNumbers:(c=(a=t.strictNumbers)!==null&&a!==void 0?a:we)!==null&&c!==void 0?c:!0,strictTypes:(l=(u=t.strictTypes)!==null&&u!==void 0?u:we)!==null&&l!==void 0?l:"log",strictTuples:(f=(d=t.strictTuples)!==null&&d!==void 0?d:we)!==null&&f!==void 0?f:"log",strictRequired:(m=(p=t.strictRequired)!==null&&p!==void 0?p:we)!==null&&m!==void 0?m:!1,code:t.code?{...t.code,optimize:Gr,regExp:js}:{optimize:Gr,regExp:js},loopRequired:(h=t.loopRequired)!==null&&h!==void 0?h:db,loopEnum:(g=t.loopEnum)!==null&&g!==void 0?g:db,meta:(y=t.meta)!==null&&y!==void 0?y:!0,messages:(x=t.messages)!==null&&x!==void 0?x:!0,inlineRefs:($=t.inlineRefs)!==null&&$!==void 0?$:!0,schemaId:(S=t.schemaId)!==null&&S!==void 0?S:"$id",addUsedSchema:(w=t.addUsedSchema)!==null&&w!==void 0?w:!0,validateSchema:(D=t.validateSchema)!==null&&D!==void 0?D:!0,validateFormats:(F=t.validateFormats)!==null&&F!==void 0?F:!0,unicodeRegExp:(Ce=t.unicodeRegExp)!==null&&Ce!==void 0?Ce:!0,int32range:(H=t.int32range)!==null&&H!==void 0?H:!0,uriResolver:Cc}}var ti=class{constructor(e={}){this.schemas={},this.refs={},this.formats={},this._compilations=new Set,this._loading={},this._cache=new Map,e=this.opts={...e,...YN(e)};let{es5:r,lines:n}=this.opts.code;this.scope=new HN.ValueScope({scope:{},prefixes:GN,es5:r,lines:n}),this.logger=n1(e.logger);let s=e.validateFormats;e.validateFormats=!1,this.RULES=(0,UN.getRules)(),pb.call(this,WN,e,"NOT SUPPORTED"),pb.call(this,JN,e,"DEPRECATED","warn"),this._metaOpts=t1.call(this),e.formats&&XN.call(this),this._addVocabularies(),this._addDefaultMetaSchema(),e.keywords&&e1.call(this,e.keywords),typeof e.meta=="object"&&this.addMetaSchema(e.meta),QN.call(this),e.validateFormats=s}_addVocabularies(){this.addKeyword("$async")}_addDefaultMetaSchema(){let{$data:e,meta:r,schemaId:n}=this.opts,s=lb;n==="id"&&(s={...lb},s.id=s.$id,delete s.$id),r&&e&&this.addMetaSchema(s,s[n],!1)}defaultMeta(){let{meta:e,schemaId:r}=this.opts;return this.opts.defaultMeta=typeof e=="object"?e[r]||e:void 0}validate(e,r){let n;if(typeof e=="string"){if(n=this.getSchema(e),!n)throw new Error(`no schema with key or ref "${e}"`)}else n=this.compile(e);let s=n(r);return"$async"in n||(this.errors=n.errors),s}compile(e,r){let n=this._addSchema(e,r);return n.validate||this._compileSchemaEnv(n)}compileAsync(e,r){if(typeof this.opts.loadSchema!="function")throw new Error("options.loadSchema should be a function");let{loadSchema:n}=this.opts;return s.call(this,e,r);async function s(l,d){await o.call(this,l.$schema);let f=this._addSchema(l,d);return f.validate||i.call(this,f)}async function o(l){l&&!this.getSchema(l)&&await s.call(this,{$ref:l},!0)}async function i(l){try{return this._compileSchemaEnv(l)}catch(d){if(!(d instanceof mb.default))throw d;return a.call(this,d),await c.call(this,d.missingSchema),i.call(this,l)}}function a({missingSchema:l,missingRef:d}){if(this.refs[l])throw new Error(`AnySchema ${l} is loaded but ${d} cannot be resolved`)}async function c(l){let d=await u.call(this,l);this.refs[l]||await o.call(this,d.$schema),this.refs[l]||this.addSchema(d,l,r)}async function u(l){let d=this._loading[l];if(d)return d;try{return await(this._loading[l]=n(l))}finally{delete this._loading[l]}}}addSchema(e,r,n,s=this.opts.validateSchema){if(Array.isArray(e)){for(let i of e)this.addSchema(i,void 0,n,s);return this}let o;if(typeof e=="object"){let{schemaId:i}=this.opts;if(o=e[i],o!==void 0&&typeof o!="string")throw new Error(`schema ${i} must be string`)}return r=(0,ei.normalizeId)(r||o),this._checkUnique(r),this.schemas[r]=this._addSchema(e,n,r,s,!0),this}addMetaSchema(e,r,n=this.opts.validateSchema){return this.addSchema(e,r,!0,n),this}validateSchema(e,r){if(typeof e=="boolean")return!0;let n;if(n=e.$schema,n!==void 0&&typeof n!="string")throw new Error("$schema must be a string");if(n=n||this.opts.defaultMeta||this.defaultMeta(),!n)return this.logger.warn("meta-schema not available"),this.errors=null,!0;let s=this.validate(n,e);if(!s&&r){let o="schema is invalid: "+this.errorsText();if(this.opts.validateSchema==="log")this.logger.error(o);else throw new Error(o)}return s}getSchema(e){let r;for(;typeof(r=fb.call(this,e))=="string";)e=r;if(r===void 0){let{schemaId:n}=this.opts,s=new Xo.SchemaEnv({schema:{},schemaId:n});if(r=Xo.resolveSchema.call(this,s,e),!r)return;this.refs[e]=r}return r.validate||this._compileSchemaEnv(r)}removeSchema(e){if(e instanceof RegExp)return this._removeAllSchemas(this.schemas,e),this._removeAllSchemas(this.refs,e),this;switch(typeof e){case"undefined":return this._removeAllSchemas(this.schemas),this._removeAllSchemas(this.refs),this._cache.clear(),this;case"string":{let r=fb.call(this,e);return typeof r=="object"&&this._cache.delete(r.schema),delete this.schemas[e],delete this.refs[e],this}case"object":{let r=e;this._cache.delete(r);let n=e[this.opts.schemaId];return n&&(n=(0,ei.normalizeId)(n),delete this.schemas[n],delete this.refs[n]),this}default:throw new Error("ajv.removeSchema: invalid parameter")}}addVocabulary(e){for(let r of e)this.addKeyword(r);return this}addKeyword(e,r){let n;if(typeof e=="string")n=e,typeof r=="object"&&(this.logger.warn("these parameters are deprecated, see docs for addKeyword"),r.keyword=n);else if(typeof e=="object"&&r===void 0){if(r=e,n=r.keyword,Array.isArray(n)&&!n.length)throw new Error("addKeywords: keyword must be string or non-empty array")}else throw new Error("invalid addKeywords parameters");if(o1.call(this,n,r),!r)return(0,zp.eachItem)(n,o=>Tp.call(this,o)),this;a1.call(this,r);let s={...r,type:(0,nc.getJSONTypes)(r.type),schemaType:(0,nc.getJSONTypes)(r.schemaType)};return(0,zp.eachItem)(n,s.type.length===0?o=>Tp.call(this,o,s):o=>s.type.forEach(i=>Tp.call(this,o,s,i))),this}getKeyword(e){let r=this.RULES.all[e];return typeof r=="object"?r.definition:!!r}removeKeyword(e){let{RULES:r}=this;delete r.keywords[e],delete r.all[e];for(let n of r.rules){let s=n.rules.findIndex(o=>o.keyword===e);s>=0&&n.rules.splice(s,1)}return this}addFormat(e,r){return typeof r=="string"&&(r=new RegExp(r)),this.formats[e]=r,this}errorsText(e=this.errors,{separator:r=", ",dataVar:n="data"}={}){return!e||e.length===0?"No errors":e.map(s=>`${n}${s.instancePath} ${s.message}`).reduce((s,o)=>s+r+o)}$dataMetaSchema(e,r){let n=this.RULES.all;e=JSON.parse(JSON.stringify(e));for(let s of r){let o=s.split("/").slice(1),i=e;for(let a of o)i=i[a];for(let a in n){let c=n[a];if(typeof c!="object")continue;let{$data:u}=c.definition,l=i[a];u&&l&&(i[a]=gb(l))}}return e}_removeAllSchemas(e,r){for(let n in e){let s=e[n];(!r||r.test(n))&&(typeof s=="string"?delete e[n]:s&&!s.meta&&(this._cache.delete(s.schema),delete e[n]))}}_addSchema(e,r,n,s=this.opts.validateSchema,o=this.opts.addUsedSchema){let i,{schemaId:a}=this.opts;if(typeof e=="object")i=e[a];else{if(this.opts.jtd)throw new Error("schema must be object");if(typeof e!="boolean")throw new Error("schema must be object or boolean")}let c=this._cache.get(e);if(c!==void 0)return c;n=(0,ei.normalizeId)(i||n);let u=ei.getSchemaRefs.call(this,e,n);return c=new Xo.SchemaEnv({schema:e,schemaId:a,meta:r,baseId:n,localRefs:u}),this._cache.set(c.schema,c),o&&!n.startsWith("#")&&(n&&this._checkUnique(n),this.refs[n]=c),s&&this.validateSchema(e,!0),c}_checkUnique(e){if(this.schemas[e]||this.refs[e])throw new Error(`schema with key or id "${e}" already exists`)}_compileSchemaEnv(e){if(e.meta?this._compileMetaSchema(e):Xo.compileSchema.call(this,e),!e.validate)throw new Error("ajv implementation error");return e.validate}_compileMetaSchema(e){let r=this.opts;this.opts=this._metaOpts;try{Xo.compileSchema.call(this,e)}finally{this.opts=r}}};ti.ValidationError=FN.default;ti.MissingRefError=mb.default;He.default=ti;function pb(t,e,r,n="error"){for(let s in t){let o=s;o in e&&this.logger[n](`${r}: option ${s}. ${t[o]}`)}}function fb(t){return t=(0,ei.normalizeId)(t),this.schemas[t]||this.refs[t]}function QN(){let t=this.opts.schemas;if(t)if(Array.isArray(t))this.addSchema(t);else for(let e in t)this.addSchema(t[e],e)}function XN(){for(let t in this.opts.formats){let e=this.opts.formats[t];e&&this.addFormat(t,e)}}function e1(t){if(Array.isArray(t)){this.addVocabulary(t);return}this.logger.warn("keywords option as map is deprecated, pass array");for(let e in t){let r=t[e];r.keyword||(r.keyword=e),this.addKeyword(r)}}function t1(){let t={...this.opts};for(let e of BN)delete t[e];return t}var r1={log(){},warn(){},error(){}};function n1(t){if(t===!1)return r1;if(t===void 0)return console;if(t.log&&t.warn&&t.error)return t;throw new Error("logger must implement log, warn and error methods")}var s1=/^[a-z_$][a-z0-9_$:-]*$/i;function o1(t,e){let{RULES:r}=this;if((0,zp.eachItem)(t,n=>{if(r.keywords[n])throw new Error(`Keyword ${n} is already defined`);if(!s1.test(n))throw new Error(`Keyword ${n} has invalid name`)}),!!e&&e.$data&&!("code"in e||"validate"in e))throw new Error('$data keyword must have "code" or "validate" function')}function Tp(t,e,r){var n;let s=e?.post;if(r&&s)throw new Error('keyword with "post" flag cannot have "type"');let{RULES:o}=this,i=s?o.post:o.rules.find(({type:c})=>c===r);if(i||(i={type:r,rules:[]},o.rules.push(i)),o.keywords[t]=!0,!e)return;let a={keyword:t,definition:{...e,type:(0,nc.getJSONTypes)(e.type),schemaType:(0,nc.getJSONTypes)(e.schemaType)}};e.before?i1.call(this,i,a,e.before):i.rules.push(a),o.all[t]=a,(n=e.implements)===null||n===void 0||n.forEach(c=>this.addKeyword(c))}function i1(t,e,r){let n=t.rules.findIndex(s=>s.keyword===r);n>=0?t.rules.splice(n,0,e):(t.rules.push(e),this.logger.warn(`rule ${r} is not defined`))}function a1(t){let{metaSchema:e}=t;e!==void 0&&(t.$data&&this.opts.$data&&(e=gb(e)),t.validateSchema=this.compile(e,!0))}var c1={$ref:"https://raw.githubusercontent.com/ajv-validator/ajv/master/lib/refs/data.json#"};function gb(t){return{anyOf:[t,c1]}}});var vb=v(Cp=>{"use strict";Object.defineProperty(Cp,"__esModule",{value:!0});var u1={keyword:"id",code(){throw new Error('NOT SUPPORTED: keyword "id", use "$id" for schema ID')}};Cp.default=u1});var $b=v(Mn=>{"use strict";Object.defineProperty(Mn,"__esModule",{value:!0});Mn.callRef=Mn.getValidate=void 0;var l1=Qo(),_b=Tt(),gt=W(),Ss=wr(),bb=rc(),sc=le(),d1={keyword:"$ref",schemaType:"string",code(t){let{gen:e,schema:r,it:n}=t,{baseId:s,schemaEnv:o,validateName:i,opts:a,self:c}=n,{root:u}=o;if((r==="#"||r==="#/")&&s===u.baseId)return d();let l=bb.resolveRef.call(c,u,s,r);if(l===void 0)throw new l1.default(n.opts.uriResolver,s,r);if(l instanceof bb.SchemaEnv)return f(l);return p(l);function d(){if(o===u)return oc(t,i,o,o.$async);let m=e.scopeValue("root",{ref:u});return oc(t,(0,gt._)`${m}.validate`,u,u.$async)}function f(m){let h=wb(t,m);oc(t,h,m,m.$async)}function p(m){let h=e.scopeValue("schema",a.code.source===!0?{ref:m,code:(0,gt.stringify)(m)}:{ref:m}),g=e.name("valid"),y=t.subschema({schema:m,dataTypes:[],schemaPath:gt.nil,topSchemaRef:h,errSchemaPath:r},g);t.mergeEvaluated(y),t.ok(g)}}};function wb(t,e){let{gen:r}=t;return e.validate?r.scopeValue("validate",{ref:e.validate}):(0,gt._)`${r.scopeValue("wrapper",{ref:e})}.validate`}Mn.getValidate=wb;function oc(t,e,r,n){let{gen:s,it:o}=t,{allErrors:i,schemaEnv:a,opts:c}=o,u=c.passContext?Ss.default.this:gt.nil;n?l():d();function l(){if(!a.$async)throw new Error("async schema referenced by sync schema");let m=s.let("valid");s.try(()=>{s.code((0,gt._)`await ${(0,_b.callValidateCode)(t,e,u)}`),p(e),i||s.assign(m,!0)},h=>{s.if((0,gt._)`!(${h} instanceof ${o.ValidationError})`,()=>s.throw(h)),f(h),i||s.assign(m,!1)}),t.ok(m)}function d(){t.result((0,_b.callValidateCode)(t,e,u),()=>p(e),()=>f(e))}function f(m){let h=(0,gt._)`${m}.errors`;s.assign(Ss.default.vErrors,(0,gt._)`${Ss.default.vErrors} === null ? ${h} : ${Ss.default.vErrors}.concat(${h})`),s.assign(Ss.default.errors,(0,gt._)`${Ss.default.vErrors}.length`)}function p(m){var h;if(!o.opts.unevaluated)return;let g=(h=r?.validate)===null||h===void 0?void 0:h.evaluated;if(o.props!==!0)if(g&&!g.dynamicProps)g.props!==void 0&&(o.props=sc.mergeEvaluated.props(s,g.props,o.props));else{let y=s.var("props",(0,gt._)`${m}.evaluated.props`);o.props=sc.mergeEvaluated.props(s,y,o.props,gt.Name)}if(o.items!==!0)if(g&&!g.dynamicItems)g.items!==void 0&&(o.items=sc.mergeEvaluated.items(s,g.items,o.items));else{let y=s.var("items",(0,gt._)`${m}.evaluated.items`);o.items=sc.mergeEvaluated.items(s,y,o.items,gt.Name)}}}Mn.callRef=oc;Mn.default=d1});var xb=v(Ip=>{"use strict";Object.defineProperty(Ip,"__esModule",{value:!0});var p1=vb(),f1=$b(),m1=["$schema","$id","$defs","$vocabulary",{keyword:"$comment"},"definitions",p1.default,f1.default];Ip.default=m1});var kb=v(Rp=>{"use strict";Object.defineProperty(Rp,"__esModule",{value:!0});var ic=W(),Kr=ic.operators,ac={maximum:{okStr:"<=",ok:Kr.LTE,fail:Kr.GT},minimum:{okStr:">=",ok:Kr.GTE,fail:Kr.LT},exclusiveMaximum:{okStr:"<",ok:Kr.LT,fail:Kr.GTE},exclusiveMinimum:{okStr:">",ok:Kr.GT,fail:Kr.LTE}},h1={message:({keyword:t,schemaCode:e})=>(0,ic.str)`must be ${ac[t].okStr} ${e}`,params:({keyword:t,schemaCode:e})=>(0,ic._)`{comparison: ${ac[t].okStr}, limit: ${e}}`},g1={keyword:Object.keys(ac),type:"number",schemaType:"number",$data:!0,error:h1,code(t){let{keyword:e,data:r,schemaCode:n}=t;t.fail$data((0,ic._)`${r} ${ac[e].fail} ${n} || isNaN(${r})`)}};Rp.default=g1});var Sb=v(Op=>{"use strict";Object.defineProperty(Op,"__esModule",{value:!0});var ri=W(),y1={message:({schemaCode:t})=>(0,ri.str)`must be multiple of ${t}`,params:({schemaCode:t})=>(0,ri._)`{multipleOf: ${t}}`},v1={keyword:"multipleOf",type:"number",schemaType:"number",$data:!0,error:y1,code(t){let{gen:e,data:r,schemaCode:n,it:s}=t,o=s.opts.multipleOfPrecision,i=e.let("res"),a=o?(0,ri._)`Math.abs(Math.round(${i}) - ${i}) > 1e-${o}`:(0,ri._)`${i} !== parseInt(${i})`;t.fail$data((0,ri._)`(${n} === 0 || (${i} = ${r}/${n}, ${a}))`)}};Op.default=v1});var Eb=v(Np=>{"use strict";Object.defineProperty(Np,"__esModule",{value:!0});function Pb(t){let e=t.length,r=0,n=0,s;for(;n<e;)r++,s=t.charCodeAt(n++),s>=55296&&s<=56319&&n<e&&(s=t.charCodeAt(n),(s&64512)===56320&&n++);return r}Np.default=Pb;Pb.code='require("ajv/dist/runtime/ucs2length").default'});var Tb=v(jp=>{"use strict";Object.defineProperty(jp,"__esModule",{value:!0});var qn=W(),_1=le(),b1=Eb(),w1={message({keyword:t,schemaCode:e}){let r=t==="maxLength"?"more":"fewer";return(0,qn.str)`must NOT have ${r} than ${e} characters`},params:({schemaCode:t})=>(0,qn._)`{limit: ${t}}`},$1={keyword:["maxLength","minLength"],type:"string",schemaType:"number",$data:!0,error:w1,code(t){let{keyword:e,data:r,schemaCode:n,it:s}=t,o=e==="maxLength"?qn.operators.GT:qn.operators.LT,i=s.opts.unicode===!1?(0,qn._)`${r}.length`:(0,qn._)`${(0,_1.useFunc)(t.gen,b1.default)}(${r})`;t.fail$data((0,qn._)`${i} ${o} ${n}`)}};jp.default=$1});var zb=v(Ap=>{"use strict";Object.defineProperty(Ap,"__esModule",{value:!0});var x1=Tt(),cc=W(),k1={message:({schemaCode:t})=>(0,cc.str)`must match pattern "${t}"`,params:({schemaCode:t})=>(0,cc._)`{pattern: ${t}}`},S1={keyword:"pattern",type:"string",schemaType:"string",$data:!0,error:k1,code(t){let{data:e,$data:r,schema:n,schemaCode:s,it:o}=t,i=o.opts.unicodeRegExp?"u":"",a=r?(0,cc._)`(new RegExp(${s}, ${i}))`:(0,x1.usePattern)(t,n);t.fail$data((0,cc._)`!${a}.test(${e})`)}};Ap.default=S1});var Cb=v(Mp=>{"use strict";Object.defineProperty(Mp,"__esModule",{value:!0});var ni=W(),P1={message({keyword:t,schemaCode:e}){let r=t==="maxProperties"?"more":"fewer";return(0,ni.str)`must NOT have ${r} than ${e} properties`},params:({schemaCode:t})=>(0,ni._)`{limit: ${t}}`},E1={keyword:["maxProperties","minProperties"],type:"object",schemaType:"number",$data:!0,error:P1,code(t){let{keyword:e,data:r,schemaCode:n}=t,s=e==="maxProperties"?ni.operators.GT:ni.operators.LT;t.fail$data((0,ni._)`Object.keys(${r}).length ${s} ${n}`)}};Mp.default=E1});var Ib=v(qp=>{"use strict";Object.defineProperty(qp,"__esModule",{value:!0});var si=Tt(),oi=W(),T1=le(),z1={message:({params:{missingProperty:t}})=>(0,oi.str)`must have required property '${t}'`,params:({params:{missingProperty:t}})=>(0,oi._)`{missingProperty: ${t}}`},C1={keyword:"required",type:"object",schemaType:"array",$data:!0,error:z1,code(t){let{gen:e,schema:r,schemaCode:n,data:s,$data:o,it:i}=t,{opts:a}=i;if(!o&&r.length===0)return;let c=r.length>=a.loopRequired;if(i.allErrors?u():l(),a.strictRequired){let p=t.parentSchema.properties,{definedProperties:m}=t.it;for(let h of r)if(p?.[h]===void 0&&!m.has(h)){let g=i.schemaEnv.baseId+i.errSchemaPath,y=`required property "${h}" is not defined at "${g}" (strictRequired)`;(0,T1.checkStrictMode)(i,y,i.opts.strictRequired)}}function u(){if(c||o)t.block$data(oi.nil,d);else for(let p of r)(0,si.checkReportMissingProp)(t,p)}function l(){let p=e.let("missing");if(c||o){let m=e.let("valid",!0);t.block$data(m,()=>f(p,m)),t.ok(m)}else e.if((0,si.checkMissingProp)(t,r,p)),(0,si.reportMissingProp)(t,p),e.else()}function d(){e.forOf("prop",n,p=>{t.setParams({missingProperty:p}),e.if((0,si.noPropertyInData)(e,s,p,a.ownProperties),()=>t.error())})}function f(p,m){t.setParams({missingProperty:p}),e.forOf(p,n,()=>{e.assign(m,(0,si.propertyInData)(e,s,p,a.ownProperties)),e.if((0,oi.not)(m),()=>{t.error(),e.break()})},oi.nil)}}};qp.default=C1});var Rb=v(Dp=>{"use strict";Object.defineProperty(Dp,"__esModule",{value:!0});var ii=W(),I1={message({keyword:t,schemaCode:e}){let r=t==="maxItems"?"more":"fewer";return(0,ii.str)`must NOT have ${r} than ${e} items`},params:({schemaCode:t})=>(0,ii._)`{limit: ${t}}`},R1={keyword:["maxItems","minItems"],type:"array",schemaType:"number",$data:!0,error:I1,code(t){let{keyword:e,data:r,schemaCode:n}=t,s=e==="maxItems"?ii.operators.GT:ii.operators.LT;t.fail$data((0,ii._)`${r}.length ${s} ${n}`)}};Dp.default=R1});var uc=v(Zp=>{"use strict";Object.defineProperty(Zp,"__esModule",{value:!0});var Ob=_o();Ob.code='require("ajv/dist/runtime/equal").default';Zp.default=Ob});var Nb=v(Vp=>{"use strict";Object.defineProperty(Vp,"__esModule",{value:!0});var Lp=Bo(),Ke=W(),O1=le(),N1=uc(),j1={message:({params:{i:t,j:e}})=>(0,Ke.str)`must NOT have duplicate items (items ## ${e} and ${t} are identical)`,params:({params:{i:t,j:e}})=>(0,Ke._)`{i: ${t}, j: ${e}}`},A1={keyword:"uniqueItems",type:"array",schemaType:"boolean",$data:!0,error:j1,code(t){let{gen:e,data:r,$data:n,schema:s,parentSchema:o,schemaCode:i,it:a}=t;if(!n&&!s)return;let c=e.let("valid"),u=o.items?(0,Lp.getSchemaTypes)(o.items):[];t.block$data(c,l,(0,Ke._)`${i} === false`),t.ok(c);function l(){let m=e.let("i",(0,Ke._)`${r}.length`),h=e.let("j");t.setParams({i:m,j:h}),e.assign(c,!0),e.if((0,Ke._)`${m} > 1`,()=>(d()?f:p)(m,h))}function d(){return u.length>0&&!u.some(m=>m==="object"||m==="array")}function f(m,h){let g=e.name("item"),y=(0,Lp.checkDataTypes)(u,g,a.opts.strictNumbers,Lp.DataType.Wrong),x=e.const("indices",(0,Ke._)`{}`);e.for((0,Ke._)`;${m}--;`,()=>{e.let(g,(0,Ke._)`${r}[${m}]`),e.if(y,(0,Ke._)`continue`),u.length>1&&e.if((0,Ke._)`typeof ${g} == "string"`,(0,Ke._)`${g} += "_"`),e.if((0,Ke._)`typeof ${x}[${g}] == "number"`,()=>{e.assign(h,(0,Ke._)`${x}[${g}]`),t.error(),e.assign(c,!1).break()}).code((0,Ke._)`${x}[${g}] = ${m}`)})}function p(m,h){let g=(0,O1.useFunc)(e,N1.default),y=e.name("outer");e.label(y).for((0,Ke._)`;${m}--;`,()=>e.for((0,Ke._)`${h} = ${m}; ${h}--;`,()=>e.if((0,Ke._)`${g}(${r}[${m}], ${r}[${h}])`,()=>{t.error(),e.assign(c,!1).break(y)})))}}};Vp.default=A1});var jb=v(Up=>{"use strict";Object.defineProperty(Up,"__esModule",{value:!0});var Fp=W(),M1=le(),q1=uc(),D1={message:"must be equal to constant",params:({schemaCode:t})=>(0,Fp._)`{allowedValue: ${t}}`},Z1={keyword:"const",$data:!0,error:D1,code(t){let{gen:e,data:r,$data:n,schemaCode:s,schema:o}=t;n||o&&typeof o=="object"?t.fail$data((0,Fp._)`!${(0,M1.useFunc)(e,q1.default)}(${r}, ${s})`):t.fail((0,Fp._)`${o} !== ${r}`)}};Up.default=Z1});var Ab=v(Hp=>{"use strict";Object.defineProperty(Hp,"__esModule",{value:!0});var ai=W(),L1=le(),V1=uc(),F1={message:"must be equal to one of the allowed values",params:({schemaCode:t})=>(0,ai._)`{allowedValues: ${t}}`},U1={keyword:"enum",schemaType:"array",$data:!0,error:F1,code(t){let{gen:e,data:r,$data:n,schema:s,schemaCode:o,it:i}=t;if(!n&&s.length===0)throw new Error("enum must have non-empty array");let a=s.length>=i.opts.loopEnum,c,u=()=>c??(c=(0,L1.useFunc)(e,V1.default)),l;if(a||n)l=e.let("valid"),t.block$data(l,d);else{if(!Array.isArray(s))throw new Error("ajv implementation error");let p=e.const("vSchema",o);l=(0,ai.or)(...s.map((m,h)=>f(p,h)))}t.pass(l);function d(){e.assign(l,!1),e.forOf("v",o,p=>e.if((0,ai._)`${u()}(${r}, ${p})`,()=>e.assign(l,!0).break()))}function f(p,m){let h=s[m];return typeof h=="object"&&h!==null?(0,ai._)`${u()}(${r}, ${p}[${m}])`:(0,ai._)`${r} === ${h}`}}};Hp.default=U1});var Mb=v(Kp=>{"use strict";Object.defineProperty(Kp,"__esModule",{value:!0});var H1=kb(),K1=Sb(),B1=Tb(),G1=zb(),W1=Cb(),J1=Ib(),Y1=Rb(),Q1=Nb(),X1=jb(),ej=Ab(),tj=[H1.default,K1.default,B1.default,G1.default,W1.default,J1.default,Y1.default,Q1.default,{keyword:"type",schemaType:["string","array"]},{keyword:"nullable",schemaType:"boolean"},X1.default,ej.default];Kp.default=tj});var Gp=v(ci=>{"use strict";Object.defineProperty(ci,"__esModule",{value:!0});ci.validateAdditionalItems=void 0;var Dn=W(),Bp=le(),rj={message:({params:{len:t}})=>(0,Dn.str)`must NOT have more than ${t} items`,params:({params:{len:t}})=>(0,Dn._)`{limit: ${t}}`},nj={keyword:"additionalItems",type:"array",schemaType:["boolean","object"],before:"uniqueItems",error:rj,code(t){let{parentSchema:e,it:r}=t,{items:n}=e;if(!Array.isArray(n)){(0,Bp.checkStrictMode)(r,'"additionalItems" is ignored when "items" is not an array of schemas');return}qb(t,n)}};function qb(t,e){let{gen:r,schema:n,data:s,keyword:o,it:i}=t;i.items=!0;let a=r.const("len",(0,Dn._)`${s}.length`);if(n===!1)t.setParams({len:e.length}),t.pass((0,Dn._)`${a} <= ${e.length}`);else if(typeof n=="object"&&!(0,Bp.alwaysValidSchema)(i,n)){let u=r.var("valid",(0,Dn._)`${a} <= ${e.length}`);r.if((0,Dn.not)(u),()=>c(u)),t.ok(u)}function c(u){r.forRange("i",e.length,a,l=>{t.subschema({keyword:o,dataProp:l,dataPropType:Bp.Type.Num},u),i.allErrors||r.if((0,Dn.not)(u),()=>r.break())})}}ci.validateAdditionalItems=qb;ci.default=nj});var Wp=v(ui=>{"use strict";Object.defineProperty(ui,"__esModule",{value:!0});ui.validateTuple=void 0;var Db=W(),lc=le(),sj=Tt(),oj={keyword:"items",type:"array",schemaType:["object","array","boolean"],before:"uniqueItems",code(t){let{schema:e,it:r}=t;if(Array.isArray(e))return Zb(t,"additionalItems",e);r.items=!0,!(0,lc.alwaysValidSchema)(r,e)&&t.ok((0,sj.validateArray)(t))}};function Zb(t,e,r=t.schema){let{gen:n,parentSchema:s,data:o,keyword:i,it:a}=t;l(s),a.opts.unevaluated&&r.length&&a.items!==!0&&(a.items=lc.mergeEvaluated.items(n,r.length,a.items));let c=n.name("valid"),u=n.const("len",(0,Db._)`${o}.length`);r.forEach((d,f)=>{(0,lc.alwaysValidSchema)(a,d)||(n.if((0,Db._)`${u} > ${f}`,()=>t.subschema({keyword:i,schemaProp:f,dataProp:f},c)),t.ok(c))});function l(d){let{opts:f,errSchemaPath:p}=a,m=r.length,h=m===d.minItems&&(m===d.maxItems||d[e]===!1);if(f.strictTuples&&!h){let g=`"${i}" is ${m}-tuple, but minItems or maxItems/${e} are not specified or different at path "${p}"`;(0,lc.checkStrictMode)(a,g,f.strictTuples)}}}ui.validateTuple=Zb;ui.default=oj});var Lb=v(Jp=>{"use strict";Object.defineProperty(Jp,"__esModule",{value:!0});var ij=Wp(),aj={keyword:"prefixItems",type:"array",schemaType:["array"],before:"uniqueItems",code:t=>(0,ij.validateTuple)(t,"items")};Jp.default=aj});var Fb=v(Yp=>{"use strict";Object.defineProperty(Yp,"__esModule",{value:!0});var Vb=W(),cj=le(),uj=Tt(),lj=Gp(),dj={message:({params:{len:t}})=>(0,Vb.str)`must NOT have more than ${t} items`,params:({params:{len:t}})=>(0,Vb._)`{limit: ${t}}`},pj={keyword:"items",type:"array",schemaType:["object","boolean"],before:"uniqueItems",error:dj,code(t){let{schema:e,parentSchema:r,it:n}=t,{prefixItems:s}=r;n.items=!0,!(0,cj.alwaysValidSchema)(n,e)&&(s?(0,lj.validateAdditionalItems)(t,s):t.ok((0,uj.validateArray)(t)))}};Yp.default=pj});var Ub=v(Qp=>{"use strict";Object.defineProperty(Qp,"__esModule",{value:!0});var Ct=W(),dc=le(),fj={message:({params:{min:t,max:e}})=>e===void 0?(0,Ct.str)`must contain at least ${t} valid item(s)`:(0,Ct.str)`must contain at least ${t} and no more than ${e} valid item(s)`,params:({params:{min:t,max:e}})=>e===void 0?(0,Ct._)`{minContains: ${t}}`:(0,Ct._)`{minContains: ${t}, maxContains: ${e}}`},mj={keyword:"contains",type:"array",schemaType:["object","boolean"],before:"uniqueItems",trackErrors:!0,error:fj,code(t){let{gen:e,schema:r,parentSchema:n,data:s,it:o}=t,i,a,{minContains:c,maxContains:u}=n;o.opts.next?(i=c===void 0?1:c,a=u):i=1;let l=e.const("len",(0,Ct._)`${s}.length`);if(t.setParams({min:i,max:a}),a===void 0&&i===0){(0,dc.checkStrictMode)(o,'"minContains" == 0 without "maxContains": "contains" keyword ignored');return}if(a!==void 0&&i>a){(0,dc.checkStrictMode)(o,'"minContains" > "maxContains" is always invalid'),t.fail();return}if((0,dc.alwaysValidSchema)(o,r)){let h=(0,Ct._)`${l} >= ${i}`;a!==void 0&&(h=(0,Ct._)`${h} && ${l} <= ${a}`),t.pass(h);return}o.items=!0;let d=e.name("valid");a===void 0&&i===1?p(d,()=>e.if(d,()=>e.break())):i===0?(e.let(d,!0),a!==void 0&&e.if((0,Ct._)`${s}.length > 0`,f)):(e.let(d,!1),f()),t.result(d,()=>t.reset());function f(){let h=e.name("_valid"),g=e.let("count",0);p(h,()=>e.if(h,()=>m(g)))}function p(h,g){e.forRange("i",0,l,y=>{t.subschema({keyword:"contains",dataProp:y,dataPropType:dc.Type.Num,compositeRule:!0},h),g()})}function m(h){e.code((0,Ct._)`${h}++`),a===void 0?e.if((0,Ct._)`${h} >= ${i}`,()=>e.assign(d,!0).break()):(e.if((0,Ct._)`${h} > ${a}`,()=>e.assign(d,!1).break()),i===1?e.assign(d,!0):e.if((0,Ct._)`${h} >= ${i}`,()=>e.assign(d,!0)))}}};Qp.default=mj});var Bb=v(or=>{"use strict";Object.defineProperty(or,"__esModule",{value:!0});or.validateSchemaDeps=or.validatePropertyDeps=or.error=void 0;var Xp=W(),hj=le(),li=Tt();or.error={message:({params:{property:t,depsCount:e,deps:r}})=>{let n=e===1?"property":"properties";return(0,Xp.str)`must have ${n} ${r} when property ${t} is present`},params:({params:{property:t,depsCount:e,deps:r,missingProperty:n}})=>(0,Xp._)`{property: ${t},
    missingProperty: ${n},
    depsCount: ${e},
    deps: ${r}}`};var gj={keyword:"dependencies",type:"object",schemaType:"object",error:or.error,code(t){let[e,r]=yj(t);Hb(t,e),Kb(t,r)}};function yj({schema:t}){let e={},r={};for(let n in t){if(n==="__proto__")continue;let s=Array.isArray(t[n])?e:r;s[n]=t[n]}return[e,r]}function Hb(t,e=t.schema){let{gen:r,data:n,it:s}=t;if(Object.keys(e).length===0)return;let o=r.let("missing");for(let i in e){let a=e[i];if(a.length===0)continue;let c=(0,li.propertyInData)(r,n,i,s.opts.ownProperties);t.setParams({property:i,depsCount:a.length,deps:a.join(", ")}),s.allErrors?r.if(c,()=>{for(let u of a)(0,li.checkReportMissingProp)(t,u)}):(r.if((0,Xp._)`${c} && (${(0,li.checkMissingProp)(t,a,o)})`),(0,li.reportMissingProp)(t,o),r.else())}}or.validatePropertyDeps=Hb;function Kb(t,e=t.schema){let{gen:r,data:n,keyword:s,it:o}=t,i=r.name("valid");for(let a in e)(0,hj.alwaysValidSchema)(o,e[a])||(r.if((0,li.propertyInData)(r,n,a,o.opts.ownProperties),()=>{let c=t.subschema({keyword:s,schemaProp:a},i);t.mergeValidEvaluated(c,i)},()=>r.var(i,!0)),t.ok(i))}or.validateSchemaDeps=Kb;or.default=gj});var Wb=v(ef=>{"use strict";Object.defineProperty(ef,"__esModule",{value:!0});var Gb=W(),vj=le(),_j={message:"property name must be valid",params:({params:t})=>(0,Gb._)`{propertyName: ${t.propertyName}}`},bj={keyword:"propertyNames",type:"object",schemaType:["object","boolean"],error:_j,code(t){let{gen:e,schema:r,data:n,it:s}=t;if((0,vj.alwaysValidSchema)(s,r))return;let o=e.name("valid");e.forIn("key",n,i=>{t.setParams({propertyName:i}),t.subschema({keyword:"propertyNames",data:i,dataTypes:["string"],propertyName:i,compositeRule:!0},o),e.if((0,Gb.not)(o),()=>{t.error(!0),s.allErrors||e.break()})}),t.ok(o)}};ef.default=bj});var rf=v(tf=>{"use strict";Object.defineProperty(tf,"__esModule",{value:!0});var pc=Tt(),Lt=W(),wj=wr(),fc=le(),$j={message:"must NOT have additional properties",params:({params:t})=>(0,Lt._)`{additionalProperty: ${t.additionalProperty}}`},xj={keyword:"additionalProperties",type:["object"],schemaType:["boolean","object"],allowUndefined:!0,trackErrors:!0,error:$j,code(t){let{gen:e,schema:r,parentSchema:n,data:s,errsCount:o,it:i}=t;if(!o)throw new Error("ajv implementation error");let{allErrors:a,opts:c}=i;if(i.props=!0,c.removeAdditional!=="all"&&(0,fc.alwaysValidSchema)(i,r))return;let u=(0,pc.allSchemaProperties)(n.properties),l=(0,pc.allSchemaProperties)(n.patternProperties);d(),t.ok((0,Lt._)`${o} === ${wj.default.errors}`);function d(){e.forIn("key",s,g=>{!u.length&&!l.length?m(g):e.if(f(g),()=>m(g))})}function f(g){let y;if(u.length>8){let x=(0,fc.schemaRefOrVal)(i,n.properties,"properties");y=(0,pc.isOwnProperty)(e,x,g)}else u.length?y=(0,Lt.or)(...u.map(x=>(0,Lt._)`${g} === ${x}`)):y=Lt.nil;return l.length&&(y=(0,Lt.or)(y,...l.map(x=>(0,Lt._)`${(0,pc.usePattern)(t,x)}.test(${g})`))),(0,Lt.not)(y)}function p(g){e.code((0,Lt._)`delete ${s}[${g}]`)}function m(g){if(c.removeAdditional==="all"||c.removeAdditional&&r===!1){p(g);return}if(r===!1){t.setParams({additionalProperty:g}),t.error(),a||e.break();return}if(typeof r=="object"&&!(0,fc.alwaysValidSchema)(i,r)){let y=e.name("valid");c.removeAdditional==="failing"?(h(g,y,!1),e.if((0,Lt.not)(y),()=>{t.reset(),p(g)})):(h(g,y),a||e.if((0,Lt.not)(y),()=>e.break()))}}function h(g,y,x){let $={keyword:"additionalProperties",dataProp:g,dataPropType:fc.Type.Str};x===!1&&Object.assign($,{compositeRule:!0,createErrors:!1,allErrors:!1}),t.subschema($,y)}}};tf.default=xj});var Qb=v(sf=>{"use strict";Object.defineProperty(sf,"__esModule",{value:!0});var kj=Yo(),Jb=Tt(),nf=le(),Yb=rf(),Sj={keyword:"properties",type:"object",schemaType:"object",code(t){let{gen:e,schema:r,parentSchema:n,data:s,it:o}=t;o.opts.removeAdditional==="all"&&n.additionalProperties===void 0&&Yb.default.code(new kj.KeywordCxt(o,Yb.default,"additionalProperties"));let i=(0,Jb.allSchemaProperties)(r);for(let d of i)o.definedProperties.add(d);o.opts.unevaluated&&i.length&&o.props!==!0&&(o.props=nf.mergeEvaluated.props(e,(0,nf.toHash)(i),o.props));let a=i.filter(d=>!(0,nf.alwaysValidSchema)(o,r[d]));if(a.length===0)return;let c=e.name("valid");for(let d of a)u(d)?l(d):(e.if((0,Jb.propertyInData)(e,s,d,o.opts.ownProperties)),l(d),o.allErrors||e.else().var(c,!0),e.endIf()),t.it.definedProperties.add(d),t.ok(c);function u(d){return o.opts.useDefaults&&!o.compositeRule&&r[d].default!==void 0}function l(d){t.subschema({keyword:"properties",schemaProp:d,dataProp:d},c)}}};sf.default=Sj});var rw=v(of=>{"use strict";Object.defineProperty(of,"__esModule",{value:!0});var Xb=Tt(),mc=W(),ew=le(),tw=le(),Pj={keyword:"patternProperties",type:"object",schemaType:"object",code(t){let{gen:e,schema:r,data:n,parentSchema:s,it:o}=t,{opts:i}=o,a=(0,Xb.allSchemaProperties)(r),c=a.filter(h=>(0,ew.alwaysValidSchema)(o,r[h]));if(a.length===0||c.length===a.length&&(!o.opts.unevaluated||o.props===!0))return;let u=i.strictSchema&&!i.allowMatchingProperties&&s.properties,l=e.name("valid");o.props!==!0&&!(o.props instanceof mc.Name)&&(o.props=(0,tw.evaluatedPropsToName)(e,o.props));let{props:d}=o;f();function f(){for(let h of a)u&&p(h),o.allErrors?m(h):(e.var(l,!0),m(h),e.if(l))}function p(h){for(let g in u)new RegExp(h).test(g)&&(0,ew.checkStrictMode)(o,`property ${g} matches pattern ${h} (use allowMatchingProperties)`)}function m(h){e.forIn("key",n,g=>{e.if((0,mc._)`${(0,Xb.usePattern)(t,h)}.test(${g})`,()=>{let y=c.includes(h);y||t.subschema({keyword:"patternProperties",schemaProp:h,dataProp:g,dataPropType:tw.Type.Str},l),o.opts.unevaluated&&d!==!0?e.assign((0,mc._)`${d}[${g}]`,!0):!y&&!o.allErrors&&e.if((0,mc.not)(l),()=>e.break())})})}}};of.default=Pj});var nw=v(af=>{"use strict";Object.defineProperty(af,"__esModule",{value:!0});var Ej=le(),Tj={keyword:"not",schemaType:["object","boolean"],trackErrors:!0,code(t){let{gen:e,schema:r,it:n}=t;if((0,Ej.alwaysValidSchema)(n,r)){t.fail();return}let s=e.name("valid");t.subschema({keyword:"not",compositeRule:!0,createErrors:!1,allErrors:!1},s),t.failResult(s,()=>t.reset(),()=>t.error())},error:{message:"must NOT be valid"}};af.default=Tj});var sw=v(cf=>{"use strict";Object.defineProperty(cf,"__esModule",{value:!0});var zj=Tt(),Cj={keyword:"anyOf",schemaType:"array",trackErrors:!0,code:zj.validateUnion,error:{message:"must match a schema in anyOf"}};cf.default=Cj});var ow=v(uf=>{"use strict";Object.defineProperty(uf,"__esModule",{value:!0});var hc=W(),Ij=le(),Rj={message:"must match exactly one schema in oneOf",params:({params:t})=>(0,hc._)`{passingSchemas: ${t.passing}}`},Oj={keyword:"oneOf",schemaType:"array",trackErrors:!0,error:Rj,code(t){let{gen:e,schema:r,parentSchema:n,it:s}=t;if(!Array.isArray(r))throw new Error("ajv implementation error");if(s.opts.discriminator&&n.discriminator)return;let o=r,i=e.let("valid",!1),a=e.let("passing",null),c=e.name("_valid");t.setParams({passing:a}),e.block(u),t.result(i,()=>t.reset(),()=>t.error(!0));function u(){o.forEach((l,d)=>{let f;(0,Ij.alwaysValidSchema)(s,l)?e.var(c,!0):f=t.subschema({keyword:"oneOf",schemaProp:d,compositeRule:!0},c),d>0&&e.if((0,hc._)`${c} && ${i}`).assign(i,!1).assign(a,(0,hc._)`[${a}, ${d}]`).else(),e.if(c,()=>{e.assign(i,!0),e.assign(a,d),f&&t.mergeEvaluated(f,hc.Name)})})}}};uf.default=Oj});var iw=v(lf=>{"use strict";Object.defineProperty(lf,"__esModule",{value:!0});var Nj=le(),jj={keyword:"allOf",schemaType:"array",code(t){let{gen:e,schema:r,it:n}=t;if(!Array.isArray(r))throw new Error("ajv implementation error");let s=e.name("valid");r.forEach((o,i)=>{if((0,Nj.alwaysValidSchema)(n,o))return;let a=t.subschema({keyword:"allOf",schemaProp:i},s);t.ok(s),t.mergeEvaluated(a)})}};lf.default=jj});var uw=v(df=>{"use strict";Object.defineProperty(df,"__esModule",{value:!0});var gc=W(),cw=le(),Aj={message:({params:t})=>(0,gc.str)`must match "${t.ifClause}" schema`,params:({params:t})=>(0,gc._)`{failingKeyword: ${t.ifClause}}`},Mj={keyword:"if",schemaType:["object","boolean"],trackErrors:!0,error:Aj,code(t){let{gen:e,parentSchema:r,it:n}=t;r.then===void 0&&r.else===void 0&&(0,cw.checkStrictMode)(n,'"if" without "then" and "else" is ignored');let s=aw(n,"then"),o=aw(n,"else");if(!s&&!o)return;let i=e.let("valid",!0),a=e.name("_valid");if(c(),t.reset(),s&&o){let l=e.let("ifClause");t.setParams({ifClause:l}),e.if(a,u("then",l),u("else",l))}else s?e.if(a,u("then")):e.if((0,gc.not)(a),u("else"));t.pass(i,()=>t.error(!0));function c(){let l=t.subschema({keyword:"if",compositeRule:!0,createErrors:!1,allErrors:!1},a);t.mergeEvaluated(l)}function u(l,d){return()=>{let f=t.subschema({keyword:l},a);e.assign(i,a),t.mergeValidEvaluated(f,i),d?e.assign(d,(0,gc._)`${l}`):t.setParams({ifClause:l})}}}};function aw(t,e){let r=t.schema[e];return r!==void 0&&!(0,cw.alwaysValidSchema)(t,r)}df.default=Mj});var lw=v(pf=>{"use strict";Object.defineProperty(pf,"__esModule",{value:!0});var qj=le(),Dj={keyword:["then","else"],schemaType:["object","boolean"],code({keyword:t,parentSchema:e,it:r}){e.if===void 0&&(0,qj.checkStrictMode)(r,`"${t}" without "if" is ignored`)}};pf.default=Dj});var dw=v(ff=>{"use strict";Object.defineProperty(ff,"__esModule",{value:!0});var Zj=Gp(),Lj=Lb(),Vj=Wp(),Fj=Fb(),Uj=Ub(),Hj=Bb(),Kj=Wb(),Bj=rf(),Gj=Qb(),Wj=rw(),Jj=nw(),Yj=sw(),Qj=ow(),Xj=iw(),eA=uw(),tA=lw();function rA(t=!1){let e=[Jj.default,Yj.default,Qj.default,Xj.default,eA.default,tA.default,Kj.default,Bj.default,Hj.default,Gj.default,Wj.default];return t?e.push(Lj.default,Fj.default):e.push(Zj.default,Vj.default),e.push(Uj.default),e}ff.default=rA});var pw=v(mf=>{"use strict";Object.defineProperty(mf,"__esModule",{value:!0});var Oe=W(),nA={message:({schemaCode:t})=>(0,Oe.str)`must match format "${t}"`,params:({schemaCode:t})=>(0,Oe._)`{format: ${t}}`},sA={keyword:"format",type:["number","string"],schemaType:"string",$data:!0,error:nA,code(t,e){let{gen:r,data:n,$data:s,schema:o,schemaCode:i,it:a}=t,{opts:c,errSchemaPath:u,schemaEnv:l,self:d}=a;if(!c.validateFormats)return;s?f():p();function f(){let m=r.scopeValue("formats",{ref:d.formats,code:c.code.formats}),h=r.const("fDef",(0,Oe._)`${m}[${i}]`),g=r.let("fType"),y=r.let("format");r.if((0,Oe._)`typeof ${h} == "object" && !(${h} instanceof RegExp)`,()=>r.assign(g,(0,Oe._)`${h}.type || "string"`).assign(y,(0,Oe._)`${h}.validate`),()=>r.assign(g,(0,Oe._)`"string"`).assign(y,h)),t.fail$data((0,Oe.or)(x(),$()));function x(){return c.strictSchema===!1?Oe.nil:(0,Oe._)`${i} && !${y}`}function $(){let S=l.$async?(0,Oe._)`(${h}.async ? await ${y}(${n}) : ${y}(${n}))`:(0,Oe._)`${y}(${n})`,w=(0,Oe._)`(typeof ${y} == "function" ? ${S} : ${y}.test(${n}))`;return(0,Oe._)`${y} && ${y} !== true && ${g} === ${e} && !${w}`}}function p(){let m=d.formats[o];if(!m){x();return}if(m===!0)return;let[h,g,y]=$(m);h===e&&t.pass(S());function x(){if(c.strictSchema===!1){d.logger.warn(w());return}throw new Error(w());function w(){return`unknown format "${o}" ignored in schema at path "${u}"`}}function $(w){let D=w instanceof RegExp?(0,Oe.regexpCode)(w):c.code.formats?(0,Oe._)`${c.code.formats}${(0,Oe.getProperty)(o)}`:void 0,F=r.scopeValue("formats",{key:o,ref:w,code:D});return typeof w=="object"&&!(w instanceof RegExp)?[w.type||"string",w.validate,(0,Oe._)`${F}.validate`]:["string",w,F]}function S(){if(typeof m=="object"&&!(m instanceof RegExp)&&m.async){if(!l.$async)throw new Error("async format in sync schema");return(0,Oe._)`await ${y}(${n})`}return typeof g=="function"?(0,Oe._)`${y}(${n})`:(0,Oe._)`${y}.test(${n})`}}}};mf.default=sA});var fw=v(hf=>{"use strict";Object.defineProperty(hf,"__esModule",{value:!0});var oA=pw(),iA=[oA.default];hf.default=iA});var mw=v(Ps=>{"use strict";Object.defineProperty(Ps,"__esModule",{value:!0});Ps.contentVocabulary=Ps.metadataVocabulary=void 0;Ps.metadataVocabulary=["title","description","default","deprecated","readOnly","writeOnly","examples"];Ps.contentVocabulary=["contentMediaType","contentEncoding","contentSchema"]});var gw=v(gf=>{"use strict";Object.defineProperty(gf,"__esModule",{value:!0});var aA=xb(),cA=Mb(),uA=dw(),lA=fw(),hw=mw(),dA=[aA.default,cA.default,(0,uA.default)(),lA.default,hw.metadataVocabulary,hw.contentVocabulary];gf.default=dA});var vw=v(yc=>{"use strict";Object.defineProperty(yc,"__esModule",{value:!0});yc.DiscrError=void 0;var yw;(function(t){t.Tag="tag",t.Mapping="mapping"})(yw||(yc.DiscrError=yw={}))});var bw=v(vf=>{"use strict";Object.defineProperty(vf,"__esModule",{value:!0});var Es=W(),yf=vw(),_w=rc(),pA=Qo(),fA=le(),mA={message:({params:{discrError:t,tagName:e}})=>t===yf.DiscrError.Tag?`tag "${e}" must be string`:`value of tag "${e}" must be in oneOf`,params:({params:{discrError:t,tag:e,tagName:r}})=>(0,Es._)`{error: ${t}, tag: ${r}, tagValue: ${e}}`},hA={keyword:"discriminator",type:"object",schemaType:"object",error:mA,code(t){let{gen:e,data:r,schema:n,parentSchema:s,it:o}=t,{oneOf:i}=s;if(!o.opts.discriminator)throw new Error("discriminator: requires discriminator option");let a=n.propertyName;if(typeof a!="string")throw new Error("discriminator: requires propertyName");if(n.mapping)throw new Error("discriminator: mapping is not supported");if(!i)throw new Error("discriminator: requires oneOf keyword");let c=e.let("valid",!1),u=e.const("tag",(0,Es._)`${r}${(0,Es.getProperty)(a)}`);e.if((0,Es._)`typeof ${u} == "string"`,()=>l(),()=>t.error(!1,{discrError:yf.DiscrError.Tag,tag:u,tagName:a})),t.ok(c);function l(){let p=f();e.if(!1);for(let m in p)e.elseIf((0,Es._)`${u} === ${m}`),e.assign(c,d(p[m]));e.else(),t.error(!1,{discrError:yf.DiscrError.Mapping,tag:u,tagName:a}),e.endIf()}function d(p){let m=e.name("valid"),h=t.subschema({keyword:"oneOf",schemaProp:p},m);return t.mergeEvaluated(h,Es.Name),m}function f(){var p;let m={},h=y(s),g=!0;for(let S=0;S<i.length;S++){let w=i[S];if(w?.$ref&&!(0,fA.schemaHasRulesButRef)(w,o.self.RULES)){let F=w.$ref;if(w=_w.resolveRef.call(o.self,o.schemaEnv.root,o.baseId,F),w instanceof _w.SchemaEnv&&(w=w.schema),w===void 0)throw new pA.default(o.opts.uriResolver,o.baseId,F)}let D=(p=w?.properties)===null||p===void 0?void 0:p[a];if(typeof D!="object")throw new Error(`discriminator: oneOf subschemas (or referenced schemas) must have "properties/${a}"`);g=g&&(h||y(w)),x(D,S)}if(!g)throw new Error(`discriminator: "${a}" must be required`);return m;function y({required:S}){return Array.isArray(S)&&S.includes(a)}function x(S,w){if(S.const)$(S.const,w);else if(S.enum)for(let D of S.enum)$(D,w);else throw new Error(`discriminator: "properties/${a}" must have "const" or "enum"`)}function $(S,w){if(typeof S!="string"||S in m)throw new Error(`discriminator: "${a}" values must be unique strings`);m[S]=w}}}};vf.default=hA});var ww=v((EF,gA)=>{gA.exports={$schema:"http://json-schema.org/draft-07/schema#",$id:"http://json-schema.org/draft-07/schema#",title:"Core schema meta-schema",definitions:{schemaArray:{type:"array",minItems:1,items:{$ref:"#"}},nonNegativeInteger:{type:"integer",minimum:0},nonNegativeIntegerDefault0:{allOf:[{$ref:"#/definitions/nonNegativeInteger"},{default:0}]},simpleTypes:{enum:["array","boolean","integer","null","number","object","string"]},stringArray:{type:"array",items:{type:"string"},uniqueItems:!0,default:[]}},type:["object","boolean"],properties:{$id:{type:"string",format:"uri-reference"},$schema:{type:"string",format:"uri"},$ref:{type:"string",format:"uri-reference"},$comment:{type:"string"},title:{type:"string"},description:{type:"string"},default:!0,readOnly:{type:"boolean",default:!1},examples:{type:"array",items:!0},multipleOf:{type:"number",exclusiveMinimum:0},maximum:{type:"number"},exclusiveMaximum:{type:"number"},minimum:{type:"number"},exclusiveMinimum:{type:"number"},maxLength:{$ref:"#/definitions/nonNegativeInteger"},minLength:{$ref:"#/definitions/nonNegativeIntegerDefault0"},pattern:{type:"string",format:"regex"},additionalItems:{$ref:"#"},items:{anyOf:[{$ref:"#"},{$ref:"#/definitions/schemaArray"}],default:!0},maxItems:{$ref:"#/definitions/nonNegativeInteger"},minItems:{$ref:"#/definitions/nonNegativeIntegerDefault0"},uniqueItems:{type:"boolean",default:!1},contains:{$ref:"#"},maxProperties:{$ref:"#/definitions/nonNegativeInteger"},minProperties:{$ref:"#/definitions/nonNegativeIntegerDefault0"},required:{$ref:"#/definitions/stringArray"},additionalProperties:{$ref:"#"},definitions:{type:"object",additionalProperties:{$ref:"#"},default:{}},properties:{type:"object",additionalProperties:{$ref:"#"},default:{}},patternProperties:{type:"object",additionalProperties:{$ref:"#"},propertyNames:{format:"regex"},default:{}},dependencies:{type:"object",additionalProperties:{anyOf:[{$ref:"#"},{$ref:"#/definitions/stringArray"}]}},propertyNames:{$ref:"#"},const:!0,enum:{type:"array",items:!0,minItems:1,uniqueItems:!0},type:{anyOf:[{$ref:"#/definitions/simpleTypes"},{type:"array",items:{$ref:"#/definitions/simpleTypes"},minItems:1,uniqueItems:!0}]},format:{type:"string"},contentMediaType:{type:"string"},contentEncoding:{type:"string"},if:{$ref:"#"},then:{$ref:"#"},else:{$ref:"#"},allOf:{$ref:"#/definitions/schemaArray"},anyOf:{$ref:"#/definitions/schemaArray"},oneOf:{$ref:"#/definitions/schemaArray"},not:{$ref:"#"}},default:!0}});var xw=v((Ee,_f)=>{"use strict";Object.defineProperty(Ee,"__esModule",{value:!0});Ee.MissingRefError=Ee.ValidationError=Ee.CodeGen=Ee.Name=Ee.nil=Ee.stringify=Ee.str=Ee._=Ee.KeywordCxt=Ee.Ajv=void 0;var yA=yb(),vA=gw(),_A=bw(),$w=ww(),bA=["/properties"],vc="http://json-schema.org/draft-07/schema",Ts=class extends yA.default{_addVocabularies(){super._addVocabularies(),vA.default.forEach(e=>this.addVocabulary(e)),this.opts.discriminator&&this.addKeyword(_A.default)}_addDefaultMetaSchema(){if(super._addDefaultMetaSchema(),!this.opts.meta)return;let e=this.opts.$data?this.$dataMetaSchema($w,bA):$w;this.addMetaSchema(e,vc,!1),this.refs["http://json-schema.org/schema"]=vc}defaultMeta(){return this.opts.defaultMeta=super.defaultMeta()||(this.getSchema(vc)?vc:void 0)}};Ee.Ajv=Ts;_f.exports=Ee=Ts;_f.exports.Ajv=Ts;Object.defineProperty(Ee,"__esModule",{value:!0});Ee.default=Ts;var wA=Yo();Object.defineProperty(Ee,"KeywordCxt",{enumerable:!0,get:function(){return wA.KeywordCxt}});var zs=W();Object.defineProperty(Ee,"_",{enumerable:!0,get:function(){return zs._}});Object.defineProperty(Ee,"str",{enumerable:!0,get:function(){return zs.str}});Object.defineProperty(Ee,"stringify",{enumerable:!0,get:function(){return zs.stringify}});Object.defineProperty(Ee,"nil",{enumerable:!0,get:function(){return zs.nil}});Object.defineProperty(Ee,"Name",{enumerable:!0,get:function(){return zs.Name}});Object.defineProperty(Ee,"CodeGen",{enumerable:!0,get:function(){return zs.CodeGen}});var $A=ec();Object.defineProperty(Ee,"ValidationError",{enumerable:!0,get:function(){return $A.default}});var xA=Qo();Object.defineProperty(Ee,"MissingRefError",{enumerable:!0,get:function(){return xA.default}})});var kw=v(Cs=>{"use strict";Object.defineProperty(Cs,"__esModule",{value:!0});Cs.formatLimitDefinition=void 0;var kA=xw(),Vt=W(),Br=Vt.operators,_c={formatMaximum:{okStr:"<=",ok:Br.LTE,fail:Br.GT},formatMinimum:{okStr:">=",ok:Br.GTE,fail:Br.LT},formatExclusiveMaximum:{okStr:"<",ok:Br.LT,fail:Br.GTE},formatExclusiveMinimum:{okStr:">",ok:Br.GT,fail:Br.LTE}},SA={message:({keyword:t,schemaCode:e})=>(0,Vt.str)`should be ${_c[t].okStr} ${e}`,params:({keyword:t,schemaCode:e})=>(0,Vt._)`{comparison: ${_c[t].okStr}, limit: ${e}}`};Cs.formatLimitDefinition={keyword:Object.keys(_c),type:"string",schemaType:"string",$data:!0,error:SA,code(t){let{gen:e,data:r,schemaCode:n,keyword:s,it:o}=t,{opts:i,self:a}=o;if(!i.validateFormats)return;let c=new kA.KeywordCxt(o,a.RULES.all.format.definition,"format");c.$data?u():l();function u(){let f=e.scopeValue("formats",{ref:a.formats,code:i.code.formats}),p=e.const("fmt",(0,Vt._)`${f}[${c.schemaCode}]`);t.fail$data((0,Vt.or)((0,Vt._)`typeof ${p} != "object"`,(0,Vt._)`${p} instanceof RegExp`,(0,Vt._)`typeof ${p}.compare != "function"`,d(p)))}function l(){let f=c.schema,p=a.formats[f];if(!p||p===!0)return;if(typeof p!="object"||p instanceof RegExp||typeof p.compare!="function")throw new Error(`"${s}": format "${f}" does not define "compare" function`);let m=e.scopeValue("formats",{key:f,ref:p,code:i.code.formats?(0,Vt._)`${i.code.formats}${(0,Vt.getProperty)(f)}`:void 0});t.fail$data(d(m))}function d(f){return(0,Vt._)`${f}.compare(${r}, ${n}) ${_c[s].fail} 0`}},dependencies:["format"]};var PA=t=>(t.addKeyword(Cs.formatLimitDefinition),t);Cs.default=PA});var Tw=v((di,Ew)=>{"use strict";Object.defineProperty(di,"__esModule",{value:!0});var Is=u0(),EA=kw(),bf=W(),Sw=new bf.Name("fullFormats"),TA=new bf.Name("fastFormats"),wf=(t,e={keywords:!0})=>{if(Array.isArray(e))return Pw(t,e,Is.fullFormats,Sw),t;let[r,n]=e.mode==="fast"?[Is.fastFormats,TA]:[Is.fullFormats,Sw],s=e.formats||Is.formatNames;return Pw(t,s,r,n),e.keywords&&(0,EA.default)(t),t};wf.get=(t,e="full")=>{let n=(e==="fast"?Is.fastFormats:Is.fullFormats)[t];if(!n)throw new Error(`Unknown format "${t}"`);return n};function Pw(t,e,r,n){var s,o;(s=(o=t.opts.code).formats)!==null&&s!==void 0||(o.formats=(0,bf._)`require("ajv-formats/dist/formats").${n}`);for(let i of e)t.addFormat(i,r[i])}Ew.exports=di=wf;Object.defineProperty(di,"__esModule",{value:!0});di.default=wf});var Mw=v((ZF,Aw)=>{Aw.exports=jw;jw.sync=RA;var Ow=require("fs");function IA(t,e){var r=e.pathExt!==void 0?e.pathExt:process.env.PATHEXT;if(!r||(r=r.split(";"),r.indexOf("")!==-1))return!0;for(var n=0;n<r.length;n++){var s=r[n].toLowerCase();if(s&&t.substr(-s.length).toLowerCase()===s)return!0}return!1}function Nw(t,e,r){return!t.isSymbolicLink()&&!t.isFile()?!1:IA(e,r)}function jw(t,e,r){Ow.stat(t,function(n,s){r(n,n?!1:Nw(s,t,e))})}function RA(t,e){return Nw(Ow.statSync(t),t,e)}});var Vw=v((LF,Lw)=>{Lw.exports=Dw;Dw.sync=OA;var qw=require("fs");function Dw(t,e,r){qw.stat(t,function(n,s){r(n,n?!1:Zw(s,e))})}function OA(t,e){return Zw(qw.statSync(t),e)}function Zw(t,e){return t.isFile()&&NA(t,e)}function NA(t,e){var r=t.mode,n=t.uid,s=t.gid,o=e.uid!==void 0?e.uid:process.getuid&&process.getuid(),i=e.gid!==void 0?e.gid:process.getgid&&process.getgid(),a=parseInt("100",8),c=parseInt("010",8),u=parseInt("001",8),l=a|c,d=r&u||r&c&&s===i||r&a&&n===o||r&l&&o===0;return d}});var Uw=v((FF,Fw)=>{var VF=require("fs"),kc;process.platform==="win32"||global.TESTING_WINDOWS?kc=Mw():kc=Vw();Fw.exports=$f;$f.sync=jA;function $f(t,e,r){if(typeof e=="function"&&(r=e,e={}),!r){if(typeof Promise!="function")throw new TypeError("callback not provided");return new Promise(function(n,s){$f(t,e||{},function(o,i){o?s(o):n(i)})})}kc(t,e||{},function(n,s){n&&(n.code==="EACCES"||e&&e.ignoreErrors)&&(n=null,s=!1),r(n,s)})}function jA(t,e){try{return kc.sync(t,e||{})}catch(r){if(e&&e.ignoreErrors||r.code==="EACCES")return!1;throw r}}});var Yw=v((UF,Jw)=>{var Rs=process.platform==="win32"||process.env.OSTYPE==="cygwin"||process.env.OSTYPE==="msys",Hw=require("path"),AA=Rs?";":":",Kw=Uw(),Bw=t=>Object.assign(new Error(`not found: ${t}`),{code:"ENOENT"}),Gw=(t,e)=>{let r=e.colon||AA,n=t.match(/\//)||Rs&&t.match(/\\/)?[""]:[...Rs?[process.cwd()]:[],...(e.path||process.env.PATH||"").split(r)],s=Rs?e.pathExt||process.env.PATHEXT||".EXE;.CMD;.BAT;.COM":"",o=Rs?s.split(r):[""];return Rs&&t.indexOf(".")!==-1&&o[0]!==""&&o.unshift(""),{pathEnv:n,pathExt:o,pathExtExe:s}},Ww=(t,e,r)=>{typeof e=="function"&&(r=e,e={}),e||(e={});let{pathEnv:n,pathExt:s,pathExtExe:o}=Gw(t,e),i=[],a=u=>new Promise((l,d)=>{if(u===n.length)return e.all&&i.length?l(i):d(Bw(t));let f=n[u],p=/^".*"$/.test(f)?f.slice(1,-1):f,m=Hw.join(p,t),h=!p&&/^\.[\\\/]/.test(t)?t.slice(0,2)+m:m;l(c(h,u,0))}),c=(u,l,d)=>new Promise((f,p)=>{if(d===s.length)return f(a(l+1));let m=s[d];Kw(u+m,{pathExt:o},(h,g)=>{if(!h&&g)if(e.all)i.push(u+m);else return f(u+m);return f(c(u,l,d+1))})});return r?a(0).then(u=>r(null,u),r):a(0)},MA=(t,e)=>{e=e||{};let{pathEnv:r,pathExt:n,pathExtExe:s}=Gw(t,e),o=[];for(let i=0;i<r.length;i++){let a=r[i],c=/^".*"$/.test(a)?a.slice(1,-1):a,u=Hw.join(c,t),l=!c&&/^\.[\\\/]/.test(t)?t.slice(0,2)+u:u;for(let d=0;d<n.length;d++){let f=l+n[d];try{if(Kw.sync(f,{pathExt:s}))if(e.all)o.push(f);else return f}catch{}}}if(e.all&&o.length)return o;if(e.nothrow)return null;throw Bw(t)};Jw.exports=Ww;Ww.sync=MA});var Xw=v((HF,xf)=>{"use strict";var Qw=(t={})=>{let e=t.env||process.env;return(t.platform||process.platform)!=="win32"?"PATH":Object.keys(e).reverse().find(n=>n.toUpperCase()==="PATH")||"Path"};xf.exports=Qw;xf.exports.default=Qw});var n$=v((KF,r$)=>{"use strict";var e$=require("path"),qA=Yw(),DA=Xw();function t$(t,e){let r=t.options.env||process.env,n=process.cwd(),s=t.options.cwd!=null,o=s&&process.chdir!==void 0&&!process.chdir.disabled;if(o)try{process.chdir(t.options.cwd)}catch{}let i;try{i=qA.sync(t.command,{path:r[DA({env:r})],pathExt:e?e$.delimiter:void 0})}catch{}finally{o&&process.chdir(n)}return i&&(i=e$.resolve(s?t.options.cwd:"",i)),i}function ZA(t){return t$(t)||t$(t,!0)}r$.exports=ZA});var s$=v((BF,Sf)=>{"use strict";var kf=/([()\][%!^"`<>&|;, *?])/g;function LA(t){return t=t.replace(kf,"^$1"),t}function VA(t,e){return t=`${t}`,t=t.replace(/(?=(\\+?)?)\1"/g,'$1$1\\"'),t=t.replace(/(?=(\\+?)?)\1$/,"$1$1"),t=`"${t}"`,t=t.replace(kf,"^$1"),e&&(t=t.replace(kf,"^$1")),t}Sf.exports.command=LA;Sf.exports.argument=VA});var i$=v((GF,o$)=>{"use strict";o$.exports=/^#!(.*)/});var c$=v((WF,a$)=>{"use strict";var FA=i$();a$.exports=(t="")=>{let e=t.match(FA);if(!e)return null;let[r,n]=e[0].replace(/#! ?/,"").split(" "),s=r.split("/").pop();return s==="env"?n:n?`${s} ${n}`:s}});var l$=v((JF,u$)=>{"use strict";var Pf=require("fs"),UA=c$();function HA(t){let r=Buffer.alloc(150),n;try{n=Pf.openSync(t,"r"),Pf.readSync(n,r,0,150,0),Pf.closeSync(n)}catch{}return UA(r.toString())}u$.exports=HA});var m$=v((YF,f$)=>{"use strict";var KA=require("path"),d$=n$(),p$=s$(),BA=l$(),GA=process.platform==="win32",WA=/\.(?:com|exe)$/i,JA=/node_modules[\\/].bin[\\/][^\\/]+\.cmd$/i;function YA(t){t.file=d$(t);let e=t.file&&BA(t.file);return e?(t.args.unshift(t.file),t.command=e,d$(t)):t.file}function QA(t){if(!GA)return t;let e=YA(t),r=!WA.test(e);if(t.options.forceShell||r){let n=JA.test(e);t.command=KA.normalize(t.command),t.command=p$.command(t.command),t.args=t.args.map(o=>p$.argument(o,n));let s=[t.command].concat(t.args).join(" ");t.args=["/d","/s","/c",`"${s}"`],t.command=process.env.comspec||"cmd.exe",t.options.windowsVerbatimArguments=!0}return t}function XA(t,e,r){e&&!Array.isArray(e)&&(r=e,e=null),e=e?e.slice(0):[],r=Object.assign({},r);let n={command:t,args:e,options:r,file:void 0,original:{command:t,args:e}};return r.shell?n:QA(n)}f$.exports=XA});var y$=v((QF,g$)=>{"use strict";var Ef=process.platform==="win32";function Tf(t,e){return Object.assign(new Error(`${e} ${t.command} ENOENT`),{code:"ENOENT",errno:"ENOENT",syscall:`${e} ${t.command}`,path:t.command,spawnargs:t.args})}function eM(t,e){if(!Ef)return;let r=t.emit;t.emit=function(n,s){if(n==="exit"){let o=h$(s,e);if(o)return r.call(t,"error",o)}return r.apply(t,arguments)}}function h$(t,e){return Ef&&t===1&&!e.file?Tf(e.original,"spawn"):null}function tM(t,e){return Ef&&t===1&&!e.file?Tf(e.original,"spawnSync"):null}g$.exports={hookChildProcess:eM,verifyENOENT:h$,verifyENOENTSync:tM,notFoundError:Tf}});var b$=v((XF,Os)=>{"use strict";var v$=require("child_process"),zf=m$(),Cf=y$();function _$(t,e,r){let n=zf(t,e,r),s=v$.spawn(n.command,n.args,n.options);return Cf.hookChildProcess(s,n),s}function rM(t,e,r){let n=zf(t,e,r),s=v$.spawnSync(n.command,n.args,n.options);return s.error=s.error||Cf.verifyENOENTSync(s.status,n),s}Os.exports=_$;Os.exports.spawn=_$;Os.exports.sync=rM;Os.exports._parse=zf;Os.exports._enoent=Cf});var uM={};hi(uM,{activate:()=>aM,deactivate:()=>cM,getMetricsCollector:()=>Zn});module.exports=I$(uM);var pe=ve(require("vscode")),S$=ve(require("path"));var Df=ve(require("vscode"));var Wr=ve(require("fs/promises")),yi=ve(require("path")),gi=class{constructor(){this.projectStructure=null;this.masterContext=new Map;this.contextWindowTokens=256*1024}async resolveContext(e){if(!e||e.length===0)return"";let r=`

<context>
`;if(e.length>0&&e[0].path){let n=e[0].path,s=yi.dirname(n);await this.buildProjectStructure(s)}for(let n of e)try{let s=await Wr.readFile(n.path,"utf-8"),o=256,i=s.split(`
`);if(i.length>o){let a=i.slice(0,o).join(`
`)+`
... (content truncated)`;r+=`<file path="${n.path}" truncated="true">
${a}
</file>
`}else r+=`<file path="${n.path}">
${s}
</file>
`}catch(s){console.error(`Failed to read context file ${n.path}`,s),r+=`<file path="${n.path}" error="true">Could not read file.</file>
`}return r+=`</context>
`,r}async buildProjectStructure(e){try{this.projectStructure=await this.buildStructureFromPath(e)}catch(r){console.error("Failed to build project structure",r)}}async buildStructureFromPath(e){let r={root:e,files:[],directories:{}},n=await Wr.readdir(e);for(let s of n){let o=yi.join(e,s),i=await Wr.stat(o);i.isDirectory()?r.directories[s]=await this.buildStructureFromPath(o):i.isFile()&&r.files.push(o)}return r}getProjectStructure(){return this.projectStructure}async getHierarchicalContext(e,r=4096){return this.resolveContext(e)}addToMasterContext(e,r){this.masterContext.set(e,r)}getFromMasterContext(e){return this.masterContext.get(e)}removeFromMasterContext(e){this.masterContext.delete(e)}getAllMasterContext(){return new Map(this.masterContext)}clearMasterContext(){this.masterContext.clear()}generateSlidingWindowContext(){let r="",n=0,s=Array.from(this.masterContext.keys()).sort((o,i)=>o==="task_description"?-1:i==="task_description"?1:o.startsWith("context_")&&!i.startsWith("context_")?-1:!o.startsWith("context_")&&i.startsWith("context_")?1:0);for(let o of s){let i=this.masterContext.get(o)||"",a=this.estimateTokenCount(i);if(n+a>262144){let c=262144-n;if(c>0){let u=c*4;i=i.slice(0,u)+`
... (content truncated)`,a=this.estimateTokenCount(i),r+=`
<master_context key="${o}" truncated="true">
${i}
</master_context>
`,n+=a}break}else r+=`
<master_context key="${o}">
${i}
</master_context>
`,n+=a}return n>262144&&(r+=`
<!-- Context window exceeded, some content omitted -->
`),r}estimateTokenCount(e){return Math.ceil(e.length/4)}async getContextForTask(e,r){this.addToMasterContext("task_description",e);for(let n of r)try{let s=await Wr.readFile(n.path,"utf-8");this.addToMasterContext(`context_${n.path}`,s)}catch(s){console.error(`Failed to read context file ${n.path}`,s),this.addToMasterContext(`context_${n.path}`,`Could not read file: ${n.path}`)}return this.generateSlidingWindowContext()}};async function Nf(t,e,r){return await t.getContextForTask(e,r||[])}async function Ic(t,e,r){return await t.chat(e,r)}function jf(t){let e=t.match(/```json[\r\n]+([\s\S]*?)[\r\n]+```/),r=null;if(e)r=e[1].trim(),r.startsWith("json")&&(r=r.slice(4).trim());else{let n=/(\{\s*"(?:thought|tool_calls)"[\s\S]*?\})\s*$/,s=t.match(n);s&&(r=s[1])}if(!r)return{text:t};try{return JSON.parse(r)}catch{return{text:t}}}async function Af(t,e){return await t.executeTool(e)}function Rc(t,e,r){t.push({role:"tool",content:JSON.stringify({role:"tool_result",tool_call_id:r.id,status:e.status||"success",result:e.result||e,error:e.error||void 0})})}function Jr(t,e){t.push(e)}function Mf(t){return t&&t.message?t.message:String(t)}function qf(t){t&&t.abort()}var vi=class{constructor(e,r,n){this.llm=e;this.tools=r;this.abortController=null;this.contextManager=new gi,this.context={workspaceRoot:n,history:[{role:"system",content:this.getSystemPrompt()}]}}cancel(){this.abortController&&(this.abortController.abort(),this.abortController=null)}getSystemPrompt(){let e=Df.workspace.getConfiguration("vibey"),r=e.get("rules",{}),n=e.get("userGuidelines",""),s="";Object.keys(r).length>0&&(s=`## Rules

${JSON.stringify(r,null,2)}

`);let o="";n&&(o=`## User Guidelines

${n}

`);let i=this.tools.getToolDefinitions().map(a=>`## ${a.name}
${a.description}
Parameters: ${JSON.stringify(a.parameters)}`).join(`

`);return`You are Vibey, an expert autonomous coding agent.
You are running inside VS Code.

## Core Behavior

BE AUTONOMOUS. When given a task:
1. Gather information using tools
2. Plan your approach
3. EXECUTE the plan immediately - do NOT ask for permission
4. Continue working until the task is COMPLETE
5. Only stop when you have fully solved the problem

NEVER respond with "Would you like me to..." or "Should I...?" - just DO IT.
NEVER stop after gathering information - immediately proceed to implementation.
NEVER ask for confirmation before making changes - the user asked you to do something, so do it.

${s}${o}## Available Tools

${i}

## Response Format

When using tools, output ONLY a JSON block:
\`\`\`json
{
  "thought": "Brief reasoning about what I'm doing and why...",
  "tool_calls": [
    {
      "id": "unique_id",
      "name": "tool_name",
      "parameters": { ... }
    }
  ]
}
\`\`\`

When you are DONE with the entire task and have nothing more to do, respond with plain text summarizing what you accomplished.

## Important Rules

- Use tools to READ before you WRITE - understand the code first
- Make targeted, minimal changes - don't rewrite entire files
- If a tool fails, try a different approach
- Keep working until the task is fully complete
- For multi-step tasks, execute ALL steps in sequence without stopping
`}async chat(e,r,n){qf(this.abortController),this.abortController=new AbortController;let s=this.abortController.signal;try{let o=r&&r.length>0?await Nf(this.contextManager,e,r):"";Jr(this.context.history,{role:"user",content:e+o}),n&&n({type:"thinking",message:"Strategic planning with full context window..."});let i=256,a=0,c="";for(;a<i;){if(s.aborted)throw new Error("Request cancelled by user");a++,n&&n({type:"thinking",message:a===1?"Analyzing request...":`Turn ${a}: Reasoning...`});let d=await Ic(this.llm,this.context.history,s);if(s.aborted)throw new Error("Request cancelled by user");let f=jf(d);if(!f||f.text){Jr(this.context.history,{role:"assistant",content:d}),c=d;break}if(f.thought&&n&&n({type:"thought",message:f.thought}),f.tool_calls&&Array.isArray(f.tool_calls)){Jr(this.context.history,{role:"assistant",content:d});for(let p of f.tool_calls){if(s.aborted)throw new Error("Request cancelled by user");try{n&&n({type:"tool_start",id:p.id,tool:p.name,parameters:p.parameters});let m=await Af(this.tools,p);n&&n({type:"tool_end",id:p.id,tool:p.name,success:!0,result:m}),Rc(this.context.history,m,p)}catch(m){n&&n({type:"tool_end",id:p.id,tool:p.name,success:!1,error:m.message}),Rc(this.context.history,{status:"error",error:m.message},p)}}}else{Jr(this.context.history,{role:"assistant",content:d}),c=f.thought||d;break}}if(this.abortController=null,c){let d=Zn();if(d){let f=d.getSummary("tokens_sent")?.currentValue||0,p=d.getSummary("tokens_received")?.currentValue||0;n&&n({type:"tokens",sent:f,received:p})}return c}n&&n({type:"thinking",message:"Max turns reached. Summarizing progress..."}),Jr(this.context.history,{role:"user",content:"You have reached the maximum number of turns. Please provide a concise summary of what you have accomplished so far, what issues you encountered, and what steps should be taken next to complete the task."});let u=await Ic(this.llm,this.context.history,s);Jr(this.context.history,{role:"assistant",content:u});let l=Zn();if(l){let d=l.getSummary("tokens_sent")?.currentValue||0,f=l.getSummary("tokens_received")?.currentValue||0;n&&n({type:"tokens",sent:d,received:f})}return`**Max Turns Reached (${i})**

${u}`}catch(o){this.abortController=null;let i=Mf(o);return n&&n({type:"error",message:i}),`**Error:** ${i}`}}};var Zf=ve(require("vscode"));var _i=class{constructor(){}getConfig(){let e=Zf.workspace.getConfiguration("vibey");return{modelName:e.get("model")||"Qwen3-coder-roo-config:latest",baseUrl:e.get("ollamaUrl")||"http://localhost:11434"}}async chat(e,r){let{modelName:n,baseUrl:s}=this.getConfig(),o={model:n,messages:e.map(i=>i.role==="tool"?{role:"tool",content:JSON.stringify(i.content)}:{role:i.role,content:typeof i.content=="string"?i.content:JSON.stringify(i.content)}),stream:!1};try{let i=await fetch(`${s}/api/chat`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(o),signal:r});if(!i.ok)throw new Error(`Ollama API error: ${i.statusText}`);let a=await i.json(),c=Zn();return c&&a.prompt_eval_count!==void 0&&c.record("tokens_sent",a.prompt_eval_count),c&&a.eval_count!==void 0&&c.record("tokens_received",a.eval_count),a.message.content}catch(i){throw i.name==="AbortError"?new Error("Request cancelled by user"):(console.error("Failed to call Ollama:",i),i)}}async listModels(){let{baseUrl:e}=this.getConfig();try{let r=await fetch(`${e}/api/tags`);if(!r.ok)throw new Error(`Failed to fetch models: ${r.statusText}`);return(await r.json()).models.map(s=>s.name)}catch(r){return console.error("Failed to list models:",r),[]}}};var bi=class{constructor(e){this.policy=e;this.tools=new Map}registerTool(e){this.tools.set(e.name,e)}unregisterTool(e){this.tools.delete(e)}getToolDefinitions(){return Array.from(this.tools.values())}async executeTool(e){let r=this.tools.get(e.name);if(!r)return{role:"tool_result",tool_call_id:e.id,status:"error",error:`Tool ${e.name} not found`,output:""};console.log(`[Gateway] Executing ${e.name}`);try{let n=await r.execute(e.parameters,{});return{role:"tool_result",tool_call_id:e.id,status:"success",output:n}}catch(n){return{role:"tool_result",tool_call_id:e.id,status:"error",error:n.message,output:""}}}};var Lf=ve(require("path")),wi=class{constructor(e){this.workspaceRoot=e}checkPathAccess(e,r){let n=Lf.resolve(this.workspaceRoot,e);return n.startsWith(this.workspaceRoot)?!((n.includes(".git")||n.includes("node_modules"))&&r==="write"):(console.warn(`Blocked access to ${n} (outside workspace)`),!1)}checkCommand(e){return!["rm -rf","mkfs","shutdown","reboot","dd "].some(n=>e.includes(n))}};var Tr=ve(require("fs/promises"));var T={};hi(T,{BRAND:()=>nx,DIRTY:()=>Yr,EMPTY_PATH:()=>j$,INVALID:()=>A,NEVER:()=>Lx,OK:()=>Be,ParseStatus:()=>qe,Schema:()=>G,ZodAny:()=>Pr,ZodArray:()=>ur,ZodBigInt:()=>Xr,ZodBoolean:()=>en,ZodBranded:()=>Ms,ZodCatch:()=>pn,ZodDate:()=>tn,ZodDefault:()=>dn,ZodDiscriminatedUnion:()=>ki,ZodEffects:()=>_t,ZodEnum:()=>un,ZodError:()=>it,ZodFirstPartyTypeKind:()=>q,ZodFunction:()=>Pi,ZodIntersection:()=>on,ZodIssueCode:()=>k,ZodLazy:()=>an,ZodLiteral:()=>cn,ZodMap:()=>Kn,ZodNaN:()=>Gn,ZodNativeEnum:()=>ln,ZodNever:()=>It,ZodNull:()=>nn,ZodNullable:()=>Ht,ZodNumber:()=>Qr,ZodObject:()=>at,ZodOptional:()=>yt,ZodParsedType:()=>z,ZodPipeline:()=>qs,ZodPromise:()=>Er,ZodReadonly:()=>fn,ZodRecord:()=>Si,ZodSchema:()=>G,ZodSet:()=>Bn,ZodString:()=>Sr,ZodSymbol:()=>Un,ZodTransformer:()=>_t,ZodTuple:()=>Ut,ZodType:()=>G,ZodUndefined:()=>rn,ZodUnion:()=>sn,ZodUnknown:()=>cr,ZodVoid:()=>Hn,addIssueToContext:()=>E,any:()=>px,array:()=>gx,bigint:()=>ax,boolean:()=>Qf,coerce:()=>Zx,custom:()=>Wf,date:()=>cx,datetimeRegex:()=>Bf,defaultErrorMap:()=>ir,discriminatedUnion:()=>bx,effect:()=>Rx,enum:()=>zx,function:()=>Px,getErrorMap:()=>Ln,getParsedType:()=>Ft,instanceof:()=>ox,intersection:()=>wx,isAborted:()=>$i,isAsync:()=>Vn,isDirty:()=>xi,isValid:()=>kr,late:()=>sx,lazy:()=>Ex,literal:()=>Tx,makeIssue:()=>As,map:()=>kx,nan:()=>ix,nativeEnum:()=>Cx,never:()=>mx,null:()=>dx,nullable:()=>Nx,number:()=>Yf,object:()=>yx,objectUtil:()=>Oc,oboolean:()=>Dx,onumber:()=>qx,optional:()=>Ox,ostring:()=>Mx,pipeline:()=>Ax,preprocess:()=>jx,promise:()=>Ix,quotelessJson:()=>R$,record:()=>xx,set:()=>Sx,setErrorMap:()=>N$,strictObject:()=>vx,string:()=>Jf,symbol:()=>ux,transformer:()=>Rx,tuple:()=>$x,undefined:()=>lx,union:()=>_x,unknown:()=>fx,util:()=>te,void:()=>hx});var te;(function(t){t.assertEqual=s=>{};function e(s){}t.assertIs=e;function r(s){throw new Error}t.assertNever=r,t.arrayToEnum=s=>{let o={};for(let i of s)o[i]=i;return o},t.getValidEnumValues=s=>{let o=t.objectKeys(s).filter(a=>typeof s[s[a]]!="number"),i={};for(let a of o)i[a]=s[a];return t.objectValues(i)},t.objectValues=s=>t.objectKeys(s).map(function(o){return s[o]}),t.objectKeys=typeof Object.keys=="function"?s=>Object.keys(s):s=>{let o=[];for(let i in s)Object.prototype.hasOwnProperty.call(s,i)&&o.push(i);return o},t.find=(s,o)=>{for(let i of s)if(o(i))return i},t.isInteger=typeof Number.isInteger=="function"?s=>Number.isInteger(s):s=>typeof s=="number"&&Number.isFinite(s)&&Math.floor(s)===s;function n(s,o=" | "){return s.map(i=>typeof i=="string"?`'${i}'`:i).join(o)}t.joinValues=n,t.jsonStringifyReplacer=(s,o)=>typeof o=="bigint"?o.toString():o})(te||(te={}));var Oc;(function(t){t.mergeShapes=(e,r)=>({...e,...r})})(Oc||(Oc={}));var z=te.arrayToEnum(["string","nan","number","integer","float","boolean","date","bigint","symbol","function","undefined","null","array","object","unknown","promise","void","never","map","set"]),Ft=t=>{switch(typeof t){case"undefined":return z.undefined;case"string":return z.string;case"number":return Number.isNaN(t)?z.nan:z.number;case"boolean":return z.boolean;case"function":return z.function;case"bigint":return z.bigint;case"symbol":return z.symbol;case"object":return Array.isArray(t)?z.array:t===null?z.null:t.then&&typeof t.then=="function"&&t.catch&&typeof t.catch=="function"?z.promise:typeof Map<"u"&&t instanceof Map?z.map:typeof Set<"u"&&t instanceof Set?z.set:typeof Date<"u"&&t instanceof Date?z.date:z.object;default:return z.unknown}};var k=te.arrayToEnum(["invalid_type","invalid_literal","custom","invalid_union","invalid_union_discriminator","invalid_enum_value","unrecognized_keys","invalid_arguments","invalid_return_type","invalid_date","invalid_string","too_small","too_big","invalid_intersection_types","not_multiple_of","not_finite"]),R$=t=>JSON.stringify(t,null,2).replace(/"([^"]+)":/g,"$1:"),it=class t extends Error{get errors(){return this.issues}constructor(e){super(),this.issues=[],this.addIssue=n=>{this.issues=[...this.issues,n]},this.addIssues=(n=[])=>{this.issues=[...this.issues,...n]};let r=new.target.prototype;Object.setPrototypeOf?Object.setPrototypeOf(this,r):this.__proto__=r,this.name="ZodError",this.issues=e}format(e){let r=e||function(o){return o.message},n={_errors:[]},s=o=>{for(let i of o.issues)if(i.code==="invalid_union")i.unionErrors.map(s);else if(i.code==="invalid_return_type")s(i.returnTypeError);else if(i.code==="invalid_arguments")s(i.argumentsError);else if(i.path.length===0)n._errors.push(r(i));else{let a=n,c=0;for(;c<i.path.length;){let u=i.path[c];c===i.path.length-1?(a[u]=a[u]||{_errors:[]},a[u]._errors.push(r(i))):a[u]=a[u]||{_errors:[]},a=a[u],c++}}};return s(this),n}static assert(e){if(!(e instanceof t))throw new Error(`Not a ZodError: ${e}`)}toString(){return this.message}get message(){return JSON.stringify(this.issues,te.jsonStringifyReplacer,2)}get isEmpty(){return this.issues.length===0}flatten(e=r=>r.message){let r={},n=[];for(let s of this.issues)if(s.path.length>0){let o=s.path[0];r[o]=r[o]||[],r[o].push(e(s))}else n.push(e(s));return{formErrors:n,fieldErrors:r}}get formErrors(){return this.flatten()}};it.create=t=>new it(t);var O$=(t,e)=>{let r;switch(t.code){case k.invalid_type:t.received===z.undefined?r="Required":r=`Expected ${t.expected}, received ${t.received}`;break;case k.invalid_literal:r=`Invalid literal value, expected ${JSON.stringify(t.expected,te.jsonStringifyReplacer)}`;break;case k.unrecognized_keys:r=`Unrecognized key(s) in object: ${te.joinValues(t.keys,", ")}`;break;case k.invalid_union:r="Invalid input";break;case k.invalid_union_discriminator:r=`Invalid discriminator value. Expected ${te.joinValues(t.options)}`;break;case k.invalid_enum_value:r=`Invalid enum value. Expected ${te.joinValues(t.options)}, received '${t.received}'`;break;case k.invalid_arguments:r="Invalid function arguments";break;case k.invalid_return_type:r="Invalid function return type";break;case k.invalid_date:r="Invalid date";break;case k.invalid_string:typeof t.validation=="object"?"includes"in t.validation?(r=`Invalid input: must include "${t.validation.includes}"`,typeof t.validation.position=="number"&&(r=`${r} at one or more positions greater than or equal to ${t.validation.position}`)):"startsWith"in t.validation?r=`Invalid input: must start with "${t.validation.startsWith}"`:"endsWith"in t.validation?r=`Invalid input: must end with "${t.validation.endsWith}"`:te.assertNever(t.validation):t.validation!=="regex"?r=`Invalid ${t.validation}`:r="Invalid";break;case k.too_small:t.type==="array"?r=`Array must contain ${t.exact?"exactly":t.inclusive?"at least":"more than"} ${t.minimum} element(s)`:t.type==="string"?r=`String must contain ${t.exact?"exactly":t.inclusive?"at least":"over"} ${t.minimum} character(s)`:t.type==="number"?r=`Number must be ${t.exact?"exactly equal to ":t.inclusive?"greater than or equal to ":"greater than "}${t.minimum}`:t.type==="bigint"?r=`Number must be ${t.exact?"exactly equal to ":t.inclusive?"greater than or equal to ":"greater than "}${t.minimum}`:t.type==="date"?r=`Date must be ${t.exact?"exactly equal to ":t.inclusive?"greater than or equal to ":"greater than "}${new Date(Number(t.minimum))}`:r="Invalid input";break;case k.too_big:t.type==="array"?r=`Array must contain ${t.exact?"exactly":t.inclusive?"at most":"less than"} ${t.maximum} element(s)`:t.type==="string"?r=`String must contain ${t.exact?"exactly":t.inclusive?"at most":"under"} ${t.maximum} character(s)`:t.type==="number"?r=`Number must be ${t.exact?"exactly":t.inclusive?"less than or equal to":"less than"} ${t.maximum}`:t.type==="bigint"?r=`BigInt must be ${t.exact?"exactly":t.inclusive?"less than or equal to":"less than"} ${t.maximum}`:t.type==="date"?r=`Date must be ${t.exact?"exactly":t.inclusive?"smaller than or equal to":"smaller than"} ${new Date(Number(t.maximum))}`:r="Invalid input";break;case k.custom:r="Invalid input";break;case k.invalid_intersection_types:r="Intersection results could not be merged";break;case k.not_multiple_of:r=`Number must be a multiple of ${t.multipleOf}`;break;case k.not_finite:r="Number must be finite";break;default:r=e.defaultError,te.assertNever(t)}return{message:r}},ir=O$;var Vf=ir;function N$(t){Vf=t}function Ln(){return Vf}var As=t=>{let{data:e,path:r,errorMaps:n,issueData:s}=t,o=[...r,...s.path||[]],i={...s,path:o};if(s.message!==void 0)return{...s,path:o,message:s.message};let a="",c=n.filter(u=>!!u).slice().reverse();for(let u of c)a=u(i,{data:e,defaultError:a}).message;return{...s,path:o,message:a}},j$=[];function E(t,e){let r=Ln(),n=As({issueData:e,data:t.data,path:t.path,errorMaps:[t.common.contextualErrorMap,t.schemaErrorMap,r,r===ir?void 0:ir].filter(s=>!!s)});t.common.issues.push(n)}var qe=class t{constructor(){this.value="valid"}dirty(){this.value==="valid"&&(this.value="dirty")}abort(){this.value!=="aborted"&&(this.value="aborted")}static mergeArray(e,r){let n=[];for(let s of r){if(s.status==="aborted")return A;s.status==="dirty"&&e.dirty(),n.push(s.value)}return{status:e.value,value:n}}static async mergeObjectAsync(e,r){let n=[];for(let s of r){let o=await s.key,i=await s.value;n.push({key:o,value:i})}return t.mergeObjectSync(e,n)}static mergeObjectSync(e,r){let n={};for(let s of r){let{key:o,value:i}=s;if(o.status==="aborted"||i.status==="aborted")return A;o.status==="dirty"&&e.dirty(),i.status==="dirty"&&e.dirty(),o.value!=="__proto__"&&(typeof i.value<"u"||s.alwaysSet)&&(n[o.value]=i.value)}return{status:e.value,value:n}}},A=Object.freeze({status:"aborted"}),Yr=t=>({status:"dirty",value:t}),Be=t=>({status:"valid",value:t}),$i=t=>t.status==="aborted",xi=t=>t.status==="dirty",kr=t=>t.status==="valid",Vn=t=>typeof Promise<"u"&&t instanceof Promise;var C;(function(t){t.errToObj=e=>typeof e=="string"?{message:e}:e||{},t.toString=e=>typeof e=="string"?e:e?.message})(C||(C={}));var vt=class{constructor(e,r,n,s){this._cachedPath=[],this.parent=e,this.data=r,this._path=n,this._key=s}get path(){return this._cachedPath.length||(Array.isArray(this._key)?this._cachedPath.push(...this._path,...this._key):this._cachedPath.push(...this._path,this._key)),this._cachedPath}},Ff=(t,e)=>{if(kr(e))return{success:!0,data:e.value};if(!t.common.issues.length)throw new Error("Validation failed but no issues detected.");return{success:!1,get error(){if(this._error)return this._error;let r=new it(t.common.issues);return this._error=r,this._error}}};function U(t){if(!t)return{};let{errorMap:e,invalid_type_error:r,required_error:n,description:s}=t;if(e&&(r||n))throw new Error(`Can't use "invalid_type_error" or "required_error" in conjunction with custom error map.`);return e?{errorMap:e,description:s}:{errorMap:(i,a)=>{let{message:c}=t;return i.code==="invalid_enum_value"?{message:c??a.defaultError}:typeof a.data>"u"?{message:c??n??a.defaultError}:i.code!=="invalid_type"?{message:a.defaultError}:{message:c??r??a.defaultError}},description:s}}var G=class{get description(){return this._def.description}_getType(e){return Ft(e.data)}_getOrReturnCtx(e,r){return r||{common:e.parent.common,data:e.data,parsedType:Ft(e.data),schemaErrorMap:this._def.errorMap,path:e.path,parent:e.parent}}_processInputParams(e){return{status:new qe,ctx:{common:e.parent.common,data:e.data,parsedType:Ft(e.data),schemaErrorMap:this._def.errorMap,path:e.path,parent:e.parent}}}_parseSync(e){let r=this._parse(e);if(Vn(r))throw new Error("Synchronous parse encountered promise.");return r}_parseAsync(e){let r=this._parse(e);return Promise.resolve(r)}parse(e,r){let n=this.safeParse(e,r);if(n.success)return n.data;throw n.error}safeParse(e,r){let n={common:{issues:[],async:r?.async??!1,contextualErrorMap:r?.errorMap},path:r?.path||[],schemaErrorMap:this._def.errorMap,parent:null,data:e,parsedType:Ft(e)},s=this._parseSync({data:e,path:n.path,parent:n});return Ff(n,s)}"~validate"(e){let r={common:{issues:[],async:!!this["~standard"].async},path:[],schemaErrorMap:this._def.errorMap,parent:null,data:e,parsedType:Ft(e)};if(!this["~standard"].async)try{let n=this._parseSync({data:e,path:[],parent:r});return kr(n)?{value:n.value}:{issues:r.common.issues}}catch(n){n?.message?.toLowerCase()?.includes("encountered")&&(this["~standard"].async=!0),r.common={issues:[],async:!0}}return this._parseAsync({data:e,path:[],parent:r}).then(n=>kr(n)?{value:n.value}:{issues:r.common.issues})}async parseAsync(e,r){let n=await this.safeParseAsync(e,r);if(n.success)return n.data;throw n.error}async safeParseAsync(e,r){let n={common:{issues:[],contextualErrorMap:r?.errorMap,async:!0},path:r?.path||[],schemaErrorMap:this._def.errorMap,parent:null,data:e,parsedType:Ft(e)},s=this._parse({data:e,path:n.path,parent:n}),o=await(Vn(s)?s:Promise.resolve(s));return Ff(n,o)}refine(e,r){let n=s=>typeof r=="string"||typeof r>"u"?{message:r}:typeof r=="function"?r(s):r;return this._refinement((s,o)=>{let i=e(s),a=()=>o.addIssue({code:k.custom,...n(s)});return typeof Promise<"u"&&i instanceof Promise?i.then(c=>c?!0:(a(),!1)):i?!0:(a(),!1)})}refinement(e,r){return this._refinement((n,s)=>e(n)?!0:(s.addIssue(typeof r=="function"?r(n,s):r),!1))}_refinement(e){return new _t({schema:this,typeName:q.ZodEffects,effect:{type:"refinement",refinement:e}})}superRefine(e){return this._refinement(e)}constructor(e){this.spa=this.safeParseAsync,this._def=e,this.parse=this.parse.bind(this),this.safeParse=this.safeParse.bind(this),this.parseAsync=this.parseAsync.bind(this),this.safeParseAsync=this.safeParseAsync.bind(this),this.spa=this.spa.bind(this),this.refine=this.refine.bind(this),this.refinement=this.refinement.bind(this),this.superRefine=this.superRefine.bind(this),this.optional=this.optional.bind(this),this.nullable=this.nullable.bind(this),this.nullish=this.nullish.bind(this),this.array=this.array.bind(this),this.promise=this.promise.bind(this),this.or=this.or.bind(this),this.and=this.and.bind(this),this.transform=this.transform.bind(this),this.brand=this.brand.bind(this),this.default=this.default.bind(this),this.catch=this.catch.bind(this),this.describe=this.describe.bind(this),this.pipe=this.pipe.bind(this),this.readonly=this.readonly.bind(this),this.isNullable=this.isNullable.bind(this),this.isOptional=this.isOptional.bind(this),this["~standard"]={version:1,vendor:"zod",validate:r=>this["~validate"](r)}}optional(){return yt.create(this,this._def)}nullable(){return Ht.create(this,this._def)}nullish(){return this.nullable().optional()}array(){return ur.create(this)}promise(){return Er.create(this,this._def)}or(e){return sn.create([this,e],this._def)}and(e){return on.create(this,e,this._def)}transform(e){return new _t({...U(this._def),schema:this,typeName:q.ZodEffects,effect:{type:"transform",transform:e}})}default(e){let r=typeof e=="function"?e:()=>e;return new dn({...U(this._def),innerType:this,defaultValue:r,typeName:q.ZodDefault})}brand(){return new Ms({typeName:q.ZodBranded,type:this,...U(this._def)})}catch(e){let r=typeof e=="function"?e:()=>e;return new pn({...U(this._def),innerType:this,catchValue:r,typeName:q.ZodCatch})}describe(e){let r=this.constructor;return new r({...this._def,description:e})}pipe(e){return qs.create(this,e)}readonly(){return fn.create(this)}isOptional(){return this.safeParse(void 0).success}isNullable(){return this.safeParse(null).success}},A$=/^c[^\s-]{8,}$/i,M$=/^[0-9a-z]+$/,q$=/^[0-9A-HJKMNP-TV-Z]{26}$/i,D$=/^[0-9a-fA-F]{8}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{12}$/i,Z$=/^[a-z0-9_-]{21}$/i,L$=/^[A-Za-z0-9-_]+\.[A-Za-z0-9-_]+\.[A-Za-z0-9-_]*$/,V$=/^[-+]?P(?!$)(?:(?:[-+]?\d+Y)|(?:[-+]?\d+[.,]\d+Y$))?(?:(?:[-+]?\d+M)|(?:[-+]?\d+[.,]\d+M$))?(?:(?:[-+]?\d+W)|(?:[-+]?\d+[.,]\d+W$))?(?:(?:[-+]?\d+D)|(?:[-+]?\d+[.,]\d+D$))?(?:T(?=[\d+-])(?:(?:[-+]?\d+H)|(?:[-+]?\d+[.,]\d+H$))?(?:(?:[-+]?\d+M)|(?:[-+]?\d+[.,]\d+M$))?(?:[-+]?\d+(?:[.,]\d+)?S)?)??$/,F$=/^(?!\.)(?!.*\.\.)([A-Z0-9_'+\-\.]*)[A-Z0-9_+-]@([A-Z0-9][A-Z0-9\-]*\.)+[A-Z]{2,}$/i,U$="^(\\p{Extended_Pictographic}|\\p{Emoji_Component})+$",Nc,H$=/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])$/,K$=/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\/(3[0-2]|[12]?[0-9])$/,B$=/^(([0-9a-fA-F]{1,4}:){7,7}[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,7}:|([0-9a-fA-F]{1,4}:){1,6}:[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,5}(:[0-9a-fA-F]{1,4}){1,2}|([0-9a-fA-F]{1,4}:){1,4}(:[0-9a-fA-F]{1,4}){1,3}|([0-9a-fA-F]{1,4}:){1,3}(:[0-9a-fA-F]{1,4}){1,4}|([0-9a-fA-F]{1,4}:){1,2}(:[0-9a-fA-F]{1,4}){1,5}|[0-9a-fA-F]{1,4}:((:[0-9a-fA-F]{1,4}){1,6})|:((:[0-9a-fA-F]{1,4}){1,7}|:)|fe80:(:[0-9a-fA-F]{0,4}){0,4}%[0-9a-zA-Z]{1,}|::(ffff(:0{1,4}){0,1}:){0,1}((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])|([0-9a-fA-F]{1,4}:){1,4}:((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9]))$/,G$=/^(([0-9a-fA-F]{1,4}:){7,7}[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,7}:|([0-9a-fA-F]{1,4}:){1,6}:[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,5}(:[0-9a-fA-F]{1,4}){1,2}|([0-9a-fA-F]{1,4}:){1,4}(:[0-9a-fA-F]{1,4}){1,3}|([0-9a-fA-F]{1,4}:){1,3}(:[0-9a-fA-F]{1,4}){1,4}|([0-9a-fA-F]{1,4}:){1,2}(:[0-9a-fA-F]{1,4}){1,5}|[0-9a-fA-F]{1,4}:((:[0-9a-fA-F]{1,4}){1,6})|:((:[0-9a-fA-F]{1,4}){1,7}|:)|fe80:(:[0-9a-fA-F]{0,4}){0,4}%[0-9a-zA-Z]{1,}|::(ffff(:0{1,4}){0,1}:){0,1}((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])|([0-9a-fA-F]{1,4}:){1,4}:((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9]))\/(12[0-8]|1[01][0-9]|[1-9]?[0-9])$/,W$=/^([0-9a-zA-Z+/]{4})*(([0-9a-zA-Z+/]{2}==)|([0-9a-zA-Z+/]{3}=))?$/,J$=/^([0-9a-zA-Z-_]{4})*(([0-9a-zA-Z-_]{2}(==)?)|([0-9a-zA-Z-_]{3}(=)?))?$/,Hf="((\\d\\d[2468][048]|\\d\\d[13579][26]|\\d\\d0[48]|[02468][048]00|[13579][26]00)-02-29|\\d{4}-((0[13578]|1[02])-(0[1-9]|[12]\\d|3[01])|(0[469]|11)-(0[1-9]|[12]\\d|30)|(02)-(0[1-9]|1\\d|2[0-8])))",Y$=new RegExp(`^${Hf}$`);function Kf(t){let e="[0-5]\\d";t.precision?e=`${e}\\.\\d{${t.precision}}`:t.precision==null&&(e=`${e}(\\.\\d+)?`);let r=t.precision?"+":"?";return`([01]\\d|2[0-3]):[0-5]\\d(:${e})${r}`}function Q$(t){return new RegExp(`^${Kf(t)}$`)}function Bf(t){let e=`${Hf}T${Kf(t)}`,r=[];return r.push(t.local?"Z?":"Z"),t.offset&&r.push("([+-]\\d{2}:?\\d{2})"),e=`${e}(${r.join("|")})`,new RegExp(`^${e}$`)}function X$(t,e){return!!((e==="v4"||!e)&&H$.test(t)||(e==="v6"||!e)&&B$.test(t))}function ex(t,e){if(!L$.test(t))return!1;try{let[r]=t.split(".");if(!r)return!1;let n=r.replace(/-/g,"+").replace(/_/g,"/").padEnd(r.length+(4-r.length%4)%4,"="),s=JSON.parse(atob(n));return!(typeof s!="object"||s===null||"typ"in s&&s?.typ!=="JWT"||!s.alg||e&&s.alg!==e)}catch{return!1}}function tx(t,e){return!!((e==="v4"||!e)&&K$.test(t)||(e==="v6"||!e)&&G$.test(t))}var Sr=class t extends G{_parse(e){if(this._def.coerce&&(e.data=String(e.data)),this._getType(e)!==z.string){let o=this._getOrReturnCtx(e);return E(o,{code:k.invalid_type,expected:z.string,received:o.parsedType}),A}let n=new qe,s;for(let o of this._def.checks)if(o.kind==="min")e.data.length<o.value&&(s=this._getOrReturnCtx(e,s),E(s,{code:k.too_small,minimum:o.value,type:"string",inclusive:!0,exact:!1,message:o.message}),n.dirty());else if(o.kind==="max")e.data.length>o.value&&(s=this._getOrReturnCtx(e,s),E(s,{code:k.too_big,maximum:o.value,type:"string",inclusive:!0,exact:!1,message:o.message}),n.dirty());else if(o.kind==="length"){let i=e.data.length>o.value,a=e.data.length<o.value;(i||a)&&(s=this._getOrReturnCtx(e,s),i?E(s,{code:k.too_big,maximum:o.value,type:"string",inclusive:!0,exact:!0,message:o.message}):a&&E(s,{code:k.too_small,minimum:o.value,type:"string",inclusive:!0,exact:!0,message:o.message}),n.dirty())}else if(o.kind==="email")F$.test(e.data)||(s=this._getOrReturnCtx(e,s),E(s,{validation:"email",code:k.invalid_string,message:o.message}),n.dirty());else if(o.kind==="emoji")Nc||(Nc=new RegExp(U$,"u")),Nc.test(e.data)||(s=this._getOrReturnCtx(e,s),E(s,{validation:"emoji",code:k.invalid_string,message:o.message}),n.dirty());else if(o.kind==="uuid")D$.test(e.data)||(s=this._getOrReturnCtx(e,s),E(s,{validation:"uuid",code:k.invalid_string,message:o.message}),n.dirty());else if(o.kind==="nanoid")Z$.test(e.data)||(s=this._getOrReturnCtx(e,s),E(s,{validation:"nanoid",code:k.invalid_string,message:o.message}),n.dirty());else if(o.kind==="cuid")A$.test(e.data)||(s=this._getOrReturnCtx(e,s),E(s,{validation:"cuid",code:k.invalid_string,message:o.message}),n.dirty());else if(o.kind==="cuid2")M$.test(e.data)||(s=this._getOrReturnCtx(e,s),E(s,{validation:"cuid2",code:k.invalid_string,message:o.message}),n.dirty());else if(o.kind==="ulid")q$.test(e.data)||(s=this._getOrReturnCtx(e,s),E(s,{validation:"ulid",code:k.invalid_string,message:o.message}),n.dirty());else if(o.kind==="url")try{new URL(e.data)}catch{s=this._getOrReturnCtx(e,s),E(s,{validation:"url",code:k.invalid_string,message:o.message}),n.dirty()}else o.kind==="regex"?(o.regex.lastIndex=0,o.regex.test(e.data)||(s=this._getOrReturnCtx(e,s),E(s,{validation:"regex",code:k.invalid_string,message:o.message}),n.dirty())):o.kind==="trim"?e.data=e.data.trim():o.kind==="includes"?e.data.includes(o.value,o.position)||(s=this._getOrReturnCtx(e,s),E(s,{code:k.invalid_string,validation:{includes:o.value,position:o.position},message:o.message}),n.dirty()):o.kind==="toLowerCase"?e.data=e.data.toLowerCase():o.kind==="toUpperCase"?e.data=e.data.toUpperCase():o.kind==="startsWith"?e.data.startsWith(o.value)||(s=this._getOrReturnCtx(e,s),E(s,{code:k.invalid_string,validation:{startsWith:o.value},message:o.message}),n.dirty()):o.kind==="endsWith"?e.data.endsWith(o.value)||(s=this._getOrReturnCtx(e,s),E(s,{code:k.invalid_string,validation:{endsWith:o.value},message:o.message}),n.dirty()):o.kind==="datetime"?Bf(o).test(e.data)||(s=this._getOrReturnCtx(e,s),E(s,{code:k.invalid_string,validation:"datetime",message:o.message}),n.dirty()):o.kind==="date"?Y$.test(e.data)||(s=this._getOrReturnCtx(e,s),E(s,{code:k.invalid_string,validation:"date",message:o.message}),n.dirty()):o.kind==="time"?Q$(o).test(e.data)||(s=this._getOrReturnCtx(e,s),E(s,{code:k.invalid_string,validation:"time",message:o.message}),n.dirty()):o.kind==="duration"?V$.test(e.data)||(s=this._getOrReturnCtx(e,s),E(s,{validation:"duration",code:k.invalid_string,message:o.message}),n.dirty()):o.kind==="ip"?X$(e.data,o.version)||(s=this._getOrReturnCtx(e,s),E(s,{validation:"ip",code:k.invalid_string,message:o.message}),n.dirty()):o.kind==="jwt"?ex(e.data,o.alg)||(s=this._getOrReturnCtx(e,s),E(s,{validation:"jwt",code:k.invalid_string,message:o.message}),n.dirty()):o.kind==="cidr"?tx(e.data,o.version)||(s=this._getOrReturnCtx(e,s),E(s,{validation:"cidr",code:k.invalid_string,message:o.message}),n.dirty()):o.kind==="base64"?W$.test(e.data)||(s=this._getOrReturnCtx(e,s),E(s,{validation:"base64",code:k.invalid_string,message:o.message}),n.dirty()):o.kind==="base64url"?J$.test(e.data)||(s=this._getOrReturnCtx(e,s),E(s,{validation:"base64url",code:k.invalid_string,message:o.message}),n.dirty()):te.assertNever(o);return{status:n.value,value:e.data}}_regex(e,r,n){return this.refinement(s=>e.test(s),{validation:r,code:k.invalid_string,...C.errToObj(n)})}_addCheck(e){return new t({...this._def,checks:[...this._def.checks,e]})}email(e){return this._addCheck({kind:"email",...C.errToObj(e)})}url(e){return this._addCheck({kind:"url",...C.errToObj(e)})}emoji(e){return this._addCheck({kind:"emoji",...C.errToObj(e)})}uuid(e){return this._addCheck({kind:"uuid",...C.errToObj(e)})}nanoid(e){return this._addCheck({kind:"nanoid",...C.errToObj(e)})}cuid(e){return this._addCheck({kind:"cuid",...C.errToObj(e)})}cuid2(e){return this._addCheck({kind:"cuid2",...C.errToObj(e)})}ulid(e){return this._addCheck({kind:"ulid",...C.errToObj(e)})}base64(e){return this._addCheck({kind:"base64",...C.errToObj(e)})}base64url(e){return this._addCheck({kind:"base64url",...C.errToObj(e)})}jwt(e){return this._addCheck({kind:"jwt",...C.errToObj(e)})}ip(e){return this._addCheck({kind:"ip",...C.errToObj(e)})}cidr(e){return this._addCheck({kind:"cidr",...C.errToObj(e)})}datetime(e){return typeof e=="string"?this._addCheck({kind:"datetime",precision:null,offset:!1,local:!1,message:e}):this._addCheck({kind:"datetime",precision:typeof e?.precision>"u"?null:e?.precision,offset:e?.offset??!1,local:e?.local??!1,...C.errToObj(e?.message)})}date(e){return this._addCheck({kind:"date",message:e})}time(e){return typeof e=="string"?this._addCheck({kind:"time",precision:null,message:e}):this._addCheck({kind:"time",precision:typeof e?.precision>"u"?null:e?.precision,...C.errToObj(e?.message)})}duration(e){return this._addCheck({kind:"duration",...C.errToObj(e)})}regex(e,r){return this._addCheck({kind:"regex",regex:e,...C.errToObj(r)})}includes(e,r){return this._addCheck({kind:"includes",value:e,position:r?.position,...C.errToObj(r?.message)})}startsWith(e,r){return this._addCheck({kind:"startsWith",value:e,...C.errToObj(r)})}endsWith(e,r){return this._addCheck({kind:"endsWith",value:e,...C.errToObj(r)})}min(e,r){return this._addCheck({kind:"min",value:e,...C.errToObj(r)})}max(e,r){return this._addCheck({kind:"max",value:e,...C.errToObj(r)})}length(e,r){return this._addCheck({kind:"length",value:e,...C.errToObj(r)})}nonempty(e){return this.min(1,C.errToObj(e))}trim(){return new t({...this._def,checks:[...this._def.checks,{kind:"trim"}]})}toLowerCase(){return new t({...this._def,checks:[...this._def.checks,{kind:"toLowerCase"}]})}toUpperCase(){return new t({...this._def,checks:[...this._def.checks,{kind:"toUpperCase"}]})}get isDatetime(){return!!this._def.checks.find(e=>e.kind==="datetime")}get isDate(){return!!this._def.checks.find(e=>e.kind==="date")}get isTime(){return!!this._def.checks.find(e=>e.kind==="time")}get isDuration(){return!!this._def.checks.find(e=>e.kind==="duration")}get isEmail(){return!!this._def.checks.find(e=>e.kind==="email")}get isURL(){return!!this._def.checks.find(e=>e.kind==="url")}get isEmoji(){return!!this._def.checks.find(e=>e.kind==="emoji")}get isUUID(){return!!this._def.checks.find(e=>e.kind==="uuid")}get isNANOID(){return!!this._def.checks.find(e=>e.kind==="nanoid")}get isCUID(){return!!this._def.checks.find(e=>e.kind==="cuid")}get isCUID2(){return!!this._def.checks.find(e=>e.kind==="cuid2")}get isULID(){return!!this._def.checks.find(e=>e.kind==="ulid")}get isIP(){return!!this._def.checks.find(e=>e.kind==="ip")}get isCIDR(){return!!this._def.checks.find(e=>e.kind==="cidr")}get isBase64(){return!!this._def.checks.find(e=>e.kind==="base64")}get isBase64url(){return!!this._def.checks.find(e=>e.kind==="base64url")}get minLength(){let e=null;for(let r of this._def.checks)r.kind==="min"&&(e===null||r.value>e)&&(e=r.value);return e}get maxLength(){let e=null;for(let r of this._def.checks)r.kind==="max"&&(e===null||r.value<e)&&(e=r.value);return e}};Sr.create=t=>new Sr({checks:[],typeName:q.ZodString,coerce:t?.coerce??!1,...U(t)});function rx(t,e){let r=(t.toString().split(".")[1]||"").length,n=(e.toString().split(".")[1]||"").length,s=r>n?r:n,o=Number.parseInt(t.toFixed(s).replace(".","")),i=Number.parseInt(e.toFixed(s).replace(".",""));return o%i/10**s}var Qr=class t extends G{constructor(){super(...arguments),this.min=this.gte,this.max=this.lte,this.step=this.multipleOf}_parse(e){if(this._def.coerce&&(e.data=Number(e.data)),this._getType(e)!==z.number){let o=this._getOrReturnCtx(e);return E(o,{code:k.invalid_type,expected:z.number,received:o.parsedType}),A}let n,s=new qe;for(let o of this._def.checks)o.kind==="int"?te.isInteger(e.data)||(n=this._getOrReturnCtx(e,n),E(n,{code:k.invalid_type,expected:"integer",received:"float",message:o.message}),s.dirty()):o.kind==="min"?(o.inclusive?e.data<o.value:e.data<=o.value)&&(n=this._getOrReturnCtx(e,n),E(n,{code:k.too_small,minimum:o.value,type:"number",inclusive:o.inclusive,exact:!1,message:o.message}),s.dirty()):o.kind==="max"?(o.inclusive?e.data>o.value:e.data>=o.value)&&(n=this._getOrReturnCtx(e,n),E(n,{code:k.too_big,maximum:o.value,type:"number",inclusive:o.inclusive,exact:!1,message:o.message}),s.dirty()):o.kind==="multipleOf"?rx(e.data,o.value)!==0&&(n=this._getOrReturnCtx(e,n),E(n,{code:k.not_multiple_of,multipleOf:o.value,message:o.message}),s.dirty()):o.kind==="finite"?Number.isFinite(e.data)||(n=this._getOrReturnCtx(e,n),E(n,{code:k.not_finite,message:o.message}),s.dirty()):te.assertNever(o);return{status:s.value,value:e.data}}gte(e,r){return this.setLimit("min",e,!0,C.toString(r))}gt(e,r){return this.setLimit("min",e,!1,C.toString(r))}lte(e,r){return this.setLimit("max",e,!0,C.toString(r))}lt(e,r){return this.setLimit("max",e,!1,C.toString(r))}setLimit(e,r,n,s){return new t({...this._def,checks:[...this._def.checks,{kind:e,value:r,inclusive:n,message:C.toString(s)}]})}_addCheck(e){return new t({...this._def,checks:[...this._def.checks,e]})}int(e){return this._addCheck({kind:"int",message:C.toString(e)})}positive(e){return this._addCheck({kind:"min",value:0,inclusive:!1,message:C.toString(e)})}negative(e){return this._addCheck({kind:"max",value:0,inclusive:!1,message:C.toString(e)})}nonpositive(e){return this._addCheck({kind:"max",value:0,inclusive:!0,message:C.toString(e)})}nonnegative(e){return this._addCheck({kind:"min",value:0,inclusive:!0,message:C.toString(e)})}multipleOf(e,r){return this._addCheck({kind:"multipleOf",value:e,message:C.toString(r)})}finite(e){return this._addCheck({kind:"finite",message:C.toString(e)})}safe(e){return this._addCheck({kind:"min",inclusive:!0,value:Number.MIN_SAFE_INTEGER,message:C.toString(e)})._addCheck({kind:"max",inclusive:!0,value:Number.MAX_SAFE_INTEGER,message:C.toString(e)})}get minValue(){let e=null;for(let r of this._def.checks)r.kind==="min"&&(e===null||r.value>e)&&(e=r.value);return e}get maxValue(){let e=null;for(let r of this._def.checks)r.kind==="max"&&(e===null||r.value<e)&&(e=r.value);return e}get isInt(){return!!this._def.checks.find(e=>e.kind==="int"||e.kind==="multipleOf"&&te.isInteger(e.value))}get isFinite(){let e=null,r=null;for(let n of this._def.checks){if(n.kind==="finite"||n.kind==="int"||n.kind==="multipleOf")return!0;n.kind==="min"?(r===null||n.value>r)&&(r=n.value):n.kind==="max"&&(e===null||n.value<e)&&(e=n.value)}return Number.isFinite(r)&&Number.isFinite(e)}};Qr.create=t=>new Qr({checks:[],typeName:q.ZodNumber,coerce:t?.coerce||!1,...U(t)});var Xr=class t extends G{constructor(){super(...arguments),this.min=this.gte,this.max=this.lte}_parse(e){if(this._def.coerce)try{e.data=BigInt(e.data)}catch{return this._getInvalidInput(e)}if(this._getType(e)!==z.bigint)return this._getInvalidInput(e);let n,s=new qe;for(let o of this._def.checks)o.kind==="min"?(o.inclusive?e.data<o.value:e.data<=o.value)&&(n=this._getOrReturnCtx(e,n),E(n,{code:k.too_small,type:"bigint",minimum:o.value,inclusive:o.inclusive,message:o.message}),s.dirty()):o.kind==="max"?(o.inclusive?e.data>o.value:e.data>=o.value)&&(n=this._getOrReturnCtx(e,n),E(n,{code:k.too_big,type:"bigint",maximum:o.value,inclusive:o.inclusive,message:o.message}),s.dirty()):o.kind==="multipleOf"?e.data%o.value!==BigInt(0)&&(n=this._getOrReturnCtx(e,n),E(n,{code:k.not_multiple_of,multipleOf:o.value,message:o.message}),s.dirty()):te.assertNever(o);return{status:s.value,value:e.data}}_getInvalidInput(e){let r=this._getOrReturnCtx(e);return E(r,{code:k.invalid_type,expected:z.bigint,received:r.parsedType}),A}gte(e,r){return this.setLimit("min",e,!0,C.toString(r))}gt(e,r){return this.setLimit("min",e,!1,C.toString(r))}lte(e,r){return this.setLimit("max",e,!0,C.toString(r))}lt(e,r){return this.setLimit("max",e,!1,C.toString(r))}setLimit(e,r,n,s){return new t({...this._def,checks:[...this._def.checks,{kind:e,value:r,inclusive:n,message:C.toString(s)}]})}_addCheck(e){return new t({...this._def,checks:[...this._def.checks,e]})}positive(e){return this._addCheck({kind:"min",value:BigInt(0),inclusive:!1,message:C.toString(e)})}negative(e){return this._addCheck({kind:"max",value:BigInt(0),inclusive:!1,message:C.toString(e)})}nonpositive(e){return this._addCheck({kind:"max",value:BigInt(0),inclusive:!0,message:C.toString(e)})}nonnegative(e){return this._addCheck({kind:"min",value:BigInt(0),inclusive:!0,message:C.toString(e)})}multipleOf(e,r){return this._addCheck({kind:"multipleOf",value:e,message:C.toString(r)})}get minValue(){let e=null;for(let r of this._def.checks)r.kind==="min"&&(e===null||r.value>e)&&(e=r.value);return e}get maxValue(){let e=null;for(let r of this._def.checks)r.kind==="max"&&(e===null||r.value<e)&&(e=r.value);return e}};Xr.create=t=>new Xr({checks:[],typeName:q.ZodBigInt,coerce:t?.coerce??!1,...U(t)});var en=class extends G{_parse(e){if(this._def.coerce&&(e.data=!!e.data),this._getType(e)!==z.boolean){let n=this._getOrReturnCtx(e);return E(n,{code:k.invalid_type,expected:z.boolean,received:n.parsedType}),A}return Be(e.data)}};en.create=t=>new en({typeName:q.ZodBoolean,coerce:t?.coerce||!1,...U(t)});var tn=class t extends G{_parse(e){if(this._def.coerce&&(e.data=new Date(e.data)),this._getType(e)!==z.date){let o=this._getOrReturnCtx(e);return E(o,{code:k.invalid_type,expected:z.date,received:o.parsedType}),A}if(Number.isNaN(e.data.getTime())){let o=this._getOrReturnCtx(e);return E(o,{code:k.invalid_date}),A}let n=new qe,s;for(let o of this._def.checks)o.kind==="min"?e.data.getTime()<o.value&&(s=this._getOrReturnCtx(e,s),E(s,{code:k.too_small,message:o.message,inclusive:!0,exact:!1,minimum:o.value,type:"date"}),n.dirty()):o.kind==="max"?e.data.getTime()>o.value&&(s=this._getOrReturnCtx(e,s),E(s,{code:k.too_big,message:o.message,inclusive:!0,exact:!1,maximum:o.value,type:"date"}),n.dirty()):te.assertNever(o);return{status:n.value,value:new Date(e.data.getTime())}}_addCheck(e){return new t({...this._def,checks:[...this._def.checks,e]})}min(e,r){return this._addCheck({kind:"min",value:e.getTime(),message:C.toString(r)})}max(e,r){return this._addCheck({kind:"max",value:e.getTime(),message:C.toString(r)})}get minDate(){let e=null;for(let r of this._def.checks)r.kind==="min"&&(e===null||r.value>e)&&(e=r.value);return e!=null?new Date(e):null}get maxDate(){let e=null;for(let r of this._def.checks)r.kind==="max"&&(e===null||r.value<e)&&(e=r.value);return e!=null?new Date(e):null}};tn.create=t=>new tn({checks:[],coerce:t?.coerce||!1,typeName:q.ZodDate,...U(t)});var Un=class extends G{_parse(e){if(this._getType(e)!==z.symbol){let n=this._getOrReturnCtx(e);return E(n,{code:k.invalid_type,expected:z.symbol,received:n.parsedType}),A}return Be(e.data)}};Un.create=t=>new Un({typeName:q.ZodSymbol,...U(t)});var rn=class extends G{_parse(e){if(this._getType(e)!==z.undefined){let n=this._getOrReturnCtx(e);return E(n,{code:k.invalid_type,expected:z.undefined,received:n.parsedType}),A}return Be(e.data)}};rn.create=t=>new rn({typeName:q.ZodUndefined,...U(t)});var nn=class extends G{_parse(e){if(this._getType(e)!==z.null){let n=this._getOrReturnCtx(e);return E(n,{code:k.invalid_type,expected:z.null,received:n.parsedType}),A}return Be(e.data)}};nn.create=t=>new nn({typeName:q.ZodNull,...U(t)});var Pr=class extends G{constructor(){super(...arguments),this._any=!0}_parse(e){return Be(e.data)}};Pr.create=t=>new Pr({typeName:q.ZodAny,...U(t)});var cr=class extends G{constructor(){super(...arguments),this._unknown=!0}_parse(e){return Be(e.data)}};cr.create=t=>new cr({typeName:q.ZodUnknown,...U(t)});var It=class extends G{_parse(e){let r=this._getOrReturnCtx(e);return E(r,{code:k.invalid_type,expected:z.never,received:r.parsedType}),A}};It.create=t=>new It({typeName:q.ZodNever,...U(t)});var Hn=class extends G{_parse(e){if(this._getType(e)!==z.undefined){let n=this._getOrReturnCtx(e);return E(n,{code:k.invalid_type,expected:z.void,received:n.parsedType}),A}return Be(e.data)}};Hn.create=t=>new Hn({typeName:q.ZodVoid,...U(t)});var ur=class t extends G{_parse(e){let{ctx:r,status:n}=this._processInputParams(e),s=this._def;if(r.parsedType!==z.array)return E(r,{code:k.invalid_type,expected:z.array,received:r.parsedType}),A;if(s.exactLength!==null){let i=r.data.length>s.exactLength.value,a=r.data.length<s.exactLength.value;(i||a)&&(E(r,{code:i?k.too_big:k.too_small,minimum:a?s.exactLength.value:void 0,maximum:i?s.exactLength.value:void 0,type:"array",inclusive:!0,exact:!0,message:s.exactLength.message}),n.dirty())}if(s.minLength!==null&&r.data.length<s.minLength.value&&(E(r,{code:k.too_small,minimum:s.minLength.value,type:"array",inclusive:!0,exact:!1,message:s.minLength.message}),n.dirty()),s.maxLength!==null&&r.data.length>s.maxLength.value&&(E(r,{code:k.too_big,maximum:s.maxLength.value,type:"array",inclusive:!0,exact:!1,message:s.maxLength.message}),n.dirty()),r.common.async)return Promise.all([...r.data].map((i,a)=>s.type._parseAsync(new vt(r,i,r.path,a)))).then(i=>qe.mergeArray(n,i));let o=[...r.data].map((i,a)=>s.type._parseSync(new vt(r,i,r.path,a)));return qe.mergeArray(n,o)}get element(){return this._def.type}min(e,r){return new t({...this._def,minLength:{value:e,message:C.toString(r)}})}max(e,r){return new t({...this._def,maxLength:{value:e,message:C.toString(r)}})}length(e,r){return new t({...this._def,exactLength:{value:e,message:C.toString(r)}})}nonempty(e){return this.min(1,e)}};ur.create=(t,e)=>new ur({type:t,minLength:null,maxLength:null,exactLength:null,typeName:q.ZodArray,...U(e)});function Fn(t){if(t instanceof at){let e={};for(let r in t.shape){let n=t.shape[r];e[r]=yt.create(Fn(n))}return new at({...t._def,shape:()=>e})}else return t instanceof ur?new ur({...t._def,type:Fn(t.element)}):t instanceof yt?yt.create(Fn(t.unwrap())):t instanceof Ht?Ht.create(Fn(t.unwrap())):t instanceof Ut?Ut.create(t.items.map(e=>Fn(e))):t}var at=class t extends G{constructor(){super(...arguments),this._cached=null,this.nonstrict=this.passthrough,this.augment=this.extend}_getCached(){if(this._cached!==null)return this._cached;let e=this._def.shape(),r=te.objectKeys(e);return this._cached={shape:e,keys:r},this._cached}_parse(e){if(this._getType(e)!==z.object){let u=this._getOrReturnCtx(e);return E(u,{code:k.invalid_type,expected:z.object,received:u.parsedType}),A}let{status:n,ctx:s}=this._processInputParams(e),{shape:o,keys:i}=this._getCached(),a=[];if(!(this._def.catchall instanceof It&&this._def.unknownKeys==="strip"))for(let u in s.data)i.includes(u)||a.push(u);let c=[];for(let u of i){let l=o[u],d=s.data[u];c.push({key:{status:"valid",value:u},value:l._parse(new vt(s,d,s.path,u)),alwaysSet:u in s.data})}if(this._def.catchall instanceof It){let u=this._def.unknownKeys;if(u==="passthrough")for(let l of a)c.push({key:{status:"valid",value:l},value:{status:"valid",value:s.data[l]}});else if(u==="strict")a.length>0&&(E(s,{code:k.unrecognized_keys,keys:a}),n.dirty());else if(u!=="strip")throw new Error("Internal ZodObject error: invalid unknownKeys value.")}else{let u=this._def.catchall;for(let l of a){let d=s.data[l];c.push({key:{status:"valid",value:l},value:u._parse(new vt(s,d,s.path,l)),alwaysSet:l in s.data})}}return s.common.async?Promise.resolve().then(async()=>{let u=[];for(let l of c){let d=await l.key,f=await l.value;u.push({key:d,value:f,alwaysSet:l.alwaysSet})}return u}).then(u=>qe.mergeObjectSync(n,u)):qe.mergeObjectSync(n,c)}get shape(){return this._def.shape()}strict(e){return C.errToObj,new t({...this._def,unknownKeys:"strict",...e!==void 0?{errorMap:(r,n)=>{let s=this._def.errorMap?.(r,n).message??n.defaultError;return r.code==="unrecognized_keys"?{message:C.errToObj(e).message??s}:{message:s}}}:{}})}strip(){return new t({...this._def,unknownKeys:"strip"})}passthrough(){return new t({...this._def,unknownKeys:"passthrough"})}extend(e){return new t({...this._def,shape:()=>({...this._def.shape(),...e})})}merge(e){return new t({unknownKeys:e._def.unknownKeys,catchall:e._def.catchall,shape:()=>({...this._def.shape(),...e._def.shape()}),typeName:q.ZodObject})}setKey(e,r){return this.augment({[e]:r})}catchall(e){return new t({...this._def,catchall:e})}pick(e){let r={};for(let n of te.objectKeys(e))e[n]&&this.shape[n]&&(r[n]=this.shape[n]);return new t({...this._def,shape:()=>r})}omit(e){let r={};for(let n of te.objectKeys(this.shape))e[n]||(r[n]=this.shape[n]);return new t({...this._def,shape:()=>r})}deepPartial(){return Fn(this)}partial(e){let r={};for(let n of te.objectKeys(this.shape)){let s=this.shape[n];e&&!e[n]?r[n]=s:r[n]=s.optional()}return new t({...this._def,shape:()=>r})}required(e){let r={};for(let n of te.objectKeys(this.shape))if(e&&!e[n])r[n]=this.shape[n];else{let o=this.shape[n];for(;o instanceof yt;)o=o._def.innerType;r[n]=o}return new t({...this._def,shape:()=>r})}keyof(){return Gf(te.objectKeys(this.shape))}};at.create=(t,e)=>new at({shape:()=>t,unknownKeys:"strip",catchall:It.create(),typeName:q.ZodObject,...U(e)});at.strictCreate=(t,e)=>new at({shape:()=>t,unknownKeys:"strict",catchall:It.create(),typeName:q.ZodObject,...U(e)});at.lazycreate=(t,e)=>new at({shape:t,unknownKeys:"strip",catchall:It.create(),typeName:q.ZodObject,...U(e)});var sn=class extends G{_parse(e){let{ctx:r}=this._processInputParams(e),n=this._def.options;function s(o){for(let a of o)if(a.result.status==="valid")return a.result;for(let a of o)if(a.result.status==="dirty")return r.common.issues.push(...a.ctx.common.issues),a.result;let i=o.map(a=>new it(a.ctx.common.issues));return E(r,{code:k.invalid_union,unionErrors:i}),A}if(r.common.async)return Promise.all(n.map(async o=>{let i={...r,common:{...r.common,issues:[]},parent:null};return{result:await o._parseAsync({data:r.data,path:r.path,parent:i}),ctx:i}})).then(s);{let o,i=[];for(let c of n){let u={...r,common:{...r.common,issues:[]},parent:null},l=c._parseSync({data:r.data,path:r.path,parent:u});if(l.status==="valid")return l;l.status==="dirty"&&!o&&(o={result:l,ctx:u}),u.common.issues.length&&i.push(u.common.issues)}if(o)return r.common.issues.push(...o.ctx.common.issues),o.result;let a=i.map(c=>new it(c));return E(r,{code:k.invalid_union,unionErrors:a}),A}}get options(){return this._def.options}};sn.create=(t,e)=>new sn({options:t,typeName:q.ZodUnion,...U(e)});var ar=t=>t instanceof an?ar(t.schema):t instanceof _t?ar(t.innerType()):t instanceof cn?[t.value]:t instanceof un?t.options:t instanceof ln?te.objectValues(t.enum):t instanceof dn?ar(t._def.innerType):t instanceof rn?[void 0]:t instanceof nn?[null]:t instanceof yt?[void 0,...ar(t.unwrap())]:t instanceof Ht?[null,...ar(t.unwrap())]:t instanceof Ms||t instanceof fn?ar(t.unwrap()):t instanceof pn?ar(t._def.innerType):[],ki=class t extends G{_parse(e){let{ctx:r}=this._processInputParams(e);if(r.parsedType!==z.object)return E(r,{code:k.invalid_type,expected:z.object,received:r.parsedType}),A;let n=this.discriminator,s=r.data[n],o=this.optionsMap.get(s);return o?r.common.async?o._parseAsync({data:r.data,path:r.path,parent:r}):o._parseSync({data:r.data,path:r.path,parent:r}):(E(r,{code:k.invalid_union_discriminator,options:Array.from(this.optionsMap.keys()),path:[n]}),A)}get discriminator(){return this._def.discriminator}get options(){return this._def.options}get optionsMap(){return this._def.optionsMap}static create(e,r,n){let s=new Map;for(let o of r){let i=ar(o.shape[e]);if(!i.length)throw new Error(`A discriminator value for key \`${e}\` could not be extracted from all schema options`);for(let a of i){if(s.has(a))throw new Error(`Discriminator property ${String(e)} has duplicate value ${String(a)}`);s.set(a,o)}}return new t({typeName:q.ZodDiscriminatedUnion,discriminator:e,options:r,optionsMap:s,...U(n)})}};function jc(t,e){let r=Ft(t),n=Ft(e);if(t===e)return{valid:!0,data:t};if(r===z.object&&n===z.object){let s=te.objectKeys(e),o=te.objectKeys(t).filter(a=>s.indexOf(a)!==-1),i={...t,...e};for(let a of o){let c=jc(t[a],e[a]);if(!c.valid)return{valid:!1};i[a]=c.data}return{valid:!0,data:i}}else if(r===z.array&&n===z.array){if(t.length!==e.length)return{valid:!1};let s=[];for(let o=0;o<t.length;o++){let i=t[o],a=e[o],c=jc(i,a);if(!c.valid)return{valid:!1};s.push(c.data)}return{valid:!0,data:s}}else return r===z.date&&n===z.date&&+t==+e?{valid:!0,data:t}:{valid:!1}}var on=class extends G{_parse(e){let{status:r,ctx:n}=this._processInputParams(e),s=(o,i)=>{if($i(o)||$i(i))return A;let a=jc(o.value,i.value);return a.valid?((xi(o)||xi(i))&&r.dirty(),{status:r.value,value:a.data}):(E(n,{code:k.invalid_intersection_types}),A)};return n.common.async?Promise.all([this._def.left._parseAsync({data:n.data,path:n.path,parent:n}),this._def.right._parseAsync({data:n.data,path:n.path,parent:n})]).then(([o,i])=>s(o,i)):s(this._def.left._parseSync({data:n.data,path:n.path,parent:n}),this._def.right._parseSync({data:n.data,path:n.path,parent:n}))}};on.create=(t,e,r)=>new on({left:t,right:e,typeName:q.ZodIntersection,...U(r)});var Ut=class t extends G{_parse(e){let{status:r,ctx:n}=this._processInputParams(e);if(n.parsedType!==z.array)return E(n,{code:k.invalid_type,expected:z.array,received:n.parsedType}),A;if(n.data.length<this._def.items.length)return E(n,{code:k.too_small,minimum:this._def.items.length,inclusive:!0,exact:!1,type:"array"}),A;!this._def.rest&&n.data.length>this._def.items.length&&(E(n,{code:k.too_big,maximum:this._def.items.length,inclusive:!0,exact:!1,type:"array"}),r.dirty());let o=[...n.data].map((i,a)=>{let c=this._def.items[a]||this._def.rest;return c?c._parse(new vt(n,i,n.path,a)):null}).filter(i=>!!i);return n.common.async?Promise.all(o).then(i=>qe.mergeArray(r,i)):qe.mergeArray(r,o)}get items(){return this._def.items}rest(e){return new t({...this._def,rest:e})}};Ut.create=(t,e)=>{if(!Array.isArray(t))throw new Error("You must pass an array of schemas to z.tuple([ ... ])");return new Ut({items:t,typeName:q.ZodTuple,rest:null,...U(e)})};var Si=class t extends G{get keySchema(){return this._def.keyType}get valueSchema(){return this._def.valueType}_parse(e){let{status:r,ctx:n}=this._processInputParams(e);if(n.parsedType!==z.object)return E(n,{code:k.invalid_type,expected:z.object,received:n.parsedType}),A;let s=[],o=this._def.keyType,i=this._def.valueType;for(let a in n.data)s.push({key:o._parse(new vt(n,a,n.path,a)),value:i._parse(new vt(n,n.data[a],n.path,a)),alwaysSet:a in n.data});return n.common.async?qe.mergeObjectAsync(r,s):qe.mergeObjectSync(r,s)}get element(){return this._def.valueType}static create(e,r,n){return r instanceof G?new t({keyType:e,valueType:r,typeName:q.ZodRecord,...U(n)}):new t({keyType:Sr.create(),valueType:e,typeName:q.ZodRecord,...U(r)})}},Kn=class extends G{get keySchema(){return this._def.keyType}get valueSchema(){return this._def.valueType}_parse(e){let{status:r,ctx:n}=this._processInputParams(e);if(n.parsedType!==z.map)return E(n,{code:k.invalid_type,expected:z.map,received:n.parsedType}),A;let s=this._def.keyType,o=this._def.valueType,i=[...n.data.entries()].map(([a,c],u)=>({key:s._parse(new vt(n,a,n.path,[u,"key"])),value:o._parse(new vt(n,c,n.path,[u,"value"]))}));if(n.common.async){let a=new Map;return Promise.resolve().then(async()=>{for(let c of i){let u=await c.key,l=await c.value;if(u.status==="aborted"||l.status==="aborted")return A;(u.status==="dirty"||l.status==="dirty")&&r.dirty(),a.set(u.value,l.value)}return{status:r.value,value:a}})}else{let a=new Map;for(let c of i){let u=c.key,l=c.value;if(u.status==="aborted"||l.status==="aborted")return A;(u.status==="dirty"||l.status==="dirty")&&r.dirty(),a.set(u.value,l.value)}return{status:r.value,value:a}}}};Kn.create=(t,e,r)=>new Kn({valueType:e,keyType:t,typeName:q.ZodMap,...U(r)});var Bn=class t extends G{_parse(e){let{status:r,ctx:n}=this._processInputParams(e);if(n.parsedType!==z.set)return E(n,{code:k.invalid_type,expected:z.set,received:n.parsedType}),A;let s=this._def;s.minSize!==null&&n.data.size<s.minSize.value&&(E(n,{code:k.too_small,minimum:s.minSize.value,type:"set",inclusive:!0,exact:!1,message:s.minSize.message}),r.dirty()),s.maxSize!==null&&n.data.size>s.maxSize.value&&(E(n,{code:k.too_big,maximum:s.maxSize.value,type:"set",inclusive:!0,exact:!1,message:s.maxSize.message}),r.dirty());let o=this._def.valueType;function i(c){let u=new Set;for(let l of c){if(l.status==="aborted")return A;l.status==="dirty"&&r.dirty(),u.add(l.value)}return{status:r.value,value:u}}let a=[...n.data.values()].map((c,u)=>o._parse(new vt(n,c,n.path,u)));return n.common.async?Promise.all(a).then(c=>i(c)):i(a)}min(e,r){return new t({...this._def,minSize:{value:e,message:C.toString(r)}})}max(e,r){return new t({...this._def,maxSize:{value:e,message:C.toString(r)}})}size(e,r){return this.min(e,r).max(e,r)}nonempty(e){return this.min(1,e)}};Bn.create=(t,e)=>new Bn({valueType:t,minSize:null,maxSize:null,typeName:q.ZodSet,...U(e)});var Pi=class t extends G{constructor(){super(...arguments),this.validate=this.implement}_parse(e){let{ctx:r}=this._processInputParams(e);if(r.parsedType!==z.function)return E(r,{code:k.invalid_type,expected:z.function,received:r.parsedType}),A;function n(a,c){return As({data:a,path:r.path,errorMaps:[r.common.contextualErrorMap,r.schemaErrorMap,Ln(),ir].filter(u=>!!u),issueData:{code:k.invalid_arguments,argumentsError:c}})}function s(a,c){return As({data:a,path:r.path,errorMaps:[r.common.contextualErrorMap,r.schemaErrorMap,Ln(),ir].filter(u=>!!u),issueData:{code:k.invalid_return_type,returnTypeError:c}})}let o={errorMap:r.common.contextualErrorMap},i=r.data;if(this._def.returns instanceof Er){let a=this;return Be(async function(...c){let u=new it([]),l=await a._def.args.parseAsync(c,o).catch(p=>{throw u.addIssue(n(c,p)),u}),d=await Reflect.apply(i,this,l);return await a._def.returns._def.type.parseAsync(d,o).catch(p=>{throw u.addIssue(s(d,p)),u})})}else{let a=this;return Be(function(...c){let u=a._def.args.safeParse(c,o);if(!u.success)throw new it([n(c,u.error)]);let l=Reflect.apply(i,this,u.data),d=a._def.returns.safeParse(l,o);if(!d.success)throw new it([s(l,d.error)]);return d.data})}}parameters(){return this._def.args}returnType(){return this._def.returns}args(...e){return new t({...this._def,args:Ut.create(e).rest(cr.create())})}returns(e){return new t({...this._def,returns:e})}implement(e){return this.parse(e)}strictImplement(e){return this.parse(e)}static create(e,r,n){return new t({args:e||Ut.create([]).rest(cr.create()),returns:r||cr.create(),typeName:q.ZodFunction,...U(n)})}},an=class extends G{get schema(){return this._def.getter()}_parse(e){let{ctx:r}=this._processInputParams(e);return this._def.getter()._parse({data:r.data,path:r.path,parent:r})}};an.create=(t,e)=>new an({getter:t,typeName:q.ZodLazy,...U(e)});var cn=class extends G{_parse(e){if(e.data!==this._def.value){let r=this._getOrReturnCtx(e);return E(r,{received:r.data,code:k.invalid_literal,expected:this._def.value}),A}return{status:"valid",value:e.data}}get value(){return this._def.value}};cn.create=(t,e)=>new cn({value:t,typeName:q.ZodLiteral,...U(e)});function Gf(t,e){return new un({values:t,typeName:q.ZodEnum,...U(e)})}var un=class t extends G{_parse(e){if(typeof e.data!="string"){let r=this._getOrReturnCtx(e),n=this._def.values;return E(r,{expected:te.joinValues(n),received:r.parsedType,code:k.invalid_type}),A}if(this._cache||(this._cache=new Set(this._def.values)),!this._cache.has(e.data)){let r=this._getOrReturnCtx(e),n=this._def.values;return E(r,{received:r.data,code:k.invalid_enum_value,options:n}),A}return Be(e.data)}get options(){return this._def.values}get enum(){let e={};for(let r of this._def.values)e[r]=r;return e}get Values(){let e={};for(let r of this._def.values)e[r]=r;return e}get Enum(){let e={};for(let r of this._def.values)e[r]=r;return e}extract(e,r=this._def){return t.create(e,{...this._def,...r})}exclude(e,r=this._def){return t.create(this.options.filter(n=>!e.includes(n)),{...this._def,...r})}};un.create=Gf;var ln=class extends G{_parse(e){let r=te.getValidEnumValues(this._def.values),n=this._getOrReturnCtx(e);if(n.parsedType!==z.string&&n.parsedType!==z.number){let s=te.objectValues(r);return E(n,{expected:te.joinValues(s),received:n.parsedType,code:k.invalid_type}),A}if(this._cache||(this._cache=new Set(te.getValidEnumValues(this._def.values))),!this._cache.has(e.data)){let s=te.objectValues(r);return E(n,{received:n.data,code:k.invalid_enum_value,options:s}),A}return Be(e.data)}get enum(){return this._def.values}};ln.create=(t,e)=>new ln({values:t,typeName:q.ZodNativeEnum,...U(e)});var Er=class extends G{unwrap(){return this._def.type}_parse(e){let{ctx:r}=this._processInputParams(e);if(r.parsedType!==z.promise&&r.common.async===!1)return E(r,{code:k.invalid_type,expected:z.promise,received:r.parsedType}),A;let n=r.parsedType===z.promise?r.data:Promise.resolve(r.data);return Be(n.then(s=>this._def.type.parseAsync(s,{path:r.path,errorMap:r.common.contextualErrorMap})))}};Er.create=(t,e)=>new Er({type:t,typeName:q.ZodPromise,...U(e)});var _t=class extends G{innerType(){return this._def.schema}sourceType(){return this._def.schema._def.typeName===q.ZodEffects?this._def.schema.sourceType():this._def.schema}_parse(e){let{status:r,ctx:n}=this._processInputParams(e),s=this._def.effect||null,o={addIssue:i=>{E(n,i),i.fatal?r.abort():r.dirty()},get path(){return n.path}};if(o.addIssue=o.addIssue.bind(o),s.type==="preprocess"){let i=s.transform(n.data,o);if(n.common.async)return Promise.resolve(i).then(async a=>{if(r.value==="aborted")return A;let c=await this._def.schema._parseAsync({data:a,path:n.path,parent:n});return c.status==="aborted"?A:c.status==="dirty"?Yr(c.value):r.value==="dirty"?Yr(c.value):c});{if(r.value==="aborted")return A;let a=this._def.schema._parseSync({data:i,path:n.path,parent:n});return a.status==="aborted"?A:a.status==="dirty"?Yr(a.value):r.value==="dirty"?Yr(a.value):a}}if(s.type==="refinement"){let i=a=>{let c=s.refinement(a,o);if(n.common.async)return Promise.resolve(c);if(c instanceof Promise)throw new Error("Async refinement encountered during synchronous parse operation. Use .parseAsync instead.");return a};if(n.common.async===!1){let a=this._def.schema._parseSync({data:n.data,path:n.path,parent:n});return a.status==="aborted"?A:(a.status==="dirty"&&r.dirty(),i(a.value),{status:r.value,value:a.value})}else return this._def.schema._parseAsync({data:n.data,path:n.path,parent:n}).then(a=>a.status==="aborted"?A:(a.status==="dirty"&&r.dirty(),i(a.value).then(()=>({status:r.value,value:a.value}))))}if(s.type==="transform")if(n.common.async===!1){let i=this._def.schema._parseSync({data:n.data,path:n.path,parent:n});if(!kr(i))return A;let a=s.transform(i.value,o);if(a instanceof Promise)throw new Error("Asynchronous transform encountered during synchronous parse operation. Use .parseAsync instead.");return{status:r.value,value:a}}else return this._def.schema._parseAsync({data:n.data,path:n.path,parent:n}).then(i=>kr(i)?Promise.resolve(s.transform(i.value,o)).then(a=>({status:r.value,value:a})):A);te.assertNever(s)}};_t.create=(t,e,r)=>new _t({schema:t,typeName:q.ZodEffects,effect:e,...U(r)});_t.createWithPreprocess=(t,e,r)=>new _t({schema:e,effect:{type:"preprocess",transform:t},typeName:q.ZodEffects,...U(r)});var yt=class extends G{_parse(e){return this._getType(e)===z.undefined?Be(void 0):this._def.innerType._parse(e)}unwrap(){return this._def.innerType}};yt.create=(t,e)=>new yt({innerType:t,typeName:q.ZodOptional,...U(e)});var Ht=class extends G{_parse(e){return this._getType(e)===z.null?Be(null):this._def.innerType._parse(e)}unwrap(){return this._def.innerType}};Ht.create=(t,e)=>new Ht({innerType:t,typeName:q.ZodNullable,...U(e)});var dn=class extends G{_parse(e){let{ctx:r}=this._processInputParams(e),n=r.data;return r.parsedType===z.undefined&&(n=this._def.defaultValue()),this._def.innerType._parse({data:n,path:r.path,parent:r})}removeDefault(){return this._def.innerType}};dn.create=(t,e)=>new dn({innerType:t,typeName:q.ZodDefault,defaultValue:typeof e.default=="function"?e.default:()=>e.default,...U(e)});var pn=class extends G{_parse(e){let{ctx:r}=this._processInputParams(e),n={...r,common:{...r.common,issues:[]}},s=this._def.innerType._parse({data:n.data,path:n.path,parent:{...n}});return Vn(s)?s.then(o=>({status:"valid",value:o.status==="valid"?o.value:this._def.catchValue({get error(){return new it(n.common.issues)},input:n.data})})):{status:"valid",value:s.status==="valid"?s.value:this._def.catchValue({get error(){return new it(n.common.issues)},input:n.data})}}removeCatch(){return this._def.innerType}};pn.create=(t,e)=>new pn({innerType:t,typeName:q.ZodCatch,catchValue:typeof e.catch=="function"?e.catch:()=>e.catch,...U(e)});var Gn=class extends G{_parse(e){if(this._getType(e)!==z.nan){let n=this._getOrReturnCtx(e);return E(n,{code:k.invalid_type,expected:z.nan,received:n.parsedType}),A}return{status:"valid",value:e.data}}};Gn.create=t=>new Gn({typeName:q.ZodNaN,...U(t)});var nx=Symbol("zod_brand"),Ms=class extends G{_parse(e){let{ctx:r}=this._processInputParams(e),n=r.data;return this._def.type._parse({data:n,path:r.path,parent:r})}unwrap(){return this._def.type}},qs=class t extends G{_parse(e){let{status:r,ctx:n}=this._processInputParams(e);if(n.common.async)return(async()=>{let o=await this._def.in._parseAsync({data:n.data,path:n.path,parent:n});return o.status==="aborted"?A:o.status==="dirty"?(r.dirty(),Yr(o.value)):this._def.out._parseAsync({data:o.value,path:n.path,parent:n})})();{let s=this._def.in._parseSync({data:n.data,path:n.path,parent:n});return s.status==="aborted"?A:s.status==="dirty"?(r.dirty(),{status:"dirty",value:s.value}):this._def.out._parseSync({data:s.value,path:n.path,parent:n})}}static create(e,r){return new t({in:e,out:r,typeName:q.ZodPipeline})}},fn=class extends G{_parse(e){let r=this._def.innerType._parse(e),n=s=>(kr(s)&&(s.value=Object.freeze(s.value)),s);return Vn(r)?r.then(s=>n(s)):n(r)}unwrap(){return this._def.innerType}};fn.create=(t,e)=>new fn({innerType:t,typeName:q.ZodReadonly,...U(e)});function Uf(t,e){let r=typeof t=="function"?t(e):typeof t=="string"?{message:t}:t;return typeof r=="string"?{message:r}:r}function Wf(t,e={},r){return t?Pr.create().superRefine((n,s)=>{let o=t(n);if(o instanceof Promise)return o.then(i=>{if(!i){let a=Uf(e,n),c=a.fatal??r??!0;s.addIssue({code:"custom",...a,fatal:c})}});if(!o){let i=Uf(e,n),a=i.fatal??r??!0;s.addIssue({code:"custom",...i,fatal:a})}}):Pr.create()}var sx={object:at.lazycreate},q;(function(t){t.ZodString="ZodString",t.ZodNumber="ZodNumber",t.ZodNaN="ZodNaN",t.ZodBigInt="ZodBigInt",t.ZodBoolean="ZodBoolean",t.ZodDate="ZodDate",t.ZodSymbol="ZodSymbol",t.ZodUndefined="ZodUndefined",t.ZodNull="ZodNull",t.ZodAny="ZodAny",t.ZodUnknown="ZodUnknown",t.ZodNever="ZodNever",t.ZodVoid="ZodVoid",t.ZodArray="ZodArray",t.ZodObject="ZodObject",t.ZodUnion="ZodUnion",t.ZodDiscriminatedUnion="ZodDiscriminatedUnion",t.ZodIntersection="ZodIntersection",t.ZodTuple="ZodTuple",t.ZodRecord="ZodRecord",t.ZodMap="ZodMap",t.ZodSet="ZodSet",t.ZodFunction="ZodFunction",t.ZodLazy="ZodLazy",t.ZodLiteral="ZodLiteral",t.ZodEnum="ZodEnum",t.ZodEffects="ZodEffects",t.ZodNativeEnum="ZodNativeEnum",t.ZodOptional="ZodOptional",t.ZodNullable="ZodNullable",t.ZodDefault="ZodDefault",t.ZodCatch="ZodCatch",t.ZodPromise="ZodPromise",t.ZodBranded="ZodBranded",t.ZodPipeline="ZodPipeline",t.ZodReadonly="ZodReadonly"})(q||(q={}));var ox=(t,e={message:`Input not instance of ${t.name}`})=>Wf(r=>r instanceof t,e),Jf=Sr.create,Yf=Qr.create,ix=Gn.create,ax=Xr.create,Qf=en.create,cx=tn.create,ux=Un.create,lx=rn.create,dx=nn.create,px=Pr.create,fx=cr.create,mx=It.create,hx=Hn.create,gx=ur.create,yx=at.create,vx=at.strictCreate,_x=sn.create,bx=ki.create,wx=on.create,$x=Ut.create,xx=Si.create,kx=Kn.create,Sx=Bn.create,Px=Pi.create,Ex=an.create,Tx=cn.create,zx=un.create,Cx=ln.create,Ix=Er.create,Rx=_t.create,Ox=yt.create,Nx=Ht.create,jx=_t.createWithPreprocess,Ax=qs.create,Mx=()=>Jf().optional(),qx=()=>Yf().optional(),Dx=()=>Qf().optional(),Zx={string:(t=>Sr.create({...t,coerce:!0})),number:(t=>Qr.create({...t,coerce:!0})),boolean:(t=>en.create({...t,coerce:!0})),bigint:(t=>Xr.create({...t,coerce:!0})),date:(t=>tn.create({...t,coerce:!0}))};var Lx=A;var Kt=ve(require("path"));function Xf(t,e){let r=n=>Kt.isAbsolute(n)?n:Kt.join(e,n);return[{name:"read_file",description:"Read file content. Relative paths are resolved against the workspace root.",parameters:T.object({path:T.string()}),execute:async n=>{let s=r(n.path);if(!t.checkPathAccess(s,"read"))throw new Error(`Access Denied by Policy: ${s}`);return await Tr.readFile(s,"utf-8")}},{name:"write_file",description:"Write file content. Relative paths are resolved against the workspace root.",parameters:T.object({path:T.string(),content:T.string()}),execute:async n=>{let s=r(n.path);if(!t.checkPathAccess(s,"write"))throw new Error(`Access Denied by Policy: ${s}`);return await Tr.mkdir(Kt.dirname(s),{recursive:!0}),await Tr.writeFile(s,n.content),`Successfully wrote to ${s}`}},{name:"scan_project",description:"List all files in the workspace (excluding .git, node_modules, etc). Useful for understanding project structure.",parameters:T.object({}),execute:async()=>{let n=[];async function s(o){let i=await Tr.readdir(o,{withFileTypes:!0});for(let a of i){let c=Kt.relative(e,Kt.join(o,a.name));if(a.name===".git"||a.name==="node_modules"||a.name===".DS_Store"||a.name==="out"||a.name==="dist"){a.isDirectory()&&n.push(c+"/ (ignored)");continue}a.isDirectory()?await s(Kt.join(o,a.name)):n.push(c)}}return await s(e),`Project Files (${n.length}):
`+n.slice(0,100).join(`
`)+(n.length>100?`
... ${n.length-100} more files`:"")}}]}var zr=ve(require("fs/promises"));var Ei=ve(require("path"));function em(t,e){let r=n=>Ei.isAbsolute(n)?n:Ei.join(e,n);return[{name:"str_replace",description:"Replace a specific string in a file with new content. The old_str must match EXACTLY (including whitespace and indentation). Use this for precise edits.",parameters:T.object({path:T.string().describe("Path to the file to edit"),old_str:T.string().describe("The exact string to find and replace (must match exactly)"),new_str:T.string().describe("The new string to replace old_str with")}),execute:async n=>{let s=r(n.path);if(!t.checkPathAccess(s,"write"))throw new Error(`Access Denied by Policy: ${s}`);let o=await zr.readFile(s,"utf-8"),i=n.old_str,a=n.new_str,c=o;if(!o.includes(i)){if(c=o.replace(/\r\n/g,`
`),i=i.replace(/\r\n/g,`
`),a=a.replace(/\r\n/g,`
`),!c.includes(i))throw new Error("old_str not found in file. Make sure it matches exactly including whitespace and indentation.");o=c}let u=o.split(i).length-1;if(u>1)throw new Error(`old_str found ${u} times. It must be unique. Add more context to make it unique.`);let l=o.replace(i,a);return await zr.writeFile(s,l),`Successfully replaced content in ${s}`}},{name:"insert_after",description:"Insert new content after a specific string in a file. The marker string must match exactly.",parameters:T.object({path:T.string().describe("Path to the file to edit"),marker:T.string().describe("The exact string after which to insert new content"),content:T.string().describe("The content to insert after the marker")}),execute:async n=>{let s=r(n.path);if(!t.checkPathAccess(s,"write"))throw new Error(`Access Denied by Policy: ${s}`);let o=await zr.readFile(s,"utf-8"),i=n.marker,a=n.content;if(!o.includes(i)&&(o=o.replace(/\r\n/g,`
`),i=i.replace(/\r\n/g,`
`),a=a.replace(/\r\n/g,`
`),!o.includes(i)))throw new Error("Marker string not found in file.");let c=o.split(i).length-1;if(c>1)throw new Error(`Marker found ${c} times. It must be unique.`);let u=o.replace(i,i+a);return await zr.writeFile(s,u),`Successfully inserted content after marker in ${s}`}},{name:"apply_patch",description:"Apply a unified diff patch to a file. Supports standard unified diff format with @@ line markers.",parameters:T.object({path:T.string(),patch:T.string().describe("Unified diff format patch content")}),execute:async n=>{let s=r(n.path);if(!t.checkPathAccess(s,"write"))throw new Error(`Access Denied by Policy: ${s}`);let o=await zr.readFile(s,"utf-8"),i=Vx(o,n.patch);return await zr.writeFile(s,i),`Successfully applied patch to ${s}`}}]}function Vx(t,e){let r=t.split(`
`),n=e.split(`
`),s=[],o=null;for(let a of n){if(a.startsWith("---")||a.startsWith("+++"))continue;let c=a.match(/^@@ -(\d+)(?:,(\d+))? \+(\d+)(?:,(\d+))? @@/);if(c){o&&s.push(o),o={oldStart:parseInt(c[1],10),oldCount:parseInt(c[2]||"1",10),newStart:parseInt(c[3],10),newCount:parseInt(c[4]||"1",10),changes:[]};continue}o&&(a.startsWith("-")?o.changes.push({type:"remove",line:a.slice(1)}):a.startsWith("+")?o.changes.push({type:"add",line:a.slice(1)}):(a.startsWith(" ")||a==="")&&o.changes.push({type:"context",line:a.slice(1)||""}))}if(o&&s.push(o),s.length===0)throw new Error("No valid hunks found in patch. Use unified diff format with @@ markers.");let i=[...r];for(let a of s.reverse()){let c=a.oldStart-1,u=0,l=[];for(let p of a.changes)(p.type==="remove"||p.type==="context")&&u++,(p.type==="add"||p.type==="context")&&l.push(p.line);let d=a.changes.filter(p=>p.type==="remove").length,f=a.changes.filter(p=>p.type==="add").map(p=>p.line);i.splice(c,a.oldCount,...f.concat(a.changes.filter(p=>p.type==="context").map(p=>p.line)))}return i.join(`
`)}var tm=t=>({name:"manage_task",description:"Create, update, or list tasks to track complex goals. Use this to break down large user requests into steps. Supports atomic changes tracking.",parameters:T.object({action:T.enum(["create","update_status","update_step","list","create_atomic_change","get_progress","start_step","complete_step"]).describe("The action to perform"),title:T.string().optional().describe("Title for new task"),description:T.string().optional().describe("Description for atomic change task"),steps:T.array(T.string()).optional().describe("List of step descriptions for new task"),taskId:T.string().optional().describe("ID of the task to update"),status:T.enum(["pending","in-progress","completed","failed"]).optional().describe("New status for task or step"),stepIndex:T.number().optional().describe("Index of the step to update (0-based)"),contextItems:T.array(T.string()).optional().describe("List of context items for atomic change task")}),execute:async e=>{if(e.action==="create"){if(!e.title)throw new Error("Title required for create");let r=t.createTask(e.title,e.steps||[]);return`Task created: [${r.id}] ${r.title}`}if(e.action==="list"){let r=t.listTasks();return JSON.stringify(r,null,2)}if(e.action==="update_status"){if(!e.taskId||!e.status)throw new Error("taskId and status required");return t.updateTaskStatus(e.taskId,e.status)?`Task ${e.taskId} status updated to ${e.status}`:`Task ${e.taskId} not found`}if(e.action==="update_step"){if(!e.taskId||e.stepIndex===void 0||!e.status)throw new Error("taskId, stepIndex, and status required");return t.updateStepStatus(e.taskId,e.stepIndex,e.status)?`Task ${e.taskId} step ${e.stepIndex} updated to ${e.status}`:`Task ${e.taskId} not found or step invalid`}if(e.action==="create_atomic_change"){if(!e.title)throw new Error("Title required for atomic change task");let r=t.createAtomicChangeTask(e.title,e.description||"",e.contextItems||[]);return`Atomic change task created: [${r.id}] ${r.title}`}if(e.action==="get_progress"){if(!e.taskId)throw new Error("taskId required");let r=t.getTaskProgress(e.taskId);return r?JSON.stringify(r,null,2):`Task ${e.taskId} not found`}if(e.action==="start_step"){if(!e.taskId||e.stepIndex===void 0)throw new Error("taskId and stepIndex required");return t.startStep(e.taskId,e.stepIndex)?`Step ${e.stepIndex} started for task ${e.taskId}`:`Failed to start step ${e.stepIndex} for task ${e.taskId}`}if(e.action==="complete_step"){if(!e.taskId||e.stepIndex===void 0)throw new Error("taskId and stepIndex required");return t.completeStep(e.taskId,e.stepIndex)?`Step ${e.stepIndex} completed for task ${e.taskId}`:`Failed to complete step ${e.stepIndex} for task ${e.taskId}`}return"Invalid action"}});var Ac=ve(require("crypto")),Ti=class{constructor(){this.tasks=new Map}createTask(e,r=[]){let n=Ac.randomUUID(),s={id:n,title:e,status:"pending",steps:r.map(o=>({id:Ac.randomUUID(),description:o,status:"pending",createdAt:Date.now()})),createdAt:Date.now(),updatedAt:Date.now()};return this.tasks.set(n,s),s}updateTaskStatus(e,r){let n=this.tasks.get(e);return n&&(n.status=r,n.updatedAt=Date.now(),this.tasks.set(e,n)),n}updateStepStatus(e,r,n){let s=this.tasks.get(e);if(s&&s.steps[r])return s.steps[r].status=n,s.steps[r].updatedAt=Date.now(),s.updatedAt=Date.now(),this.tasks.set(e,s),s}createAtomicChangeTask(e,r,n){let s=this.createTask(e,["Analyze requirements","Plan atomic changes","Implement changes","Verify changes","Document changes"]);return s.description=r,s.contextItems=n||[],s}getTaskProgress(e){let r=this.tasks.get(e);if(!r)return null;let n=r.steps.length;if(n===0)return{completedSteps:0,totalSteps:0,percentage:0};let s=r.steps.filter(i=>i.status==="completed").length,o=Math.round(s/n*100);return{completedSteps:s,totalSteps:n,percentage:o}}getCurrentStep(e){let r=this.tasks.get(e);return r?(r.steps.find(s=>s.status==="in-progress"||s.status==="pending"),r):void 0}startStep(e,r){let n=this.tasks.get(e);return!n||n.steps[r]===void 0||n.steps[r].status!=="pending"?!1:(n.steps[r].status="in-progress",n.steps[r].startedAt=Date.now(),n.updatedAt=Date.now(),this.tasks.set(e,n),!0)}completeStep(e,r){let n=this.tasks.get(e);return!n||n.steps[r]===void 0||n.steps[r].status!=="in-progress"?!1:(n.steps[r].status="completed",n.steps[r].completedAt=Date.now(),n.updatedAt=Date.now(),this.tasks.set(e,n),!0)}getDetailedTask(e){let r=this.tasks.get(e);if(!r)return;let n=this.getTaskProgress(e);return n&&(r.progress=n),r}getTask(e){return this.tasks.get(e)}listTasks(){return Array.from(this.tasks.values()).sort((e,r)=>r.createdAt-e.createdAt)}toJSON(){return Array.from(this.tasks.values())}};var Cr=ve(require("vscode"));var zi=class{constructor(){this.isListening=!1;this.resolveCallback=null;this.rejectCallback=null;this.initSpeechRecognition()}initSpeechRecognition(){let e=window.SpeechRecognition||window.webkitSpeechRecognition;e?(this.recognition=new e,this.recognition.continuous=!1,this.recognition.interimResults=!1,this.recognition.lang="en-US",this.recognition.onresult=r=>{if(r.results&&r.results.length>0){let n=r.results[0][0].transcript;this.resolveCallback&&(this.resolveCallback(n),this.resolveCallback=null,this.rejectCallback=null)}this.isListening=!1},this.recognition.onerror=r=>{console.error("Speech recognition error:",r.error),this.rejectCallback&&(this.rejectCallback(`Speech recognition error: ${r.error}`),this.resolveCallback=null,this.rejectCallback=null),this.isListening=!1},this.recognition.onend=()=>{this.isListening=!1,this.rejectCallback&&(this.rejectCallback("No speech detected"),this.resolveCallback=null,this.rejectCallback=null)}):console.warn("Speech recognition not supported in this browser")}async startListening(){return new Promise((e,r)=>{if(this.isListening){r("Already listening");return}if(!this.recognition){r("Speech recognition not supported");return}this.resolveCallback=e,this.rejectCallback=r,this.isListening=!0;try{this.recognition.start()}catch(n){this.isListening=!1,r(`Failed to start speech recognition: ${n}`)}})}stopListening(){this.recognition&&this.isListening&&(this.recognition.stop(),this.isListening=!1)}isSupported(){return!!(window.SpeechRecognition||window.webkitSpeechRecognition)}isActive(){return this.isListening}};var Ds=class{constructor(e,r,n,s){this._extensionUri=e;this.orchestrator=r;this.taskManager=n;this.historyManager=s;this.currentHistory=[];this.isGenerating=!1;this.webviewReady=!1;this.ongoingAgentProcess=null;this.lastAgentUpdate=null;this.agentUpdatesBuffer=[];this.pendingAgentUpdates=[];this.voiceService=new zi}static{this.viewType="vibey.chatView"}async resolveWebviewView(e,r,n){this._view=e,e.webview.options={enableScripts:!0,localResourceRoots:[this._extensionUri]},this.currentHistory=await this.historyManager.loadHistory(),e.webview.html=this._getHtmlForWebview(e.webview),e.webview.onDidReceiveMessage(async s=>{switch(s.type){case"webviewReady":{this.webviewReady=!0,this.currentHistory.length>0&&this._view?.webview.postMessage({type:"restoreHistory",messages:this.currentHistory}),this.isGenerating&&(this._view?.webview.postMessage({type:"restoreState",busy:!0}),this.lastAgentUpdate&&this._view?.webview.postMessage({type:"agentUpdate",update:this.lastAgentUpdate}),this.ongoingAgentProcess&&this.ongoingAgentProcess.reconnect(o=>{this.lastAgentUpdate=o,this.agentUpdatesBuffer.push(o),this.webviewReady&&this._view?.webview.postMessage({type:"agentUpdate",update:o})}));break}case"sendMessage":{if(!s.text)return;let o={role:"user",content:s.text};this.currentHistory.push(o),this.webviewReady&&this._view?.webview.postMessage({type:"addMessage",role:o.role,content:o.content}),await this.historyManager.saveHistory(this.currentHistory),this.isGenerating=!0,this.agentUpdatesBuffer=[],this.pendingAgentUpdates=[];let i=!1;try{let a=l=>{this.lastAgentUpdate=l,this.agentUpdatesBuffer.push(l),this.pendingAgentUpdates.push(l),this.webviewReady&&this._view?.webview.postMessage({type:"agentUpdate",update:l})},c=l=>{a=l};this.ongoingAgentProcess={cancel:()=>{i=!0,this.orchestrator.cancel()},reconnect:c};let u=await this.orchestrator.chat(s.text,s.context,l=>{i||a(l)});this.webviewReady&&this._view?.webview.postMessage({type:"addMessage",role:"assistant",content:u}),this.currentHistory.push({role:"assistant",content:u,agentUpdates:[...this.pendingAgentUpdates]}),await this.historyManager.saveHistory(this.currentHistory),u!=="Request cancelled."&&this.webviewReady&&this._view?.webview.postMessage({type:"requestComplete"})}catch(a){this.webviewReady&&this._view?.webview.postMessage({type:"addMessage",role:"assistant",content:`Error: ${a.message}`}),this.webviewReady&&this._view?.webview.postMessage({type:"requestComplete"})}finally{this.isGenerating=!1,this.ongoingAgentProcess=null,this.lastAgentUpdate=null,await this.historyManager.saveSession(this.currentHistory)}break}case"openSettings":{Cr.commands.executeCommand("vibey.openSettings");break}case"selectContext":{let o=await Cr.window.showOpenDialog({canSelectMany:!0,openLabel:"Add to Context"});o&&o.forEach(i=>{this.webviewReady&&e.webview.postMessage({type:"appendContext",file:{name:i.path.split("/").pop(),path:i.fsPath}})});break}case"stopRequest":{this.orchestrator.cancel(),this.webviewReady&&e.webview.postMessage({type:"requestStopped"});break}case"retryRequest":break;case"getTasks":{let o=this.taskManager.listTasks();this.webviewReady&&e.webview.postMessage({type:"updateTasks",tasks:o});break}case"error":{Cr.window.showErrorMessage(s.message);break}case"voiceInput":{this.handleVoiceInput().catch(o=>{console.error("Voice input error:",o),this.webviewReady&&this._view?.webview.postMessage({type:"voiceInputError",message:o.message||"Failed to process voice input"})});break}}})}async handleVoiceInput(){try{if(!this.voiceService.isSupported())throw new Error("Speech recognition not supported in this browser");if(this.voiceService.isActive())throw new Error("Already listening");this.webviewReady&&this._view?.webview.postMessage({type:"voiceInputStarted"});let e=await this.voiceService.startListening();this.webviewReady&&this._view?.webview.postMessage({type:"voiceInputReceived",text:e})}catch(e){console.error("Voice input error:",e),this.webviewReady&&this._view?.webview.postMessage({type:"voiceInputError",message:e.message||"Failed to process voice input"})}}_getHtmlForWebview(e){let r=e.asWebviewUri(Cr.Uri.joinPath(this._extensionUri,"src","ui","media","main.js"));return`<!DOCTYPE html>
        <html lang="en">
        <head>
            <meta charset="UTF-8">
            <meta name="viewport" content="width=device-width, initial-scale=1.0">
            <link href="${e.asWebviewUri(Cr.Uri.joinPath(this._extensionUri,"src","ui","media","main.css"))}" rel="stylesheet">
            <title>Vibey Chat</title>
        </head>
        <body>
            <div class="tabs">
                <div class="tab active" data-tab="chat">Chat</div>
                <div class="tab" data-tab="tasks">Tasks</div>
            </div>

            <div id="chat-view" class="view active">
                <div id="chat-container"></div>

                <div id="input-area">
                    <div id="context-area"></div>
                    
                    <div class="input-container">
                        <textarea id="InputBox" placeholder="Ask Vibey... (Shift+Enter for new line)"></textarea>
                        
                        <div class="input-actions">
                            <div class="toolbar">
                                <button id="attach-btn" class="icon-btn" title="Add Context">\u{1F4CE}</button>
                                <button id="mic-btn" class="icon-btn" title="Voice Input">\u{1F3A4}</button>
                                <button id="models-btn" class="icon-btn" title="Select Model">\u{1F916}</button>
                                <button id="settings-btn" class="icon-btn" title="Settings">\u2699\uFE0F</button>
                            </div>
                            <button id="send-btn">Send \u27A4</button>
                        </div>
                    </div>
                </div>
            </div>

            <div id="tasks-view" class="view">
                <div id="task-list">
                    <!-- Tasks will be rendered here -->
                    <div class="empty-state">No active tasks. Ask Vibey to start a task!</div>
                </div>
            </div>

            <script src="${r}"></script>
        </body>
        </html>`}};var Mc={win32:{powershell:{path:"powershell.exe",args:["-NoLogo"],displayName:"PowerShell"},cmd:{path:"cmd.exe",displayName:"Command Prompt"},bash:{path:"bash.exe",displayName:"Bash (WSL/Git)"},zsh:void 0,sh:void 0,fish:void 0,auto:void 0},linux:{powershell:{path:"pwsh",displayName:"PowerShell Core"},cmd:void 0,bash:{path:"/bin/bash",displayName:"Bash"},zsh:{path:"/bin/zsh",displayName:"Zsh"},sh:{path:"/bin/sh",displayName:"Shell"},fish:{path:"/usr/bin/fish",displayName:"Fish"},auto:void 0},darwin:{powershell:{path:"pwsh",displayName:"PowerShell Core"},cmd:void 0,bash:{path:"/bin/bash",displayName:"Bash"},zsh:{path:"/bin/zsh",displayName:"Zsh"},sh:{path:"/bin/sh",displayName:"Shell"},fish:{path:"/usr/bin/fish",displayName:"Fish"},auto:void 0}};var lr=ve(require("vscode")),qc=ve(require("path")),dr=ve(require("fs")),rm=ve(require("os"));function Ci(){return`vibey-${Date.now()}-${Math.random().toString(36).substring(2,11)}`}var Zs=class{constructor(e,r,n){this.workspaceRoot=e;this.context=r;this.iconPath=n;this.terminals=new Map;this.terminalStates=new Map;this.eventListeners=[];this.disposables=[];this.terminalOutputBuffers=new Map;this.history=this.context.globalState.get("vibey.terminalHistory")||{entries:[],maxEntries:500},this.outputChannel=lr.window.createOutputChannel("Vibey Terminal"),this.disposables.push(lr.window.onDidCloseTerminal(s=>{this.handleTerminalClosed(s)})),this.disposables.push(lr.window.onDidChangeActiveTerminal(s=>{s&&this.updateActiveState(s)}))}getPreferredShell(){return lr.workspace.getConfiguration("vibey").get("preferredShell")||"auto"}getShellConfig(e){let r=process.platform,n=Mc[r]||Mc.linux;if(e!=="auto")return n[e]}getIconPath(){return lr.Uri.file(this.iconPath)}async createTerminal(e={}){let r=e.shellType||this.getPreferredShell(),n=this.getShellConfig(r),s=Ci(),o=e.name||`Vibey ${this.terminals.size+1}`,i={name:o,cwd:e.cwd||this.workspaceRoot,iconPath:this.getIconPath()};n&&(i.shellPath=n.path,i.shellArgs=n.args);let a=lr.window.createTerminal(i);this.terminals.set(s,a),this.terminalOutputBuffers.set(s,"");let c={id:s,name:o,shellType:r,createdAt:Date.now(),isActive:!0};return this.terminalStates.set(s,c),this.emitEvent({type:"terminal-created",terminalId:s}),this.outputChannel.appendLine(`[Terminal] Created: ${o} (${s})`),s}async getOrCreateTerminal(e={}){if(e.reuseExisting){for(let[r,n]of this.terminalStates.entries())if(n.isActive)return this.outputChannel.appendLine(`[Terminal] Reusing: ${n.name} (${r})`),r}return this.createTerminal(e)}async sendCommand(e,r){let n=this.terminals.get(e);if(!n)throw new Error(`Terminal ${e} not found`);let s=this.terminalStates.get(e);s&&(s.lastCommandAt=Date.now());let o={id:Ci(),terminalId:e,command:r,executedAt:Date.now()};this.addHistoryEntry(o),n.sendText(r),this.outputChannel.appendLine(`[Terminal ${e}] > ${r}`),this.emitEvent({type:"command-executed",terminalId:e,data:{command:r}})}async runCommand(e,r={}){let n=await this.getOrCreateTerminal({...r,reuseExisting:!0}),s=this.terminals.get(n),o=Date.now();if(!s)throw new Error(`Terminal ${n} not found`);return r.showTerminal!==!1&&s.show(!0),s.shellIntegration?this.runWithShellIntegration(s,n,e,o,r.timeout):this.runWithFileRedirect(s,n,e,o,r.timeout)}async runWithShellIntegration(e,r,n,s,o=3e4){let i=e.shellIntegration;try{let a=i.executeCommand(n),c="",u=a.read(),l=new Promise((m,h)=>{setTimeout(()=>h(new Error("Command timeout")),o)}),d=(async()=>{for await(let m of u)c+=m;return c})();c=await Promise.race([d,l]);let f=a.exitCode,p={id:Ci(),terminalId:r,command:n,executedAt:s,output:c.substring(0,1e4),exitCode:f,duration:Date.now()-s};return this.addHistoryEntry(p),this.outputChannel.appendLine(`[Terminal ${r}] Command completed (shell integration)`),this.emitEvent({type:"command-completed",terminalId:r,data:{command:n,exitCode:f,output:c}}),{success:f===void 0||f===0,output:c,terminalId:r,command:n,duration:Date.now()-s,exitCode:f,captureMethod:"shell_integration"}}catch(a){return this.outputChannel.appendLine(`[Terminal ${r}] Shell integration error: ${a.message}`),this.runWithFileRedirect(e,r,n,s,o)}}async runWithFileRedirect(e,r,n,s,o=3e4){let i=rm.tmpdir(),a=qc.join(i,`vibey-output-${r}-${Date.now()}.txt`),c=qc.join(i,`vibey-exit-${r}-${Date.now()}.txt`),l=this.terminalStates.get(r)?.shellType||"auto",d=this.buildRedirectCommand(n,a,c,l);e.sendText(d),this.outputChannel.appendLine(`[Terminal ${r}] > ${n} (file redirect)`);let f=100,p=o/f,m=0,h="",g;for(;m<p;)if(await this.sleep(f),m++,dr.existsSync(c)){try{let $=dr.readFileSync(c,"utf-8").trim();g=parseInt($,10),isNaN(g)&&(g=void 0)}catch{}if(dr.existsSync(a))try{h=dr.readFileSync(a,"utf-8")}catch{}this.cleanupTempFiles(a,c);break}let y={id:Ci(),terminalId:r,command:n,executedAt:s,output:h.substring(0,1e4),exitCode:g,duration:Date.now()-s};this.addHistoryEntry(y);let x=m>=p;return x&&(this.cleanupTempFiles(a,c),h=`Command timed out after ${o}ms. Check terminal for output.`),this.emitEvent({type:"command-completed",terminalId:r,data:{command:n,exitCode:g,output:h}}),{success:!x&&(g===void 0||g===0),output:h||"No output captured",terminalId:r,command:n,duration:Date.now()-s,exitCode:g,captureMethod:"file_redirect"}}buildRedirectCommand(e,r,n,s){let o=process.platform,i=s;s==="auto"&&(i=o==="win32"?"powershell":"bash");let a=r.replace(/\\/g,"/"),c=n.replace(/\\/g,"/");switch(i){case"powershell":return`& { ${e} } 2>&1 | Out-File -FilePath "${a}" -Encoding utf8; $LASTEXITCODE | Out-File -FilePath "${c}" -Encoding utf8`;case"cmd":return`(${e}) > "${a}" 2>&1 & echo %ERRORLEVEL% > "${c}"`;case"bash":case"zsh":case"sh":default:return`{ ${e}; } > "${a}" 2>&1; echo $? > "${c}"`}}cleanupTempFiles(...e){for(let r of e)try{dr.existsSync(r)&&dr.unlinkSync(r)}catch{}}sleep(e){return new Promise(r=>setTimeout(r,e))}showTerminal(e,r=!0){let n=this.terminals.get(e);n&&n.show(r)}hideTerminal(e){let r=this.terminals.get(e);r&&r.hide()}closeTerminal(e){let r=this.terminals.get(e);r&&(r.dispose(),this.terminals.delete(e),this.terminalStates.delete(e),this.terminalOutputBuffers.delete(e))}listTerminals(){return Array.from(this.terminalStates.values())}getTerminalState(e){return this.terminalStates.get(e)}getHistory(e){let r=this.history.entries;return e?r.slice(-e):r}getTerminalHistory(e){return this.history.entries.filter(r=>r.terminalId===e)}getLastOutput(e){let r=this.getTerminalHistory(e);if(r.length!==0)return r[r.length-1].output}getRecentOutputs(e,r=5){return this.getTerminalHistory(e).slice(-r)}async clearHistory(){this.history.entries=[],await this.saveHistory()}addEventListener(e){this.eventListeners.push(e)}removeEventListener(e){let r=this.eventListeners.indexOf(e);r>=0&&this.eventListeners.splice(r,1)}dispose(){this.disposables.forEach(e=>e.dispose()),this.outputChannel.dispose()}handleTerminalClosed(e){for(let[r,n]of this.terminals.entries())if(n===e){let s=this.terminalStates.get(r);s&&(s.isActive=!1),this.terminals.delete(r),this.terminalOutputBuffers.delete(r),this.emitEvent({type:"terminal-closed",terminalId:r}),this.outputChannel.appendLine(`[Terminal] Closed: ${s?.name||r}`);break}}updateActiveState(e){for(let[r,n]of this.terminals.entries()){let s=this.terminalStates.get(r);s&&(s.isActive=n===e)}}addHistoryEntry(e){this.history.entries.push(e),this.history.entries.length>this.history.maxEntries&&(this.history.entries=this.history.entries.slice(-this.history.maxEntries)),this.saveHistory()}async saveHistory(){await this.context.globalState.update("vibey.terminalHistory",this.history)}emitEvent(e){for(let r of this.eventListeners)try{r(e)}catch(n){console.error("[VibeyTerminal] Event listener error:",n)}}};var nm=T.enum(["powershell","cmd","bash","zsh","sh","fish","auto"]).optional();function sm(t){return[{name:"terminal_create",description:"Create a new Vibey terminal. Returns a terminal ID.",parameters:T.object({name:T.string().optional().describe("Custom name for the terminal"),shell:nm.describe("Shell type: powershell, cmd, bash, zsh, sh, fish, or auto"),cwd:T.string().optional().describe("Working directory for the terminal")}),execute:async e=>{let r=await t.createTerminal({name:e.name,shellType:e.shell,cwd:e.cwd});return t.showTerminal(r),`Terminal created with ID: ${r}`}},{name:"terminal_run",description:"Run a command in a Vibey terminal and capture output. Reuses existing or creates new.",parameters:T.object({command:T.string().describe("The command to run"),shell:nm.describe("Shell type preference"),newTerminal:T.boolean().optional().describe("Force create a new terminal"),timeout:T.number().optional().describe("Timeout in ms (default 30000)")}),execute:async e=>{let r=await t.runCommand(e.command,{shellType:e.shell,reuseExisting:!e.newTerminal,timeout:e.timeout});t.showTerminal(r.terminalId);let n={terminalId:r.terminalId,command:e.command,success:r.success,exitCode:r.exitCode,output:r.output,captureMethod:r.captureMethod,duration:r.duration};return JSON.stringify(n,null,2)}},{name:"terminal_send",description:"Send a command to a specific terminal by ID.",parameters:T.object({terminalId:T.string().describe("The terminal ID"),command:T.string().describe("The command to send")}),execute:async e=>(await t.sendCommand(e.terminalId,e.command),`Command sent to terminal ${e.terminalId}`)},{name:"terminal_list",description:"List all Vibey terminals with their IDs and status.",parameters:T.object({}),execute:async()=>{let e=t.listTerminals();return e.length===0?"No Vibey terminals are currently open.":e.map(r=>`- ${r.id}: "${r.name}" (${r.shellType}, ${r.isActive?"active":"inactive"})`).join(`
`)}},{name:"terminal_show",description:"Show/focus a terminal by ID.",parameters:T.object({terminalId:T.string()}),execute:async e=>(t.showTerminal(e.terminalId,!1),`Terminal ${e.terminalId} is now visible.`)},{name:"terminal_close",description:"Close a terminal by ID.",parameters:T.object({terminalId:T.string()}),execute:async e=>(t.closeTerminal(e.terminalId),`Terminal ${e.terminalId} closed.`)},{name:"terminal_history",description:"Get command history for terminals including output.",parameters:T.object({terminalId:T.string().optional().describe("Filter by terminal ID"),limit:T.number().optional().describe("Max entries (default 20)"),includeOutput:T.boolean().optional().describe("Include command output (default false)")}),execute:async e=>{let r=e.limit||20,n=e.terminalId?t.getTerminalHistory(e.terminalId):t.getHistory(r);return n.length===0?"No history available.":e.includeOutput?JSON.stringify(n.slice(-r).map(s=>({time:new Date(s.executedAt).toISOString(),command:s.command,output:s.output||null,exitCode:s.exitCode,duration:s.duration})),null,2):n.slice(-r).map(s=>`[${new Date(s.executedAt).toLocaleTimeString()}] ${s.command}`).join(`
`)}},{name:"terminal_read_output",description:"Read the output from the last command(s) in a terminal.",parameters:T.object({terminalId:T.string().describe("The terminal ID to read from"),count:T.number().optional().describe("Number of recent commands to read (default 1)")}),execute:async e=>{let r=e.count||1,n=t.getRecentOutputs(e.terminalId,r);if(n.length===0)return JSON.stringify({error:"No output available for this terminal"});if(r===1){let s=n[n.length-1];return JSON.stringify({command:s.command,output:s.output||"No output captured",exitCode:s.exitCode,executedAt:new Date(s.executedAt).toISOString()},null,2)}return JSON.stringify(n.map(s=>({command:s.command,output:s.output||"No output captured",exitCode:s.exitCode,executedAt:new Date(s.executedAt).toISOString()})),null,2)}}]}var Me=ve(require("vscode"));function om(){return[{name:"get_problems",description:"Get diagnostics (problems) from the current workspace. Can be filtered by severity or file.",parameters:T.object({filepath:T.string().optional().describe("Filter by specific file path"),severity:T.enum(["error","warning","info","hint"]).optional().describe("Filter by severity level. If omitted, returns all.")}),execute:async t=>{let e=Me.languages.getDiagnostics();if(t.filepath){let o=Me.Uri.file(t.filepath);e=Me.languages.getDiagnostics(o).map(i=>[o,[i]])}let r={error:Me.DiagnosticSeverity.Error,warning:Me.DiagnosticSeverity.Warning,info:Me.DiagnosticSeverity.Information,hint:Me.DiagnosticSeverity.Hint},n=t.severity?r[t.severity]:void 0,s=[];for(let[o,i]of e){if(i.length===0)continue;let a=i.filter(c=>n===void 0||c.severity===n);a.length>0&&s.push({file:Me.workspace.asRelativePath(o),problems:a.map(c=>({message:c.message,severity:Me.DiagnosticSeverity[c.severity],line:c.range.start.line+1,source:c.source,code:typeof c.code=="object"?c.code.value:c.code}))})}return s.length===0?"No problems found matching criteria.":JSON.stringify(s,null,2)}},{name:"get_open_editors",description:"List all currently visible text editors.",parameters:T.object({}),execute:async()=>{let t=Me.window.visibleTextEditors;return t.length===0?"No editors are currently visible.":JSON.stringify(t.map(e=>({file:Me.workspace.asRelativePath(e.document.uri),language:e.document.languageId,isDirty:e.document.isDirty,active:e===Me.window.activeTextEditor})),null,2)}},{name:"get_active_terminal",description:"Get information about the currently active terminal.",parameters:T.object({}),execute:async()=>{let t=Me.window.activeTerminal;return t?JSON.stringify({name:t.name,processId:await t.processId,state:t.state},null,2):"No terminal is currently active/focused."}}]}var Ie=ve(require("fs")),Ls=ve(require("path")),Ii=class t{constructor(e,r){this.context=e;this.workspaceRoot=r;this.currentSessionId=null;this.gitIgnoreChecked=!1;this.historyDir=Ls.join(this.workspaceRoot,".vibey"),this.historyFile=Ls.join(this.historyDir,"chat_history.json"),this.sessionsFile=Ls.join(this.historyDir,"sessions.json")}static{this.KEY="vibey.chatHistory"}static{this.SESSIONS_KEY="vibey.chatSessions"}async saveHistory(e){await this.context.workspaceState.update(t.KEY,e);try{await this.ensureHistoryDirectory(),await this.ensureGitIgnore(),await Ie.promises.writeFile(this.historyFile,JSON.stringify(e,null,2),"utf-8")}catch(r){console.error("Failed to save chat history to file:",r)}await this.saveSession(e)}async loadHistory(){try{if(Ie.existsSync(this.historyFile)){let r=await Ie.promises.readFile(this.historyFile,"utf-8"),n=JSON.parse(r);if(Array.isArray(n))return n}}catch(r){console.error("Failed to load chat history from file:",r)}return this.context.workspaceState.get(t.KEY)||[]}async clearHistory(){await this.context.workspaceState.update(t.KEY,void 0);try{Ie.existsSync(this.historyFile)&&await Ie.promises.unlink(this.historyFile)}catch(e){console.error("Failed to delete chat history file:",e)}await this.clearSessions()}async saveSession(e){let r=this.generateSessionId();this.currentSessionId=r;let n={sessionId:r,history:e,createdAt:Date.now(),updatedAt:Date.now()},s=await this.loadSessions();s.push(n),s.length>10&&s.shift();try{await this.ensureHistoryDirectory(),await Ie.promises.writeFile(this.sessionsFile,JSON.stringify(s,null,2),"utf-8")}catch(o){console.error("Failed to save chat sessions:",o)}}async loadSession(e){try{if(Ie.existsSync(this.sessionsFile)){let r=await Ie.promises.readFile(this.sessionsFile,"utf-8"),s=JSON.parse(r).find(o=>o.sessionId===e);return s?s.history:null}}catch(r){console.error("Failed to load chat session:",r)}return null}async loadLatestSession(){try{if(Ie.existsSync(this.sessionsFile)){let e=await Ie.promises.readFile(this.sessionsFile,"utf-8"),r=JSON.parse(e);if(r.length>0)return r[r.length-1].history}}catch(e){console.error("Failed to load latest chat session:",e)}return null}async loadSessions(){try{if(Ie.existsSync(this.sessionsFile)){let e=await Ie.promises.readFile(this.sessionsFile,"utf-8");return JSON.parse(e)}}catch(e){console.error("Failed to load chat sessions:",e)}return[]}async clearSessions(){try{Ie.existsSync(this.sessionsFile)&&await Ie.promises.unlink(this.sessionsFile)}catch(e){console.error("Failed to delete chat sessions file:",e)}}generateSessionId(){return"session_"+Date.now()+"_"+Math.random().toString(36).substr(2,9)}async ensureHistoryDirectory(){Ie.existsSync(this.historyDir)||await Ie.promises.mkdir(this.historyDir,{recursive:!0})}async ensureGitIgnore(){if(this.gitIgnoreChecked)return;let e=Ls.join(this.workspaceRoot,".gitignore"),r=".vibey/";try{let n="";if(Ie.existsSync(e)&&(n=await Ie.promises.readFile(e,"utf-8")),!n.includes(r)&&!n.includes(".vibey")){let s=n.endsWith(`
`)||n.length===0?`${n}${r}
`:`${n}
${r}
`;await Ie.promises.writeFile(e,s,"utf-8")}}catch(n){console.error("Failed to update .gitignore:",n)}finally{this.gitIgnoreChecked=!0}}};var Ns=ve(require("vscode"));var jq=Object.freeze({status:"aborted"});function b(t,e,r){function n(a,c){var u;Object.defineProperty(a,"_zod",{value:a._zod??{},enumerable:!1}),(u=a._zod).traits??(u.traits=new Set),a._zod.traits.add(t),e(a,c);for(let l in i.prototype)l in a||Object.defineProperty(a,l,{value:i.prototype[l].bind(a)});a._zod.constr=i,a._zod.def=c}let s=r?.Parent??Object;class o extends s{}Object.defineProperty(o,"name",{value:t});function i(a){var c;let u=r?.Parent?new o:this;n(u,a),(c=u._zod).deferred??(c.deferred=[]);for(let l of u._zod.deferred)l();return u}return Object.defineProperty(i,"init",{value:n}),Object.defineProperty(i,Symbol.hasInstance,{value:a=>r?.Parent&&a instanceof r.Parent?!0:a?._zod?.traits?.has(t)}),Object.defineProperty(i,"name",{value:t}),i}var pr=class extends Error{constructor(){super("Encountered Promise during synchronous parse. Use .parseAsync() instead.")}},Ri={};function bt(t){return t&&Object.assign(Ri,t),Ri}var de={};hi(de,{BIGINT_FORMAT_RANGES:()=>am,Class:()=>Zc,NUMBER_FORMAT_RANGES:()=>Gc,aborted:()=>hn,allowsEval:()=>Hc,assert:()=>Bx,assertEqual:()=>Fx,assertIs:()=>Hx,assertNever:()=>Kx,assertNotEqual:()=>Ux,assignProp:()=>Uc,cached:()=>Fs,captureStackTrace:()=>Ni,cleanEnum:()=>ik,cleanRegex:()=>Hs,clone:()=>Bt,createTransparentProxy:()=>Xx,defineLazy:()=>_e,esc:()=>mn,escapeRegex:()=>Ir,extend:()=>rk,finalizeIssue:()=>Rt,floatSafeRemainder:()=>Fc,getElementAtPath:()=>Gx,getEnumValues:()=>Lc,getLengthableOrigin:()=>Ks,getParsedType:()=>Qx,getSizableOrigin:()=>cm,isObject:()=>Wn,isPlainObject:()=>Jn,issue:()=>Wc,joinValues:()=>Oi,jsonStringifyReplacer:()=>Vc,merge:()=>nk,normalizeParams:()=>M,nullish:()=>Us,numKeys:()=>Yx,omit:()=>tk,optionalKeys:()=>Bc,partial:()=>sk,pick:()=>ek,prefixIssues:()=>Gt,primitiveTypes:()=>im,promiseAllObject:()=>Wx,propertyKeyTypes:()=>Kc,randomString:()=>Jx,required:()=>ok,stringifyPrimitive:()=>ji,unwrapMessage:()=>Vs});function Fx(t){return t}function Ux(t){return t}function Hx(t){}function Kx(t){throw new Error}function Bx(t){}function Lc(t){let e=Object.values(t).filter(n=>typeof n=="number");return Object.entries(t).filter(([n,s])=>e.indexOf(+n)===-1).map(([n,s])=>s)}function Oi(t,e="|"){return t.map(r=>ji(r)).join(e)}function Vc(t,e){return typeof e=="bigint"?e.toString():e}function Fs(t){return{get value(){{let r=t();return Object.defineProperty(this,"value",{value:r}),r}throw new Error("cached value already set")}}}function Us(t){return t==null}function Hs(t){let e=t.startsWith("^")?1:0,r=t.endsWith("$")?t.length-1:t.length;return t.slice(e,r)}function Fc(t,e){let r=(t.toString().split(".")[1]||"").length,n=(e.toString().split(".")[1]||"").length,s=r>n?r:n,o=Number.parseInt(t.toFixed(s).replace(".","")),i=Number.parseInt(e.toFixed(s).replace(".",""));return o%i/10**s}function _e(t,e,r){Object.defineProperty(t,e,{get(){{let s=r();return t[e]=s,s}throw new Error("cached value already set")},set(s){Object.defineProperty(t,e,{value:s})},configurable:!0})}function Uc(t,e,r){Object.defineProperty(t,e,{value:r,writable:!0,enumerable:!0,configurable:!0})}function Gx(t,e){return e?e.reduce((r,n)=>r?.[n],t):t}function Wx(t){let e=Object.keys(t),r=e.map(n=>t[n]);return Promise.all(r).then(n=>{let s={};for(let o=0;o<e.length;o++)s[e[o]]=n[o];return s})}function Jx(t=10){let e="abcdefghijklmnopqrstuvwxyz",r="";for(let n=0;n<t;n++)r+=e[Math.floor(Math.random()*e.length)];return r}function mn(t){return JSON.stringify(t)}var Ni=Error.captureStackTrace?Error.captureStackTrace:(...t)=>{};function Wn(t){return typeof t=="object"&&t!==null&&!Array.isArray(t)}var Hc=Fs(()=>{if(typeof navigator<"u"&&navigator?.userAgent?.includes("Cloudflare"))return!1;try{let t=Function;return new t(""),!0}catch{return!1}});function Jn(t){if(Wn(t)===!1)return!1;let e=t.constructor;if(e===void 0)return!0;let r=e.prototype;return!(Wn(r)===!1||Object.prototype.hasOwnProperty.call(r,"isPrototypeOf")===!1)}function Yx(t){let e=0;for(let r in t)Object.prototype.hasOwnProperty.call(t,r)&&e++;return e}var Qx=t=>{let e=typeof t;switch(e){case"undefined":return"undefined";case"string":return"string";case"number":return Number.isNaN(t)?"nan":"number";case"boolean":return"boolean";case"function":return"function";case"bigint":return"bigint";case"symbol":return"symbol";case"object":return Array.isArray(t)?"array":t===null?"null":t.then&&typeof t.then=="function"&&t.catch&&typeof t.catch=="function"?"promise":typeof Map<"u"&&t instanceof Map?"map":typeof Set<"u"&&t instanceof Set?"set":typeof Date<"u"&&t instanceof Date?"date":typeof File<"u"&&t instanceof File?"file":"object";default:throw new Error(`Unknown data type: ${e}`)}},Kc=new Set(["string","number","symbol"]),im=new Set(["string","number","bigint","boolean","symbol","undefined"]);function Ir(t){return t.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}function Bt(t,e,r){let n=new t._zod.constr(e??t._zod.def);return(!e||r?.parent)&&(n._zod.parent=t),n}function M(t){let e=t;if(!e)return{};if(typeof e=="string")return{error:()=>e};if(e?.message!==void 0){if(e?.error!==void 0)throw new Error("Cannot specify both `message` and `error` params");e.error=e.message}return delete e.message,typeof e.error=="string"?{...e,error:()=>e.error}:e}function Xx(t){let e;return new Proxy({},{get(r,n,s){return e??(e=t()),Reflect.get(e,n,s)},set(r,n,s,o){return e??(e=t()),Reflect.set(e,n,s,o)},has(r,n){return e??(e=t()),Reflect.has(e,n)},deleteProperty(r,n){return e??(e=t()),Reflect.deleteProperty(e,n)},ownKeys(r){return e??(e=t()),Reflect.ownKeys(e)},getOwnPropertyDescriptor(r,n){return e??(e=t()),Reflect.getOwnPropertyDescriptor(e,n)},defineProperty(r,n,s){return e??(e=t()),Reflect.defineProperty(e,n,s)}})}function ji(t){return typeof t=="bigint"?t.toString()+"n":typeof t=="string"?`"${t}"`:`${t}`}function Bc(t){return Object.keys(t).filter(e=>t[e]._zod.optin==="optional"&&t[e]._zod.optout==="optional")}var Gc={safeint:[Number.MIN_SAFE_INTEGER,Number.MAX_SAFE_INTEGER],int32:[-2147483648,2147483647],uint32:[0,4294967295],float32:[-34028234663852886e22,34028234663852886e22],float64:[-Number.MAX_VALUE,Number.MAX_VALUE]},am={int64:[BigInt("-9223372036854775808"),BigInt("9223372036854775807")],uint64:[BigInt(0),BigInt("18446744073709551615")]};function ek(t,e){let r={},n=t._zod.def;for(let s in e){if(!(s in n.shape))throw new Error(`Unrecognized key: "${s}"`);e[s]&&(r[s]=n.shape[s])}return Bt(t,{...t._zod.def,shape:r,checks:[]})}function tk(t,e){let r={...t._zod.def.shape},n=t._zod.def;for(let s in e){if(!(s in n.shape))throw new Error(`Unrecognized key: "${s}"`);e[s]&&delete r[s]}return Bt(t,{...t._zod.def,shape:r,checks:[]})}function rk(t,e){if(!Jn(e))throw new Error("Invalid input to extend: expected a plain object");let r={...t._zod.def,get shape(){let n={...t._zod.def.shape,...e};return Uc(this,"shape",n),n},checks:[]};return Bt(t,r)}function nk(t,e){return Bt(t,{...t._zod.def,get shape(){let r={...t._zod.def.shape,...e._zod.def.shape};return Uc(this,"shape",r),r},catchall:e._zod.def.catchall,checks:[]})}function sk(t,e,r){let n=e._zod.def.shape,s={...n};if(r)for(let o in r){if(!(o in n))throw new Error(`Unrecognized key: "${o}"`);r[o]&&(s[o]=t?new t({type:"optional",innerType:n[o]}):n[o])}else for(let o in n)s[o]=t?new t({type:"optional",innerType:n[o]}):n[o];return Bt(e,{...e._zod.def,shape:s,checks:[]})}function ok(t,e,r){let n=e._zod.def.shape,s={...n};if(r)for(let o in r){if(!(o in s))throw new Error(`Unrecognized key: "${o}"`);r[o]&&(s[o]=new t({type:"nonoptional",innerType:n[o]}))}else for(let o in n)s[o]=new t({type:"nonoptional",innerType:n[o]});return Bt(e,{...e._zod.def,shape:s,checks:[]})}function hn(t,e=0){for(let r=e;r<t.issues.length;r++)if(t.issues[r]?.continue!==!0)return!0;return!1}function Gt(t,e){return e.map(r=>{var n;return(n=r).path??(n.path=[]),r.path.unshift(t),r})}function Vs(t){return typeof t=="string"?t:t?.message}function Rt(t,e,r){let n={...t,path:t.path??[]};if(!t.message){let s=Vs(t.inst?._zod.def?.error?.(t))??Vs(e?.error?.(t))??Vs(r.customError?.(t))??Vs(r.localeError?.(t))??"Invalid input";n.message=s}return delete n.inst,delete n.continue,e?.reportInput||delete n.input,n}function cm(t){return t instanceof Set?"set":t instanceof Map?"map":t instanceof File?"file":"unknown"}function Ks(t){return Array.isArray(t)?"array":typeof t=="string"?"string":"unknown"}function Wc(...t){let[e,r,n]=t;return typeof e=="string"?{message:e,code:"custom",input:r,inst:n}:{...e}}function ik(t){return Object.entries(t).filter(([e,r])=>Number.isNaN(Number.parseInt(e,10))).map(e=>e[1])}var Zc=class{constructor(...e){}};var um=(t,e)=>{t.name="$ZodError",Object.defineProperty(t,"_zod",{value:t._zod,enumerable:!1}),Object.defineProperty(t,"issues",{value:e,enumerable:!1}),Object.defineProperty(t,"message",{get(){return JSON.stringify(e,Vc,2)},enumerable:!0}),Object.defineProperty(t,"toString",{value:()=>t.message,enumerable:!1})},Ai=b("$ZodError",um),Jc=b("$ZodError",um,{Parent:Error});function lm(t,e=r=>r.message){let r={},n=[];for(let s of t.issues)s.path.length>0?(r[s.path[0]]=r[s.path[0]]||[],r[s.path[0]].push(e(s))):n.push(e(s));return{formErrors:n,fieldErrors:r}}function dm(t,e){let r=e||function(o){return o.message},n={_errors:[]},s=o=>{for(let i of o.issues)if(i.code==="invalid_union"&&i.errors.length)i.errors.map(a=>s({issues:a}));else if(i.code==="invalid_key")s({issues:i.issues});else if(i.code==="invalid_element")s({issues:i.issues});else if(i.path.length===0)n._errors.push(r(i));else{let a=n,c=0;for(;c<i.path.length;){let u=i.path[c];c===i.path.length-1?(a[u]=a[u]||{_errors:[]},a[u]._errors.push(r(i))):a[u]=a[u]||{_errors:[]},a=a[u],c++}}};return s(t),n}var pm=t=>(e,r,n,s)=>{let o=n?Object.assign(n,{async:!1}):{async:!1},i=e._zod.run({value:r,issues:[]},o);if(i instanceof Promise)throw new pr;if(i.issues.length){let a=new(s?.Err??t)(i.issues.map(c=>Rt(c,o,bt())));throw Ni(a,s?.callee),a}return i.value};var fm=t=>async(e,r,n,s)=>{let o=n?Object.assign(n,{async:!0}):{async:!0},i=e._zod.run({value:r,issues:[]},o);if(i instanceof Promise&&(i=await i),i.issues.length){let a=new(s?.Err??t)(i.issues.map(c=>Rt(c,o,bt())));throw Ni(a,s?.callee),a}return i.value};var Yc=t=>(e,r,n)=>{let s=n?{...n,async:!1}:{async:!1},o=e._zod.run({value:r,issues:[]},s);if(o instanceof Promise)throw new pr;return o.issues.length?{success:!1,error:new(t??Ai)(o.issues.map(i=>Rt(i,s,bt())))}:{success:!0,data:o.value}},Bs=Yc(Jc),Qc=t=>async(e,r,n)=>{let s=n?Object.assign(n,{async:!0}):{async:!0},o=e._zod.run({value:r,issues:[]},s);return o instanceof Promise&&(o=await o),o.issues.length?{success:!1,error:new t(o.issues.map(i=>Rt(i,s,bt())))}:{success:!0,data:o.value}},Mi=Qc(Jc);var mm=/^[cC][^\s-]{8,}$/,hm=/^[0-9a-z]+$/,gm=/^[0-9A-HJKMNP-TV-Za-hjkmnp-tv-z]{26}$/,ym=/^[0-9a-vA-V]{20}$/,vm=/^[A-Za-z0-9]{27}$/,_m=/^[a-zA-Z0-9_-]{21}$/,bm=/^P(?:(\d+W)|(?!.*W)(?=\d|T\d)(\d+Y)?(\d+M)?(\d+D)?(T(?=\d)(\d+H)?(\d+M)?(\d+([.,]\d+)?S)?)?)$/;var wm=/^([0-9a-fA-F]{8}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{12})$/,Xc=t=>t?new RegExp(`^([0-9a-fA-F]{8}-[0-9a-fA-F]{4}-${t}[0-9a-fA-F]{3}-[89abAB][0-9a-fA-F]{3}-[0-9a-fA-F]{12})$`):/^([0-9a-fA-F]{8}-[0-9a-fA-F]{4}-[1-8][0-9a-fA-F]{3}-[89abAB][0-9a-fA-F]{3}-[0-9a-fA-F]{12}|00000000-0000-0000-0000-000000000000)$/;var $m=/^(?!\.)(?!.*\.\.)([A-Za-z0-9_'+\-\.]*)[A-Za-z0-9_+-]@([A-Za-z0-9][A-Za-z0-9\-]*\.)+[A-Za-z]{2,}$/;var ck="^(\\p{Extended_Pictographic}|\\p{Emoji_Component})+$";function xm(){return new RegExp(ck,"u")}var km=/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])$/,Sm=/^(([0-9a-fA-F]{1,4}:){7}[0-9a-fA-F]{1,4}|::|([0-9a-fA-F]{1,4})?::([0-9a-fA-F]{1,4}:?){0,6})$/,Pm=/^((25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\/([0-9]|[1-2][0-9]|3[0-2])$/,Em=/^(([0-9a-fA-F]{1,4}:){7}[0-9a-fA-F]{1,4}|::|([0-9a-fA-F]{1,4})?::([0-9a-fA-F]{1,4}:?){0,6})\/(12[0-8]|1[01][0-9]|[1-9]?[0-9])$/,Tm=/^$|^(?:[0-9a-zA-Z+/]{4})*(?:(?:[0-9a-zA-Z+/]{2}==)|(?:[0-9a-zA-Z+/]{3}=))?$/,eu=/^[A-Za-z0-9_-]*$/,zm=/^([a-zA-Z0-9-]+\.)*[a-zA-Z0-9-]+$/;var Cm=/^\+(?:[0-9]){6,14}[0-9]$/,Im="(?:(?:\\d\\d[2468][048]|\\d\\d[13579][26]|\\d\\d0[48]|[02468][048]00|[13579][26]00)-02-29|\\d{4}-(?:(?:0[13578]|1[02])-(?:0[1-9]|[12]\\d|3[01])|(?:0[469]|11)-(?:0[1-9]|[12]\\d|30)|(?:02)-(?:0[1-9]|1\\d|2[0-8])))",Rm=new RegExp(`^${Im}$`);function Om(t){let e="(?:[01]\\d|2[0-3]):[0-5]\\d";return typeof t.precision=="number"?t.precision===-1?`${e}`:t.precision===0?`${e}:[0-5]\\d`:`${e}:[0-5]\\d\\.\\d{${t.precision}}`:`${e}(?::[0-5]\\d(?:\\.\\d+)?)?`}function Nm(t){return new RegExp(`^${Om(t)}$`)}function jm(t){let e=Om({precision:t.precision}),r=["Z"];t.local&&r.push(""),t.offset&&r.push("([+-]\\d{2}:\\d{2})");let n=`${e}(?:${r.join("|")})`;return new RegExp(`^${Im}T(?:${n})$`)}var Am=t=>{let e=t?`[\\s\\S]{${t?.minimum??0},${t?.maximum??""}}`:"[\\s\\S]*";return new RegExp(`^${e}$`)};var Mm=/^\d+$/,qm=/^-?\d+(?:\.\d+)?/i,Dm=/true|false/i,Zm=/null/i;var Lm=/^[^A-Z]*$/,Vm=/^[^a-z]*$/;var Ge=b("$ZodCheck",(t,e)=>{var r;t._zod??(t._zod={}),t._zod.def=e,(r=t._zod).onattach??(r.onattach=[])}),Fm={number:"number",bigint:"bigint",object:"date"},ru=b("$ZodCheckLessThan",(t,e)=>{Ge.init(t,e);let r=Fm[typeof e.value];t._zod.onattach.push(n=>{let s=n._zod.bag,o=(e.inclusive?s.maximum:s.exclusiveMaximum)??Number.POSITIVE_INFINITY;e.value<o&&(e.inclusive?s.maximum=e.value:s.exclusiveMaximum=e.value)}),t._zod.check=n=>{(e.inclusive?n.value<=e.value:n.value<e.value)||n.issues.push({origin:r,code:"too_big",maximum:e.value,input:n.value,inclusive:e.inclusive,inst:t,continue:!e.abort})}}),nu=b("$ZodCheckGreaterThan",(t,e)=>{Ge.init(t,e);let r=Fm[typeof e.value];t._zod.onattach.push(n=>{let s=n._zod.bag,o=(e.inclusive?s.minimum:s.exclusiveMinimum)??Number.NEGATIVE_INFINITY;e.value>o&&(e.inclusive?s.minimum=e.value:s.exclusiveMinimum=e.value)}),t._zod.check=n=>{(e.inclusive?n.value>=e.value:n.value>e.value)||n.issues.push({origin:r,code:"too_small",minimum:e.value,input:n.value,inclusive:e.inclusive,inst:t,continue:!e.abort})}}),Um=b("$ZodCheckMultipleOf",(t,e)=>{Ge.init(t,e),t._zod.onattach.push(r=>{var n;(n=r._zod.bag).multipleOf??(n.multipleOf=e.value)}),t._zod.check=r=>{if(typeof r.value!=typeof e.value)throw new Error("Cannot mix number and bigint in multiple_of check.");(typeof r.value=="bigint"?r.value%e.value===BigInt(0):Fc(r.value,e.value)===0)||r.issues.push({origin:typeof r.value,code:"not_multiple_of",divisor:e.value,input:r.value,inst:t,continue:!e.abort})}}),Hm=b("$ZodCheckNumberFormat",(t,e)=>{Ge.init(t,e),e.format=e.format||"float64";let r=e.format?.includes("int"),n=r?"int":"number",[s,o]=Gc[e.format];t._zod.onattach.push(i=>{let a=i._zod.bag;a.format=e.format,a.minimum=s,a.maximum=o,r&&(a.pattern=Mm)}),t._zod.check=i=>{let a=i.value;if(r){if(!Number.isInteger(a)){i.issues.push({expected:n,format:e.format,code:"invalid_type",input:a,inst:t});return}if(!Number.isSafeInteger(a)){a>0?i.issues.push({input:a,code:"too_big",maximum:Number.MAX_SAFE_INTEGER,note:"Integers must be within the safe integer range.",inst:t,origin:n,continue:!e.abort}):i.issues.push({input:a,code:"too_small",minimum:Number.MIN_SAFE_INTEGER,note:"Integers must be within the safe integer range.",inst:t,origin:n,continue:!e.abort});return}}a<s&&i.issues.push({origin:"number",input:a,code:"too_small",minimum:s,inclusive:!0,inst:t,continue:!e.abort}),a>o&&i.issues.push({origin:"number",input:a,code:"too_big",maximum:o,inst:t})}});var Km=b("$ZodCheckMaxLength",(t,e)=>{var r;Ge.init(t,e),(r=t._zod.def).when??(r.when=n=>{let s=n.value;return!Us(s)&&s.length!==void 0}),t._zod.onattach.push(n=>{let s=n._zod.bag.maximum??Number.POSITIVE_INFINITY;e.maximum<s&&(n._zod.bag.maximum=e.maximum)}),t._zod.check=n=>{let s=n.value;if(s.length<=e.maximum)return;let i=Ks(s);n.issues.push({origin:i,code:"too_big",maximum:e.maximum,inclusive:!0,input:s,inst:t,continue:!e.abort})}}),Bm=b("$ZodCheckMinLength",(t,e)=>{var r;Ge.init(t,e),(r=t._zod.def).when??(r.when=n=>{let s=n.value;return!Us(s)&&s.length!==void 0}),t._zod.onattach.push(n=>{let s=n._zod.bag.minimum??Number.NEGATIVE_INFINITY;e.minimum>s&&(n._zod.bag.minimum=e.minimum)}),t._zod.check=n=>{let s=n.value;if(s.length>=e.minimum)return;let i=Ks(s);n.issues.push({origin:i,code:"too_small",minimum:e.minimum,inclusive:!0,input:s,inst:t,continue:!e.abort})}}),Gm=b("$ZodCheckLengthEquals",(t,e)=>{var r;Ge.init(t,e),(r=t._zod.def).when??(r.when=n=>{let s=n.value;return!Us(s)&&s.length!==void 0}),t._zod.onattach.push(n=>{let s=n._zod.bag;s.minimum=e.length,s.maximum=e.length,s.length=e.length}),t._zod.check=n=>{let s=n.value,o=s.length;if(o===e.length)return;let i=Ks(s),a=o>e.length;n.issues.push({origin:i,...a?{code:"too_big",maximum:e.length}:{code:"too_small",minimum:e.length},inclusive:!0,exact:!0,input:n.value,inst:t,continue:!e.abort})}}),Gs=b("$ZodCheckStringFormat",(t,e)=>{var r,n;Ge.init(t,e),t._zod.onattach.push(s=>{let o=s._zod.bag;o.format=e.format,e.pattern&&(o.patterns??(o.patterns=new Set),o.patterns.add(e.pattern))}),e.pattern?(r=t._zod).check??(r.check=s=>{e.pattern.lastIndex=0,!e.pattern.test(s.value)&&s.issues.push({origin:"string",code:"invalid_format",format:e.format,input:s.value,...e.pattern?{pattern:e.pattern.toString()}:{},inst:t,continue:!e.abort})}):(n=t._zod).check??(n.check=()=>{})}),Wm=b("$ZodCheckRegex",(t,e)=>{Gs.init(t,e),t._zod.check=r=>{e.pattern.lastIndex=0,!e.pattern.test(r.value)&&r.issues.push({origin:"string",code:"invalid_format",format:"regex",input:r.value,pattern:e.pattern.toString(),inst:t,continue:!e.abort})}}),Jm=b("$ZodCheckLowerCase",(t,e)=>{e.pattern??(e.pattern=Lm),Gs.init(t,e)}),Ym=b("$ZodCheckUpperCase",(t,e)=>{e.pattern??(e.pattern=Vm),Gs.init(t,e)}),Qm=b("$ZodCheckIncludes",(t,e)=>{Ge.init(t,e);let r=Ir(e.includes),n=new RegExp(typeof e.position=="number"?`^.{${e.position}}${r}`:r);e.pattern=n,t._zod.onattach.push(s=>{let o=s._zod.bag;o.patterns??(o.patterns=new Set),o.patterns.add(n)}),t._zod.check=s=>{s.value.includes(e.includes,e.position)||s.issues.push({origin:"string",code:"invalid_format",format:"includes",includes:e.includes,input:s.value,inst:t,continue:!e.abort})}}),Xm=b("$ZodCheckStartsWith",(t,e)=>{Ge.init(t,e);let r=new RegExp(`^${Ir(e.prefix)}.*`);e.pattern??(e.pattern=r),t._zod.onattach.push(n=>{let s=n._zod.bag;s.patterns??(s.patterns=new Set),s.patterns.add(r)}),t._zod.check=n=>{n.value.startsWith(e.prefix)||n.issues.push({origin:"string",code:"invalid_format",format:"starts_with",prefix:e.prefix,input:n.value,inst:t,continue:!e.abort})}}),eh=b("$ZodCheckEndsWith",(t,e)=>{Ge.init(t,e);let r=new RegExp(`.*${Ir(e.suffix)}$`);e.pattern??(e.pattern=r),t._zod.onattach.push(n=>{let s=n._zod.bag;s.patterns??(s.patterns=new Set),s.patterns.add(r)}),t._zod.check=n=>{n.value.endsWith(e.suffix)||n.issues.push({origin:"string",code:"invalid_format",format:"ends_with",suffix:e.suffix,input:n.value,inst:t,continue:!e.abort})}});var th=b("$ZodCheckOverwrite",(t,e)=>{Ge.init(t,e),t._zod.check=r=>{r.value=e.tx(r.value)}});var qi=class{constructor(e=[]){this.content=[],this.indent=0,this&&(this.args=e)}indented(e){this.indent+=1,e(this),this.indent-=1}write(e){if(typeof e=="function"){e(this,{execution:"sync"}),e(this,{execution:"async"});return}let n=e.split(`
`).filter(i=>i),s=Math.min(...n.map(i=>i.length-i.trimStart().length)),o=n.map(i=>i.slice(s)).map(i=>" ".repeat(this.indent*2)+i);for(let i of o)this.content.push(i)}compile(){let e=Function,r=this?.args,s=[...(this?.content??[""]).map(o=>`  ${o}`)];return new e(...r,s.join(`
`))}};var nh={major:4,minor:0,patch:0};var be=b("$ZodType",(t,e)=>{var r;t??(t={}),t._zod.def=e,t._zod.bag=t._zod.bag||{},t._zod.version=nh;let n=[...t._zod.def.checks??[]];t._zod.traits.has("$ZodCheck")&&n.unshift(t);for(let s of n)for(let o of s._zod.onattach)o(t);if(n.length===0)(r=t._zod).deferred??(r.deferred=[]),t._zod.deferred?.push(()=>{t._zod.run=t._zod.parse});else{let s=(o,i,a)=>{let c=hn(o),u;for(let l of i){if(l._zod.def.when){if(!l._zod.def.when(o))continue}else if(c)continue;let d=o.issues.length,f=l._zod.check(o);if(f instanceof Promise&&a?.async===!1)throw new pr;if(u||f instanceof Promise)u=(u??Promise.resolve()).then(async()=>{await f,o.issues.length!==d&&(c||(c=hn(o,d)))});else{if(o.issues.length===d)continue;c||(c=hn(o,d))}}return u?u.then(()=>o):o};t._zod.run=(o,i)=>{let a=t._zod.parse(o,i);if(a instanceof Promise){if(i.async===!1)throw new pr;return a.then(c=>s(c,n,i))}return s(a,n,i)}}t["~standard"]={validate:s=>{try{let o=Bs(t,s);return o.success?{value:o.data}:{issues:o.error?.issues}}catch{return Mi(t,s).then(i=>i.success?{value:i.data}:{issues:i.error?.issues})}},vendor:"zod",version:1}}),Zi=b("$ZodString",(t,e)=>{be.init(t,e),t._zod.pattern=[...t?._zod.bag?.patterns??[]].pop()??Am(t._zod.bag),t._zod.parse=(r,n)=>{if(e.coerce)try{r.value=String(r.value)}catch{}return typeof r.value=="string"||r.issues.push({expected:"string",code:"invalid_type",input:r.value,inst:t}),r}}),$e=b("$ZodStringFormat",(t,e)=>{Gs.init(t,e),Zi.init(t,e)}),fh=b("$ZodGUID",(t,e)=>{e.pattern??(e.pattern=wm),$e.init(t,e)}),mh=b("$ZodUUID",(t,e)=>{if(e.version){let n={v1:1,v2:2,v3:3,v4:4,v5:5,v6:6,v7:7,v8:8}[e.version];if(n===void 0)throw new Error(`Invalid UUID version: "${e.version}"`);e.pattern??(e.pattern=Xc(n))}else e.pattern??(e.pattern=Xc());$e.init(t,e)}),hh=b("$ZodEmail",(t,e)=>{e.pattern??(e.pattern=$m),$e.init(t,e)}),gh=b("$ZodURL",(t,e)=>{$e.init(t,e),t._zod.check=r=>{try{let n=r.value,s=new URL(n),o=s.href;e.hostname&&(e.hostname.lastIndex=0,e.hostname.test(s.hostname)||r.issues.push({code:"invalid_format",format:"url",note:"Invalid hostname",pattern:zm.source,input:r.value,inst:t,continue:!e.abort})),e.protocol&&(e.protocol.lastIndex=0,e.protocol.test(s.protocol.endsWith(":")?s.protocol.slice(0,-1):s.protocol)||r.issues.push({code:"invalid_format",format:"url",note:"Invalid protocol",pattern:e.protocol.source,input:r.value,inst:t,continue:!e.abort})),!n.endsWith("/")&&o.endsWith("/")?r.value=o.slice(0,-1):r.value=o;return}catch{r.issues.push({code:"invalid_format",format:"url",input:r.value,inst:t,continue:!e.abort})}}}),yh=b("$ZodEmoji",(t,e)=>{e.pattern??(e.pattern=xm()),$e.init(t,e)}),vh=b("$ZodNanoID",(t,e)=>{e.pattern??(e.pattern=_m),$e.init(t,e)}),_h=b("$ZodCUID",(t,e)=>{e.pattern??(e.pattern=mm),$e.init(t,e)}),bh=b("$ZodCUID2",(t,e)=>{e.pattern??(e.pattern=hm),$e.init(t,e)}),wh=b("$ZodULID",(t,e)=>{e.pattern??(e.pattern=gm),$e.init(t,e)}),$h=b("$ZodXID",(t,e)=>{e.pattern??(e.pattern=ym),$e.init(t,e)}),xh=b("$ZodKSUID",(t,e)=>{e.pattern??(e.pattern=vm),$e.init(t,e)}),kh=b("$ZodISODateTime",(t,e)=>{e.pattern??(e.pattern=jm(e)),$e.init(t,e)}),Sh=b("$ZodISODate",(t,e)=>{e.pattern??(e.pattern=Rm),$e.init(t,e)}),Ph=b("$ZodISOTime",(t,e)=>{e.pattern??(e.pattern=Nm(e)),$e.init(t,e)}),Eh=b("$ZodISODuration",(t,e)=>{e.pattern??(e.pattern=bm),$e.init(t,e)}),Th=b("$ZodIPv4",(t,e)=>{e.pattern??(e.pattern=km),$e.init(t,e),t._zod.onattach.push(r=>{let n=r._zod.bag;n.format="ipv4"})}),zh=b("$ZodIPv6",(t,e)=>{e.pattern??(e.pattern=Sm),$e.init(t,e),t._zod.onattach.push(r=>{let n=r._zod.bag;n.format="ipv6"}),t._zod.check=r=>{try{new URL(`http://[${r.value}]`)}catch{r.issues.push({code:"invalid_format",format:"ipv6",input:r.value,inst:t,continue:!e.abort})}}}),Ch=b("$ZodCIDRv4",(t,e)=>{e.pattern??(e.pattern=Pm),$e.init(t,e)}),Ih=b("$ZodCIDRv6",(t,e)=>{e.pattern??(e.pattern=Em),$e.init(t,e),t._zod.check=r=>{let[n,s]=r.value.split("/");try{if(!s)throw new Error;let o=Number(s);if(`${o}`!==s)throw new Error;if(o<0||o>128)throw new Error;new URL(`http://[${n}]`)}catch{r.issues.push({code:"invalid_format",format:"cidrv6",input:r.value,inst:t,continue:!e.abort})}}});function Rh(t){if(t==="")return!0;if(t.length%4!==0)return!1;try{return atob(t),!0}catch{return!1}}var Oh=b("$ZodBase64",(t,e)=>{e.pattern??(e.pattern=Tm),$e.init(t,e),t._zod.onattach.push(r=>{r._zod.bag.contentEncoding="base64"}),t._zod.check=r=>{Rh(r.value)||r.issues.push({code:"invalid_format",format:"base64",input:r.value,inst:t,continue:!e.abort})}});function uk(t){if(!eu.test(t))return!1;let e=t.replace(/[-_]/g,n=>n==="-"?"+":"/"),r=e.padEnd(Math.ceil(e.length/4)*4,"=");return Rh(r)}var Nh=b("$ZodBase64URL",(t,e)=>{e.pattern??(e.pattern=eu),$e.init(t,e),t._zod.onattach.push(r=>{r._zod.bag.contentEncoding="base64url"}),t._zod.check=r=>{uk(r.value)||r.issues.push({code:"invalid_format",format:"base64url",input:r.value,inst:t,continue:!e.abort})}}),jh=b("$ZodE164",(t,e)=>{e.pattern??(e.pattern=Cm),$e.init(t,e)});function lk(t,e=null){try{let r=t.split(".");if(r.length!==3)return!1;let[n]=r;if(!n)return!1;let s=JSON.parse(atob(n));return!("typ"in s&&s?.typ!=="JWT"||!s.alg||e&&(!("alg"in s)||s.alg!==e))}catch{return!1}}var Ah=b("$ZodJWT",(t,e)=>{$e.init(t,e),t._zod.check=r=>{lk(r.value,e.alg)||r.issues.push({code:"invalid_format",format:"jwt",input:r.value,inst:t,continue:!e.abort})}});var ou=b("$ZodNumber",(t,e)=>{be.init(t,e),t._zod.pattern=t._zod.bag.pattern??qm,t._zod.parse=(r,n)=>{if(e.coerce)try{r.value=Number(r.value)}catch{}let s=r.value;if(typeof s=="number"&&!Number.isNaN(s)&&Number.isFinite(s))return r;let o=typeof s=="number"?Number.isNaN(s)?"NaN":Number.isFinite(s)?void 0:"Infinity":void 0;return r.issues.push({expected:"number",code:"invalid_type",input:s,inst:t,...o?{received:o}:{}}),r}}),Mh=b("$ZodNumber",(t,e)=>{Hm.init(t,e),ou.init(t,e)}),qh=b("$ZodBoolean",(t,e)=>{be.init(t,e),t._zod.pattern=Dm,t._zod.parse=(r,n)=>{if(e.coerce)try{r.value=!!r.value}catch{}let s=r.value;return typeof s=="boolean"||r.issues.push({expected:"boolean",code:"invalid_type",input:s,inst:t}),r}});var Dh=b("$ZodNull",(t,e)=>{be.init(t,e),t._zod.pattern=Zm,t._zod.values=new Set([null]),t._zod.parse=(r,n)=>{let s=r.value;return s===null||r.issues.push({expected:"null",code:"invalid_type",input:s,inst:t}),r}});var Zh=b("$ZodUnknown",(t,e)=>{be.init(t,e),t._zod.parse=r=>r}),Lh=b("$ZodNever",(t,e)=>{be.init(t,e),t._zod.parse=(r,n)=>(r.issues.push({expected:"never",code:"invalid_type",input:r.value,inst:t}),r)});function sh(t,e,r){t.issues.length&&e.issues.push(...Gt(r,t.issues)),e.value[r]=t.value}var Vh=b("$ZodArray",(t,e)=>{be.init(t,e),t._zod.parse=(r,n)=>{let s=r.value;if(!Array.isArray(s))return r.issues.push({expected:"array",code:"invalid_type",input:s,inst:t}),r;r.value=Array(s.length);let o=[];for(let i=0;i<s.length;i++){let a=s[i],c=e.element._zod.run({value:a,issues:[]},n);c instanceof Promise?o.push(c.then(u=>sh(u,r,i))):sh(c,r,i)}return o.length?Promise.all(o).then(()=>r):r}});function Di(t,e,r){t.issues.length&&e.issues.push(...Gt(r,t.issues)),e.value[r]=t.value}function oh(t,e,r,n){t.issues.length?n[r]===void 0?r in n?e.value[r]=void 0:e.value[r]=t.value:e.issues.push(...Gt(r,t.issues)):t.value===void 0?r in n&&(e.value[r]=void 0):e.value[r]=t.value}var Fh=b("$ZodObject",(t,e)=>{be.init(t,e);let r=Fs(()=>{let d=Object.keys(e.shape);for(let p of d)if(!(e.shape[p]instanceof be))throw new Error(`Invalid element at key "${p}": expected a Zod schema`);let f=Bc(e.shape);return{shape:e.shape,keys:d,keySet:new Set(d),numKeys:d.length,optionalKeys:new Set(f)}});_e(t._zod,"propValues",()=>{let d=e.shape,f={};for(let p in d){let m=d[p]._zod;if(m.values){f[p]??(f[p]=new Set);for(let h of m.values)f[p].add(h)}}return f});let n=d=>{let f=new qi(["shape","payload","ctx"]),p=r.value,m=x=>{let $=mn(x);return`shape[${$}]._zod.run({ value: input[${$}], issues: [] }, ctx)`};f.write("const input = payload.value;");let h=Object.create(null),g=0;for(let x of p.keys)h[x]=`key_${g++}`;f.write("const newResult = {}");for(let x of p.keys)if(p.optionalKeys.has(x)){let $=h[x];f.write(`const ${$} = ${m(x)};`);let S=mn(x);f.write(`
        if (${$}.issues.length) {
          if (input[${S}] === undefined) {
            if (${S} in input) {
              newResult[${S}] = undefined;
            }
          } else {
            payload.issues = payload.issues.concat(
              ${$}.issues.map((iss) => ({
                ...iss,
                path: iss.path ? [${S}, ...iss.path] : [${S}],
              }))
            );
          }
        } else if (${$}.value === undefined) {
          if (${S} in input) newResult[${S}] = undefined;
        } else {
          newResult[${S}] = ${$}.value;
        }
        `)}else{let $=h[x];f.write(`const ${$} = ${m(x)};`),f.write(`
          if (${$}.issues.length) payload.issues = payload.issues.concat(${$}.issues.map(iss => ({
            ...iss,
            path: iss.path ? [${mn(x)}, ...iss.path] : [${mn(x)}]
          })));`),f.write(`newResult[${mn(x)}] = ${$}.value`)}f.write("payload.value = newResult;"),f.write("return payload;");let y=f.compile();return(x,$)=>y(d,x,$)},s,o=Wn,i=!Ri.jitless,c=i&&Hc.value,u=e.catchall,l;t._zod.parse=(d,f)=>{l??(l=r.value);let p=d.value;if(!o(p))return d.issues.push({expected:"object",code:"invalid_type",input:p,inst:t}),d;let m=[];if(i&&c&&f?.async===!1&&f.jitless!==!0)s||(s=n(e.shape)),d=s(d,f);else{d.value={};let $=l.shape;for(let S of l.keys){let w=$[S],D=w._zod.run({value:p[S],issues:[]},f),F=w._zod.optin==="optional"&&w._zod.optout==="optional";D instanceof Promise?m.push(D.then(Ce=>F?oh(Ce,d,S,p):Di(Ce,d,S))):F?oh(D,d,S,p):Di(D,d,S)}}if(!u)return m.length?Promise.all(m).then(()=>d):d;let h=[],g=l.keySet,y=u._zod,x=y.def.type;for(let $ of Object.keys(p)){if(g.has($))continue;if(x==="never"){h.push($);continue}let S=y.run({value:p[$],issues:[]},f);S instanceof Promise?m.push(S.then(w=>Di(w,d,$))):Di(S,d,$)}return h.length&&d.issues.push({code:"unrecognized_keys",keys:h,input:p,inst:t}),m.length?Promise.all(m).then(()=>d):d}});function ih(t,e,r,n){for(let s of t)if(s.issues.length===0)return e.value=s.value,e;return e.issues.push({code:"invalid_union",input:e.value,inst:r,errors:t.map(s=>s.issues.map(o=>Rt(o,n,bt())))}),e}var iu=b("$ZodUnion",(t,e)=>{be.init(t,e),_e(t._zod,"optin",()=>e.options.some(r=>r._zod.optin==="optional")?"optional":void 0),_e(t._zod,"optout",()=>e.options.some(r=>r._zod.optout==="optional")?"optional":void 0),_e(t._zod,"values",()=>{if(e.options.every(r=>r._zod.values))return new Set(e.options.flatMap(r=>Array.from(r._zod.values)))}),_e(t._zod,"pattern",()=>{if(e.options.every(r=>r._zod.pattern)){let r=e.options.map(n=>n._zod.pattern);return new RegExp(`^(${r.map(n=>Hs(n.source)).join("|")})$`)}}),t._zod.parse=(r,n)=>{let s=!1,o=[];for(let i of e.options){let a=i._zod.run({value:r.value,issues:[]},n);if(a instanceof Promise)o.push(a),s=!0;else{if(a.issues.length===0)return a;o.push(a)}}return s?Promise.all(o).then(i=>ih(i,r,t,n)):ih(o,r,t,n)}}),Uh=b("$ZodDiscriminatedUnion",(t,e)=>{iu.init(t,e);let r=t._zod.parse;_e(t._zod,"propValues",()=>{let s={};for(let o of e.options){let i=o._zod.propValues;if(!i||Object.keys(i).length===0)throw new Error(`Invalid discriminated union option at index "${e.options.indexOf(o)}"`);for(let[a,c]of Object.entries(i)){s[a]||(s[a]=new Set);for(let u of c)s[a].add(u)}}return s});let n=Fs(()=>{let s=e.options,o=new Map;for(let i of s){let a=i._zod.propValues[e.discriminator];if(!a||a.size===0)throw new Error(`Invalid discriminated union option at index "${e.options.indexOf(i)}"`);for(let c of a){if(o.has(c))throw new Error(`Duplicate discriminator value "${String(c)}"`);o.set(c,i)}}return o});t._zod.parse=(s,o)=>{let i=s.value;if(!Wn(i))return s.issues.push({code:"invalid_type",expected:"object",input:i,inst:t}),s;let a=n.value.get(i?.[e.discriminator]);return a?a._zod.run(s,o):e.unionFallback?r(s,o):(s.issues.push({code:"invalid_union",errors:[],note:"No matching discriminator",input:i,path:[e.discriminator],inst:t}),s)}}),Hh=b("$ZodIntersection",(t,e)=>{be.init(t,e),t._zod.parse=(r,n)=>{let s=r.value,o=e.left._zod.run({value:s,issues:[]},n),i=e.right._zod.run({value:s,issues:[]},n);return o instanceof Promise||i instanceof Promise?Promise.all([o,i]).then(([c,u])=>ah(r,c,u)):ah(r,o,i)}});function su(t,e){if(t===e)return{valid:!0,data:t};if(t instanceof Date&&e instanceof Date&&+t==+e)return{valid:!0,data:t};if(Jn(t)&&Jn(e)){let r=Object.keys(e),n=Object.keys(t).filter(o=>r.indexOf(o)!==-1),s={...t,...e};for(let o of n){let i=su(t[o],e[o]);if(!i.valid)return{valid:!1,mergeErrorPath:[o,...i.mergeErrorPath]};s[o]=i.data}return{valid:!0,data:s}}if(Array.isArray(t)&&Array.isArray(e)){if(t.length!==e.length)return{valid:!1,mergeErrorPath:[]};let r=[];for(let n=0;n<t.length;n++){let s=t[n],o=e[n],i=su(s,o);if(!i.valid)return{valid:!1,mergeErrorPath:[n,...i.mergeErrorPath]};r.push(i.data)}return{valid:!0,data:r}}return{valid:!1,mergeErrorPath:[]}}function ah(t,e,r){if(e.issues.length&&t.issues.push(...e.issues),r.issues.length&&t.issues.push(...r.issues),hn(t))return t;let n=su(e.value,r.value);if(!n.valid)throw new Error(`Unmergable intersection. Error path: ${JSON.stringify(n.mergeErrorPath)}`);return t.value=n.data,t}var Kh=b("$ZodRecord",(t,e)=>{be.init(t,e),t._zod.parse=(r,n)=>{let s=r.value;if(!Jn(s))return r.issues.push({expected:"record",code:"invalid_type",input:s,inst:t}),r;let o=[];if(e.keyType._zod.values){let i=e.keyType._zod.values;r.value={};for(let c of i)if(typeof c=="string"||typeof c=="number"||typeof c=="symbol"){let u=e.valueType._zod.run({value:s[c],issues:[]},n);u instanceof Promise?o.push(u.then(l=>{l.issues.length&&r.issues.push(...Gt(c,l.issues)),r.value[c]=l.value})):(u.issues.length&&r.issues.push(...Gt(c,u.issues)),r.value[c]=u.value)}let a;for(let c in s)i.has(c)||(a=a??[],a.push(c));a&&a.length>0&&r.issues.push({code:"unrecognized_keys",input:s,inst:t,keys:a})}else{r.value={};for(let i of Reflect.ownKeys(s)){if(i==="__proto__")continue;let a=e.keyType._zod.run({value:i,issues:[]},n);if(a instanceof Promise)throw new Error("Async schemas not supported in object keys currently");if(a.issues.length){r.issues.push({origin:"record",code:"invalid_key",issues:a.issues.map(u=>Rt(u,n,bt())),input:i,path:[i],inst:t}),r.value[a.value]=a.value;continue}let c=e.valueType._zod.run({value:s[i],issues:[]},n);c instanceof Promise?o.push(c.then(u=>{u.issues.length&&r.issues.push(...Gt(i,u.issues)),r.value[a.value]=u.value})):(c.issues.length&&r.issues.push(...Gt(i,c.issues)),r.value[a.value]=c.value)}}return o.length?Promise.all(o).then(()=>r):r}});var Bh=b("$ZodEnum",(t,e)=>{be.init(t,e);let r=Lc(e.entries);t._zod.values=new Set(r),t._zod.pattern=new RegExp(`^(${r.filter(n=>Kc.has(typeof n)).map(n=>typeof n=="string"?Ir(n):n.toString()).join("|")})$`),t._zod.parse=(n,s)=>{let o=n.value;return t._zod.values.has(o)||n.issues.push({code:"invalid_value",values:r,input:o,inst:t}),n}}),Gh=b("$ZodLiteral",(t,e)=>{be.init(t,e),t._zod.values=new Set(e.values),t._zod.pattern=new RegExp(`^(${e.values.map(r=>typeof r=="string"?Ir(r):r?r.toString():String(r)).join("|")})$`),t._zod.parse=(r,n)=>{let s=r.value;return t._zod.values.has(s)||r.issues.push({code:"invalid_value",values:e.values,input:s,inst:t}),r}});var Wh=b("$ZodTransform",(t,e)=>{be.init(t,e),t._zod.parse=(r,n)=>{let s=e.transform(r.value,r);if(n.async)return(s instanceof Promise?s:Promise.resolve(s)).then(i=>(r.value=i,r));if(s instanceof Promise)throw new pr;return r.value=s,r}}),Jh=b("$ZodOptional",(t,e)=>{be.init(t,e),t._zod.optin="optional",t._zod.optout="optional",_e(t._zod,"values",()=>e.innerType._zod.values?new Set([...e.innerType._zod.values,void 0]):void 0),_e(t._zod,"pattern",()=>{let r=e.innerType._zod.pattern;return r?new RegExp(`^(${Hs(r.source)})?$`):void 0}),t._zod.parse=(r,n)=>e.innerType._zod.optin==="optional"?e.innerType._zod.run(r,n):r.value===void 0?r:e.innerType._zod.run(r,n)}),Yh=b("$ZodNullable",(t,e)=>{be.init(t,e),_e(t._zod,"optin",()=>e.innerType._zod.optin),_e(t._zod,"optout",()=>e.innerType._zod.optout),_e(t._zod,"pattern",()=>{let r=e.innerType._zod.pattern;return r?new RegExp(`^(${Hs(r.source)}|null)$`):void 0}),_e(t._zod,"values",()=>e.innerType._zod.values?new Set([...e.innerType._zod.values,null]):void 0),t._zod.parse=(r,n)=>r.value===null?r:e.innerType._zod.run(r,n)}),Qh=b("$ZodDefault",(t,e)=>{be.init(t,e),t._zod.optin="optional",_e(t._zod,"values",()=>e.innerType._zod.values),t._zod.parse=(r,n)=>{if(r.value===void 0)return r.value=e.defaultValue,r;let s=e.innerType._zod.run(r,n);return s instanceof Promise?s.then(o=>ch(o,e)):ch(s,e)}});function ch(t,e){return t.value===void 0&&(t.value=e.defaultValue),t}var Xh=b("$ZodPrefault",(t,e)=>{be.init(t,e),t._zod.optin="optional",_e(t._zod,"values",()=>e.innerType._zod.values),t._zod.parse=(r,n)=>(r.value===void 0&&(r.value=e.defaultValue),e.innerType._zod.run(r,n))}),eg=b("$ZodNonOptional",(t,e)=>{be.init(t,e),_e(t._zod,"values",()=>{let r=e.innerType._zod.values;return r?new Set([...r].filter(n=>n!==void 0)):void 0}),t._zod.parse=(r,n)=>{let s=e.innerType._zod.run(r,n);return s instanceof Promise?s.then(o=>uh(o,t)):uh(s,t)}});function uh(t,e){return!t.issues.length&&t.value===void 0&&t.issues.push({code:"invalid_type",expected:"nonoptional",input:t.value,inst:e}),t}var tg=b("$ZodCatch",(t,e)=>{be.init(t,e),t._zod.optin="optional",_e(t._zod,"optout",()=>e.innerType._zod.optout),_e(t._zod,"values",()=>e.innerType._zod.values),t._zod.parse=(r,n)=>{let s=e.innerType._zod.run(r,n);return s instanceof Promise?s.then(o=>(r.value=o.value,o.issues.length&&(r.value=e.catchValue({...r,error:{issues:o.issues.map(i=>Rt(i,n,bt()))},input:r.value}),r.issues=[]),r)):(r.value=s.value,s.issues.length&&(r.value=e.catchValue({...r,error:{issues:s.issues.map(o=>Rt(o,n,bt()))},input:r.value}),r.issues=[]),r)}});var rg=b("$ZodPipe",(t,e)=>{be.init(t,e),_e(t._zod,"values",()=>e.in._zod.values),_e(t._zod,"optin",()=>e.in._zod.optin),_e(t._zod,"optout",()=>e.out._zod.optout),t._zod.parse=(r,n)=>{let s=e.in._zod.run(r,n);return s instanceof Promise?s.then(o=>lh(o,e,n)):lh(s,e,n)}});function lh(t,e,r){return hn(t)?t:e.out._zod.run({value:t.value,issues:t.issues},r)}var ng=b("$ZodReadonly",(t,e)=>{be.init(t,e),_e(t._zod,"propValues",()=>e.innerType._zod.propValues),_e(t._zod,"values",()=>e.innerType._zod.values),_e(t._zod,"optin",()=>e.innerType._zod.optin),_e(t._zod,"optout",()=>e.innerType._zod.optout),t._zod.parse=(r,n)=>{let s=e.innerType._zod.run(r,n);return s instanceof Promise?s.then(dh):dh(s)}});function dh(t){return t.value=Object.freeze(t.value),t}var sg=b("$ZodCustom",(t,e)=>{Ge.init(t,e),be.init(t,e),t._zod.parse=(r,n)=>r,t._zod.check=r=>{let n=r.value,s=e.fn(n);if(s instanceof Promise)return s.then(o=>ph(o,r,n,t));ph(s,r,n,t)}});function ph(t,e,r,n){if(!t){let s={code:"custom",input:r,inst:n,path:[...n._zod.def.path??[]],continue:!n._zod.def.abort};n._zod.def.params&&(s.params=n._zod.def.params),e.issues.push(Wc(s))}}var dk=t=>{let e=typeof t;switch(e){case"number":return Number.isNaN(t)?"NaN":"number";case"object":{if(Array.isArray(t))return"array";if(t===null)return"null";if(Object.getPrototypeOf(t)!==Object.prototype&&t.constructor)return t.constructor.name}}return e},pk=()=>{let t={string:{unit:"characters",verb:"to have"},file:{unit:"bytes",verb:"to have"},array:{unit:"items",verb:"to have"},set:{unit:"items",verb:"to have"}};function e(n){return t[n]??null}let r={regex:"input",email:"email address",url:"URL",emoji:"emoji",uuid:"UUID",uuidv4:"UUIDv4",uuidv6:"UUIDv6",nanoid:"nanoid",guid:"GUID",cuid:"cuid",cuid2:"cuid2",ulid:"ULID",xid:"XID",ksuid:"KSUID",datetime:"ISO datetime",date:"ISO date",time:"ISO time",duration:"ISO duration",ipv4:"IPv4 address",ipv6:"IPv6 address",cidrv4:"IPv4 range",cidrv6:"IPv6 range",base64:"base64-encoded string",base64url:"base64url-encoded string",json_string:"JSON string",e164:"E.164 number",jwt:"JWT",template_literal:"input"};return n=>{switch(n.code){case"invalid_type":return`Invalid input: expected ${n.expected}, received ${dk(n.input)}`;case"invalid_value":return n.values.length===1?`Invalid input: expected ${ji(n.values[0])}`:`Invalid option: expected one of ${Oi(n.values,"|")}`;case"too_big":{let s=n.inclusive?"<=":"<",o=e(n.origin);return o?`Too big: expected ${n.origin??"value"} to have ${s}${n.maximum.toString()} ${o.unit??"elements"}`:`Too big: expected ${n.origin??"value"} to be ${s}${n.maximum.toString()}`}case"too_small":{let s=n.inclusive?">=":">",o=e(n.origin);return o?`Too small: expected ${n.origin} to have ${s}${n.minimum.toString()} ${o.unit}`:`Too small: expected ${n.origin} to be ${s}${n.minimum.toString()}`}case"invalid_format":{let s=n;return s.format==="starts_with"?`Invalid string: must start with "${s.prefix}"`:s.format==="ends_with"?`Invalid string: must end with "${s.suffix}"`:s.format==="includes"?`Invalid string: must include "${s.includes}"`:s.format==="regex"?`Invalid string: must match pattern ${s.pattern}`:`Invalid ${r[s.format]??n.format}`}case"not_multiple_of":return`Invalid number: must be a multiple of ${n.divisor}`;case"unrecognized_keys":return`Unrecognized key${n.keys.length>1?"s":""}: ${Oi(n.keys,", ")}`;case"invalid_key":return`Invalid key in ${n.origin}`;case"invalid_union":return"Invalid input";case"invalid_element":return`Invalid value in ${n.origin}`;default:return"Invalid input"}}};function og(){return{localeError:pk()}}var au=class{constructor(){this._map=new Map,this._idmap=new Map}add(e,...r){let n=r[0];if(this._map.set(e,n),n&&typeof n=="object"&&"id"in n){if(this._idmap.has(n.id))throw new Error(`ID ${n.id} already exists in the registry`);this._idmap.set(n.id,e)}return this}clear(){return this._map=new Map,this._idmap=new Map,this}remove(e){let r=this._map.get(e);return r&&typeof r=="object"&&"id"in r&&this._idmap.delete(r.id),this._map.delete(e),this}get(e){let r=e._zod.parent;if(r){let n={...this.get(r)??{}};return delete n.id,{...n,...this._map.get(e)}}return this._map.get(e)}has(e){return this._map.has(e)}};function fk(){return new au}var Ws=fk();function ig(t,e){return new t({type:"string",...M(e)})}function ag(t,e){return new t({type:"string",format:"email",check:"string_format",abort:!1,...M(e)})}function cu(t,e){return new t({type:"string",format:"guid",check:"string_format",abort:!1,...M(e)})}function cg(t,e){return new t({type:"string",format:"uuid",check:"string_format",abort:!1,...M(e)})}function ug(t,e){return new t({type:"string",format:"uuid",check:"string_format",abort:!1,version:"v4",...M(e)})}function lg(t,e){return new t({type:"string",format:"uuid",check:"string_format",abort:!1,version:"v6",...M(e)})}function dg(t,e){return new t({type:"string",format:"uuid",check:"string_format",abort:!1,version:"v7",...M(e)})}function pg(t,e){return new t({type:"string",format:"url",check:"string_format",abort:!1,...M(e)})}function fg(t,e){return new t({type:"string",format:"emoji",check:"string_format",abort:!1,...M(e)})}function mg(t,e){return new t({type:"string",format:"nanoid",check:"string_format",abort:!1,...M(e)})}function hg(t,e){return new t({type:"string",format:"cuid",check:"string_format",abort:!1,...M(e)})}function gg(t,e){return new t({type:"string",format:"cuid2",check:"string_format",abort:!1,...M(e)})}function yg(t,e){return new t({type:"string",format:"ulid",check:"string_format",abort:!1,...M(e)})}function vg(t,e){return new t({type:"string",format:"xid",check:"string_format",abort:!1,...M(e)})}function _g(t,e){return new t({type:"string",format:"ksuid",check:"string_format",abort:!1,...M(e)})}function bg(t,e){return new t({type:"string",format:"ipv4",check:"string_format",abort:!1,...M(e)})}function wg(t,e){return new t({type:"string",format:"ipv6",check:"string_format",abort:!1,...M(e)})}function $g(t,e){return new t({type:"string",format:"cidrv4",check:"string_format",abort:!1,...M(e)})}function xg(t,e){return new t({type:"string",format:"cidrv6",check:"string_format",abort:!1,...M(e)})}function kg(t,e){return new t({type:"string",format:"base64",check:"string_format",abort:!1,...M(e)})}function Sg(t,e){return new t({type:"string",format:"base64url",check:"string_format",abort:!1,...M(e)})}function Pg(t,e){return new t({type:"string",format:"e164",check:"string_format",abort:!1,...M(e)})}function Eg(t,e){return new t({type:"string",format:"jwt",check:"string_format",abort:!1,...M(e)})}function Tg(t,e){return new t({type:"string",format:"datetime",check:"string_format",offset:!1,local:!1,precision:null,...M(e)})}function zg(t,e){return new t({type:"string",format:"date",check:"string_format",...M(e)})}function Cg(t,e){return new t({type:"string",format:"time",check:"string_format",precision:null,...M(e)})}function Ig(t,e){return new t({type:"string",format:"duration",check:"string_format",...M(e)})}function Rg(t,e){return new t({type:"number",checks:[],...M(e)})}function Og(t,e){return new t({type:"number",check:"number_format",abort:!1,format:"safeint",...M(e)})}function Ng(t,e){return new t({type:"boolean",...M(e)})}function jg(t,e){return new t({type:"null",...M(e)})}function Ag(t){return new t({type:"unknown"})}function Mg(t,e){return new t({type:"never",...M(e)})}function Li(t,e){return new ru({check:"less_than",...M(e),value:t,inclusive:!1})}function Js(t,e){return new ru({check:"less_than",...M(e),value:t,inclusive:!0})}function Vi(t,e){return new nu({check:"greater_than",...M(e),value:t,inclusive:!1})}function Ys(t,e){return new nu({check:"greater_than",...M(e),value:t,inclusive:!0})}function Fi(t,e){return new Um({check:"multiple_of",...M(e),value:t})}function Ui(t,e){return new Km({check:"max_length",...M(e),maximum:t})}function Yn(t,e){return new Bm({check:"min_length",...M(e),minimum:t})}function Hi(t,e){return new Gm({check:"length_equals",...M(e),length:t})}function uu(t,e){return new Wm({check:"string_format",format:"regex",...M(e),pattern:t})}function lu(t){return new Jm({check:"string_format",format:"lowercase",...M(t)})}function du(t){return new Ym({check:"string_format",format:"uppercase",...M(t)})}function pu(t,e){return new Qm({check:"string_format",format:"includes",...M(e),includes:t})}function fu(t,e){return new Xm({check:"string_format",format:"starts_with",...M(e),prefix:t})}function mu(t,e){return new eh({check:"string_format",format:"ends_with",...M(e),suffix:t})}function gn(t){return new th({check:"overwrite",tx:t})}function hu(t){return gn(e=>e.normalize(t))}function gu(){return gn(t=>t.trim())}function yu(){return gn(t=>t.toLowerCase())}function vu(){return gn(t=>t.toUpperCase())}function qg(t,e,r){return new t({type:"array",element:e,...M(r)})}function Dg(t,e,r){let n=M(r);return n.abort??(n.abort=!0),new t({type:"custom",check:"custom",fn:e,...n})}function Zg(t,e,r){return new t({type:"custom",check:"custom",fn:e,...M(r)})}function Qn(t){return!!t._zod}function Ot(t,e){return Qn(t)?Bs(t,e):t.safeParse(e)}function Ki(t){var e,r;if(!t)return;let n;if(Qn(t)?n=(r=(e=t._zod)===null||e===void 0?void 0:e.def)===null||r===void 0?void 0:r.shape:n=t.shape,!!n){if(typeof n=="function")try{return n()}catch{return}return n}}function Lg(t){var e;if(Qn(t)){let i=(e=t._zod)===null||e===void 0?void 0:e.def;if(i){if(i.value!==void 0)return i.value;if(Array.isArray(i.values)&&i.values.length>0)return i.values[0]}}let n=t._def;if(n){if(n.value!==void 0)return n.value;if(Array.isArray(n.values)&&n.values.length>0)return n.values[0]}let s=t.value;if(s!==void 0)return s}var Xs={};hi(Xs,{ZodISODate:()=>Fg,ZodISODateTime:()=>Vg,ZodISODuration:()=>Hg,ZodISOTime:()=>Ug,date:()=>bu,datetime:()=>_u,duration:()=>$u,time:()=>wu});var Vg=b("ZodISODateTime",(t,e)=>{kh.init(t,e),Te.init(t,e)});function _u(t){return Tg(Vg,t)}var Fg=b("ZodISODate",(t,e)=>{Sh.init(t,e),Te.init(t,e)});function bu(t){return zg(Fg,t)}var Ug=b("ZodISOTime",(t,e)=>{Ph.init(t,e),Te.init(t,e)});function wu(t){return Cg(Ug,t)}var Hg=b("ZodISODuration",(t,e)=>{Eh.init(t,e),Te.init(t,e)});function $u(t){return Ig(Hg,t)}var Kg=(t,e)=>{Ai.init(t,e),t.name="ZodError",Object.defineProperties(t,{format:{value:r=>dm(t,r)},flatten:{value:r=>lm(t,r)},addIssue:{value:r=>t.issues.push(r)},addIssues:{value:r=>t.issues.push(...r)},isEmpty:{get(){return t.issues.length===0}}})},TD=b("ZodError",Kg),eo=b("ZodError",Kg,{Parent:Error});var Bg=pm(eo),Gg=fm(eo),Wg=Yc(eo),Jg=Qc(eo);var ze=b("ZodType",(t,e)=>(be.init(t,e),t.def=e,Object.defineProperty(t,"_def",{value:e}),t.check=(...r)=>t.clone({...e,checks:[...e.checks??[],...r.map(n=>typeof n=="function"?{_zod:{check:n,def:{check:"custom"},onattach:[]}}:n)]}),t.clone=(r,n)=>Bt(t,r,n),t.brand=()=>t,t.register=((r,n)=>(r.add(t,n),t)),t.parse=(r,n)=>Bg(t,r,n,{callee:t.parse}),t.safeParse=(r,n)=>Wg(t,r,n),t.parseAsync=async(r,n)=>Gg(t,r,n,{callee:t.parseAsync}),t.safeParseAsync=async(r,n)=>Jg(t,r,n),t.spa=t.safeParseAsync,t.refine=(r,n)=>t.check(lS(r,n)),t.superRefine=r=>t.check(dS(r)),t.overwrite=r=>t.check(gn(r)),t.optional=()=>I(t),t.nullable=()=>Xg(t),t.nullish=()=>I(Xg(t)),t.nonoptional=r=>nS(t,r),t.array=()=>re(t),t.or=r=>xe([t,r]),t.and=r=>Gi(t,r),t.transform=r=>ku(t,sy(r)),t.default=r=>eS(t,r),t.prefault=r=>rS(t,r),t.catch=r=>oS(t,r),t.pipe=r=>ku(t,r),t.readonly=()=>cS(t),t.describe=r=>{let n=t.clone();return Ws.add(n,{description:r}),n},Object.defineProperty(t,"description",{get(){return Ws.get(t)?.description},configurable:!0}),t.meta=(...r)=>{if(r.length===0)return Ws.get(t);let n=t.clone();return Ws.add(n,r[0]),n},t.isOptional=()=>t.safeParse(void 0).success,t.isNullable=()=>t.safeParse(null).success,t)),ey=b("_ZodString",(t,e)=>{Zi.init(t,e),ze.init(t,e);let r=t._zod.bag;t.format=r.format??null,t.minLength=r.minimum??null,t.maxLength=r.maximum??null,t.regex=(...n)=>t.check(uu(...n)),t.includes=(...n)=>t.check(pu(...n)),t.startsWith=(...n)=>t.check(fu(...n)),t.endsWith=(...n)=>t.check(mu(...n)),t.min=(...n)=>t.check(Yn(...n)),t.max=(...n)=>t.check(Ui(...n)),t.length=(...n)=>t.check(Hi(...n)),t.nonempty=(...n)=>t.check(Yn(1,...n)),t.lowercase=n=>t.check(lu(n)),t.uppercase=n=>t.check(du(n)),t.trim=()=>t.check(gu()),t.normalize=(...n)=>t.check(hu(...n)),t.toLowerCase=()=>t.check(yu()),t.toUpperCase=()=>t.check(vu())}),$k=b("ZodString",(t,e)=>{Zi.init(t,e),ey.init(t,e),t.email=r=>t.check(ag(xk,r)),t.url=r=>t.check(pg(kk,r)),t.jwt=r=>t.check(Eg(Dk,r)),t.emoji=r=>t.check(fg(Sk,r)),t.guid=r=>t.check(cu(Yg,r)),t.uuid=r=>t.check(cg(Bi,r)),t.uuidv4=r=>t.check(ug(Bi,r)),t.uuidv6=r=>t.check(lg(Bi,r)),t.uuidv7=r=>t.check(dg(Bi,r)),t.nanoid=r=>t.check(mg(Pk,r)),t.guid=r=>t.check(cu(Yg,r)),t.cuid=r=>t.check(hg(Ek,r)),t.cuid2=r=>t.check(gg(Tk,r)),t.ulid=r=>t.check(yg(zk,r)),t.base64=r=>t.check(kg(Ak,r)),t.base64url=r=>t.check(Sg(Mk,r)),t.xid=r=>t.check(vg(Ck,r)),t.ksuid=r=>t.check(_g(Ik,r)),t.ipv4=r=>t.check(bg(Rk,r)),t.ipv6=r=>t.check(wg(Ok,r)),t.cidrv4=r=>t.check($g(Nk,r)),t.cidrv6=r=>t.check(xg(jk,r)),t.e164=r=>t.check(Pg(qk,r)),t.datetime=r=>t.check(_u(r)),t.date=r=>t.check(bu(r)),t.time=r=>t.check(wu(r)),t.duration=r=>t.check($u(r))});function _(t){return ig($k,t)}var Te=b("ZodStringFormat",(t,e)=>{$e.init(t,e),ey.init(t,e)}),xk=b("ZodEmail",(t,e)=>{hh.init(t,e),Te.init(t,e)});var Yg=b("ZodGUID",(t,e)=>{fh.init(t,e),Te.init(t,e)});var Bi=b("ZodUUID",(t,e)=>{mh.init(t,e),Te.init(t,e)});var kk=b("ZodURL",(t,e)=>{gh.init(t,e),Te.init(t,e)});var Sk=b("ZodEmoji",(t,e)=>{yh.init(t,e),Te.init(t,e)});var Pk=b("ZodNanoID",(t,e)=>{vh.init(t,e),Te.init(t,e)});var Ek=b("ZodCUID",(t,e)=>{_h.init(t,e),Te.init(t,e)});var Tk=b("ZodCUID2",(t,e)=>{bh.init(t,e),Te.init(t,e)});var zk=b("ZodULID",(t,e)=>{wh.init(t,e),Te.init(t,e)});var Ck=b("ZodXID",(t,e)=>{$h.init(t,e),Te.init(t,e)});var Ik=b("ZodKSUID",(t,e)=>{xh.init(t,e),Te.init(t,e)});var Rk=b("ZodIPv4",(t,e)=>{Th.init(t,e),Te.init(t,e)});var Ok=b("ZodIPv6",(t,e)=>{zh.init(t,e),Te.init(t,e)});var Nk=b("ZodCIDRv4",(t,e)=>{Ch.init(t,e),Te.init(t,e)});var jk=b("ZodCIDRv6",(t,e)=>{Ih.init(t,e),Te.init(t,e)});var Ak=b("ZodBase64",(t,e)=>{Oh.init(t,e),Te.init(t,e)});var Mk=b("ZodBase64URL",(t,e)=>{Nh.init(t,e),Te.init(t,e)});var qk=b("ZodE164",(t,e)=>{jh.init(t,e),Te.init(t,e)});var Dk=b("ZodJWT",(t,e)=>{Ah.init(t,e),Te.init(t,e)});var ty=b("ZodNumber",(t,e)=>{ou.init(t,e),ze.init(t,e),t.gt=(n,s)=>t.check(Vi(n,s)),t.gte=(n,s)=>t.check(Ys(n,s)),t.min=(n,s)=>t.check(Ys(n,s)),t.lt=(n,s)=>t.check(Li(n,s)),t.lte=(n,s)=>t.check(Js(n,s)),t.max=(n,s)=>t.check(Js(n,s)),t.int=n=>t.check(Qg(n)),t.safe=n=>t.check(Qg(n)),t.positive=n=>t.check(Vi(0,n)),t.nonnegative=n=>t.check(Ys(0,n)),t.negative=n=>t.check(Li(0,n)),t.nonpositive=n=>t.check(Js(0,n)),t.multipleOf=(n,s)=>t.check(Fi(n,s)),t.step=(n,s)=>t.check(Fi(n,s)),t.finite=()=>t;let r=t._zod.bag;t.minValue=Math.max(r.minimum??Number.NEGATIVE_INFINITY,r.exclusiveMinimum??Number.NEGATIVE_INFINITY)??null,t.maxValue=Math.min(r.maximum??Number.POSITIVE_INFINITY,r.exclusiveMaximum??Number.POSITIVE_INFINITY)??null,t.isInt=(r.format??"").includes("int")||Number.isSafeInteger(r.multipleOf??.5),t.isFinite=!0,t.format=r.format??null});function he(t){return Rg(ty,t)}var Zk=b("ZodNumberFormat",(t,e)=>{Mh.init(t,e),ty.init(t,e)});function Qg(t){return Og(Zk,t)}var Lk=b("ZodBoolean",(t,e)=>{qh.init(t,e),ze.init(t,e)});function De(t){return Ng(Lk,t)}var Vk=b("ZodNull",(t,e)=>{Dh.init(t,e),ze.init(t,e)});function Su(t){return jg(Vk,t)}var Fk=b("ZodUnknown",(t,e)=>{Zh.init(t,e),ze.init(t,e)});function Ne(){return Ag(Fk)}var Uk=b("ZodNever",(t,e)=>{Lh.init(t,e),ze.init(t,e)});function Hk(t){return Mg(Uk,t)}var Kk=b("ZodArray",(t,e)=>{Vh.init(t,e),ze.init(t,e),t.element=e.element,t.min=(r,n)=>t.check(Yn(r,n)),t.nonempty=r=>t.check(Yn(1,r)),t.max=(r,n)=>t.check(Ui(r,n)),t.length=(r,n)=>t.check(Hi(r,n)),t.unwrap=()=>t.element});function re(t,e){return qg(Kk,t,e)}var ry=b("ZodObject",(t,e)=>{Fh.init(t,e),ze.init(t,e),de.defineLazy(t,"shape",()=>e.shape),t.keyof=()=>Ze(Object.keys(t._zod.def.shape)),t.catchall=r=>t.clone({...t._zod.def,catchall:r}),t.passthrough=()=>t.clone({...t._zod.def,catchall:Ne()}),t.loose=()=>t.clone({...t._zod.def,catchall:Ne()}),t.strict=()=>t.clone({...t._zod.def,catchall:Hk()}),t.strip=()=>t.clone({...t._zod.def,catchall:void 0}),t.extend=r=>de.extend(t,r),t.merge=r=>de.merge(t,r),t.pick=r=>de.pick(t,r),t.omit=r=>de.omit(t,r),t.partial=(...r)=>de.partial(oy,t,r[0]),t.required=(...r)=>de.required(iy,t,r[0])});function P(t,e){let r={type:"object",get shape(){return de.assignProp(this,"shape",{...t}),this.shape},...de.normalizeParams(e)};return new ry(r)}function wt(t,e){return new ry({type:"object",get shape(){return de.assignProp(this,"shape",{...t}),this.shape},catchall:Ne(),...de.normalizeParams(e)})}var ny=b("ZodUnion",(t,e)=>{iu.init(t,e),ze.init(t,e),t.options=e.options});function xe(t,e){return new ny({type:"union",options:t,...de.normalizeParams(e)})}var Bk=b("ZodDiscriminatedUnion",(t,e)=>{ny.init(t,e),Uh.init(t,e)});function Pu(t,e,r){return new Bk({type:"union",options:e,discriminator:t,...de.normalizeParams(r)})}var Gk=b("ZodIntersection",(t,e)=>{Hh.init(t,e),ze.init(t,e)});function Gi(t,e){return new Gk({type:"intersection",left:t,right:e})}var Wk=b("ZodRecord",(t,e)=>{Kh.init(t,e),ze.init(t,e),t.keyType=e.keyType,t.valueType=e.valueType});function je(t,e,r){return new Wk({type:"record",keyType:t,valueType:e,...de.normalizeParams(r)})}var xu=b("ZodEnum",(t,e)=>{Bh.init(t,e),ze.init(t,e),t.enum=e.entries,t.options=Object.values(e.entries);let r=new Set(Object.keys(e.entries));t.extract=(n,s)=>{let o={};for(let i of n)if(r.has(i))o[i]=e.entries[i];else throw new Error(`Key ${i} not found in enum`);return new xu({...e,checks:[],...de.normalizeParams(s),entries:o})},t.exclude=(n,s)=>{let o={...e.entries};for(let i of n)if(r.has(i))delete o[i];else throw new Error(`Key ${i} not found in enum`);return new xu({...e,checks:[],...de.normalizeParams(s),entries:o})}});function Ze(t,e){let r=Array.isArray(t)?Object.fromEntries(t.map(n=>[n,n])):t;return new xu({type:"enum",entries:r,...de.normalizeParams(e)})}var Jk=b("ZodLiteral",(t,e)=>{Gh.init(t,e),ze.init(t,e),t.values=new Set(e.values),Object.defineProperty(t,"value",{get(){if(e.values.length>1)throw new Error("This schema contains multiple valid literal values. Use `.values` instead.");return e.values[0]}})});function R(t,e){return new Jk({type:"literal",values:Array.isArray(t)?t:[t],...de.normalizeParams(e)})}var Yk=b("ZodTransform",(t,e)=>{Wh.init(t,e),ze.init(t,e),t._zod.parse=(r,n)=>{r.addIssue=o=>{if(typeof o=="string")r.issues.push(de.issue(o,r.value,e));else{let i=o;i.fatal&&(i.continue=!1),i.code??(i.code="custom"),i.input??(i.input=r.value),i.inst??(i.inst=t),i.continue??(i.continue=!0),r.issues.push(de.issue(i))}};let s=e.transform(r.value,r);return s instanceof Promise?s.then(o=>(r.value=o,r)):(r.value=s,r)}});function sy(t){return new Yk({type:"transform",transform:t})}var oy=b("ZodOptional",(t,e)=>{Jh.init(t,e),ze.init(t,e),t.unwrap=()=>t._zod.def.innerType});function I(t){return new oy({type:"optional",innerType:t})}var Qk=b("ZodNullable",(t,e)=>{Yh.init(t,e),ze.init(t,e),t.unwrap=()=>t._zod.def.innerType});function Xg(t){return new Qk({type:"nullable",innerType:t})}var Xk=b("ZodDefault",(t,e)=>{Qh.init(t,e),ze.init(t,e),t.unwrap=()=>t._zod.def.innerType,t.removeDefault=t.unwrap});function eS(t,e){return new Xk({type:"default",innerType:t,get defaultValue(){return typeof e=="function"?e():e}})}var tS=b("ZodPrefault",(t,e)=>{Xh.init(t,e),ze.init(t,e),t.unwrap=()=>t._zod.def.innerType});function rS(t,e){return new tS({type:"prefault",innerType:t,get defaultValue(){return typeof e=="function"?e():e}})}var iy=b("ZodNonOptional",(t,e)=>{eg.init(t,e),ze.init(t,e),t.unwrap=()=>t._zod.def.innerType});function nS(t,e){return new iy({type:"nonoptional",innerType:t,...de.normalizeParams(e)})}var sS=b("ZodCatch",(t,e)=>{tg.init(t,e),ze.init(t,e),t.unwrap=()=>t._zod.def.innerType,t.removeCatch=t.unwrap});function oS(t,e){return new sS({type:"catch",innerType:t,catchValue:typeof e=="function"?e:()=>e})}var iS=b("ZodPipe",(t,e)=>{rg.init(t,e),ze.init(t,e),t.in=e.in,t.out=e.out});function ku(t,e){return new iS({type:"pipe",in:t,out:e})}var aS=b("ZodReadonly",(t,e)=>{ng.init(t,e),ze.init(t,e)});function cS(t){return new aS({type:"readonly",innerType:t})}var ay=b("ZodCustom",(t,e)=>{sg.init(t,e),ze.init(t,e)});function uS(t){let e=new Ge({check:"custom"});return e._zod.check=t,e}function cy(t,e){return Dg(ay,t??(()=>!0),e)}function lS(t,e={}){return Zg(ay,t,e)}function dS(t){let e=uS(r=>(r.addIssue=n=>{if(typeof n=="string")r.issues.push(de.issue(n,r.value,e._zod.def));else{let s=n;s.fatal&&(s.continue=!1),s.code??(s.code="custom"),s.input??(s.input=r.value),s.inst??(s.inst=e),s.continue??(s.continue=!e._zod.def.abort),r.issues.push(de.issue(s))}},t(r.value,r)));return e}function Eu(t,e){return ku(sy(t),e)}bt(og());var zu="2025-11-25";var uy=[zu,"2025-06-18","2025-03-26","2024-11-05","2024-10-07"],Jt="io.modelcontextprotocol/related-task",Ji="2.0",Wt=cy(t=>t!==null&&(typeof t=="object"||typeof t=="function")),ly=xe([_(),he().int()]),dy=_(),pS=wt({ttl:xe([he(),Su()]).optional(),pollInterval:he().optional()}),Cu=wt({taskId:_()}),fS=wt({progressToken:ly.optional(),[Jt]:Cu.optional()}),ct=wt({task:pS.optional(),_meta:fS.optional()}),Le=P({method:_(),params:ct.optional()}),yn=wt({_meta:P({[Jt]:I(Cu)}).passthrough().optional()}),$t=P({method:_(),params:yn.optional()}),We=wt({_meta:wt({[Jt]:Cu.optional()}).optional()}),Yi=xe([_(),he().int()]),py=P({jsonrpc:R(Ji),id:Yi,...Le.shape}).strict(),Iu=t=>py.safeParse(t).success,fy=P({jsonrpc:R(Ji),...$t.shape}).strict(),my=t=>fy.safeParse(t).success,hy=P({jsonrpc:R(Ji),id:Yi,result:We}).strict(),to=t=>hy.safeParse(t).success,Z;(function(t){t[t.ConnectionClosed=-32e3]="ConnectionClosed",t[t.RequestTimeout=-32001]="RequestTimeout",t[t.ParseError=-32700]="ParseError",t[t.InvalidRequest=-32600]="InvalidRequest",t[t.MethodNotFound=-32601]="MethodNotFound",t[t.InvalidParams=-32602]="InvalidParams",t[t.InternalError=-32603]="InternalError",t[t.UrlElicitationRequired=-32042]="UrlElicitationRequired"})(Z||(Z={}));var gy=P({jsonrpc:R(Ji),id:Yi,error:P({code:he().int(),message:_(),data:I(Ne())})}).strict(),yy=t=>gy.safeParse(t).success,vy=xe([py,fy,hy,gy]),vn=We.strict(),mS=yn.extend({requestId:Yi,reason:_().optional()}),Qi=$t.extend({method:R("notifications/cancelled"),params:mS}),hS=P({src:_(),mimeType:_().optional(),sizes:re(_()).optional()}),ro=P({icons:re(hS).optional()}),Xn=P({name:_(),title:_().optional()}),_y=Xn.extend({...Xn.shape,...ro.shape,version:_(),websiteUrl:_().optional()}),gS=Gi(P({applyDefaults:De().optional()}),je(_(),Ne())),yS=Eu(t=>t&&typeof t=="object"&&!Array.isArray(t)&&Object.keys(t).length===0?{form:{}}:t,Gi(P({form:gS.optional(),url:Wt.optional()}),je(_(),Ne()).optional())),vS=P({list:I(P({}).passthrough()),cancel:I(P({}).passthrough()),requests:I(P({sampling:I(P({createMessage:I(P({}).passthrough())}).passthrough()),elicitation:I(P({create:I(P({}).passthrough())}).passthrough())}).passthrough())}).passthrough(),_S=P({list:I(P({}).passthrough()),cancel:I(P({}).passthrough()),requests:I(P({tools:I(P({call:I(P({}).passthrough())}).passthrough())}).passthrough())}).passthrough(),bS=P({experimental:je(_(),Wt).optional(),sampling:P({context:Wt.optional(),tools:Wt.optional()}).optional(),elicitation:yS.optional(),roots:P({listChanged:De().optional()}).optional(),tasks:I(vS)}),wS=ct.extend({protocolVersion:_(),capabilities:bS,clientInfo:_y}),$S=Le.extend({method:R("initialize"),params:wS});var xS=P({experimental:je(_(),Wt).optional(),logging:Wt.optional(),completions:Wt.optional(),prompts:I(P({listChanged:I(De())})),resources:P({subscribe:De().optional(),listChanged:De().optional()}).optional(),tools:P({listChanged:De().optional()}).optional(),tasks:I(_S)}).passthrough(),Ru=We.extend({protocolVersion:_(),capabilities:xS,serverInfo:_y,instructions:_().optional()}),kS=$t.extend({method:R("notifications/initialized")});var Xi=Le.extend({method:R("ping")}),SS=P({progress:he(),total:I(he()),message:I(_())}),PS=P({...yn.shape,...SS.shape,progressToken:ly}),ea=$t.extend({method:R("notifications/progress"),params:PS}),ES=ct.extend({cursor:dy.optional()}),no=Le.extend({params:ES.optional()}),so=We.extend({nextCursor:I(dy)}),oo=P({taskId:_(),status:Ze(["working","input_required","completed","failed","cancelled"]),ttl:xe([he(),Su()]),createdAt:_(),lastUpdatedAt:_(),pollInterval:I(he()),statusMessage:I(_())}),_n=We.extend({task:oo}),TS=yn.merge(oo),io=$t.extend({method:R("notifications/tasks/status"),params:TS}),ta=Le.extend({method:R("tasks/get"),params:ct.extend({taskId:_()})}),ra=We.merge(oo),na=Le.extend({method:R("tasks/result"),params:ct.extend({taskId:_()})}),sa=no.extend({method:R("tasks/list")}),oa=so.extend({tasks:re(oo)}),by=Le.extend({method:R("tasks/cancel"),params:ct.extend({taskId:_()})}),wy=We.merge(oo),$y=P({uri:_(),mimeType:I(_()),_meta:je(_(),Ne()).optional()}),xy=$y.extend({text:_()}),Ou=_().refine(t=>{try{return atob(t),!0}catch{return!1}},{message:"Invalid Base64 string"}),ky=$y.extend({blob:Ou}),es=P({audience:re(Ze(["user","assistant"])).optional(),priority:he().min(0).max(1).optional(),lastModified:Xs.datetime({offset:!0}).optional()}),Sy=P({...Xn.shape,...ro.shape,uri:_(),description:I(_()),mimeType:I(_()),annotations:es.optional(),_meta:I(wt({}))}),zS=P({...Xn.shape,...ro.shape,uriTemplate:_(),description:I(_()),mimeType:I(_()),annotations:es.optional(),_meta:I(wt({}))}),CS=no.extend({method:R("resources/list")}),Nu=so.extend({resources:re(Sy)}),IS=no.extend({method:R("resources/templates/list")}),ju=so.extend({resourceTemplates:re(zS)}),Au=ct.extend({uri:_()}),RS=Au,OS=Le.extend({method:R("resources/read"),params:RS}),Mu=We.extend({contents:re(xe([xy,ky]))}),NS=$t.extend({method:R("notifications/resources/list_changed")}),jS=Au,AS=Le.extend({method:R("resources/subscribe"),params:jS}),MS=Au,qS=Le.extend({method:R("resources/unsubscribe"),params:MS}),DS=yn.extend({uri:_()}),ZS=$t.extend({method:R("notifications/resources/updated"),params:DS}),LS=P({name:_(),description:I(_()),required:I(De())}),VS=P({...Xn.shape,...ro.shape,description:I(_()),arguments:I(re(LS)),_meta:I(wt({}))}),FS=no.extend({method:R("prompts/list")}),qu=so.extend({prompts:re(VS)}),US=ct.extend({name:_(),arguments:je(_(),_()).optional()}),HS=Le.extend({method:R("prompts/get"),params:US}),Du=P({type:R("text"),text:_(),annotations:es.optional(),_meta:je(_(),Ne()).optional()}),Zu=P({type:R("image"),data:Ou,mimeType:_(),annotations:es.optional(),_meta:je(_(),Ne()).optional()}),Lu=P({type:R("audio"),data:Ou,mimeType:_(),annotations:es.optional(),_meta:je(_(),Ne()).optional()}),KS=P({type:R("tool_use"),name:_(),id:_(),input:P({}).passthrough(),_meta:I(P({}).passthrough())}).passthrough(),BS=P({type:R("resource"),resource:xe([xy,ky]),annotations:es.optional(),_meta:je(_(),Ne()).optional()}),GS=Sy.extend({type:R("resource_link")}),Vu=xe([Du,Zu,Lu,GS,BS]),WS=P({role:Ze(["user","assistant"]),content:Vu}),Fu=We.extend({description:I(_()),messages:re(WS)}),JS=$t.extend({method:R("notifications/prompts/list_changed")}),YS=P({title:_().optional(),readOnlyHint:De().optional(),destructiveHint:De().optional(),idempotentHint:De().optional(),openWorldHint:De().optional()}),QS=P({taskSupport:Ze(["required","optional","forbidden"]).optional()}),Py=P({...Xn.shape,...ro.shape,description:_().optional(),inputSchema:P({type:R("object"),properties:je(_(),Wt).optional(),required:re(_()).optional()}).catchall(Ne()),outputSchema:P({type:R("object"),properties:je(_(),Wt).optional(),required:re(_()).optional()}).catchall(Ne()).optional(),annotations:I(YS),execution:I(QS),_meta:je(_(),Ne()).optional()}),XS=no.extend({method:R("tools/list")}),Uu=so.extend({tools:re(Py)}),ts=We.extend({content:re(Vu).default([]),structuredContent:je(_(),Ne()).optional(),isError:I(De())}),wZ=ts.or(We.extend({toolResult:Ne()})),eP=ct.extend({name:_(),arguments:I(je(_(),Ne()))}),tP=Le.extend({method:R("tools/call"),params:eP}),rP=$t.extend({method:R("notifications/tools/list_changed")}),Ey=Ze(["debug","info","notice","warning","error","critical","alert","emergency"]),nP=ct.extend({level:Ey}),sP=Le.extend({method:R("logging/setLevel"),params:nP}),oP=yn.extend({level:Ey,logger:_().optional(),data:Ne()}),iP=$t.extend({method:R("notifications/message"),params:oP}),aP=P({name:_().optional()}),cP=P({hints:I(re(aP)),costPriority:I(he().min(0).max(1)),speedPriority:I(he().min(0).max(1)),intelligencePriority:I(he().min(0).max(1))}),uP=P({mode:I(Ze(["auto","required","none"]))}),lP=P({type:R("tool_result"),toolUseId:_().describe("The unique identifier for the corresponding tool call."),content:re(Vu).default([]),structuredContent:P({}).passthrough().optional(),isError:I(De()),_meta:I(P({}).passthrough())}).passthrough(),dP=Pu("type",[Du,Zu,Lu]),Wi=Pu("type",[Du,Zu,Lu,KS,lP]),pP=P({role:Ze(["user","assistant"]),content:xe([Wi,re(Wi)]),_meta:I(P({}).passthrough())}).passthrough(),fP=ct.extend({messages:re(pP),modelPreferences:cP.optional(),systemPrompt:_().optional(),includeContext:Ze(["none","thisServer","allServers"]).optional(),temperature:he().optional(),maxTokens:he().int(),stopSequences:re(_()).optional(),metadata:Wt.optional(),tools:I(re(Py)),toolChoice:I(uP)}),Hu=Le.extend({method:R("sampling/createMessage"),params:fP}),Ku=We.extend({model:_(),stopReason:I(Ze(["endTurn","stopSequence","maxTokens"]).or(_())),role:Ze(["user","assistant"]),content:dP}),mP=We.extend({model:_(),stopReason:I(Ze(["endTurn","stopSequence","maxTokens","toolUse"]).or(_())),role:Ze(["user","assistant"]),content:xe([Wi,re(Wi)])}),hP=P({type:R("boolean"),title:_().optional(),description:_().optional(),default:De().optional()}),gP=P({type:R("string"),title:_().optional(),description:_().optional(),minLength:he().optional(),maxLength:he().optional(),format:Ze(["email","uri","date","date-time"]).optional(),default:_().optional()}),yP=P({type:Ze(["number","integer"]),title:_().optional(),description:_().optional(),minimum:he().optional(),maximum:he().optional(),default:he().optional()}),vP=P({type:R("string"),title:_().optional(),description:_().optional(),enum:re(_()),default:_().optional()}),_P=P({type:R("string"),title:_().optional(),description:_().optional(),oneOf:re(P({const:_(),title:_()})),default:_().optional()}),bP=P({type:R("string"),title:_().optional(),description:_().optional(),enum:re(_()),enumNames:re(_()).optional(),default:_().optional()}),wP=xe([vP,_P]),$P=P({type:R("array"),title:_().optional(),description:_().optional(),minItems:he().optional(),maxItems:he().optional(),items:P({type:R("string"),enum:re(_())}),default:re(_()).optional()}),xP=P({type:R("array"),title:_().optional(),description:_().optional(),minItems:he().optional(),maxItems:he().optional(),items:P({anyOf:re(P({const:_(),title:_()}))}),default:re(_()).optional()}),kP=xe([$P,xP]),SP=xe([bP,wP,kP]),PP=xe([SP,hP,gP,yP]),EP=ct.extend({mode:R("form").optional(),message:_(),requestedSchema:P({type:R("object"),properties:je(_(),PP),required:re(_()).optional()})}),TP=ct.extend({mode:R("url"),message:_(),elicitationId:_(),url:_().url()}),zP=xe([EP,TP]),Bu=Le.extend({method:R("elicitation/create"),params:zP}),CP=yn.extend({elicitationId:_()}),IP=$t.extend({method:R("notifications/elicitation/complete"),params:CP}),Gu=We.extend({action:Ze(["accept","decline","cancel"]),content:Eu(t=>t===null?void 0:t,je(_(),xe([_(),he(),De(),re(_())])).optional())}),RP=P({type:R("ref/resource"),uri:_()});var OP=P({type:R("ref/prompt"),name:_()}),NP=ct.extend({ref:xe([OP,RP]),argument:P({name:_(),value:_()}),context:P({arguments:je(_(),_()).optional()}).optional()}),jP=Le.extend({method:R("completion/complete"),params:NP});var Wu=We.extend({completion:wt({values:re(_()).max(100),total:I(he().int()),hasMore:I(De())})}),AP=P({uri:_().startsWith("file://"),name:_().optional(),_meta:je(_(),Ne()).optional()}),MP=Le.extend({method:R("roots/list")}),qP=We.extend({roots:re(AP)}),DP=$t.extend({method:R("notifications/roots/list_changed")}),$Z=xe([Xi,$S,jP,sP,HS,FS,CS,IS,OS,AS,qS,tP,XS,ta,na,sa]),xZ=xe([Qi,ea,kS,DP,io]),kZ=xe([vn,Ku,mP,Gu,qP,ra,oa,_n]),SZ=xe([Xi,Hu,Bu,MP,ta,na,sa]),PZ=xe([Qi,ea,iP,ZS,NS,rP,JS,io,IP]),EZ=xe([vn,Ru,Wu,Fu,qu,Nu,ju,Mu,ts,Uu,ra,oa,_n]),j=class t extends Error{constructor(e,r,n){super(`MCP error ${e}: ${r}`),this.code=e,this.data=n,this.name="McpError"}static fromError(e,r,n){if(e===Z.UrlElicitationRequired&&n){let s=n;if(s.elicitations)return new Tu(s.elicitations,r)}return new t(e,r,n)}},Tu=class extends j{constructor(e,r=`URL elicitation${e.length>1?"s":""} required`){super(Z.UrlElicitationRequired,r,{elicitations:e})}get elicitations(){var e,r;return(r=(e=this.data)===null||e===void 0?void 0:e.elicitations)!==null&&r!==void 0?r:[]}};function Rr(t){return t==="completed"||t==="failed"||t==="cancelled"}var i9=new Set("ABCDEFGHIJKLMNOPQRSTUVXYZabcdefghijklmnopqrstuvxyz0123456789");function Ju(t){let e=Ki(t),r=e?.method;if(!r)throw new Error("Schema is missing a method literal");let n=Lg(r);if(typeof n!="string")throw new Error("Schema method literal must be a string");return n}function Yu(t,e){let r=Ot(t,e);if(!r.success)throw r.error;return r.data}var HP=6e4,ia=class{constructor(e){this._options=e,this._requestMessageId=0,this._requestHandlers=new Map,this._requestHandlerAbortControllers=new Map,this._notificationHandlers=new Map,this._responseHandlers=new Map,this._progressHandlers=new Map,this._timeoutInfo=new Map,this._pendingDebouncedNotifications=new Set,this._taskProgressTokens=new Map,this._requestResolvers=new Map,this.setNotificationHandler(Qi,r=>{this._oncancel(r)}),this.setNotificationHandler(ea,r=>{this._onprogress(r)}),this.setRequestHandler(Xi,r=>({})),this._taskStore=e?.taskStore,this._taskMessageQueue=e?.taskMessageQueue,this._taskStore&&(this.setRequestHandler(ta,async(r,n)=>{let s=await this._taskStore.getTask(r.params.taskId,n.sessionId);if(!s)throw new j(Z.InvalidParams,"Failed to retrieve task: Task not found");return{...s}}),this.setRequestHandler(na,async(r,n)=>{let s=async()=>{var o;let i=r.params.taskId;if(this._taskMessageQueue){let c;for(;c=await this._taskMessageQueue.dequeue(i,n.sessionId);){if(c.type==="response"||c.type==="error"){let u=c.message,l=u.id,d=this._requestResolvers.get(l);if(d)if(this._requestResolvers.delete(l),c.type==="response")d(u);else{let f=u,p=new j(f.error.code,f.error.message,f.error.data);d(p)}else{let f=c.type==="response"?"Response":"Error";this._onerror(new Error(`${f} handler missing for request ${l}`))}continue}await((o=this._transport)===null||o===void 0?void 0:o.send(c.message,{relatedRequestId:n.requestId}))}}let a=await this._taskStore.getTask(i,n.sessionId);if(!a)throw new j(Z.InvalidParams,`Task not found: ${i}`);if(!Rr(a.status))return await this._waitForTaskUpdate(i,n.signal),await s();if(Rr(a.status)){let c=await this._taskStore.getTaskResult(i,n.sessionId);return this._clearTaskQueue(i),{...c,_meta:{...c._meta,[Jt]:{taskId:i}}}}return await s()};return await s()}),this.setRequestHandler(sa,async(r,n)=>{var s;try{let{tasks:o,nextCursor:i}=await this._taskStore.listTasks((s=r.params)===null||s===void 0?void 0:s.cursor,n.sessionId);return{tasks:o,nextCursor:i,_meta:{}}}catch(o){throw new j(Z.InvalidParams,`Failed to list tasks: ${o instanceof Error?o.message:String(o)}`)}}),this.setRequestHandler(by,async(r,n)=>{try{let s=await this._taskStore.getTask(r.params.taskId,n.sessionId);if(!s)throw new j(Z.InvalidParams,`Task not found: ${r.params.taskId}`);if(Rr(s.status))throw new j(Z.InvalidParams,`Cannot cancel task in terminal status: ${s.status}`);await this._taskStore.updateTaskStatus(r.params.taskId,"cancelled","Client cancelled task execution.",n.sessionId),this._clearTaskQueue(r.params.taskId);let o=await this._taskStore.getTask(r.params.taskId,n.sessionId);if(!o)throw new j(Z.InvalidParams,`Task not found after cancellation: ${r.params.taskId}`);return{_meta:{},...o}}catch(s){throw s instanceof j?s:new j(Z.InvalidRequest,`Failed to cancel task: ${s instanceof Error?s.message:String(s)}`)}}))}async _oncancel(e){let r=this._requestHandlerAbortControllers.get(e.params.requestId);r?.abort(e.params.reason)}_setupTimeout(e,r,n,s,o=!1){this._timeoutInfo.set(e,{timeoutId:setTimeout(s,r),startTime:Date.now(),timeout:r,maxTotalTimeout:n,resetTimeoutOnProgress:o,onTimeout:s})}_resetTimeout(e){let r=this._timeoutInfo.get(e);if(!r)return!1;let n=Date.now()-r.startTime;if(r.maxTotalTimeout&&n>=r.maxTotalTimeout)throw this._timeoutInfo.delete(e),j.fromError(Z.RequestTimeout,"Maximum total timeout exceeded",{maxTotalTimeout:r.maxTotalTimeout,totalElapsed:n});return clearTimeout(r.timeoutId),r.timeoutId=setTimeout(r.onTimeout,r.timeout),!0}_cleanupTimeout(e){let r=this._timeoutInfo.get(e);r&&(clearTimeout(r.timeoutId),this._timeoutInfo.delete(e))}async connect(e){var r,n,s;this._transport=e;let o=(r=this.transport)===null||r===void 0?void 0:r.onclose;this._transport.onclose=()=>{o?.(),this._onclose()};let i=(n=this.transport)===null||n===void 0?void 0:n.onerror;this._transport.onerror=c=>{i?.(c),this._onerror(c)};let a=(s=this._transport)===null||s===void 0?void 0:s.onmessage;this._transport.onmessage=(c,u)=>{a?.(c,u),to(c)||yy(c)?this._onresponse(c):Iu(c)?this._onrequest(c,u):my(c)?this._onnotification(c):this._onerror(new Error(`Unknown message type: ${JSON.stringify(c)}`))},await this._transport.start()}_onclose(){var e;let r=this._responseHandlers;this._responseHandlers=new Map,this._progressHandlers.clear(),this._taskProgressTokens.clear(),this._pendingDebouncedNotifications.clear();let n=j.fromError(Z.ConnectionClosed,"Connection closed");this._transport=void 0,(e=this.onclose)===null||e===void 0||e.call(this);for(let s of r.values())s(n)}_onerror(e){var r;(r=this.onerror)===null||r===void 0||r.call(this,e)}_onnotification(e){var r;let n=(r=this._notificationHandlers.get(e.method))!==null&&r!==void 0?r:this.fallbackNotificationHandler;n!==void 0&&Promise.resolve().then(()=>n(e)).catch(s=>this._onerror(new Error(`Uncaught error in notification handler: ${s}`)))}_onrequest(e,r){var n,s,o,i,a,c;let u=(n=this._requestHandlers.get(e.method))!==null&&n!==void 0?n:this.fallbackRequestHandler,l=this._transport,d=(i=(o=(s=e.params)===null||s===void 0?void 0:s._meta)===null||o===void 0?void 0:o[Jt])===null||i===void 0?void 0:i.taskId;if(u===void 0){let g={jsonrpc:"2.0",id:e.id,error:{code:Z.MethodNotFound,message:"Method not found"}};d&&this._taskMessageQueue?this._enqueueTaskMessage(d,{type:"error",message:g,timestamp:Date.now()},l?.sessionId).catch(y=>this._onerror(new Error(`Failed to enqueue error response: ${y}`))):l?.send(g).catch(y=>this._onerror(new Error(`Failed to send an error response: ${y}`)));return}let f=new AbortController;this._requestHandlerAbortControllers.set(e.id,f);let p=(a=e.params)===null||a===void 0?void 0:a.task,m=this._taskStore?this.requestTaskStore(e,l?.sessionId):void 0,h={signal:f.signal,sessionId:l?.sessionId,_meta:(c=e.params)===null||c===void 0?void 0:c._meta,sendNotification:async g=>{let y={relatedRequestId:e.id};d&&(y.relatedTask={taskId:d}),await this.notification(g,y)},sendRequest:async(g,y,x)=>{var $,S;let w={...x,relatedRequestId:e.id};d&&!w.relatedTask&&(w.relatedTask={taskId:d});let D=(S=($=w.relatedTask)===null||$===void 0?void 0:$.taskId)!==null&&S!==void 0?S:d;return D&&m&&await m.updateTaskStatus(D,"input_required"),await this.request(g,y,w)},authInfo:r?.authInfo,requestId:e.id,requestInfo:r?.requestInfo,taskId:d,taskStore:m,taskRequestedTtl:p?.ttl,closeSSEStream:r?.closeSSEStream,closeStandaloneSSEStream:r?.closeStandaloneSSEStream};Promise.resolve().then(()=>{p&&this.assertTaskHandlerCapability(e.method)}).then(()=>u(e,h)).then(async g=>{if(f.signal.aborted)return;let y={result:g,jsonrpc:"2.0",id:e.id};d&&this._taskMessageQueue?await this._enqueueTaskMessage(d,{type:"response",message:y,timestamp:Date.now()},l?.sessionId):await l?.send(y)},async g=>{var y;if(f.signal.aborted)return;let x={jsonrpc:"2.0",id:e.id,error:{code:Number.isSafeInteger(g.code)?g.code:Z.InternalError,message:(y=g.message)!==null&&y!==void 0?y:"Internal error",...g.data!==void 0&&{data:g.data}}};d&&this._taskMessageQueue?await this._enqueueTaskMessage(d,{type:"error",message:x,timestamp:Date.now()},l?.sessionId):await l?.send(x)}).catch(g=>this._onerror(new Error(`Failed to send response: ${g}`))).finally(()=>{this._requestHandlerAbortControllers.delete(e.id)})}_onprogress(e){let{progressToken:r,...n}=e.params,s=Number(r),o=this._progressHandlers.get(s);if(!o){this._onerror(new Error(`Received a progress notification for an unknown token: ${JSON.stringify(e)}`));return}let i=this._responseHandlers.get(s),a=this._timeoutInfo.get(s);if(a&&i&&a.resetTimeoutOnProgress)try{this._resetTimeout(s)}catch(c){this._responseHandlers.delete(s),this._progressHandlers.delete(s),this._cleanupTimeout(s),i(c);return}o(n)}_onresponse(e){let r=Number(e.id),n=this._requestResolvers.get(r);if(n){if(this._requestResolvers.delete(r),to(e))n(e);else{let i=new j(e.error.code,e.error.message,e.error.data);n(i)}return}let s=this._responseHandlers.get(r);if(s===void 0){this._onerror(new Error(`Received a response for an unknown message ID: ${JSON.stringify(e)}`));return}this._responseHandlers.delete(r),this._cleanupTimeout(r);let o=!1;if(to(e)&&e.result&&typeof e.result=="object"){let i=e.result;if(i.task&&typeof i.task=="object"){let a=i.task;typeof a.taskId=="string"&&(o=!0,this._taskProgressTokens.set(a.taskId,r))}}if(o||this._progressHandlers.delete(r),to(e))s(e);else{let i=j.fromError(e.error.code,e.error.message,e.error.data);s(i)}}get transport(){return this._transport}async close(){var e;await((e=this._transport)===null||e===void 0?void 0:e.close())}async*requestStream(e,r,n){var s,o,i,a;let{task:c}=n??{};if(!c){try{yield{type:"result",result:await this.request(e,r,n)}}catch(l){yield{type:"error",error:l instanceof j?l:new j(Z.InternalError,String(l))}}return}let u;try{let l=await this.request(e,_n,n);if(l.task)u=l.task.taskId,yield{type:"taskCreated",task:l.task};else throw new j(Z.InternalError,"Task creation did not return a task");for(;;){let d=await this.getTask({taskId:u},n);if(yield{type:"taskStatus",task:d},Rr(d.status)){d.status==="completed"?yield{type:"result",result:await this.getTaskResult({taskId:u},r,n)}:d.status==="failed"?yield{type:"error",error:new j(Z.InternalError,`Task ${u} failed`)}:d.status==="cancelled"&&(yield{type:"error",error:new j(Z.InternalError,`Task ${u} was cancelled`)});return}if(d.status==="input_required"){yield{type:"result",result:await this.getTaskResult({taskId:u},r,n)};return}let f=(i=(s=d.pollInterval)!==null&&s!==void 0?s:(o=this._options)===null||o===void 0?void 0:o.defaultTaskPollInterval)!==null&&i!==void 0?i:1e3;await new Promise(p=>setTimeout(p,f)),(a=n?.signal)===null||a===void 0||a.throwIfAborted()}}catch(l){yield{type:"error",error:l instanceof j?l:new j(Z.InternalError,String(l))}}}request(e,r,n){let{relatedRequestId:s,resumptionToken:o,onresumptiontoken:i,task:a,relatedTask:c}=n??{};return new Promise((u,l)=>{var d,f,p,m,h,g,y;let x=H=>{l(H)};if(!this._transport){x(new Error("Not connected"));return}if(((d=this._options)===null||d===void 0?void 0:d.enforceStrictCapabilities)===!0)try{this.assertCapabilityForMethod(e.method),a&&this.assertTaskCapability(e.method)}catch(H){x(H);return}(f=n?.signal)===null||f===void 0||f.throwIfAborted();let $=this._requestMessageId++,S={...e,jsonrpc:"2.0",id:$};n?.onprogress&&(this._progressHandlers.set($,n.onprogress),S.params={...e.params,_meta:{...((p=e.params)===null||p===void 0?void 0:p._meta)||{},progressToken:$}}),a&&(S.params={...S.params,task:a}),c&&(S.params={...S.params,_meta:{...((m=S.params)===null||m===void 0?void 0:m._meta)||{},[Jt]:c}});let w=H=>{var we;this._responseHandlers.delete($),this._progressHandlers.delete($),this._cleanupTimeout($),(we=this._transport)===null||we===void 0||we.send({jsonrpc:"2.0",method:"notifications/cancelled",params:{requestId:$,reason:String(H)}},{relatedRequestId:s,resumptionToken:o,onresumptiontoken:i}).catch(Gr=>this._onerror(new Error(`Failed to send cancellation: ${Gr}`)));let Ae=H instanceof j?H:new j(Z.RequestTimeout,String(H));l(Ae)};this._responseHandlers.set($,H=>{var we;if(!(!((we=n?.signal)===null||we===void 0)&&we.aborted)){if(H instanceof Error)return l(H);try{let Ae=Ot(r,H.result);Ae.success?u(Ae.data):l(Ae.error)}catch(Ae){l(Ae)}}}),(h=n?.signal)===null||h===void 0||h.addEventListener("abort",()=>{var H;w((H=n?.signal)===null||H===void 0?void 0:H.reason)});let D=(g=n?.timeout)!==null&&g!==void 0?g:HP,F=()=>w(j.fromError(Z.RequestTimeout,"Request timed out",{timeout:D}));this._setupTimeout($,D,n?.maxTotalTimeout,F,(y=n?.resetTimeoutOnProgress)!==null&&y!==void 0?y:!1);let Ce=c?.taskId;if(Ce){let H=we=>{let Ae=this._responseHandlers.get($);Ae?Ae(we):this._onerror(new Error(`Response handler missing for side-channeled request ${$}`))};this._requestResolvers.set($,H),this._enqueueTaskMessage(Ce,{type:"request",message:S,timestamp:Date.now()}).catch(we=>{this._cleanupTimeout($),l(we)})}else this._transport.send(S,{relatedRequestId:s,resumptionToken:o,onresumptiontoken:i}).catch(H=>{this._cleanupTimeout($),l(H)})})}async getTask(e,r){return this.request({method:"tasks/get",params:e},ra,r)}async getTaskResult(e,r,n){return this.request({method:"tasks/result",params:e},r,n)}async listTasks(e,r){return this.request({method:"tasks/list",params:e},oa,r)}async cancelTask(e,r){return this.request({method:"tasks/cancel",params:e},wy,r)}async notification(e,r){var n,s,o,i,a;if(!this._transport)throw new Error("Not connected");this.assertNotificationCapability(e.method);let c=(n=r?.relatedTask)===null||n===void 0?void 0:n.taskId;if(c){let f={...e,jsonrpc:"2.0",params:{...e.params,_meta:{...((s=e.params)===null||s===void 0?void 0:s._meta)||{},[Jt]:r.relatedTask}}};await this._enqueueTaskMessage(c,{type:"notification",message:f,timestamp:Date.now()});return}if(((i=(o=this._options)===null||o===void 0?void 0:o.debouncedNotificationMethods)!==null&&i!==void 0?i:[]).includes(e.method)&&!e.params&&!r?.relatedRequestId&&!r?.relatedTask){if(this._pendingDebouncedNotifications.has(e.method))return;this._pendingDebouncedNotifications.add(e.method),Promise.resolve().then(()=>{var f,p;if(this._pendingDebouncedNotifications.delete(e.method),!this._transport)return;let m={...e,jsonrpc:"2.0"};r?.relatedTask&&(m={...m,params:{...m.params,_meta:{...((f=m.params)===null||f===void 0?void 0:f._meta)||{},[Jt]:r.relatedTask}}}),(p=this._transport)===null||p===void 0||p.send(m,r).catch(h=>this._onerror(h))});return}let d={...e,jsonrpc:"2.0"};r?.relatedTask&&(d={...d,params:{...d.params,_meta:{...((a=d.params)===null||a===void 0?void 0:a._meta)||{},[Jt]:r.relatedTask}}}),await this._transport.send(d,r)}setRequestHandler(e,r){let n=Ju(e);this.assertRequestHandlerCapability(n),this._requestHandlers.set(n,(s,o)=>{let i=Yu(e,s);return Promise.resolve(r(i,o))})}removeRequestHandler(e){this._requestHandlers.delete(e)}assertCanSetRequestHandler(e){if(this._requestHandlers.has(e))throw new Error(`A request handler for ${e} already exists, which would be overridden`)}setNotificationHandler(e,r){let n=Ju(e);this._notificationHandlers.set(n,s=>{let o=Yu(e,s);return Promise.resolve(r(o))})}removeNotificationHandler(e){this._notificationHandlers.delete(e)}_cleanupTaskProgressHandler(e){let r=this._taskProgressTokens.get(e);r!==void 0&&(this._progressHandlers.delete(r),this._taskProgressTokens.delete(e))}async _enqueueTaskMessage(e,r,n){var s;if(!this._taskStore||!this._taskMessageQueue)throw new Error("Cannot enqueue task message: taskStore and taskMessageQueue are not configured");let o=(s=this._options)===null||s===void 0?void 0:s.maxTaskQueueSize;await this._taskMessageQueue.enqueue(e,r,n,o)}async _clearTaskQueue(e,r){if(this._taskMessageQueue){let n=await this._taskMessageQueue.dequeueAll(e,r);for(let s of n)if(s.type==="request"&&Iu(s.message)){let o=s.message.id,i=this._requestResolvers.get(o);i?(i(new j(Z.InternalError,"Task cancelled or completed")),this._requestResolvers.delete(o)):this._onerror(new Error(`Resolver missing for request ${o} during task ${e} cleanup`))}}}async _waitForTaskUpdate(e,r){var n,s,o;let i=(s=(n=this._options)===null||n===void 0?void 0:n.defaultTaskPollInterval)!==null&&s!==void 0?s:1e3;try{let a=await((o=this._taskStore)===null||o===void 0?void 0:o.getTask(e));a?.pollInterval&&(i=a.pollInterval)}catch{}return new Promise((a,c)=>{if(r.aborted){c(new j(Z.InvalidRequest,"Request cancelled"));return}let u=setTimeout(a,i);r.addEventListener("abort",()=>{clearTimeout(u),c(new j(Z.InvalidRequest,"Request cancelled"))},{once:!0})})}requestTaskStore(e,r){let n=this._taskStore;if(!n)throw new Error("No task store configured");return{createTask:async s=>{if(!e)throw new Error("No request provided");return await n.createTask(s,e.id,{method:e.method,params:e.params},r)},getTask:async s=>{let o=await n.getTask(s,r);if(!o)throw new j(Z.InvalidParams,"Failed to retrieve task: Task not found");return o},storeTaskResult:async(s,o,i)=>{await n.storeTaskResult(s,o,i,r);let a=await n.getTask(s,r);if(a){let c=io.parse({method:"notifications/tasks/status",params:a});await this.notification(c),Rr(a.status)&&this._cleanupTaskProgressHandler(s)}},getTaskResult:s=>n.getTaskResult(s,r),updateTaskStatus:async(s,o,i)=>{let a=await n.getTask(s,r);if(!a)throw new j(Z.InvalidParams,`Task "${s}" not found - it may have been cleaned up`);if(Rr(a.status))throw new j(Z.InvalidParams,`Cannot update task "${s}" from terminal status "${a.status}" to "${o}". Terminal states (completed, failed, cancelled) cannot transition to other states.`);await n.updateTaskStatus(s,o,i,r);let c=await n.getTask(s,r);if(c){let u=io.parse({method:"notifications/tasks/status",params:c});await this.notification(u),Rr(c.status)&&this._cleanupTaskProgressHandler(s)}},listTasks:s=>n.listTasks(s,r)}}};function Ty(t){return t!==null&&typeof t=="object"&&!Array.isArray(t)}function zy(t,e){let r={...t};for(let n in e){let s=n,o=e[s];if(o===void 0)continue;let i=r[s];Ty(i)&&Ty(o)?r[s]={...i,...o}:r[s]=o}return r}var zw=ve(t0(),1),Cw=ve(Tw(),1);function zA(){let t=new zw.Ajv({strict:!1,validateFormats:!0,validateSchema:!1,allErrors:!0});return(0,Cw.default)(t),t}var bc=class{constructor(e){this._ajv=e??zA()}getValidator(e){var r;let n="$id"in e&&typeof e.$id=="string"?(r=this._ajv.getSchema(e.$id))!==null&&r!==void 0?r:this._ajv.compile(e):this._ajv.compile(e);return s=>n(s)?{valid:!0,data:s,errorMessage:void 0}:{valid:!1,data:void 0,errorMessage:this._ajv.errorsText(n.errors)}}};var wc=class{constructor(e){this._client=e}async*callToolStream(e,r=ts,n){var s;let o=this._client,i={...n,task:(s=n?.task)!==null&&s!==void 0?s:o.isToolTask(e.name)?{}:void 0},a=o.requestStream({method:"tools/call",params:e},r,i),c=o.getToolOutputValidator(e.name);for await(let u of a){if(u.type==="result"&&c){let l=u.result;if(!l.structuredContent&&!l.isError){yield{type:"error",error:new j(Z.InvalidRequest,`Tool ${e.name} has an output schema but did not return structured content`)};return}if(l.structuredContent)try{let d=c(l.structuredContent);if(!d.valid){yield{type:"error",error:new j(Z.InvalidParams,`Structured content does not match the tool's output schema: ${d.errorMessage}`)};return}}catch(d){if(d instanceof j){yield{type:"error",error:d};return}yield{type:"error",error:new j(Z.InvalidParams,`Failed to validate structured content: ${d instanceof Error?d.message:String(d)}`)};return}}yield u}}async getTask(e,r){return this._client.getTask({taskId:e},r)}async getTaskResult(e,r,n){return this._client.getTaskResult({taskId:e},r,n)}async listTasks(e,r){return this._client.listTasks(e?{cursor:e}:void 0,r)}async cancelTask(e,r){return this._client.cancelTask({taskId:e},r)}requestStream(e,r,n){return this._client.requestStream(e,r,n)}};function Iw(t,e,r){var n;if(!t)throw new Error(`${r} does not support task creation (required for ${e})`);switch(e){case"tools/call":if(!(!((n=t.tools)===null||n===void 0)&&n.call))throw new Error(`${r} does not support task creation for tools/call (required for ${e})`);break;default:break}}function Rw(t,e,r){var n,s;if(!t)throw new Error(`${r} does not support task creation (required for ${e})`);switch(e){case"sampling/createMessage":if(!(!((n=t.sampling)===null||n===void 0)&&n.createMessage))throw new Error(`${r} does not support task creation for sampling/createMessage (required for ${e})`);break;case"elicitation/create":if(!(!((s=t.elicitation)===null||s===void 0)&&s.create))throw new Error(`${r} does not support task creation for elicitation/create (required for ${e})`);break;default:break}}function $c(t,e){if(!(!t||e===null||typeof e!="object")){if(t.type==="object"&&t.properties&&typeof t.properties=="object"){let r=e,n=t.properties;for(let s of Object.keys(n)){let o=n[s];r[s]===void 0&&Object.prototype.hasOwnProperty.call(o,"default")&&(r[s]=o.default),r[s]!==void 0&&$c(o,r[s])}}if(Array.isArray(t.anyOf))for(let r of t.anyOf)$c(r,e);if(Array.isArray(t.oneOf))for(let r of t.oneOf)$c(r,e)}}function CA(t){if(!t)return{supportsFormMode:!1,supportsUrlMode:!1};let e=t.form!==void 0,r=t.url!==void 0;return{supportsFormMode:e||!e&&!r,supportsUrlMode:r}}var xc=class extends ia{constructor(e,r){var n,s;super(r),this._clientInfo=e,this._cachedToolOutputValidators=new Map,this._cachedKnownTaskTools=new Set,this._cachedRequiredTaskTools=new Set,this._capabilities=(n=r?.capabilities)!==null&&n!==void 0?n:{},this._jsonSchemaValidator=(s=r?.jsonSchemaValidator)!==null&&s!==void 0?s:new bc}get experimental(){return this._experimental||(this._experimental={tasks:new wc(this)}),this._experimental}registerCapabilities(e){if(this.transport)throw new Error("Cannot register capabilities after connecting to transport");this._capabilities=zy(this._capabilities,e)}setRequestHandler(e,r){var n,s,o;let i=Ki(e),a=i?.method;if(!a)throw new Error("Schema is missing a method literal");let c;if(Qn(a)){let l=a,d=(n=l._zod)===null||n===void 0?void 0:n.def;c=(s=d?.value)!==null&&s!==void 0?s:l.value}else{let l=a,d=l._def;c=(o=d?.value)!==null&&o!==void 0?o:l.value}if(typeof c!="string")throw new Error("Schema method literal must be a string");let u=c;if(u==="elicitation/create"){let l=async(d,f)=>{var p,m,h;let g=Ot(Bu,d);if(!g.success){let H=g.error instanceof Error?g.error.message:String(g.error);throw new j(Z.InvalidParams,`Invalid elicitation request: ${H}`)}let{params:y}=g.data,x=(p=y.mode)!==null&&p!==void 0?p:"form",{supportsFormMode:$,supportsUrlMode:S}=CA(this._capabilities.elicitation);if(x==="form"&&!$)throw new j(Z.InvalidParams,"Client does not support form-mode elicitation requests");if(x==="url"&&!S)throw new j(Z.InvalidParams,"Client does not support URL-mode elicitation requests");let w=await Promise.resolve(r(d,f));if(y.task){let H=Ot(_n,w);if(!H.success){let we=H.error instanceof Error?H.error.message:String(H.error);throw new j(Z.InvalidParams,`Invalid task creation result: ${we}`)}return H.data}let D=Ot(Gu,w);if(!D.success){let H=D.error instanceof Error?D.error.message:String(D.error);throw new j(Z.InvalidParams,`Invalid elicitation result: ${H}`)}let F=D.data,Ce=x==="form"?y.requestedSchema:void 0;if(x==="form"&&F.action==="accept"&&F.content&&Ce&&!((h=(m=this._capabilities.elicitation)===null||m===void 0?void 0:m.form)===null||h===void 0)&&h.applyDefaults)try{$c(Ce,F.content)}catch{}return F};return super.setRequestHandler(e,l)}if(u==="sampling/createMessage"){let l=async(d,f)=>{let p=Ot(Hu,d);if(!p.success){let y=p.error instanceof Error?p.error.message:String(p.error);throw new j(Z.InvalidParams,`Invalid sampling request: ${y}`)}let{params:m}=p.data,h=await Promise.resolve(r(d,f));if(m.task){let y=Ot(_n,h);if(!y.success){let x=y.error instanceof Error?y.error.message:String(y.error);throw new j(Z.InvalidParams,`Invalid task creation result: ${x}`)}return y.data}let g=Ot(Ku,h);if(!g.success){let y=g.error instanceof Error?g.error.message:String(g.error);throw new j(Z.InvalidParams,`Invalid sampling result: ${y}`)}return g.data};return super.setRequestHandler(e,l)}return super.setRequestHandler(e,r)}assertCapability(e,r){var n;if(!(!((n=this._serverCapabilities)===null||n===void 0)&&n[e]))throw new Error(`Server does not support ${e} (required for ${r})`)}async connect(e,r){if(await super.connect(e),e.sessionId===void 0)try{let n=await this.request({method:"initialize",params:{protocolVersion:zu,capabilities:this._capabilities,clientInfo:this._clientInfo}},Ru,r);if(n===void 0)throw new Error(`Server sent invalid initialize result: ${n}`);if(!uy.includes(n.protocolVersion))throw new Error(`Server's protocol version is not supported: ${n.protocolVersion}`);this._serverCapabilities=n.capabilities,this._serverVersion=n.serverInfo,e.setProtocolVersion&&e.setProtocolVersion(n.protocolVersion),this._instructions=n.instructions,await this.notification({method:"notifications/initialized"})}catch(n){throw this.close(),n}}getServerCapabilities(){return this._serverCapabilities}getServerVersion(){return this._serverVersion}getInstructions(){return this._instructions}assertCapabilityForMethod(e){var r,n,s,o,i;switch(e){case"logging/setLevel":if(!(!((r=this._serverCapabilities)===null||r===void 0)&&r.logging))throw new Error(`Server does not support logging (required for ${e})`);break;case"prompts/get":case"prompts/list":if(!(!((n=this._serverCapabilities)===null||n===void 0)&&n.prompts))throw new Error(`Server does not support prompts (required for ${e})`);break;case"resources/list":case"resources/templates/list":case"resources/read":case"resources/subscribe":case"resources/unsubscribe":if(!(!((s=this._serverCapabilities)===null||s===void 0)&&s.resources))throw new Error(`Server does not support resources (required for ${e})`);if(e==="resources/subscribe"&&!this._serverCapabilities.resources.subscribe)throw new Error(`Server does not support resource subscriptions (required for ${e})`);break;case"tools/call":case"tools/list":if(!(!((o=this._serverCapabilities)===null||o===void 0)&&o.tools))throw new Error(`Server does not support tools (required for ${e})`);break;case"completion/complete":if(!(!((i=this._serverCapabilities)===null||i===void 0)&&i.completions))throw new Error(`Server does not support completions (required for ${e})`);break;case"initialize":break;case"ping":break}}assertNotificationCapability(e){var r;switch(e){case"notifications/roots/list_changed":if(!(!((r=this._capabilities.roots)===null||r===void 0)&&r.listChanged))throw new Error(`Client does not support roots list changed notifications (required for ${e})`);break;case"notifications/initialized":break;case"notifications/cancelled":break;case"notifications/progress":break}}assertRequestHandlerCapability(e){if(this._capabilities)switch(e){case"sampling/createMessage":if(!this._capabilities.sampling)throw new Error(`Client does not support sampling capability (required for ${e})`);break;case"elicitation/create":if(!this._capabilities.elicitation)throw new Error(`Client does not support elicitation capability (required for ${e})`);break;case"roots/list":if(!this._capabilities.roots)throw new Error(`Client does not support roots capability (required for ${e})`);break;case"tasks/get":case"tasks/list":case"tasks/result":case"tasks/cancel":if(!this._capabilities.tasks)throw new Error(`Client does not support tasks capability (required for ${e})`);break;case"ping":break}}assertTaskCapability(e){var r,n;Iw((n=(r=this._serverCapabilities)===null||r===void 0?void 0:r.tasks)===null||n===void 0?void 0:n.requests,e,"Server")}assertTaskHandlerCapability(e){var r;this._capabilities&&Rw((r=this._capabilities.tasks)===null||r===void 0?void 0:r.requests,e,"Client")}async ping(e){return this.request({method:"ping"},vn,e)}async complete(e,r){return this.request({method:"completion/complete",params:e},Wu,r)}async setLoggingLevel(e,r){return this.request({method:"logging/setLevel",params:{level:e}},vn,r)}async getPrompt(e,r){return this.request({method:"prompts/get",params:e},Fu,r)}async listPrompts(e,r){return this.request({method:"prompts/list",params:e},qu,r)}async listResources(e,r){return this.request({method:"resources/list",params:e},Nu,r)}async listResourceTemplates(e,r){return this.request({method:"resources/templates/list",params:e},ju,r)}async readResource(e,r){return this.request({method:"resources/read",params:e},Mu,r)}async subscribeResource(e,r){return this.request({method:"resources/subscribe",params:e},vn,r)}async unsubscribeResource(e,r){return this.request({method:"resources/unsubscribe",params:e},vn,r)}async callTool(e,r=ts,n){if(this.isToolTaskRequired(e.name))throw new j(Z.InvalidRequest,`Tool "${e.name}" requires task-based execution. Use client.experimental.tasks.callToolStream() instead.`);let s=await this.request({method:"tools/call",params:e},r,n),o=this.getToolOutputValidator(e.name);if(o){if(!s.structuredContent&&!s.isError)throw new j(Z.InvalidRequest,`Tool ${e.name} has an output schema but did not return structured content`);if(s.structuredContent)try{let i=o(s.structuredContent);if(!i.valid)throw new j(Z.InvalidParams,`Structured content does not match the tool's output schema: ${i.errorMessage}`)}catch(i){throw i instanceof j?i:new j(Z.InvalidParams,`Failed to validate structured content: ${i instanceof Error?i.message:String(i)}`)}}return s}isToolTask(e){var r,n,s,o;return!((o=(s=(n=(r=this._serverCapabilities)===null||r===void 0?void 0:r.tasks)===null||n===void 0?void 0:n.requests)===null||s===void 0?void 0:s.tools)===null||o===void 0)&&o.call?this._cachedKnownTaskTools.has(e):!1}isToolTaskRequired(e){return this._cachedRequiredTaskTools.has(e)}cacheToolMetadata(e){var r;this._cachedToolOutputValidators.clear(),this._cachedKnownTaskTools.clear(),this._cachedRequiredTaskTools.clear();for(let n of e){if(n.outputSchema){let o=this._jsonSchemaValidator.getValidator(n.outputSchema);this._cachedToolOutputValidators.set(n.name,o)}let s=(r=n.execution)===null||r===void 0?void 0:r.taskSupport;(s==="required"||s==="optional")&&this._cachedKnownTaskTools.add(n.name),s==="required"&&this._cachedRequiredTaskTools.add(n.name)}}getToolOutputValidator(e){return this._cachedToolOutputValidators.get(e)}async listTools(e,r){let n=await this.request({method:"tools/list",params:e},Uu,r);return this.cacheToolMetadata(n.tools),n}async sendRootsListChanged(){return this.notification({method:"notifications/roots/list_changed"})}};var $$=ve(b$(),1),pi=ve(require("node:process"),1),x$=require("node:stream");var Sc=class{append(e){this._buffer=this._buffer?Buffer.concat([this._buffer,e]):e}readMessage(){if(!this._buffer)return null;let e=this._buffer.indexOf(`
`);if(e===-1)return null;let r=this._buffer.toString("utf8",0,e).replace(/\r$/,"");return this._buffer=this._buffer.subarray(e+1),nM(r)}clear(){this._buffer=void 0}};function nM(t){return vy.parse(JSON.parse(t))}function w$(t){return JSON.stringify(t)+`
`}var sM=pi.default.platform==="win32"?["APPDATA","HOMEDRIVE","HOMEPATH","LOCALAPPDATA","PATH","PROCESSOR_ARCHITECTURE","SYSTEMDRIVE","SYSTEMROOT","TEMP","USERNAME","USERPROFILE","PROGRAMFILES"]:["HOME","LOGNAME","PATH","SHELL","TERM","USER"];function oM(){let t={};for(let e of sM){let r=pi.default.env[e];r!==void 0&&(r.startsWith("()")||(t[e]=r))}return t}var Pc=class{constructor(e){this._readBuffer=new Sc,this._stderrStream=null,this._serverParams=e,(e.stderr==="pipe"||e.stderr==="overlapped")&&(this._stderrStream=new x$.PassThrough)}async start(){if(this._process)throw new Error("StdioClientTransport already started! If using Client class, note that connect() calls start() automatically.");return new Promise((e,r)=>{var n,s,o,i,a;this._process=(0,$$.default)(this._serverParams.command,(n=this._serverParams.args)!==null&&n!==void 0?n:[],{env:{...oM(),...this._serverParams.env},stdio:["pipe","pipe",(s=this._serverParams.stderr)!==null&&s!==void 0?s:"inherit"],shell:!1,windowsHide:pi.default.platform==="win32"&&iM(),cwd:this._serverParams.cwd}),this._process.on("error",c=>{var u;r(c),(u=this.onerror)===null||u===void 0||u.call(this,c)}),this._process.on("spawn",()=>{e()}),this._process.on("close",c=>{var u;this._process=void 0,(u=this.onclose)===null||u===void 0||u.call(this)}),(o=this._process.stdin)===null||o===void 0||o.on("error",c=>{var u;(u=this.onerror)===null||u===void 0||u.call(this,c)}),(i=this._process.stdout)===null||i===void 0||i.on("data",c=>{this._readBuffer.append(c),this.processReadBuffer()}),(a=this._process.stdout)===null||a===void 0||a.on("error",c=>{var u;(u=this.onerror)===null||u===void 0||u.call(this,c)}),this._stderrStream&&this._process.stderr&&this._process.stderr.pipe(this._stderrStream)})}get stderr(){var e,r;return this._stderrStream?this._stderrStream:(r=(e=this._process)===null||e===void 0?void 0:e.stderr)!==null&&r!==void 0?r:null}get pid(){var e,r;return(r=(e=this._process)===null||e===void 0?void 0:e.pid)!==null&&r!==void 0?r:null}processReadBuffer(){for(var e,r;;)try{let n=this._readBuffer.readMessage();if(n===null)break;(e=this.onmessage)===null||e===void 0||e.call(this,n)}catch(n){(r=this.onerror)===null||r===void 0||r.call(this,n)}}async close(){var e;if(this._process){let r=this._process;this._process=void 0;let n=new Promise(s=>{r.once("close",()=>{s()})});try{(e=r.stdin)===null||e===void 0||e.end()}catch{}if(await Promise.race([n,new Promise(s=>setTimeout(s,2e3).unref())]),r.exitCode===null){try{r.kill("SIGTERM")}catch{}await Promise.race([n,new Promise(s=>setTimeout(s,2e3).unref())])}if(r.exitCode===null)try{r.kill("SIGKILL")}catch{}}this._readBuffer.clear()}send(e){return new Promise(r=>{var n;if(!(!((n=this._process)===null||n===void 0)&&n.stdin))throw new Error("Not connected");let s=w$(e);this._process.stdin.write(s)?r():this._process.stdin.once("drain",r)})}};function iM(){return"type"in pi.default}function Ec(t){if(!t||typeof t!="object")return T.any();let e=t.type;switch(e){case"string":let r=T.string();return t.enum?T.enum(t.enum):r;case"number":case"integer":let n=T.number();return e==="integer"&&(n=n.int()),n;case"boolean":return T.boolean();case"array":return t.items?T.array(Ec(t.items)):T.array(T.any());case"object":if(t.properties){let s={},o=new Set(t.required||[]);for(let[i,a]of Object.entries(t.properties)){let c=Ec(a);o.has(i)||(c=c.optional()),s[i]=c}return t.additionalProperties!==!1?T.object(s).passthrough():T.object(s)}return T.object({}).passthrough();default:return T.any()}}var Tc=class{constructor(e,r){this.gateway=e;this.context=r;this.clients=new Map;this.serverStates=new Map;this.resources=new Map;this.prompts=new Map;this.disposables=[];this.eventListeners=[];this.disposables.push(Ns.workspace.onDidChangeConfiguration(n=>{n.affectsConfiguration("vibey.mcpServers")&&this.reloadServers()}))}async initialize(){await this.reloadServers()}addEventListener(e){this.eventListeners.push(e)}removeEventListener(e){let r=this.eventListeners.indexOf(e);r>=0&&this.eventListeners.splice(r,1)}emitEvent(e){for(let r of this.eventListeners)try{r(e)}catch(n){console.error("[MCP] Event listener error:",n)}}getServerStates(){return Array.from(this.serverStates.values())}getServerState(e){return this.serverStates.get(e)}getResources(e){return e?this.resources.get(e)||[]:Array.from(this.resources.values()).flat()}getPrompts(e){return e?this.prompts.get(e)||[]:Array.from(this.prompts.values()).flat()}async readResource(e){for(let[r,n]of this.resources.entries())if(n.find(o=>o.uri===e)){let o=this.clients.get(r);if(!o)throw new Error(`Server ${r} not connected`);let i=await o.readResource({uri:e});if(i.contents&&i.contents.length>0){let a=i.contents[0];return"text"in a?a.text:JSON.stringify(a)}return""}throw new Error(`Resource not found: ${e}`)}async getPrompt(e,r){for(let[n,s]of this.prompts.entries())if(s.find(i=>i.name===e)){let i=this.clients.get(n);if(!i)throw new Error(`Server ${n} not connected`);let a=await i.getPrompt({name:e,arguments:r});return a.messages&&a.messages.length>0?a.messages.map(c=>typeof c.content=="string"?c.content:c.content&&"text"in c.content?c.content.text:JSON.stringify(c.content)).join(`
`):""}throw new Error(`Prompt not found: ${e}`)}async dispose(){this.disposables.forEach(e=>e.dispose());for(let[e]of this.clients.entries())await this.disconnectServer(e);this.clients.clear(),this.serverStates.clear(),this.resources.clear(),this.prompts.clear()}async reconnectServer(e){let r=this.serverStates.get(e);if(!r)throw new Error(`Server ${e} not configured`);await this.disconnectServer(e),await this.connectToServer(e,r.config)}async reloadServers(){console.log("[MCP] Reloading servers...");let r=Ns.workspace.getConfiguration("vibey").get("mcpServers")||{},n=new Set(Object.keys(r));for(let s of this.clients.keys())n.has(s)||await this.disconnectServer(s);for(let[s,o]of Object.entries(r)){let i=this.serverStates.get(s),a=i&&JSON.stringify(i.config)!==JSON.stringify(o);if(!i||a){i&&await this.disconnectServer(s);try{await this.connectToServer(s,o)}catch(c){console.error(`[MCP] Error connecting to ${s}:`,c),this.updateServerState(s,{name:s,config:o,status:"error",error:c.message,toolCount:0,resourceCount:0,promptCount:0,registeredTools:[]})}}}}updateServerState(e,r){this.serverStates.set(e,r)}async disconnectServer(e){let r=this.serverStates.get(e),n=this.clients.get(e);if(r)for(let s of r.registeredTools)this.gateway.unregisterTool(s);if(n){try{await n.close()}catch(s){console.error(`[MCP] Error closing client ${e}:`,s)}this.clients.delete(e)}this.serverStates.delete(e),this.resources.delete(e),this.prompts.delete(e),this.emitEvent({type:"server-disconnected",serverName:e}),console.log(`[MCP] Disconnected from ${e}`)}async connectToServer(e,r){console.log(`[MCP] Connecting to ${e}...`,r),this.updateServerState(e,{name:e,config:r,status:"connecting",toolCount:0,resourceCount:0,promptCount:0,registeredTools:[]});try{let n=new Pc({command:r.command,args:r.args||[],env:r.env}),s=new xc({name:"VibeyClient",version:"0.1.3"},{capabilities:{sampling:{}}});await s.connect(n),this.clients.set(e,s);let o=[],i=0,a=0,c=0;try{let u=await s.listTools();if(u.tools)for(let l of u.tools){let d=this.adaptMcpTool(e,s,l);this.gateway.registerTool(d),o.push(l.name),i++,console.log(`[MCP] Registered tool: ${l.name} from ${e}`)}}catch(u){console.warn(`[MCP] Failed to list tools from ${e}:`,u)}try{let u=await s.listResources();if(u.resources){let l=u.resources.map(d=>({uri:d.uri,name:d.name,description:d.description,mimeType:d.mimeType}));this.resources.set(e,l),a=l.length,console.log(`[MCP] Discovered ${a} resources from ${e}`)}}catch{console.log(`[MCP] Server ${e} does not support resources`)}try{let u=await s.listPrompts();if(u.prompts){let l=u.prompts.map(d=>({name:d.name,description:d.description,arguments:d.arguments?.map(f=>({name:f.name,description:f.description,required:f.required}))}));this.prompts.set(e,l),c=l.length,console.log(`[MCP] Discovered ${c} prompts from ${e}`)}}catch{console.log(`[MCP] Server ${e} does not support prompts`)}this.updateServerState(e,{name:e,config:r,status:"connected",connectedAt:Date.now(),toolCount:i,resourceCount:a,promptCount:c,registeredTools:o}),this.emitEvent({type:"server-connected",serverName:e}),this.emitEvent({type:"tools-updated",serverName:e,data:{count:i}}),Ns.window.showInformationMessage(`MCP: Connected to ${e} (${i} tools, ${a} resources)`)}catch(n){throw console.error(`[MCP] Failed to connect to ${e}:`,n),this.updateServerState(e,{name:e,config:r,status:"error",error:n.message,toolCount:0,resourceCount:0,promptCount:0,registeredTools:[]}),this.emitEvent({type:"server-error",serverName:e,data:{error:n.message}}),Ns.window.showErrorMessage(`MCP: Failed to connect to ${e}: ${n.message}`),n}}adaptMcpTool(e,r,n){return{name:n.name,description:n.description||`Tool from MCP server: ${e}`,parameters:Ec(n.inputSchema),execute:async s=>{let o=await r.callTool({name:n.name,arguments:s});if(o.isError){let i=this.extractContent(o.content);throw new Error(i||"Tool execution failed")}return this.extractContent(o.content)}}}extractContent(e){return e?Array.isArray(e)?e.map(r=>typeof r=="string"?r:r.type==="text"?r.text:r.type==="image"?`[Image: ${r.mimeType||"unknown"}]`:r.type==="resource"?`[Resource: ${r.resource?.uri||"unknown"}]`:JSON.stringify(r)).join(`
`):JSON.stringify(e):""}};var If=ve(require("crypto"));var k$=[{id:"tool_success_rate",name:"Tool Success Rate",description:"Percentage of tool executions that succeed",category:"performance",unit:"%",aggregation:"rate",higherIsBetter:!0},{id:"task_completion_rate",name:"Task Completion Rate",description:"Percentage of tasks completed successfully",category:"performance",unit:"%",aggregation:"rate",higherIsBetter:!0},{id:"avg_task_duration",name:"Average Task Duration",description:"Average time to complete a task",category:"efficiency",unit:"minutes",aggregation:"avg",higherIsBetter:!1},{id:"turns_per_task",name:"Turns Per Task",description:"Average LLM turns needed to complete a task",category:"efficiency",aggregation:"avg",higherIsBetter:!1},{id:"error_recovery_rate",name:"Error Recovery Rate",description:"Percentage of errors successfully recovered from",category:"quality",unit:"%",aggregation:"rate",higherIsBetter:!0},{id:"security_violations",name:"Security Violations",description:"Number of blocked security violations",category:"security",aggregation:"count",higherIsBetter:!1},{id:"learnings_applied",name:"Learnings Applied",description:"Number of past learnings successfully applied",category:"learning",aggregation:"count",higherIsBetter:!0},{id:"tokens_sent",name:"Tokens Sent",description:"Total tokens sent to LLM in prompts",category:"efficiency",unit:"tokens",aggregation:"sum",higherIsBetter:!1},{id:"tokens_received",name:"Tokens Received",description:"Total tokens received from LLM responses",category:"efficiency",unit:"tokens",aggregation:"sum",higherIsBetter:!1}];var zc=class t{constructor(e,r=t.DEFAULT_CONFIG){this.context=e;this.config=r;this.dataPoints=[];this.decisions=[];this.learnings=[];this.metrics=new Map;this.snapshots=[];for(let n of k$)this.metrics.set(n.id,n);this.loadState()}static{this.STORAGE_KEY="vibey.metrics.data"}static{this.DEFAULT_CONFIG={retentionDays:30,snapshotInterval:24,enableDetailedLogging:!0}}record(e,r,n,s){if(!this.metrics.get(e)){console.warn(`Unknown metric: ${e}`);return}this.dataPoints.push({metricId:e,value:r,timestamp:Date.now(),context:n,tags:s}),this.pruneOldData(),this.saveState()}recordDecision(e){let r={id:If.randomUUID(),timestamp:Date.now(),...e};return this.decisions.push(r),this.saveState(),r.id}updateDecisionOutcome(e,r){let n=this.decisions.find(s=>s.id===e);n&&(n.outcome=r,this.saveState())}addLearning(e){let r={id:If.randomUUID(),timestamp:Date.now(),appliedCount:0,...e};return this.learnings.push(r),this.saveState(),r.id}recordLearningApplied(e,r){let n=this.learnings.find(s=>s.id===e);if(n){n.appliedCount++;let s=n.successRate??0,o=n.appliedCount-1;n.successRate=o>0?(s*o+(r?1:0))/n.appliedCount:r?1:0,this.saveState()}}getSummary(e,r=24){let n=this.metrics.get(e);if(!n)return;let s=Date.now(),o=s-r*60*60*1e3,i=o-r*60*60*1e3,a=this.dataPoints.filter(m=>m.metricId===e&&m.timestamp>=o),c=this.dataPoints.filter(m=>m.metricId===e&&m.timestamp>=i&&m.timestamp<o),u=this.aggregate(a,n.aggregation),l=c.length>0?this.aggregate(c,n.aggregation):void 0,d="stable",f,p;return l!==void 0&&l!==0&&(f=u-l,p=f/l*100,Math.abs(p)>5&&(d=f>0?"up":"down")),{metricId:e,name:n.name,category:n.category,currentValue:u,previousValue:l,change:f,changePercent:p,trend:d,dataPoints:a.length,period:{start:o,end:s}}}getAllSummaries(e=24){return Array.from(this.metrics.keys()).map(r=>this.getSummary(r,e)).filter(r=>r!==void 0)}createSnapshot(){let e=this.getAllSummaries(),r=[],n=[],s=[];for(let c of e){let u=this.metrics.get(c.metricId),l=c.trend==="up"&&u.higherIsBetter||c.trend==="down"&&!u.higherIsBetter,d=c.trend==="down"&&u.higherIsBetter||c.trend==="up"&&!u.higherIsBetter;l?r.push(`${u.name} is improving (${c.changePercent?.toFixed(1)}%)`):d&&(n.push(`${u.name} is declining (${c.changePercent?.toFixed(1)}%)`),s.push(`Investigate ${u.name} decline and identify root cause`))}let o=e.filter(c=>c.dataPoints>0),i=o.length>0?o.reduce((c,u)=>{let l=this.metrics.get(u.metricId),d=u.currentValue;return l.aggregation==="rate"&&(d=u.currentValue*100),c+Math.min(100,Math.max(0,d))},0)/o.length:50,a={timestamp:Date.now(),metrics:e,overallScore:Math.round(i),strengths:r,weaknesses:n,recommendations:s};return this.snapshots.push(a),this.saveState(),a}getLatestSnapshot(){return this.snapshots[this.snapshots.length-1]}getLearnings(e){let r=[...this.learnings];return e&&(r=r.filter(n=>n.category===e)),r.sort((n,s)=>s.confidence-n.confidence)}getRecentDecisions(e=20){return this.decisions.slice(-e).sort((r,n)=>n.timestamp-r.timestamp)}aggregate(e,r){if(e.length===0)return 0;let n=e.map(s=>s.value);switch(r){case"sum":return n.reduce((o,i)=>o+i,0);case"avg":return n.reduce((o,i)=>o+i,0)/n.length;case"min":return Math.min(...n);case"max":return Math.max(...n);case"count":return n.length;case"rate":return n.filter(o=>o===1).length/n.length;default:return n[n.length-1]}}pruneOldData(){let e=Date.now()-this.config.retentionDays*24*60*60*1e3;this.dataPoints=this.dataPoints.filter(r=>r.timestamp>=e),this.decisions=this.decisions.filter(r=>r.timestamp>=e),this.snapshots=this.snapshots.filter(r=>r.timestamp>=e)}async saveState(){let e={dataPoints:this.dataPoints,decisions:this.decisions,learnings:this.learnings,snapshots:this.snapshots};await this.context.globalState.update(t.STORAGE_KEY,e)}loadState(){let e=this.context.globalState.get(t.STORAGE_KEY);e&&(this.dataPoints=e.dataPoints||[],this.decisions=e.decisions||[],this.learnings=e.learnings||[],this.snapshots=e.snapshots||[])}clearAllData(){this.dataPoints=[],this.decisions=[],this.learnings=[],this.snapshots=[],this.saveState()}};var xr,fi,Rf;function aM(t){console.log("Vibey is now active!");let e=pe.workspace.workspaceFolders?pe.workspace.workspaceFolders[0].uri.fsPath:process.cwd();console.log("Vibey Workspace Root:",e),Rf=new zc(t);let r=new wi(e),n=new bi(r),s=new Ti;Xf(r,e).forEach(w=>n.registerTool(w)),em(r,e).forEach(w=>n.registerTool(w)),n.registerTool(tm(s));let a=S$.join(t.extensionPath,"src","ui","media","vibey-terminal.svg");fi=new Zs(e,t,a),sm(fi).forEach(w=>n.registerTool(w)),om().forEach(w=>n.registerTool(w)),xr=new Tc(n,t),xr.initialize().catch(w=>{console.error("[Vibey] Failed to initialize MCP service:",w)});let l=new _i,d=new vi(l,n,e),f=new Ii(t,e),p=pe.extensions.getExtension("vibey.vibey");p&&p.exports&&(p.exports.metricsCollector=Rf);let m=new Ds(t.extensionUri,d,s,f);t.subscriptions.push(pe.window.registerWebviewViewProvider(Ds.viewType,m)),t.subscriptions.push(pe.window.registerWebviewViewProvider("vibey.chatViewAux",m));let h=pe.commands.registerCommand("vibey.start",()=>{pe.commands.executeCommand("workbench.view.extension.vibey-sidebar")}),g=pe.commands.registerCommand("vibey.openSettings",()=>{pe.commands.executeCommand("workbench.action.openSettings","vibey")}),y=pe.commands.registerCommand("vibey.selectModel",async()=>{try{let w=await l.listModels();if(w.length===0){pe.window.showErrorMessage("No Ollama models found. Is Ollama running?");return}let D=await pe.window.showQuickPick(w,{placeHolder:"Select an Ollama model"});D&&(await pe.workspace.getConfiguration("vibey").update("model",D,pe.ConfigurationTarget.Global),pe.window.showInformationMessage(`Vibey model set to: ${D}`))}catch(w){pe.window.showErrorMessage(`Failed to select model: ${w.message}`)}}),x=pe.commands.registerCommand("vibey.mcpStatus",()=>{if(!xr){pe.window.showErrorMessage("MCP service not initialized");return}let w=xr.getServerStates();if(w.length===0){pe.window.showInformationMessage("No MCP servers configured. Add servers in settings (vibey.mcpServers)");return}let D=w.map(F=>`${F.status==="connected"?"\u2705":F.status==="error"?"\u274C":"\u23F3"} ${F.name}: ${F.toolCount} tools, ${F.resourceCount} resources${F.error?` (${F.error})`:""}`);pe.window.showInformationMessage(`MCP Servers:
${D.join(`
`)}`)}),$=pe.commands.registerCommand("vibey.mcpReload",async()=>{if(!xr){pe.window.showErrorMessage("MCP service not initialized");return}pe.window.showInformationMessage("Reloading MCP servers..."),await xr.reloadServers()}),S=pe.commands.registerCommand("vibey.mcpListTools",()=>{let w=n.getToolDefinitions(),D=w.map(F=>F.name).sort();pe.window.showQuickPick(D,{placeHolder:"Available tools (built-in + MCP)",canPickMany:!1}).then(F=>{if(F){let Ce=w.find(H=>H.name===F);Ce&&pe.window.showInformationMessage(`${Ce.name}: ${Ce.description}`)}})});t.subscriptions.push(h),t.subscriptions.push(g),t.subscriptions.push(y),t.subscriptions.push(x),t.subscriptions.push($),t.subscriptions.push(S)}function Zn(){return Rf}async function cM(){xr&&(await xr.dispose(),xr=void 0),fi&&(fi.dispose(),fi=void 0)}0&&(module.exports={activate,deactivate,getMetricsCollector});
