"use strict";var T$=Object.create;var hi=Object.defineProperty;var E$=Object.getOwnPropertyDescriptor;var z$=Object.getOwnPropertyNames;var C$=Object.getPrototypeOf,I$=Object.prototype.hasOwnProperty;var v=(t,e)=>()=>(e||t((e={exports:{}}).exports,e),e.exports),gi=(t,e)=>{for(var r in e)hi(t,r,{get:e[r],enumerable:!0})},Nf=(t,e,r,n)=>{if(e&&typeof e=="object"||typeof e=="function")for(let s of z$(e))!I$.call(t,s)&&s!==r&&hi(t,s,{get:()=>e[s],enumerable:!(n=E$(e,s))||n.enumerable});return t};var ye=(t,e,r)=>(r=t!=null?T$(C$(t)):{},Nf(e||!t||!t.__esModule?hi(r,"default",{value:t,enumerable:!0}):r,t)),R$=t=>Nf(hi({},"__esModule",{value:!0}),t);var po=v(ae=>{"use strict";Object.defineProperty(ae,"__esModule",{value:!0});ae.regexpCode=ae.getEsmExportName=ae.getProperty=ae.safeStringify=ae.stringify=ae.strConcat=ae.addCodeArg=ae.str=ae._=ae.nil=ae._Code=ae.Name=ae.IDENTIFIER=ae._CodeOrName=void 0;var uo=class{};ae._CodeOrName=uo;ae.IDENTIFIER=/^[a-z$_][a-z$_0-9]*$/i;var bn=class extends uo{constructor(e){if(super(),!ae.IDENTIFIER.test(e))throw new Error("CodeGen: name must be a valid identifier");this.str=e}toString(){return this.str}emptyStr(){return!1}get names(){return{[this.str]:1}}};ae.Name=bn;var xt=class extends uo{constructor(e){super(),this._items=typeof e=="string"?[e]:e}toString(){return this.str}emptyStr(){if(this._items.length>1)return!1;let e=this._items[0];return e===""||e==='""'}get str(){var e;return(e=this._str)!==null&&e!==void 0?e:this._str=this._items.reduce((r,n)=>`${r}${n}`,"")}get names(){var e;return(e=this._names)!==null&&e!==void 0?e:this._names=this._items.reduce((r,n)=>(n instanceof bn&&(r[n.str]=(r[n.str]||0)+1),r),{})}};ae._Code=xt;ae.nil=new xt("");function Iy(t,...e){let r=[t[0]],n=0;for(;n<e.length;)el(r,e[n]),r.push(t[++n]);return new xt(r)}ae._=Iy;var Xu=new xt("+");function Ry(t,...e){let r=[lo(t[0])],n=0;for(;n<e.length;)r.push(Xu),el(r,e[n]),r.push(Xu,lo(t[++n]));return BP(r),new xt(r)}ae.str=Ry;function el(t,e){e instanceof xt?t.push(...e._items):e instanceof bn?t.push(e):t.push(JP(e))}ae.addCodeArg=el;function BP(t){let e=1;for(;e<t.length-1;){if(t[e]===Xu){let r=GP(t[e-1],t[e+1]);if(r!==void 0){t.splice(e-1,3,r);continue}t[e++]="+"}e++}}function GP(t,e){if(e==='""')return t;if(t==='""')return e;if(typeof t=="string")return e instanceof bn||t[t.length-1]!=='"'?void 0:typeof e!="string"?`${t.slice(0,-1)}${e}"`:e[0]==='"'?t.slice(0,-1)+e.slice(1):void 0;if(typeof e=="string"&&e[0]==='"'&&!(t instanceof bn))return`"${t}${e.slice(1)}`}function WP(t,e){return e.emptyStr()?t:t.emptyStr()?e:Ry`${t}${e}`}ae.strConcat=WP;function JP(t){return typeof t=="number"||typeof t=="boolean"||t===null?t:lo(Array.isArray(t)?t.join(","):t)}function YP(t){return new xt(lo(t))}ae.stringify=YP;function lo(t){return JSON.stringify(t).replace(/\u2028/g,"\\u2028").replace(/\u2029/g,"\\u2029")}ae.safeStringify=lo;function QP(t){return typeof t=="string"&&ae.IDENTIFIER.test(t)?new xt(`.${t}`):Iy`[${t}]`}ae.getProperty=QP;function XP(t){if(typeof t=="string"&&ae.IDENTIFIER.test(t))return new xt(`${t}`);throw new Error(`CodeGen: invalid export name: ${t}, use explicit $id name mapping`)}ae.getEsmExportName=XP;function eT(t){return new xt(t.toString())}ae.regexpCode=eT});var nl=v(lt=>{"use strict";Object.defineProperty(lt,"__esModule",{value:!0});lt.ValueScope=lt.ValueScopeName=lt.Scope=lt.varKinds=lt.UsedValueState=void 0;var ut=po(),tl=class extends Error{constructor(e){super(`CodeGen: "code" for ${e} not defined`),this.value=e.value}},ca;(function(t){t[t.Started=0]="Started",t[t.Completed=1]="Completed"})(ca||(lt.UsedValueState=ca={}));lt.varKinds={const:new ut.Name("const"),let:new ut.Name("let"),var:new ut.Name("var")};var ua=class{constructor({prefixes:e,parent:r}={}){this._names={},this._prefixes=e,this._parent=r}toName(e){return e instanceof ut.Name?e:this.name(e)}name(e){return new ut.Name(this._newName(e))}_newName(e){let r=this._names[e]||this._nameGroup(e);return`${e}${r.index++}`}_nameGroup(e){var r,n;if(!((n=(r=this._parent)===null||r===void 0?void 0:r._prefixes)===null||n===void 0)&&n.has(e)||this._prefixes&&!this._prefixes.has(e))throw new Error(`CodeGen: prefix "${e}" is not allowed in this scope`);return this._names[e]={prefix:e,index:0}}};lt.Scope=ua;var la=class extends ut.Name{constructor(e,r){super(r),this.prefix=e}setValue(e,{property:r,itemIndex:n}){this.value=e,this.scopePath=(0,ut._)`.${new ut.Name(r)}[${n}]`}};lt.ValueScopeName=la;var tT=(0,ut._)`\n`,rl=class extends ua{constructor(e){super(e),this._values={},this._scope=e.scope,this.opts={...e,_n:e.lines?tT:ut.nil}}get(){return this._scope}name(e){return new la(e,this._newName(e))}value(e,r){var n;if(r.ref===void 0)throw new Error("CodeGen: ref must be passed in value");let s=this.toName(e),{prefix:o}=s,i=(n=r.key)!==null&&n!==void 0?n:r.ref,a=this._values[o];if(a){let l=a.get(i);if(l)return l}else a=this._values[o]=new Map;a.set(i,s);let c=this._scope[o]||(this._scope[o]=[]),u=c.length;return c[u]=r.ref,s.setValue(r,{property:o,itemIndex:u}),s}getValue(e,r){let n=this._values[e];if(n)return n.get(r)}scopeRefs(e,r=this._values){return this._reduceValues(r,n=>{if(n.scopePath===void 0)throw new Error(`CodeGen: name "${n}" has no value`);return(0,ut._)`${e}${n.scopePath}`})}scopeCode(e=this._values,r,n){return this._reduceValues(e,s=>{if(s.value===void 0)throw new Error(`CodeGen: name "${s}" has no value`);return s.value.code},r,n)}_reduceValues(e,r,n={},s){let o=ut.nil;for(let i in e){let a=e[i];if(!a)continue;let c=n[i]=n[i]||new Map;a.forEach(u=>{if(c.has(u))return;c.set(u,ca.Started);let l=r(u);if(l){let d=this.opts.es5?lt.varKinds.var:lt.varKinds.const;o=(0,ut._)`${o}${d} ${u} = ${l};${this.opts._n}`}else if(l=s?.(u))o=(0,ut._)`${o}${l}${this.opts._n}`;else throw new tl(u);c.set(u,ca.Completed)})}return o}};lt.ValueScope=rl});var Y=v(W=>{"use strict";Object.defineProperty(W,"__esModule",{value:!0});W.or=W.and=W.not=W.CodeGen=W.operators=W.varKinds=W.ValueScopeName=W.ValueScope=W.Scope=W.Name=W.regexpCode=W.stringify=W.getProperty=W.nil=W.strConcat=W.str=W._=void 0;var ne=po(),Nt=nl(),Or=po();Object.defineProperty(W,"_",{enumerable:!0,get:function(){return Or._}});Object.defineProperty(W,"str",{enumerable:!0,get:function(){return Or.str}});Object.defineProperty(W,"strConcat",{enumerable:!0,get:function(){return Or.strConcat}});Object.defineProperty(W,"nil",{enumerable:!0,get:function(){return Or.nil}});Object.defineProperty(W,"getProperty",{enumerable:!0,get:function(){return Or.getProperty}});Object.defineProperty(W,"stringify",{enumerable:!0,get:function(){return Or.stringify}});Object.defineProperty(W,"regexpCode",{enumerable:!0,get:function(){return Or.regexpCode}});Object.defineProperty(W,"Name",{enumerable:!0,get:function(){return Or.Name}});var ma=nl();Object.defineProperty(W,"Scope",{enumerable:!0,get:function(){return ma.Scope}});Object.defineProperty(W,"ValueScope",{enumerable:!0,get:function(){return ma.ValueScope}});Object.defineProperty(W,"ValueScopeName",{enumerable:!0,get:function(){return ma.ValueScopeName}});Object.defineProperty(W,"varKinds",{enumerable:!0,get:function(){return ma.varKinds}});W.operators={GT:new ne._Code(">"),GTE:new ne._Code(">="),LT:new ne._Code("<"),LTE:new ne._Code("<="),EQ:new ne._Code("==="),NEQ:new ne._Code("!=="),NOT:new ne._Code("!"),OR:new ne._Code("||"),AND:new ne._Code("&&"),ADD:new ne._Code("+")};var hr=class{optimizeNodes(){return this}optimizeNames(e,r){return this}},sl=class extends hr{constructor(e,r,n){super(),this.varKind=e,this.name=r,this.rhs=n}render({es5:e,_n:r}){let n=e?Nt.varKinds.var:this.varKind,s=this.rhs===void 0?"":` = ${this.rhs}`;return`${n} ${this.name}${s};`+r}optimizeNames(e,r){if(e[this.name.str])return this.rhs&&(this.rhs=ss(this.rhs,e,r)),this}get names(){return this.rhs instanceof ne._CodeOrName?this.rhs.names:{}}},da=class extends hr{constructor(e,r,n){super(),this.lhs=e,this.rhs=r,this.sideEffects=n}render({_n:e}){return`${this.lhs} = ${this.rhs};`+e}optimizeNames(e,r){if(!(this.lhs instanceof ne.Name&&!e[this.lhs.str]&&!this.sideEffects))return this.rhs=ss(this.rhs,e,r),this}get names(){let e=this.lhs instanceof ne.Name?{}:{...this.lhs.names};return fa(e,this.rhs)}},ol=class extends da{constructor(e,r,n,s){super(e,n,s),this.op=r}render({_n:e}){return`${this.lhs} ${this.op}= ${this.rhs};`+e}},il=class extends hr{constructor(e){super(),this.label=e,this.names={}}render({_n:e}){return`${this.label}:`+e}},al=class extends hr{constructor(e){super(),this.label=e,this.names={}}render({_n:e}){return`break${this.label?` ${this.label}`:""};`+e}},cl=class extends hr{constructor(e){super(),this.error=e}render({_n:e}){return`throw ${this.error};`+e}get names(){return this.error.names}},ul=class extends hr{constructor(e){super(),this.code=e}render({_n:e}){return`${this.code};`+e}optimizeNodes(){return`${this.code}`?this:void 0}optimizeNames(e,r){return this.code=ss(this.code,e,r),this}get names(){return this.code instanceof ne._CodeOrName?this.code.names:{}}},fo=class extends hr{constructor(e=[]){super(),this.nodes=e}render(e){return this.nodes.reduce((r,n)=>r+n.render(e),"")}optimizeNodes(){let{nodes:e}=this,r=e.length;for(;r--;){let n=e[r].optimizeNodes();Array.isArray(n)?e.splice(r,1,...n):n?e[r]=n:e.splice(r,1)}return e.length>0?this:void 0}optimizeNames(e,r){let{nodes:n}=this,s=n.length;for(;s--;){let o=n[s];o.optimizeNames(e,r)||(rT(e,o.names),n.splice(s,1))}return n.length>0?this:void 0}get names(){return this.nodes.reduce((e,r)=>xn(e,r.names),{})}},gr=class extends fo{render(e){return"{"+e._n+super.render(e)+"}"+e._n}},ll=class extends fo{},ns=class extends gr{};ns.kind="else";var wn=class t extends gr{constructor(e,r){super(r),this.condition=e}render(e){let r=`if(${this.condition})`+super.render(e);return this.else&&(r+="else "+this.else.render(e)),r}optimizeNodes(){super.optimizeNodes();let e=this.condition;if(e===!0)return this.nodes;let r=this.else;if(r){let n=r.optimizeNodes();r=this.else=Array.isArray(n)?new ns(n):n}if(r)return e===!1?r instanceof t?r:r.nodes:this.nodes.length?this:new t(Oy(e),r instanceof t?[r]:r.nodes);if(!(e===!1||!this.nodes.length))return this}optimizeNames(e,r){var n;if(this.else=(n=this.else)===null||n===void 0?void 0:n.optimizeNames(e,r),!!(super.optimizeNames(e,r)||this.else))return this.condition=ss(this.condition,e,r),this}get names(){let e=super.names;return fa(e,this.condition),this.else&&xn(e,this.else.names),e}};wn.kind="if";var $n=class extends gr{};$n.kind="for";var dl=class extends $n{constructor(e){super(),this.iteration=e}render(e){return`for(${this.iteration})`+super.render(e)}optimizeNames(e,r){if(super.optimizeNames(e,r))return this.iteration=ss(this.iteration,e,r),this}get names(){return xn(super.names,this.iteration.names)}},pl=class extends $n{constructor(e,r,n,s){super(),this.varKind=e,this.name=r,this.from=n,this.to=s}render(e){let r=e.es5?Nt.varKinds.var:this.varKind,{name:n,from:s,to:o}=this;return`for(${r} ${n}=${s}; ${n}<${o}; ${n}++)`+super.render(e)}get names(){let e=fa(super.names,this.from);return fa(e,this.to)}},pa=class extends $n{constructor(e,r,n,s){super(),this.loop=e,this.varKind=r,this.name=n,this.iterable=s}render(e){return`for(${this.varKind} ${this.name} ${this.loop} ${this.iterable})`+super.render(e)}optimizeNames(e,r){if(super.optimizeNames(e,r))return this.iterable=ss(this.iterable,e,r),this}get names(){return xn(super.names,this.iterable.names)}},mo=class extends gr{constructor(e,r,n){super(),this.name=e,this.args=r,this.async=n}render(e){return`${this.async?"async ":""}function ${this.name}(${this.args})`+super.render(e)}};mo.kind="func";var ho=class extends fo{render(e){return"return "+super.render(e)}};ho.kind="return";var fl=class extends gr{render(e){let r="try"+super.render(e);return this.catch&&(r+=this.catch.render(e)),this.finally&&(r+=this.finally.render(e)),r}optimizeNodes(){var e,r;return super.optimizeNodes(),(e=this.catch)===null||e===void 0||e.optimizeNodes(),(r=this.finally)===null||r===void 0||r.optimizeNodes(),this}optimizeNames(e,r){var n,s;return super.optimizeNames(e,r),(n=this.catch)===null||n===void 0||n.optimizeNames(e,r),(s=this.finally)===null||s===void 0||s.optimizeNames(e,r),this}get names(){let e=super.names;return this.catch&&xn(e,this.catch.names),this.finally&&xn(e,this.finally.names),e}},go=class extends gr{constructor(e){super(),this.error=e}render(e){return`catch(${this.error})`+super.render(e)}};go.kind="catch";var yo=class extends gr{render(e){return"finally"+super.render(e)}};yo.kind="finally";var ml=class{constructor(e,r={}){this._values={},this._blockStarts=[],this._constants={},this.opts={...r,_n:r.lines?`
`:""},this._extScope=e,this._scope=new Nt.Scope({parent:e}),this._nodes=[new ll]}toString(){return this._root.render(this.opts)}name(e){return this._scope.name(e)}scopeName(e){return this._extScope.name(e)}scopeValue(e,r){let n=this._extScope.value(e,r);return(this._values[n.prefix]||(this._values[n.prefix]=new Set)).add(n),n}getScopeValue(e,r){return this._extScope.getValue(e,r)}scopeRefs(e){return this._extScope.scopeRefs(e,this._values)}scopeCode(){return this._extScope.scopeCode(this._values)}_def(e,r,n,s){let o=this._scope.toName(r);return n!==void 0&&s&&(this._constants[o.str]=n),this._leafNode(new sl(e,o,n)),o}const(e,r,n){return this._def(Nt.varKinds.const,e,r,n)}let(e,r,n){return this._def(Nt.varKinds.let,e,r,n)}var(e,r,n){return this._def(Nt.varKinds.var,e,r,n)}assign(e,r,n){return this._leafNode(new da(e,r,n))}add(e,r){return this._leafNode(new ol(e,W.operators.ADD,r))}code(e){return typeof e=="function"?e():e!==ne.nil&&this._leafNode(new ul(e)),this}object(...e){let r=["{"];for(let[n,s]of e)r.length>1&&r.push(","),r.push(n),(n!==s||this.opts.es5)&&(r.push(":"),(0,ne.addCodeArg)(r,s));return r.push("}"),new ne._Code(r)}if(e,r,n){if(this._blockNode(new wn(e)),r&&n)this.code(r).else().code(n).endIf();else if(r)this.code(r).endIf();else if(n)throw new Error('CodeGen: "else" body without "then" body');return this}elseIf(e){return this._elseNode(new wn(e))}else(){return this._elseNode(new ns)}endIf(){return this._endBlockNode(wn,ns)}_for(e,r){return this._blockNode(e),r&&this.code(r).endFor(),this}for(e,r){return this._for(new dl(e),r)}forRange(e,r,n,s,o=this.opts.es5?Nt.varKinds.var:Nt.varKinds.let){let i=this._scope.toName(e);return this._for(new pl(o,i,r,n),()=>s(i))}forOf(e,r,n,s=Nt.varKinds.const){let o=this._scope.toName(e);if(this.opts.es5){let i=r instanceof ne.Name?r:this.var("_arr",r);return this.forRange("_i",0,(0,ne._)`${i}.length`,a=>{this.var(o,(0,ne._)`${i}[${a}]`),n(o)})}return this._for(new pa("of",s,o,r),()=>n(o))}forIn(e,r,n,s=this.opts.es5?Nt.varKinds.var:Nt.varKinds.const){if(this.opts.ownProperties)return this.forOf(e,(0,ne._)`Object.keys(${r})`,n);let o=this._scope.toName(e);return this._for(new pa("in",s,o,r),()=>n(o))}endFor(){return this._endBlockNode($n)}label(e){return this._leafNode(new il(e))}break(e){return this._leafNode(new al(e))}return(e){let r=new ho;if(this._blockNode(r),this.code(e),r.nodes.length!==1)throw new Error('CodeGen: "return" should have one node');return this._endBlockNode(ho)}try(e,r,n){if(!r&&!n)throw new Error('CodeGen: "try" without "catch" and "finally"');let s=new fl;if(this._blockNode(s),this.code(e),r){let o=this.name("e");this._currNode=s.catch=new go(o),r(o)}return n&&(this._currNode=s.finally=new yo,this.code(n)),this._endBlockNode(go,yo)}throw(e){return this._leafNode(new cl(e))}block(e,r){return this._blockStarts.push(this._nodes.length),e&&this.code(e).endBlock(r),this}endBlock(e){let r=this._blockStarts.pop();if(r===void 0)throw new Error("CodeGen: not in self-balancing block");let n=this._nodes.length-r;if(n<0||e!==void 0&&n!==e)throw new Error(`CodeGen: wrong number of nodes: ${n} vs ${e} expected`);return this._nodes.length=r,this}func(e,r=ne.nil,n,s){return this._blockNode(new mo(e,r,n)),s&&this.code(s).endFunc(),this}endFunc(){return this._endBlockNode(mo)}optimize(e=1){for(;e-- >0;)this._root.optimizeNodes(),this._root.optimizeNames(this._root.names,this._constants)}_leafNode(e){return this._currNode.nodes.push(e),this}_blockNode(e){this._currNode.nodes.push(e),this._nodes.push(e)}_endBlockNode(e,r){let n=this._currNode;if(n instanceof e||r&&n instanceof r)return this._nodes.pop(),this;throw new Error(`CodeGen: not in block "${r?`${e.kind}/${r.kind}`:e.kind}"`)}_elseNode(e){let r=this._currNode;if(!(r instanceof wn))throw new Error('CodeGen: "else" without "if"');return this._currNode=r.else=e,this}get _root(){return this._nodes[0]}get _currNode(){let e=this._nodes;return e[e.length-1]}set _currNode(e){let r=this._nodes;r[r.length-1]=e}};W.CodeGen=ml;function xn(t,e){for(let r in e)t[r]=(t[r]||0)+(e[r]||0);return t}function fa(t,e){return e instanceof ne._CodeOrName?xn(t,e.names):t}function ss(t,e,r){if(t instanceof ne.Name)return n(t);if(!s(t))return t;return new ne._Code(t._items.reduce((o,i)=>(i instanceof ne.Name&&(i=n(i)),i instanceof ne._Code?o.push(...i._items):o.push(i),o),[]));function n(o){let i=r[o.str];return i===void 0||e[o.str]!==1?o:(delete e[o.str],i)}function s(o){return o instanceof ne._Code&&o._items.some(i=>i instanceof ne.Name&&e[i.str]===1&&r[i.str]!==void 0)}}function rT(t,e){for(let r in e)t[r]=(t[r]||0)-(e[r]||0)}function Oy(t){return typeof t=="boolean"||typeof t=="number"||t===null?!t:(0,ne._)`!${hl(t)}`}W.not=Oy;var nT=Ny(W.operators.AND);function sT(...t){return t.reduce(nT)}W.and=sT;var oT=Ny(W.operators.OR);function iT(...t){return t.reduce(oT)}W.or=iT;function Ny(t){return(e,r)=>e===ne.nil?r:r===ne.nil?e:(0,ne._)`${hl(e)} ${t} ${hl(r)}`}function hl(t){return t instanceof ne.Name?t:(0,ne._)`(${t})`}});var ce=v(Q=>{"use strict";Object.defineProperty(Q,"__esModule",{value:!0});Q.checkStrictMode=Q.getErrorPath=Q.Type=Q.useFunc=Q.setEvaluated=Q.evaluatedPropsToName=Q.mergeEvaluated=Q.eachItem=Q.unescapeJsonPointer=Q.escapeJsonPointer=Q.escapeFragment=Q.unescapeFragment=Q.schemaRefOrVal=Q.schemaHasRulesButRef=Q.schemaHasRules=Q.checkUnknownRules=Q.alwaysValidSchema=Q.toHash=void 0;var _e=Y(),aT=po();function cT(t){let e={};for(let r of t)e[r]=!0;return e}Q.toHash=cT;function uT(t,e){return typeof e=="boolean"?e:Object.keys(e).length===0?!0:(My(t,e),!qy(e,t.self.RULES.all))}Q.alwaysValidSchema=uT;function My(t,e=t.schema){let{opts:r,self:n}=t;if(!r.strictSchema||typeof e=="boolean")return;let s=n.RULES.keywords;for(let o in e)s[o]||Ly(t,`unknown keyword: "${o}"`)}Q.checkUnknownRules=My;function qy(t,e){if(typeof t=="boolean")return!t;for(let r in t)if(e[r])return!0;return!1}Q.schemaHasRules=qy;function lT(t,e){if(typeof t=="boolean")return!t;for(let r in t)if(r!=="$ref"&&e.all[r])return!0;return!1}Q.schemaHasRulesButRef=lT;function dT({topSchemaRef:t,schemaPath:e},r,n,s){if(!s){if(typeof r=="number"||typeof r=="boolean")return r;if(typeof r=="string")return(0,_e._)`${r}`}return(0,_e._)`${t}${e}${(0,_e.getProperty)(n)}`}Q.schemaRefOrVal=dT;function pT(t){return Dy(decodeURIComponent(t))}Q.unescapeFragment=pT;function fT(t){return encodeURIComponent(yl(t))}Q.escapeFragment=fT;function yl(t){return typeof t=="number"?`${t}`:t.replace(/~/g,"~0").replace(/\//g,"~1")}Q.escapeJsonPointer=yl;function Dy(t){return t.replace(/~1/g,"/").replace(/~0/g,"~")}Q.unescapeJsonPointer=Dy;function mT(t,e){if(Array.isArray(t))for(let r of t)e(r);else e(t)}Q.eachItem=mT;function jy({mergeNames:t,mergeToName:e,mergeValues:r,resultToName:n}){return(s,o,i,a)=>{let c=i===void 0?o:i instanceof _e.Name?(o instanceof _e.Name?t(s,o,i):e(s,o,i),i):o instanceof _e.Name?(e(s,i,o),o):r(o,i);return a===_e.Name&&!(c instanceof _e.Name)?n(s,c):c}}Q.mergeEvaluated={props:jy({mergeNames:(t,e,r)=>t.if((0,_e._)`${r} !== true && ${e} !== undefined`,()=>{t.if((0,_e._)`${e} === true`,()=>t.assign(r,!0),()=>t.assign(r,(0,_e._)`${r} || {}`).code((0,_e._)`Object.assign(${r}, ${e})`))}),mergeToName:(t,e,r)=>t.if((0,_e._)`${r} !== true`,()=>{e===!0?t.assign(r,!0):(t.assign(r,(0,_e._)`${r} || {}`),vl(t,r,e))}),mergeValues:(t,e)=>t===!0?!0:{...t,...e},resultToName:Zy}),items:jy({mergeNames:(t,e,r)=>t.if((0,_e._)`${r} !== true && ${e} !== undefined`,()=>t.assign(r,(0,_e._)`${e} === true ? true : ${r} > ${e} ? ${r} : ${e}`)),mergeToName:(t,e,r)=>t.if((0,_e._)`${r} !== true`,()=>t.assign(r,e===!0?!0:(0,_e._)`${r} > ${e} ? ${r} : ${e}`)),mergeValues:(t,e)=>t===!0?!0:Math.max(t,e),resultToName:(t,e)=>t.var("items",e)})};function Zy(t,e){if(e===!0)return t.var("props",!0);let r=t.var("props",(0,_e._)`{}`);return e!==void 0&&vl(t,r,e),r}Q.evaluatedPropsToName=Zy;function vl(t,e,r){Object.keys(r).forEach(n=>t.assign((0,_e._)`${e}${(0,_e.getProperty)(n)}`,!0))}Q.setEvaluated=vl;var Ay={};function hT(t,e){return t.scopeValue("func",{ref:e,code:Ay[e.code]||(Ay[e.code]=new aT._Code(e.code))})}Q.useFunc=hT;var gl;(function(t){t[t.Num=0]="Num",t[t.Str=1]="Str"})(gl||(Q.Type=gl={}));function gT(t,e,r){if(t instanceof _e.Name){let n=e===gl.Num;return r?n?(0,_e._)`"[" + ${t} + "]"`:(0,_e._)`"['" + ${t} + "']"`:n?(0,_e._)`"/" + ${t}`:(0,_e._)`"/" + ${t}.replace(/~/g, "~0").replace(/\\//g, "~1")`}return r?(0,_e.getProperty)(t).toString():"/"+yl(t)}Q.getErrorPath=gT;function Ly(t,e,r=t.opts.strictSchema){if(r){if(e=`strict mode: ${e}`,r===!0)throw new Error(e);t.self.logger.warn(e)}}Q.checkStrictMode=Ly});var yr=v(_l=>{"use strict";Object.defineProperty(_l,"__esModule",{value:!0});var Je=Y(),yT={data:new Je.Name("data"),valCxt:new Je.Name("valCxt"),instancePath:new Je.Name("instancePath"),parentData:new Je.Name("parentData"),parentDataProperty:new Je.Name("parentDataProperty"),rootData:new Je.Name("rootData"),dynamicAnchors:new Je.Name("dynamicAnchors"),vErrors:new Je.Name("vErrors"),errors:new Je.Name("errors"),this:new Je.Name("this"),self:new Je.Name("self"),scope:new Je.Name("scope"),json:new Je.Name("json"),jsonPos:new Je.Name("jsonPos"),jsonLen:new Je.Name("jsonLen"),jsonPart:new Je.Name("jsonPart")};_l.default=yT});var vo=v(Ye=>{"use strict";Object.defineProperty(Ye,"__esModule",{value:!0});Ye.extendErrors=Ye.resetErrorsCount=Ye.reportExtraError=Ye.reportError=Ye.keyword$DataError=Ye.keywordError=void 0;var oe=Y(),ha=ce(),rt=yr();Ye.keywordError={message:({keyword:t})=>(0,oe.str)`must pass "${t}" keyword validation`};Ye.keyword$DataError={message:({keyword:t,schemaType:e})=>e?(0,oe.str)`"${t}" keyword must be ${e} ($data)`:(0,oe.str)`"${t}" keyword is invalid ($data)`};function vT(t,e=Ye.keywordError,r,n){let{it:s}=t,{gen:o,compositeRule:i,allErrors:a}=s,c=Uy(t,e,r);n??(i||a)?Vy(o,c):Fy(s,(0,oe._)`[${c}]`)}Ye.reportError=vT;function _T(t,e=Ye.keywordError,r){let{it:n}=t,{gen:s,compositeRule:o,allErrors:i}=n,a=Uy(t,e,r);Vy(s,a),o||i||Fy(n,rt.default.vErrors)}Ye.reportExtraError=_T;function bT(t,e){t.assign(rt.default.errors,e),t.if((0,oe._)`${rt.default.vErrors} !== null`,()=>t.if(e,()=>t.assign((0,oe._)`${rt.default.vErrors}.length`,e),()=>t.assign(rt.default.vErrors,null)))}Ye.resetErrorsCount=bT;function wT({gen:t,keyword:e,schemaValue:r,data:n,errsCount:s,it:o}){if(s===void 0)throw new Error("ajv implementation error");let i=t.name("err");t.forRange("i",s,rt.default.errors,a=>{t.const(i,(0,oe._)`${rt.default.vErrors}[${a}]`),t.if((0,oe._)`${i}.instancePath === undefined`,()=>t.assign((0,oe._)`${i}.instancePath`,(0,oe.strConcat)(rt.default.instancePath,o.errorPath))),t.assign((0,oe._)`${i}.schemaPath`,(0,oe.str)`${o.errSchemaPath}/${e}`),o.opts.verbose&&(t.assign((0,oe._)`${i}.schema`,r),t.assign((0,oe._)`${i}.data`,n))})}Ye.extendErrors=wT;function Vy(t,e){let r=t.const("err",e);t.if((0,oe._)`${rt.default.vErrors} === null`,()=>t.assign(rt.default.vErrors,(0,oe._)`[${r}]`),(0,oe._)`${rt.default.vErrors}.push(${r})`),t.code((0,oe._)`${rt.default.errors}++`)}function Fy(t,e){let{gen:r,validateName:n,schemaEnv:s}=t;s.$async?r.throw((0,oe._)`new ${t.ValidationError}(${e})`):(r.assign((0,oe._)`${n}.errors`,e),r.return(!1))}var kn={keyword:new oe.Name("keyword"),schemaPath:new oe.Name("schemaPath"),params:new oe.Name("params"),propertyName:new oe.Name("propertyName"),message:new oe.Name("message"),schema:new oe.Name("schema"),parentSchema:new oe.Name("parentSchema")};function Uy(t,e,r){let{createErrors:n}=t.it;return n===!1?(0,oe._)`{}`:$T(t,e,r)}function $T(t,e,r={}){let{gen:n,it:s}=t,o=[xT(s,r),kT(t,r)];return ST(t,e,o),n.object(...o)}function xT({errorPath:t},{instancePath:e}){let r=e?(0,oe.str)`${t}${(0,ha.getErrorPath)(e,ha.Type.Str)}`:t;return[rt.default.instancePath,(0,oe.strConcat)(rt.default.instancePath,r)]}function kT({keyword:t,it:{errSchemaPath:e}},{schemaPath:r,parentSchema:n}){let s=n?e:(0,oe.str)`${e}/${t}`;return r&&(s=(0,oe.str)`${s}${(0,ha.getErrorPath)(r,ha.Type.Str)}`),[kn.schemaPath,s]}function ST(t,{params:e,message:r},n){let{keyword:s,data:o,schemaValue:i,it:a}=t,{opts:c,propertyName:u,topSchemaRef:l,schemaPath:d}=a;n.push([kn.keyword,s],[kn.params,typeof e=="function"?e(t):e||(0,oe._)`{}`]),c.messages&&n.push([kn.message,typeof r=="function"?r(t):r]),c.verbose&&n.push([kn.schema,i],[kn.parentSchema,(0,oe._)`${l}${d}`],[rt.default.data,o]),u&&n.push([kn.propertyName,u])}});var Ky=v(os=>{"use strict";Object.defineProperty(os,"__esModule",{value:!0});os.boolOrEmptySchema=os.topBoolOrEmptySchema=void 0;var PT=vo(),TT=Y(),ET=yr(),zT={message:"boolean schema is false"};function CT(t){let{gen:e,schema:r,validateName:n}=t;r===!1?Hy(t,!1):typeof r=="object"&&r.$async===!0?e.return(ET.default.data):(e.assign((0,TT._)`${n}.errors`,null),e.return(!0))}os.topBoolOrEmptySchema=CT;function IT(t,e){let{gen:r,schema:n}=t;n===!1?(r.var(e,!1),Hy(t)):r.var(e,!0)}os.boolOrEmptySchema=IT;function Hy(t,e){let{gen:r,data:n}=t,s={gen:r,keyword:"false schema",data:n,schema:!1,schemaCode:!1,schemaValue:!1,params:{},it:t};(0,PT.reportError)(s,zT,void 0,e)}});var bl=v(is=>{"use strict";Object.defineProperty(is,"__esModule",{value:!0});is.getRules=is.isJSONType=void 0;var RT=["string","number","integer","boolean","null","object","array"],OT=new Set(RT);function NT(t){return typeof t=="string"&&OT.has(t)}is.isJSONType=NT;function jT(){let t={number:{type:"number",rules:[]},string:{type:"string",rules:[]},array:{type:"array",rules:[]},object:{type:"object",rules:[]}};return{types:{...t,integer:!0,boolean:!0,null:!0},rules:[{rules:[]},t.number,t.string,t.array,t.object],post:{rules:[]},all:{},keywords:{}}}is.getRules=jT});var wl=v(Nr=>{"use strict";Object.defineProperty(Nr,"__esModule",{value:!0});Nr.shouldUseRule=Nr.shouldUseGroup=Nr.schemaHasRulesForType=void 0;function AT({schema:t,self:e},r){let n=e.RULES.types[r];return n&&n!==!0&&By(t,n)}Nr.schemaHasRulesForType=AT;function By(t,e){return e.rules.some(r=>Gy(t,r))}Nr.shouldUseGroup=By;function Gy(t,e){var r;return t[e.keyword]!==void 0||((r=e.definition.implements)===null||r===void 0?void 0:r.some(n=>t[n]!==void 0))}Nr.shouldUseRule=Gy});var _o=v(Qe=>{"use strict";Object.defineProperty(Qe,"__esModule",{value:!0});Qe.reportTypeError=Qe.checkDataTypes=Qe.checkDataType=Qe.coerceAndCheckDataType=Qe.getJSONTypes=Qe.getSchemaTypes=Qe.DataType=void 0;var MT=bl(),qT=wl(),DT=vo(),H=Y(),Wy=ce(),as;(function(t){t[t.Correct=0]="Correct",t[t.Wrong=1]="Wrong"})(as||(Qe.DataType=as={}));function ZT(t){let e=Jy(t.type);if(e.includes("null")){if(t.nullable===!1)throw new Error("type: null contradicts nullable: false")}else{if(!e.length&&t.nullable!==void 0)throw new Error('"nullable" cannot be used without "type"');t.nullable===!0&&e.push("null")}return e}Qe.getSchemaTypes=ZT;function Jy(t){let e=Array.isArray(t)?t:t?[t]:[];if(e.every(MT.isJSONType))return e;throw new Error("type must be JSONType or JSONType[]: "+e.join(","))}Qe.getJSONTypes=Jy;function LT(t,e){let{gen:r,data:n,opts:s}=t,o=VT(e,s.coerceTypes),i=e.length>0&&!(o.length===0&&e.length===1&&(0,qT.schemaHasRulesForType)(t,e[0]));if(i){let a=xl(e,n,s.strictNumbers,as.Wrong);r.if(a,()=>{o.length?FT(t,e,o):kl(t)})}return i}Qe.coerceAndCheckDataType=LT;var Yy=new Set(["string","number","integer","boolean","null"]);function VT(t,e){return e?t.filter(r=>Yy.has(r)||e==="array"&&r==="array"):[]}function FT(t,e,r){let{gen:n,data:s,opts:o}=t,i=n.let("dataType",(0,H._)`typeof ${s}`),a=n.let("coerced",(0,H._)`undefined`);o.coerceTypes==="array"&&n.if((0,H._)`${i} == 'object' && Array.isArray(${s}) && ${s}.length == 1`,()=>n.assign(s,(0,H._)`${s}[0]`).assign(i,(0,H._)`typeof ${s}`).if(xl(e,s,o.strictNumbers),()=>n.assign(a,s))),n.if((0,H._)`${a} !== undefined`);for(let u of r)(Yy.has(u)||u==="array"&&o.coerceTypes==="array")&&c(u);n.else(),kl(t),n.endIf(),n.if((0,H._)`${a} !== undefined`,()=>{n.assign(s,a),UT(t,a)});function c(u){switch(u){case"string":n.elseIf((0,H._)`${i} == "number" || ${i} == "boolean"`).assign(a,(0,H._)`"" + ${s}`).elseIf((0,H._)`${s} === null`).assign(a,(0,H._)`""`);return;case"number":n.elseIf((0,H._)`${i} == "boolean" || ${s} === null
              || (${i} == "string" && ${s} && ${s} == +${s})`).assign(a,(0,H._)`+${s}`);return;case"integer":n.elseIf((0,H._)`${i} === "boolean" || ${s} === null
              || (${i} === "string" && ${s} && ${s} == +${s} && !(${s} % 1))`).assign(a,(0,H._)`+${s}`);return;case"boolean":n.elseIf((0,H._)`${s} === "false" || ${s} === 0 || ${s} === null`).assign(a,!1).elseIf((0,H._)`${s} === "true" || ${s} === 1`).assign(a,!0);return;case"null":n.elseIf((0,H._)`${s} === "" || ${s} === 0 || ${s} === false`),n.assign(a,null);return;case"array":n.elseIf((0,H._)`${i} === "string" || ${i} === "number"
              || ${i} === "boolean" || ${s} === null`).assign(a,(0,H._)`[${s}]`)}}}function UT({gen:t,parentData:e,parentDataProperty:r},n){t.if((0,H._)`${e} !== undefined`,()=>t.assign((0,H._)`${e}[${r}]`,n))}function $l(t,e,r,n=as.Correct){let s=n===as.Correct?H.operators.EQ:H.operators.NEQ,o;switch(t){case"null":return(0,H._)`${e} ${s} null`;case"array":o=(0,H._)`Array.isArray(${e})`;break;case"object":o=(0,H._)`${e} && typeof ${e} == "object" && !Array.isArray(${e})`;break;case"integer":o=i((0,H._)`!(${e} % 1) && !isNaN(${e})`);break;case"number":o=i();break;default:return(0,H._)`typeof ${e} ${s} ${t}`}return n===as.Correct?o:(0,H.not)(o);function i(a=H.nil){return(0,H.and)((0,H._)`typeof ${e} == "number"`,a,r?(0,H._)`isFinite(${e})`:H.nil)}}Qe.checkDataType=$l;function xl(t,e,r,n){if(t.length===1)return $l(t[0],e,r,n);let s,o=(0,Wy.toHash)(t);if(o.array&&o.object){let i=(0,H._)`typeof ${e} != "object"`;s=o.null?i:(0,H._)`!${e} || ${i}`,delete o.null,delete o.array,delete o.object}else s=H.nil;o.number&&delete o.integer;for(let i in o)s=(0,H.and)(s,$l(i,e,r,n));return s}Qe.checkDataTypes=xl;var HT={message:({schema:t})=>`must be ${t}`,params:({schema:t,schemaValue:e})=>typeof t=="string"?(0,H._)`{type: ${t}}`:(0,H._)`{type: ${e}}`};function kl(t){let e=KT(t);(0,DT.reportError)(e,HT)}Qe.reportTypeError=kl;function KT(t){let{gen:e,data:r,schema:n}=t,s=(0,Wy.schemaRefOrVal)(t,n,"type");return{gen:e,keyword:"type",data:r,schema:n.type,schemaCode:s,schemaValue:s,parentSchema:n,params:{},it:t}}});var Xy=v(ga=>{"use strict";Object.defineProperty(ga,"__esModule",{value:!0});ga.assignDefaults=void 0;var cs=Y(),BT=ce();function GT(t,e){let{properties:r,items:n}=t.schema;if(e==="object"&&r)for(let s in r)Qy(t,s,r[s].default);else e==="array"&&Array.isArray(n)&&n.forEach((s,o)=>Qy(t,o,s.default))}ga.assignDefaults=GT;function Qy(t,e,r){let{gen:n,compositeRule:s,data:o,opts:i}=t;if(r===void 0)return;let a=(0,cs._)`${o}${(0,cs.getProperty)(e)}`;if(s){(0,BT.checkStrictMode)(t,`default is ignored for: ${a}`);return}let c=(0,cs._)`${a} === undefined`;i.useDefaults==="empty"&&(c=(0,cs._)`${c} || ${a} === null || ${a} === ""`),n.if(c,(0,cs._)`${a} = ${(0,cs.stringify)(r)}`)}});var kt=v(me=>{"use strict";Object.defineProperty(me,"__esModule",{value:!0});me.validateUnion=me.validateArray=me.usePattern=me.callValidateCode=me.schemaProperties=me.allSchemaProperties=me.noPropertyInData=me.propertyInData=me.isOwnProperty=me.hasPropFunc=me.reportMissingProp=me.checkMissingProp=me.checkReportMissingProp=void 0;var Se=Y(),Sl=ce(),jr=yr(),WT=ce();function JT(t,e){let{gen:r,data:n,it:s}=t;r.if(Tl(r,n,e,s.opts.ownProperties),()=>{t.setParams({missingProperty:(0,Se._)`${e}`},!0),t.error()})}me.checkReportMissingProp=JT;function YT({gen:t,data:e,it:{opts:r}},n,s){return(0,Se.or)(...n.map(o=>(0,Se.and)(Tl(t,e,o,r.ownProperties),(0,Se._)`${s} = ${o}`)))}me.checkMissingProp=YT;function QT(t,e){t.setParams({missingProperty:e},!0),t.error()}me.reportMissingProp=QT;function ev(t){return t.scopeValue("func",{ref:Object.prototype.hasOwnProperty,code:(0,Se._)`Object.prototype.hasOwnProperty`})}me.hasPropFunc=ev;function Pl(t,e,r){return(0,Se._)`${ev(t)}.call(${e}, ${r})`}me.isOwnProperty=Pl;function XT(t,e,r,n){let s=(0,Se._)`${e}${(0,Se.getProperty)(r)} !== undefined`;return n?(0,Se._)`${s} && ${Pl(t,e,r)}`:s}me.propertyInData=XT;function Tl(t,e,r,n){let s=(0,Se._)`${e}${(0,Se.getProperty)(r)} === undefined`;return n?(0,Se.or)(s,(0,Se.not)(Pl(t,e,r))):s}me.noPropertyInData=Tl;function tv(t){return t?Object.keys(t).filter(e=>e!=="__proto__"):[]}me.allSchemaProperties=tv;function eE(t,e){return tv(e).filter(r=>!(0,Sl.alwaysValidSchema)(t,e[r]))}me.schemaProperties=eE;function tE({schemaCode:t,data:e,it:{gen:r,topSchemaRef:n,schemaPath:s,errorPath:o},it:i},a,c,u){let l=u?(0,Se._)`${t}, ${e}, ${n}${s}`:e,d=[[jr.default.instancePath,(0,Se.strConcat)(jr.default.instancePath,o)],[jr.default.parentData,i.parentData],[jr.default.parentDataProperty,i.parentDataProperty],[jr.default.rootData,jr.default.rootData]];i.opts.dynamicRef&&d.push([jr.default.dynamicAnchors,jr.default.dynamicAnchors]);let f=(0,Se._)`${l}, ${r.object(...d)}`;return c!==Se.nil?(0,Se._)`${a}.call(${c}, ${f})`:(0,Se._)`${a}(${f})`}me.callValidateCode=tE;var rE=(0,Se._)`new RegExp`;function nE({gen:t,it:{opts:e}},r){let n=e.unicodeRegExp?"u":"",{regExp:s}=e.code,o=s(r,n);return t.scopeValue("pattern",{key:o.toString(),ref:o,code:(0,Se._)`${s.code==="new RegExp"?rE:(0,WT.useFunc)(t,s)}(${r}, ${n})`})}me.usePattern=nE;function sE(t){let{gen:e,data:r,keyword:n,it:s}=t,o=e.name("valid");if(s.allErrors){let a=e.let("valid",!0);return i(()=>e.assign(a,!1)),a}return e.var(o,!0),i(()=>e.break()),o;function i(a){let c=e.const("len",(0,Se._)`${r}.length`);e.forRange("i",0,c,u=>{t.subschema({keyword:n,dataProp:u,dataPropType:Sl.Type.Num},o),e.if((0,Se.not)(o),a)})}}me.validateArray=sE;function oE(t){let{gen:e,schema:r,keyword:n,it:s}=t;if(!Array.isArray(r))throw new Error("ajv implementation error");if(r.some(c=>(0,Sl.alwaysValidSchema)(s,c))&&!s.opts.unevaluated)return;let i=e.let("valid",!1),a=e.name("_valid");e.block(()=>r.forEach((c,u)=>{let l=t.subschema({keyword:n,schemaProp:u,compositeRule:!0},a);e.assign(i,(0,Se._)`${i} || ${a}`),t.mergeValidEvaluated(l,a)||e.if((0,Se.not)(i))})),t.result(i,()=>t.reset(),()=>t.error(!0))}me.validateUnion=oE});var sv=v(Qt=>{"use strict";Object.defineProperty(Qt,"__esModule",{value:!0});Qt.validateKeywordUsage=Qt.validSchemaType=Qt.funcKeywordCode=Qt.macroKeywordCode=void 0;var nt=Y(),Sn=yr(),iE=kt(),aE=vo();function cE(t,e){let{gen:r,keyword:n,schema:s,parentSchema:o,it:i}=t,a=e.macro.call(i.self,s,o,i),c=nv(r,n,a);i.opts.validateSchema!==!1&&i.self.validateSchema(a,!0);let u=r.name("valid");t.subschema({schema:a,schemaPath:nt.nil,errSchemaPath:`${i.errSchemaPath}/${n}`,topSchemaRef:c,compositeRule:!0},u),t.pass(u,()=>t.error(!0))}Qt.macroKeywordCode=cE;function uE(t,e){var r;let{gen:n,keyword:s,schema:o,parentSchema:i,$data:a,it:c}=t;dE(c,e);let u=!a&&e.compile?e.compile.call(c.self,o,i,c):e.validate,l=nv(n,s,u),d=n.let("valid");t.block$data(d,f),t.ok((r=e.valid)!==null&&r!==void 0?r:d);function f(){if(e.errors===!1)h(),e.modifying&&rv(t),g(()=>t.error());else{let y=e.async?p():m();e.modifying&&rv(t),g(()=>lE(t,y))}}function p(){let y=n.let("ruleErrs",null);return n.try(()=>h((0,nt._)`await `),$=>n.assign(d,!1).if((0,nt._)`${$} instanceof ${c.ValidationError}`,()=>n.assign(y,(0,nt._)`${$}.errors`),()=>n.throw($))),y}function m(){let y=(0,nt._)`${l}.errors`;return n.assign(y,null),h(nt.nil),y}function h(y=e.async?(0,nt._)`await `:nt.nil){let $=c.opts.passContext?Sn.default.this:Sn.default.self,w=!("compile"in e&&!a||e.schema===!1);n.assign(d,(0,nt._)`${y}${(0,iE.callValidateCode)(t,l,$,w)}`,e.modifying)}function g(y){var $;n.if((0,nt.not)(($=e.valid)!==null&&$!==void 0?$:d),y)}}Qt.funcKeywordCode=uE;function rv(t){let{gen:e,data:r,it:n}=t;e.if(n.parentData,()=>e.assign(r,(0,nt._)`${n.parentData}[${n.parentDataProperty}]`))}function lE(t,e){let{gen:r}=t;r.if((0,nt._)`Array.isArray(${e})`,()=>{r.assign(Sn.default.vErrors,(0,nt._)`${Sn.default.vErrors} === null ? ${e} : ${Sn.default.vErrors}.concat(${e})`).assign(Sn.default.errors,(0,nt._)`${Sn.default.vErrors}.length`),(0,aE.extendErrors)(t)},()=>t.error())}function dE({schemaEnv:t},e){if(e.async&&!t.$async)throw new Error("async keyword in sync schema")}function nv(t,e,r){if(r===void 0)throw new Error(`keyword "${e}" failed to compile`);return t.scopeValue("keyword",typeof r=="function"?{ref:r}:{ref:r,code:(0,nt.stringify)(r)})}function pE(t,e,r=!1){return!e.length||e.some(n=>n==="array"?Array.isArray(t):n==="object"?t&&typeof t=="object"&&!Array.isArray(t):typeof t==n||r&&typeof t>"u")}Qt.validSchemaType=pE;function fE({schema:t,opts:e,self:r,errSchemaPath:n},s,o){if(Array.isArray(s.keyword)?!s.keyword.includes(o):s.keyword!==o)throw new Error("ajv implementation error");let i=s.dependencies;if(i?.some(a=>!Object.prototype.hasOwnProperty.call(t,a)))throw new Error(`parent schema must have dependencies of ${o}: ${i.join(",")}`);if(s.validateSchema&&!s.validateSchema(t[o])){let c=`keyword "${o}" value is invalid at path "${n}": `+r.errorsText(s.validateSchema.errors);if(e.validateSchema==="log")r.logger.error(c);else throw new Error(c)}}Qt.validateKeywordUsage=fE});var iv=v(Ar=>{"use strict";Object.defineProperty(Ar,"__esModule",{value:!0});Ar.extendSubschemaMode=Ar.extendSubschemaData=Ar.getSubschema=void 0;var Xt=Y(),ov=ce();function mE(t,{keyword:e,schemaProp:r,schema:n,schemaPath:s,errSchemaPath:o,topSchemaRef:i}){if(e!==void 0&&n!==void 0)throw new Error('both "keyword" and "schema" passed, only one allowed');if(e!==void 0){let a=t.schema[e];return r===void 0?{schema:a,schemaPath:(0,Xt._)`${t.schemaPath}${(0,Xt.getProperty)(e)}`,errSchemaPath:`${t.errSchemaPath}/${e}`}:{schema:a[r],schemaPath:(0,Xt._)`${t.schemaPath}${(0,Xt.getProperty)(e)}${(0,Xt.getProperty)(r)}`,errSchemaPath:`${t.errSchemaPath}/${e}/${(0,ov.escapeFragment)(r)}`}}if(n!==void 0){if(s===void 0||o===void 0||i===void 0)throw new Error('"schemaPath", "errSchemaPath" and "topSchemaRef" are required with "schema"');return{schema:n,schemaPath:s,topSchemaRef:i,errSchemaPath:o}}throw new Error('either "keyword" or "schema" must be passed')}Ar.getSubschema=mE;function hE(t,e,{dataProp:r,dataPropType:n,data:s,dataTypes:o,propertyName:i}){if(s!==void 0&&r!==void 0)throw new Error('both "data" and "dataProp" passed, only one allowed');let{gen:a}=e;if(r!==void 0){let{errorPath:u,dataPathArr:l,opts:d}=e,f=a.let("data",(0,Xt._)`${e.data}${(0,Xt.getProperty)(r)}`,!0);c(f),t.errorPath=(0,Xt.str)`${u}${(0,ov.getErrorPath)(r,n,d.jsPropertySyntax)}`,t.parentDataProperty=(0,Xt._)`${r}`,t.dataPathArr=[...l,t.parentDataProperty]}if(s!==void 0){let u=s instanceof Xt.Name?s:a.let("data",s,!0);c(u),i!==void 0&&(t.propertyName=i)}o&&(t.dataTypes=o);function c(u){t.data=u,t.dataLevel=e.dataLevel+1,t.dataTypes=[],e.definedProperties=new Set,t.parentData=e.data,t.dataNames=[...e.dataNames,u]}}Ar.extendSubschemaData=hE;function gE(t,{jtdDiscriminator:e,jtdMetadata:r,compositeRule:n,createErrors:s,allErrors:o}){n!==void 0&&(t.compositeRule=n),s!==void 0&&(t.createErrors=s),o!==void 0&&(t.allErrors=o),t.jtdDiscriminator=e,t.jtdMetadata=r}Ar.extendSubschemaMode=gE});var bo=v((_2,av)=>{"use strict";av.exports=function t(e,r){if(e===r)return!0;if(e&&r&&typeof e=="object"&&typeof r=="object"){if(e.constructor!==r.constructor)return!1;var n,s,o;if(Array.isArray(e)){if(n=e.length,n!=r.length)return!1;for(s=n;s--!==0;)if(!t(e[s],r[s]))return!1;return!0}if(e.constructor===RegExp)return e.source===r.source&&e.flags===r.flags;if(e.valueOf!==Object.prototype.valueOf)return e.valueOf()===r.valueOf();if(e.toString!==Object.prototype.toString)return e.toString()===r.toString();if(o=Object.keys(e),n=o.length,n!==Object.keys(r).length)return!1;for(s=n;s--!==0;)if(!Object.prototype.hasOwnProperty.call(r,o[s]))return!1;for(s=n;s--!==0;){var i=o[s];if(!t(e[i],r[i]))return!1}return!0}return e!==e&&r!==r}});var uv=v((b2,cv)=>{"use strict";var Mr=cv.exports=function(t,e,r){typeof e=="function"&&(r=e,e={}),r=e.cb||r;var n=typeof r=="function"?r:r.pre||function(){},s=r.post||function(){};ya(e,n,s,t,"",t)};Mr.keywords={additionalItems:!0,items:!0,contains:!0,additionalProperties:!0,propertyNames:!0,not:!0,if:!0,then:!0,else:!0};Mr.arrayKeywords={items:!0,allOf:!0,anyOf:!0,oneOf:!0};Mr.propsKeywords={$defs:!0,definitions:!0,properties:!0,patternProperties:!0,dependencies:!0};Mr.skipKeywords={default:!0,enum:!0,const:!0,required:!0,maximum:!0,minimum:!0,exclusiveMaximum:!0,exclusiveMinimum:!0,multipleOf:!0,maxLength:!0,minLength:!0,pattern:!0,format:!0,maxItems:!0,minItems:!0,uniqueItems:!0,maxProperties:!0,minProperties:!0};function ya(t,e,r,n,s,o,i,a,c,u){if(n&&typeof n=="object"&&!Array.isArray(n)){e(n,s,o,i,a,c,u);for(var l in n){var d=n[l];if(Array.isArray(d)){if(l in Mr.arrayKeywords)for(var f=0;f<d.length;f++)ya(t,e,r,d[f],s+"/"+l+"/"+f,o,s,l,n,f)}else if(l in Mr.propsKeywords){if(d&&typeof d=="object")for(var p in d)ya(t,e,r,d[p],s+"/"+l+"/"+yE(p),o,s,l,n,p)}else(l in Mr.keywords||t.allKeys&&!(l in Mr.skipKeywords))&&ya(t,e,r,d,s+"/"+l,o,s,l,n)}r(n,s,o,i,a,c,u)}}function yE(t){return t.replace(/~/g,"~0").replace(/\//g,"~1")}});var wo=v(dt=>{"use strict";Object.defineProperty(dt,"__esModule",{value:!0});dt.getSchemaRefs=dt.resolveUrl=dt.normalizeId=dt._getFullPath=dt.getFullPath=dt.inlineRef=void 0;var vE=ce(),_E=bo(),bE=uv(),wE=new Set(["type","format","pattern","maxLength","minLength","maxProperties","minProperties","maxItems","minItems","maximum","minimum","uniqueItems","multipleOf","required","enum","const"]);function $E(t,e=!0){return typeof t=="boolean"?!0:e===!0?!El(t):e?lv(t)<=e:!1}dt.inlineRef=$E;var xE=new Set(["$ref","$recursiveRef","$recursiveAnchor","$dynamicRef","$dynamicAnchor"]);function El(t){for(let e in t){if(xE.has(e))return!0;let r=t[e];if(Array.isArray(r)&&r.some(El)||typeof r=="object"&&El(r))return!0}return!1}function lv(t){let e=0;for(let r in t){if(r==="$ref")return 1/0;if(e++,!wE.has(r)&&(typeof t[r]=="object"&&(0,vE.eachItem)(t[r],n=>e+=lv(n)),e===1/0))return 1/0}return e}function dv(t,e="",r){r!==!1&&(e=us(e));let n=t.parse(e);return pv(t,n)}dt.getFullPath=dv;function pv(t,e){return t.serialize(e).split("#")[0]+"#"}dt._getFullPath=pv;var kE=/#\/?$/;function us(t){return t?t.replace(kE,""):""}dt.normalizeId=us;function SE(t,e,r){return r=us(r),t.resolve(e,r)}dt.resolveUrl=SE;var PE=/^[a-z_][-a-z0-9._]*$/i;function TE(t,e){if(typeof t=="boolean")return{};let{schemaId:r,uriResolver:n}=this.opts,s=us(t[r]||e),o={"":s},i=dv(n,s,!1),a={},c=new Set;return bE(t,{allKeys:!0},(d,f,p,m)=>{if(m===void 0)return;let h=i+f,g=o[m];typeof d[r]=="string"&&(g=y.call(this,d[r])),$.call(this,d.$anchor),$.call(this,d.$dynamicAnchor),o[f]=g;function y(w){let S=this.opts.uriResolver.resolve;if(w=us(g?S(g,w):w),c.has(w))throw l(w);c.add(w);let x=this.refs[w];return typeof x=="string"&&(x=this.refs[x]),typeof x=="object"?u(d,x.schema,w):w!==us(h)&&(w[0]==="#"?(u(d,a[w],w),a[w]=d):this.refs[w]=h),w}function $(w){if(typeof w=="string"){if(!PE.test(w))throw new Error(`invalid anchor "${w}"`);y.call(this,`#${w}`)}}}),a;function u(d,f,p){if(f!==void 0&&!_E(d,f))throw l(p)}function l(d){return new Error(`reference "${d}" resolves to more than one schema`)}}dt.getSchemaRefs=TE});var ko=v(qr=>{"use strict";Object.defineProperty(qr,"__esModule",{value:!0});qr.getData=qr.KeywordCxt=qr.validateFunctionCode=void 0;var yv=Ky(),fv=_o(),Cl=wl(),va=_o(),EE=Xy(),xo=sv(),zl=iv(),N=Y(),L=yr(),zE=wo(),vr=ce(),$o=vo();function CE(t){if(bv(t)&&(wv(t),_v(t))){OE(t);return}vv(t,()=>(0,yv.topBoolOrEmptySchema)(t))}qr.validateFunctionCode=CE;function vv({gen:t,validateName:e,schema:r,schemaEnv:n,opts:s},o){s.code.es5?t.func(e,(0,N._)`${L.default.data}, ${L.default.valCxt}`,n.$async,()=>{t.code((0,N._)`"use strict"; ${mv(r,s)}`),RE(t,s),t.code(o)}):t.func(e,(0,N._)`${L.default.data}, ${IE(s)}`,n.$async,()=>t.code(mv(r,s)).code(o))}function IE(t){return(0,N._)`{${L.default.instancePath}="", ${L.default.parentData}, ${L.default.parentDataProperty}, ${L.default.rootData}=${L.default.data}${t.dynamicRef?(0,N._)`, ${L.default.dynamicAnchors}={}`:N.nil}}={}`}function RE(t,e){t.if(L.default.valCxt,()=>{t.var(L.default.instancePath,(0,N._)`${L.default.valCxt}.${L.default.instancePath}`),t.var(L.default.parentData,(0,N._)`${L.default.valCxt}.${L.default.parentData}`),t.var(L.default.parentDataProperty,(0,N._)`${L.default.valCxt}.${L.default.parentDataProperty}`),t.var(L.default.rootData,(0,N._)`${L.default.valCxt}.${L.default.rootData}`),e.dynamicRef&&t.var(L.default.dynamicAnchors,(0,N._)`${L.default.valCxt}.${L.default.dynamicAnchors}`)},()=>{t.var(L.default.instancePath,(0,N._)`""`),t.var(L.default.parentData,(0,N._)`undefined`),t.var(L.default.parentDataProperty,(0,N._)`undefined`),t.var(L.default.rootData,L.default.data),e.dynamicRef&&t.var(L.default.dynamicAnchors,(0,N._)`{}`)})}function OE(t){let{schema:e,opts:r,gen:n}=t;vv(t,()=>{r.$comment&&e.$comment&&xv(t),qE(t),n.let(L.default.vErrors,null),n.let(L.default.errors,0),r.unevaluated&&NE(t),$v(t),LE(t)})}function NE(t){let{gen:e,validateName:r}=t;t.evaluated=e.const("evaluated",(0,N._)`${r}.evaluated`),e.if((0,N._)`${t.evaluated}.dynamicProps`,()=>e.assign((0,N._)`${t.evaluated}.props`,(0,N._)`undefined`)),e.if((0,N._)`${t.evaluated}.dynamicItems`,()=>e.assign((0,N._)`${t.evaluated}.items`,(0,N._)`undefined`))}function mv(t,e){let r=typeof t=="object"&&t[e.schemaId];return r&&(e.code.source||e.code.process)?(0,N._)`/*# sourceURL=${r} */`:N.nil}function jE(t,e){if(bv(t)&&(wv(t),_v(t))){AE(t,e);return}(0,yv.boolOrEmptySchema)(t,e)}function _v({schema:t,self:e}){if(typeof t=="boolean")return!t;for(let r in t)if(e.RULES.all[r])return!0;return!1}function bv(t){return typeof t.schema!="boolean"}function AE(t,e){let{schema:r,gen:n,opts:s}=t;s.$comment&&r.$comment&&xv(t),DE(t),ZE(t);let o=n.const("_errs",L.default.errors);$v(t,o),n.var(e,(0,N._)`${o} === ${L.default.errors}`)}function wv(t){(0,vr.checkUnknownRules)(t),ME(t)}function $v(t,e){if(t.opts.jtd)return hv(t,[],!1,e);let r=(0,fv.getSchemaTypes)(t.schema),n=(0,fv.coerceAndCheckDataType)(t,r);hv(t,r,!n,e)}function ME(t){let{schema:e,errSchemaPath:r,opts:n,self:s}=t;e.$ref&&n.ignoreKeywordsWithRef&&(0,vr.schemaHasRulesButRef)(e,s.RULES)&&s.logger.warn(`$ref: keywords ignored in schema at path "${r}"`)}function qE(t){let{schema:e,opts:r}=t;e.default!==void 0&&r.useDefaults&&r.strictSchema&&(0,vr.checkStrictMode)(t,"default is ignored in the schema root")}function DE(t){let e=t.schema[t.opts.schemaId];e&&(t.baseId=(0,zE.resolveUrl)(t.opts.uriResolver,t.baseId,e))}function ZE(t){if(t.schema.$async&&!t.schemaEnv.$async)throw new Error("async schema in sync schema")}function xv({gen:t,schemaEnv:e,schema:r,errSchemaPath:n,opts:s}){let o=r.$comment;if(s.$comment===!0)t.code((0,N._)`${L.default.self}.logger.log(${o})`);else if(typeof s.$comment=="function"){let i=(0,N.str)`${n}/$comment`,a=t.scopeValue("root",{ref:e.root});t.code((0,N._)`${L.default.self}.opts.$comment(${o}, ${i}, ${a}.schema)`)}}function LE(t){let{gen:e,schemaEnv:r,validateName:n,ValidationError:s,opts:o}=t;r.$async?e.if((0,N._)`${L.default.errors} === 0`,()=>e.return(L.default.data),()=>e.throw((0,N._)`new ${s}(${L.default.vErrors})`)):(e.assign((0,N._)`${n}.errors`,L.default.vErrors),o.unevaluated&&VE(t),e.return((0,N._)`${L.default.errors} === 0`))}function VE({gen:t,evaluated:e,props:r,items:n}){r instanceof N.Name&&t.assign((0,N._)`${e}.props`,r),n instanceof N.Name&&t.assign((0,N._)`${e}.items`,n)}function hv(t,e,r,n){let{gen:s,schema:o,data:i,allErrors:a,opts:c,self:u}=t,{RULES:l}=u;if(o.$ref&&(c.ignoreKeywordsWithRef||!(0,vr.schemaHasRulesButRef)(o,l))){s.block(()=>Sv(t,"$ref",l.all.$ref.definition));return}c.jtd||FE(t,e),s.block(()=>{for(let f of l.rules)d(f);d(l.post)});function d(f){(0,Cl.shouldUseGroup)(o,f)&&(f.type?(s.if((0,va.checkDataType)(f.type,i,c.strictNumbers)),gv(t,f),e.length===1&&e[0]===f.type&&r&&(s.else(),(0,va.reportTypeError)(t)),s.endIf()):gv(t,f),a||s.if((0,N._)`${L.default.errors} === ${n||0}`))}}function gv(t,e){let{gen:r,schema:n,opts:{useDefaults:s}}=t;s&&(0,EE.assignDefaults)(t,e.type),r.block(()=>{for(let o of e.rules)(0,Cl.shouldUseRule)(n,o)&&Sv(t,o.keyword,o.definition,e.type)})}function FE(t,e){t.schemaEnv.meta||!t.opts.strictTypes||(UE(t,e),t.opts.allowUnionTypes||HE(t,e),KE(t,t.dataTypes))}function UE(t,e){if(e.length){if(!t.dataTypes.length){t.dataTypes=e;return}e.forEach(r=>{kv(t.dataTypes,r)||Il(t,`type "${r}" not allowed by context "${t.dataTypes.join(",")}"`)}),GE(t,e)}}function HE(t,e){e.length>1&&!(e.length===2&&e.includes("null"))&&Il(t,"use allowUnionTypes to allow union type keyword")}function KE(t,e){let r=t.self.RULES.all;for(let n in r){let s=r[n];if(typeof s=="object"&&(0,Cl.shouldUseRule)(t.schema,s)){let{type:o}=s.definition;o.length&&!o.some(i=>BE(e,i))&&Il(t,`missing type "${o.join(",")}" for keyword "${n}"`)}}}function BE(t,e){return t.includes(e)||e==="number"&&t.includes("integer")}function kv(t,e){return t.includes(e)||e==="integer"&&t.includes("number")}function GE(t,e){let r=[];for(let n of t.dataTypes)kv(e,n)?r.push(n):e.includes("integer")&&n==="number"&&r.push("integer");t.dataTypes=r}function Il(t,e){let r=t.schemaEnv.baseId+t.errSchemaPath;e+=` at "${r}" (strictTypes)`,(0,vr.checkStrictMode)(t,e,t.opts.strictTypes)}var _a=class{constructor(e,r,n){if((0,xo.validateKeywordUsage)(e,r,n),this.gen=e.gen,this.allErrors=e.allErrors,this.keyword=n,this.data=e.data,this.schema=e.schema[n],this.$data=r.$data&&e.opts.$data&&this.schema&&this.schema.$data,this.schemaValue=(0,vr.schemaRefOrVal)(e,this.schema,n,this.$data),this.schemaType=r.schemaType,this.parentSchema=e.schema,this.params={},this.it=e,this.def=r,this.$data)this.schemaCode=e.gen.const("vSchema",Pv(this.$data,e));else if(this.schemaCode=this.schemaValue,!(0,xo.validSchemaType)(this.schema,r.schemaType,r.allowUndefined))throw new Error(`${n} value must be ${JSON.stringify(r.schemaType)}`);("code"in r?r.trackErrors:r.errors!==!1)&&(this.errsCount=e.gen.const("_errs",L.default.errors))}result(e,r,n){this.failResult((0,N.not)(e),r,n)}failResult(e,r,n){this.gen.if(e),n?n():this.error(),r?(this.gen.else(),r(),this.allErrors&&this.gen.endIf()):this.allErrors?this.gen.endIf():this.gen.else()}pass(e,r){this.failResult((0,N.not)(e),void 0,r)}fail(e){if(e===void 0){this.error(),this.allErrors||this.gen.if(!1);return}this.gen.if(e),this.error(),this.allErrors?this.gen.endIf():this.gen.else()}fail$data(e){if(!this.$data)return this.fail(e);let{schemaCode:r}=this;this.fail((0,N._)`${r} !== undefined && (${(0,N.or)(this.invalid$data(),e)})`)}error(e,r,n){if(r){this.setParams(r),this._error(e,n),this.setParams({});return}this._error(e,n)}_error(e,r){(e?$o.reportExtraError:$o.reportError)(this,this.def.error,r)}$dataError(){(0,$o.reportError)(this,this.def.$dataError||$o.keyword$DataError)}reset(){if(this.errsCount===void 0)throw new Error('add "trackErrors" to keyword definition');(0,$o.resetErrorsCount)(this.gen,this.errsCount)}ok(e){this.allErrors||this.gen.if(e)}setParams(e,r){r?Object.assign(this.params,e):this.params=e}block$data(e,r,n=N.nil){this.gen.block(()=>{this.check$data(e,n),r()})}check$data(e=N.nil,r=N.nil){if(!this.$data)return;let{gen:n,schemaCode:s,schemaType:o,def:i}=this;n.if((0,N.or)((0,N._)`${s} === undefined`,r)),e!==N.nil&&n.assign(e,!0),(o.length||i.validateSchema)&&(n.elseIf(this.invalid$data()),this.$dataError(),e!==N.nil&&n.assign(e,!1)),n.else()}invalid$data(){let{gen:e,schemaCode:r,schemaType:n,def:s,it:o}=this;return(0,N.or)(i(),a());function i(){if(n.length){if(!(r instanceof N.Name))throw new Error("ajv implementation error");let c=Array.isArray(n)?n:[n];return(0,N._)`${(0,va.checkDataTypes)(c,r,o.opts.strictNumbers,va.DataType.Wrong)}`}return N.nil}function a(){if(s.validateSchema){let c=e.scopeValue("validate$data",{ref:s.validateSchema});return(0,N._)`!${c}(${r})`}return N.nil}}subschema(e,r){let n=(0,zl.getSubschema)(this.it,e);(0,zl.extendSubschemaData)(n,this.it,e),(0,zl.extendSubschemaMode)(n,e);let s={...this.it,...n,items:void 0,props:void 0};return jE(s,r),s}mergeEvaluated(e,r){let{it:n,gen:s}=this;n.opts.unevaluated&&(n.props!==!0&&e.props!==void 0&&(n.props=vr.mergeEvaluated.props(s,e.props,n.props,r)),n.items!==!0&&e.items!==void 0&&(n.items=vr.mergeEvaluated.items(s,e.items,n.items,r)))}mergeValidEvaluated(e,r){let{it:n,gen:s}=this;if(n.opts.unevaluated&&(n.props!==!0||n.items!==!0))return s.if(r,()=>this.mergeEvaluated(e,N.Name)),!0}};qr.KeywordCxt=_a;function Sv(t,e,r,n){let s=new _a(t,r,e);"code"in r?r.code(s,n):s.$data&&r.validate?(0,xo.funcKeywordCode)(s,r):"macro"in r?(0,xo.macroKeywordCode)(s,r):(r.compile||r.validate)&&(0,xo.funcKeywordCode)(s,r)}var WE=/^\/(?:[^~]|~0|~1)*$/,JE=/^([0-9]+)(#|\/(?:[^~]|~0|~1)*)?$/;function Pv(t,{dataLevel:e,dataNames:r,dataPathArr:n}){let s,o;if(t==="")return L.default.rootData;if(t[0]==="/"){if(!WE.test(t))throw new Error(`Invalid JSON-pointer: ${t}`);s=t,o=L.default.rootData}else{let u=JE.exec(t);if(!u)throw new Error(`Invalid JSON-pointer: ${t}`);let l=+u[1];if(s=u[2],s==="#"){if(l>=e)throw new Error(c("property/index",l));return n[e-l]}if(l>e)throw new Error(c("data",l));if(o=r[e-l],!s)return o}let i=o,a=s.split("/");for(let u of a)u&&(o=(0,N._)`${o}${(0,N.getProperty)((0,vr.unescapeJsonPointer)(u))}`,i=(0,N._)`${i} && ${o}`);return i;function c(u,l){return`Cannot access ${u} ${l} levels up, current level is ${e}`}}qr.getData=Pv});var ba=v(Ol=>{"use strict";Object.defineProperty(Ol,"__esModule",{value:!0});var Rl=class extends Error{constructor(e){super("validation failed"),this.errors=e,this.ajv=this.validation=!0}};Ol.default=Rl});var So=v(Al=>{"use strict";Object.defineProperty(Al,"__esModule",{value:!0});var Nl=wo(),jl=class extends Error{constructor(e,r,n,s){super(s||`can't resolve reference ${n} from id ${r}`),this.missingRef=(0,Nl.resolveUrl)(e,r,n),this.missingSchema=(0,Nl.normalizeId)((0,Nl.getFullPath)(e,this.missingRef))}};Al.default=jl});var $a=v(St=>{"use strict";Object.defineProperty(St,"__esModule",{value:!0});St.resolveSchema=St.getCompilingSchema=St.resolveRef=St.compileSchema=St.SchemaEnv=void 0;var jt=Y(),YE=ba(),Pn=yr(),At=wo(),Tv=ce(),QE=ko(),ls=class{constructor(e){var r;this.refs={},this.dynamicAnchors={};let n;typeof e.schema=="object"&&(n=e.schema),this.schema=e.schema,this.schemaId=e.schemaId,this.root=e.root||this,this.baseId=(r=e.baseId)!==null&&r!==void 0?r:(0,At.normalizeId)(n?.[e.schemaId||"$id"]),this.schemaPath=e.schemaPath,this.localRefs=e.localRefs,this.meta=e.meta,this.$async=n?.$async,this.refs={}}};St.SchemaEnv=ls;function ql(t){let e=Ev.call(this,t);if(e)return e;let r=(0,At.getFullPath)(this.opts.uriResolver,t.root.baseId),{es5:n,lines:s}=this.opts.code,{ownProperties:o}=this.opts,i=new jt.CodeGen(this.scope,{es5:n,lines:s,ownProperties:o}),a;t.$async&&(a=i.scopeValue("Error",{ref:YE.default,code:(0,jt._)`require("ajv/dist/runtime/validation_error").default`}));let c=i.scopeName("validate");t.validateName=c;let u={gen:i,allErrors:this.opts.allErrors,data:Pn.default.data,parentData:Pn.default.parentData,parentDataProperty:Pn.default.parentDataProperty,dataNames:[Pn.default.data],dataPathArr:[jt.nil],dataLevel:0,dataTypes:[],definedProperties:new Set,topSchemaRef:i.scopeValue("schema",this.opts.code.source===!0?{ref:t.schema,code:(0,jt.stringify)(t.schema)}:{ref:t.schema}),validateName:c,ValidationError:a,schema:t.schema,schemaEnv:t,rootId:r,baseId:t.baseId||r,schemaPath:jt.nil,errSchemaPath:t.schemaPath||(this.opts.jtd?"":"#"),errorPath:(0,jt._)`""`,opts:this.opts,self:this},l;try{this._compilations.add(t),(0,QE.validateFunctionCode)(u),i.optimize(this.opts.code.optimize);let d=i.toString();l=`${i.scopeRefs(Pn.default.scope)}return ${d}`,this.opts.code.process&&(l=this.opts.code.process(l,t));let p=new Function(`${Pn.default.self}`,`${Pn.default.scope}`,l)(this,this.scope.get());if(this.scope.value(c,{ref:p}),p.errors=null,p.schema=t.schema,p.schemaEnv=t,t.$async&&(p.$async=!0),this.opts.code.source===!0&&(p.source={validateName:c,validateCode:d,scopeValues:i._values}),this.opts.unevaluated){let{props:m,items:h}=u;p.evaluated={props:m instanceof jt.Name?void 0:m,items:h instanceof jt.Name?void 0:h,dynamicProps:m instanceof jt.Name,dynamicItems:h instanceof jt.Name},p.source&&(p.source.evaluated=(0,jt.stringify)(p.evaluated))}return t.validate=p,t}catch(d){throw delete t.validate,delete t.validateName,l&&this.logger.error("Error compiling schema, function code:",l),d}finally{this._compilations.delete(t)}}St.compileSchema=ql;function XE(t,e,r){var n;r=(0,At.resolveUrl)(this.opts.uriResolver,e,r);let s=t.refs[r];if(s)return s;let o=rz.call(this,t,r);if(o===void 0){let i=(n=t.localRefs)===null||n===void 0?void 0:n[r],{schemaId:a}=this.opts;i&&(o=new ls({schema:i,schemaId:a,root:t,baseId:e}))}if(o!==void 0)return t.refs[r]=ez.call(this,o)}St.resolveRef=XE;function ez(t){return(0,At.inlineRef)(t.schema,this.opts.inlineRefs)?t.schema:t.validate?t:ql.call(this,t)}function Ev(t){for(let e of this._compilations)if(tz(e,t))return e}St.getCompilingSchema=Ev;function tz(t,e){return t.schema===e.schema&&t.root===e.root&&t.baseId===e.baseId}function rz(t,e){let r;for(;typeof(r=this.refs[e])=="string";)e=r;return r||this.schemas[e]||wa.call(this,t,e)}function wa(t,e){let r=this.opts.uriResolver.parse(e),n=(0,At._getFullPath)(this.opts.uriResolver,r),s=(0,At.getFullPath)(this.opts.uriResolver,t.baseId,void 0);if(Object.keys(t.schema).length>0&&n===s)return Ml.call(this,r,t);let o=(0,At.normalizeId)(n),i=this.refs[o]||this.schemas[o];if(typeof i=="string"){let a=wa.call(this,t,i);return typeof a?.schema!="object"?void 0:Ml.call(this,r,a)}if(typeof i?.schema=="object"){if(i.validate||ql.call(this,i),o===(0,At.normalizeId)(e)){let{schema:a}=i,{schemaId:c}=this.opts,u=a[c];return u&&(s=(0,At.resolveUrl)(this.opts.uriResolver,s,u)),new ls({schema:a,schemaId:c,root:t,baseId:s})}return Ml.call(this,r,i)}}St.resolveSchema=wa;var nz=new Set(["properties","patternProperties","enum","dependencies","definitions"]);function Ml(t,{baseId:e,schema:r,root:n}){var s;if(((s=t.fragment)===null||s===void 0?void 0:s[0])!=="/")return;for(let a of t.fragment.slice(1).split("/")){if(typeof r=="boolean")return;let c=r[(0,Tv.unescapeFragment)(a)];if(c===void 0)return;r=c;let u=typeof r=="object"&&r[this.opts.schemaId];!nz.has(a)&&u&&(e=(0,At.resolveUrl)(this.opts.uriResolver,e,u))}let o;if(typeof r!="boolean"&&r.$ref&&!(0,Tv.schemaHasRulesButRef)(r,this.RULES)){let a=(0,At.resolveUrl)(this.opts.uriResolver,e,r.$ref);o=wa.call(this,n,a)}let{schemaId:i}=this.opts;if(o=o||new ls({schema:r,schemaId:i,root:n,baseId:e}),o.schema!==o.root.schema)return o}});var zv=v((P2,sz)=>{sz.exports={$id:"https://raw.githubusercontent.com/ajv-validator/ajv/master/lib/refs/data.json#",description:"Meta-schema for $data reference (JSON AnySchema extension proposal)",type:"object",required:["$data"],properties:{$data:{type:"string",anyOf:[{format:"relative-json-pointer"},{format:"json-pointer"}]}},additionalProperties:!1}});var Zl=v((T2,Ov)=>{"use strict";var oz=RegExp.prototype.test.bind(/^[\da-f]{8}-[\da-f]{4}-[\da-f]{4}-[\da-f]{4}-[\da-f]{12}$/iu),Iv=RegExp.prototype.test.bind(/^(?:(?:25[0-5]|2[0-4]\d|1\d{2}|[1-9]\d|\d)\.){3}(?:25[0-5]|2[0-4]\d|1\d{2}|[1-9]\d|\d)$/u);function Dl(t){let e="",r=0,n=0;for(n=0;n<t.length;n++)if(r=t[n].charCodeAt(0),r!==48){if(!(r>=48&&r<=57||r>=65&&r<=70||r>=97&&r<=102))return"";e+=t[n];break}for(n+=1;n<t.length;n++){if(r=t[n].charCodeAt(0),!(r>=48&&r<=57||r>=65&&r<=70||r>=97&&r<=102))return"";e+=t[n]}return e}var iz=RegExp.prototype.test.bind(/[^!"$&'()*+,\-.;=_`a-z{}~]/u);function Cv(t){return t.length=0,!0}function az(t,e,r){if(t.length){let n=Dl(t);if(n!=="")e.push(n);else return r.error=!0,!1;t.length=0}return!0}function cz(t){let e=0,r={error:!1,address:"",zone:""},n=[],s=[],o=!1,i=!1,a=az;for(let c=0;c<t.length;c++){let u=t[c];if(!(u==="["||u==="]"))if(u===":"){if(o===!0&&(i=!0),!a(s,n,r))break;if(++e>7){r.error=!0;break}c>0&&t[c-1]===":"&&(o=!0),n.push(":");continue}else if(u==="%"){if(!a(s,n,r))break;a=Cv}else{s.push(u);continue}}return s.length&&(a===Cv?r.zone=s.join(""):i?n.push(s.join("")):n.push(Dl(s))),r.address=n.join(""),r}function Rv(t){if(uz(t,":")<2)return{host:t,isIPV6:!1};let e=cz(t);if(e.error)return{host:t,isIPV6:!1};{let r=e.address,n=e.address;return e.zone&&(r+="%"+e.zone,n+="%25"+e.zone),{host:r,isIPV6:!0,escapedHost:n}}}function uz(t,e){let r=0;for(let n=0;n<t.length;n++)t[n]===e&&r++;return r}function lz(t){let e=t,r=[],n=-1,s=0;for(;s=e.length;){if(s===1){if(e===".")break;if(e==="/"){r.push("/");break}else{r.push(e);break}}else if(s===2){if(e[0]==="."){if(e[1]===".")break;if(e[1]==="/"){e=e.slice(2);continue}}else if(e[0]==="/"&&(e[1]==="."||e[1]==="/")){r.push("/");break}}else if(s===3&&e==="/.."){r.length!==0&&r.pop(),r.push("/");break}if(e[0]==="."){if(e[1]==="."){if(e[2]==="/"){e=e.slice(3);continue}}else if(e[1]==="/"){e=e.slice(2);continue}}else if(e[0]==="/"&&e[1]==="."){if(e[2]==="/"){e=e.slice(2);continue}else if(e[2]==="."&&e[3]==="/"){e=e.slice(3),r.length!==0&&r.pop();continue}}if((n=e.indexOf("/",1))===-1){r.push(e);break}else r.push(e.slice(0,n)),e=e.slice(n)}return r.join("")}function dz(t,e){let r=e!==!0?escape:unescape;return t.scheme!==void 0&&(t.scheme=r(t.scheme)),t.userinfo!==void 0&&(t.userinfo=r(t.userinfo)),t.host!==void 0&&(t.host=r(t.host)),t.path!==void 0&&(t.path=r(t.path)),t.query!==void 0&&(t.query=r(t.query)),t.fragment!==void 0&&(t.fragment=r(t.fragment)),t}function pz(t){let e=[];if(t.userinfo!==void 0&&(e.push(t.userinfo),e.push("@")),t.host!==void 0){let r=unescape(t.host);if(!Iv(r)){let n=Rv(r);n.isIPV6===!0?r=`[${n.escapedHost}]`:r=t.host}e.push(r)}return(typeof t.port=="number"||typeof t.port=="string")&&(e.push(":"),e.push(String(t.port))),e.length?e.join(""):void 0}Ov.exports={nonSimpleDomain:iz,recomposeAuthority:pz,normalizeComponentEncoding:dz,removeDotSegments:lz,isIPv4:Iv,isUUID:oz,normalizeIPv6:Rv,stringArrayToHexStripped:Dl}});var qv=v((E2,Mv)=>{"use strict";var{isUUID:fz}=Zl(),mz=/([\da-z][\d\-a-z]{0,31}):((?:[\w!$'()*+,\-.:;=@]|%[\da-f]{2})+)/iu,hz=["http","https","ws","wss","urn","urn:uuid"];function gz(t){return hz.indexOf(t)!==-1}function Ll(t){return t.secure===!0?!0:t.secure===!1?!1:t.scheme?t.scheme.length===3&&(t.scheme[0]==="w"||t.scheme[0]==="W")&&(t.scheme[1]==="s"||t.scheme[1]==="S")&&(t.scheme[2]==="s"||t.scheme[2]==="S"):!1}function Nv(t){return t.host||(t.error=t.error||"HTTP URIs must have a host."),t}function jv(t){let e=String(t.scheme).toLowerCase()==="https";return(t.port===(e?443:80)||t.port==="")&&(t.port=void 0),t.path||(t.path="/"),t}function yz(t){return t.secure=Ll(t),t.resourceName=(t.path||"/")+(t.query?"?"+t.query:""),t.path=void 0,t.query=void 0,t}function vz(t){if((t.port===(Ll(t)?443:80)||t.port==="")&&(t.port=void 0),typeof t.secure=="boolean"&&(t.scheme=t.secure?"wss":"ws",t.secure=void 0),t.resourceName){let[e,r]=t.resourceName.split("?");t.path=e&&e!=="/"?e:void 0,t.query=r,t.resourceName=void 0}return t.fragment=void 0,t}function _z(t,e){if(!t.path)return t.error="URN can not be parsed",t;let r=t.path.match(mz);if(r){let n=e.scheme||t.scheme||"urn";t.nid=r[1].toLowerCase(),t.nss=r[2];let s=`${n}:${e.nid||t.nid}`,o=Vl(s);t.path=void 0,o&&(t=o.parse(t,e))}else t.error=t.error||"URN can not be parsed.";return t}function bz(t,e){if(t.nid===void 0)throw new Error("URN without nid cannot be serialized");let r=e.scheme||t.scheme||"urn",n=t.nid.toLowerCase(),s=`${r}:${e.nid||n}`,o=Vl(s);o&&(t=o.serialize(t,e));let i=t,a=t.nss;return i.path=`${n||e.nid}:${a}`,e.skipEscape=!0,i}function wz(t,e){let r=t;return r.uuid=r.nss,r.nss=void 0,!e.tolerant&&(!r.uuid||!fz(r.uuid))&&(r.error=r.error||"UUID is not valid."),r}function $z(t){let e=t;return e.nss=(t.uuid||"").toLowerCase(),e}var Av={scheme:"http",domainHost:!0,parse:Nv,serialize:jv},xz={scheme:"https",domainHost:Av.domainHost,parse:Nv,serialize:jv},xa={scheme:"ws",domainHost:!0,parse:yz,serialize:vz},kz={scheme:"wss",domainHost:xa.domainHost,parse:xa.parse,serialize:xa.serialize},Sz={scheme:"urn",parse:_z,serialize:bz,skipNormalize:!0},Pz={scheme:"urn:uuid",parse:wz,serialize:$z,skipNormalize:!0},ka={http:Av,https:xz,ws:xa,wss:kz,urn:Sz,"urn:uuid":Pz};Object.setPrototypeOf(ka,null);function Vl(t){return t&&(ka[t]||ka[t.toLowerCase()])||void 0}Mv.exports={wsIsSecure:Ll,SCHEMES:ka,isValidSchemeName:gz,getSchemeHandler:Vl}});var Ul=v((z2,Pa)=>{"use strict";var{normalizeIPv6:Tz,removeDotSegments:Po,recomposeAuthority:Ez,normalizeComponentEncoding:Sa,isIPv4:zz,nonSimpleDomain:Cz}=Zl(),{SCHEMES:Iz,getSchemeHandler:Dv}=qv();function Rz(t,e){return typeof t=="string"?t=er(_r(t,e),e):typeof t=="object"&&(t=_r(er(t,e),e)),t}function Oz(t,e,r){let n=r?Object.assign({scheme:"null"},r):{scheme:"null"},s=Zv(_r(t,n),_r(e,n),n,!0);return n.skipEscape=!0,er(s,n)}function Zv(t,e,r,n){let s={};return n||(t=_r(er(t,r),r),e=_r(er(e,r),r)),r=r||{},!r.tolerant&&e.scheme?(s.scheme=e.scheme,s.userinfo=e.userinfo,s.host=e.host,s.port=e.port,s.path=Po(e.path||""),s.query=e.query):(e.userinfo!==void 0||e.host!==void 0||e.port!==void 0?(s.userinfo=e.userinfo,s.host=e.host,s.port=e.port,s.path=Po(e.path||""),s.query=e.query):(e.path?(e.path[0]==="/"?s.path=Po(e.path):((t.userinfo!==void 0||t.host!==void 0||t.port!==void 0)&&!t.path?s.path="/"+e.path:t.path?s.path=t.path.slice(0,t.path.lastIndexOf("/")+1)+e.path:s.path=e.path,s.path=Po(s.path)),s.query=e.query):(s.path=t.path,e.query!==void 0?s.query=e.query:s.query=t.query),s.userinfo=t.userinfo,s.host=t.host,s.port=t.port),s.scheme=t.scheme),s.fragment=e.fragment,s}function Nz(t,e,r){return typeof t=="string"?(t=unescape(t),t=er(Sa(_r(t,r),!0),{...r,skipEscape:!0})):typeof t=="object"&&(t=er(Sa(t,!0),{...r,skipEscape:!0})),typeof e=="string"?(e=unescape(e),e=er(Sa(_r(e,r),!0),{...r,skipEscape:!0})):typeof e=="object"&&(e=er(Sa(e,!0),{...r,skipEscape:!0})),t.toLowerCase()===e.toLowerCase()}function er(t,e){let r={host:t.host,scheme:t.scheme,userinfo:t.userinfo,port:t.port,path:t.path,query:t.query,nid:t.nid,nss:t.nss,uuid:t.uuid,fragment:t.fragment,reference:t.reference,resourceName:t.resourceName,secure:t.secure,error:""},n=Object.assign({},e),s=[],o=Dv(n.scheme||r.scheme);o&&o.serialize&&o.serialize(r,n),r.path!==void 0&&(n.skipEscape?r.path=unescape(r.path):(r.path=escape(r.path),r.scheme!==void 0&&(r.path=r.path.split("%3A").join(":")))),n.reference!=="suffix"&&r.scheme&&s.push(r.scheme,":");let i=Ez(r);if(i!==void 0&&(n.reference!=="suffix"&&s.push("//"),s.push(i),r.path&&r.path[0]!=="/"&&s.push("/")),r.path!==void 0){let a=r.path;!n.absolutePath&&(!o||!o.absolutePath)&&(a=Po(a)),i===void 0&&a[0]==="/"&&a[1]==="/"&&(a="/%2F"+a.slice(2)),s.push(a)}return r.query!==void 0&&s.push("?",r.query),r.fragment!==void 0&&s.push("#",r.fragment),s.join("")}var jz=/^(?:([^#/:?]+):)?(?:\/\/((?:([^#/?@]*)@)?(\[[^#/?\]]+\]|[^#/:?]*)(?::(\d*))?))?([^#?]*)(?:\?([^#]*))?(?:#((?:.|[\n\r])*))?/u;function _r(t,e){let r=Object.assign({},e),n={scheme:void 0,userinfo:void 0,host:"",port:void 0,path:"",query:void 0,fragment:void 0},s=!1;r.reference==="suffix"&&(r.scheme?t=r.scheme+":"+t:t="//"+t);let o=t.match(jz);if(o){if(n.scheme=o[1],n.userinfo=o[3],n.host=o[4],n.port=parseInt(o[5],10),n.path=o[6]||"",n.query=o[7],n.fragment=o[8],isNaN(n.port)&&(n.port=o[5]),n.host)if(zz(n.host)===!1){let c=Tz(n.host);n.host=c.host.toLowerCase(),s=c.isIPV6}else s=!0;n.scheme===void 0&&n.userinfo===void 0&&n.host===void 0&&n.port===void 0&&n.query===void 0&&!n.path?n.reference="same-document":n.scheme===void 0?n.reference="relative":n.fragment===void 0?n.reference="absolute":n.reference="uri",r.reference&&r.reference!=="suffix"&&r.reference!==n.reference&&(n.error=n.error||"URI is not a "+r.reference+" reference.");let i=Dv(r.scheme||n.scheme);if(!r.unicodeSupport&&(!i||!i.unicodeSupport)&&n.host&&(r.domainHost||i&&i.domainHost)&&s===!1&&Cz(n.host))try{n.host=URL.domainToASCII(n.host.toLowerCase())}catch(a){n.error=n.error||"Host's domain name can not be converted to ASCII: "+a}(!i||i&&!i.skipNormalize)&&(t.indexOf("%")!==-1&&(n.scheme!==void 0&&(n.scheme=unescape(n.scheme)),n.host!==void 0&&(n.host=unescape(n.host))),n.path&&(n.path=escape(unescape(n.path))),n.fragment&&(n.fragment=encodeURI(decodeURIComponent(n.fragment)))),i&&i.parse&&i.parse(n,r)}else n.error=n.error||"URI can not be parsed.";return n}var Fl={SCHEMES:Iz,normalize:Rz,resolve:Oz,resolveComponent:Zv,equal:Nz,serialize:er,parse:_r};Pa.exports=Fl;Pa.exports.default=Fl;Pa.exports.fastUri=Fl});var Vv=v(Hl=>{"use strict";Object.defineProperty(Hl,"__esModule",{value:!0});var Lv=Ul();Lv.code='require("ajv/dist/runtime/uri").default';Hl.default=Lv});var Jv=v(Fe=>{"use strict";Object.defineProperty(Fe,"__esModule",{value:!0});Fe.CodeGen=Fe.Name=Fe.nil=Fe.stringify=Fe.str=Fe._=Fe.KeywordCxt=void 0;var Az=ko();Object.defineProperty(Fe,"KeywordCxt",{enumerable:!0,get:function(){return Az.KeywordCxt}});var ds=Y();Object.defineProperty(Fe,"_",{enumerable:!0,get:function(){return ds._}});Object.defineProperty(Fe,"str",{enumerable:!0,get:function(){return ds.str}});Object.defineProperty(Fe,"stringify",{enumerable:!0,get:function(){return ds.stringify}});Object.defineProperty(Fe,"nil",{enumerable:!0,get:function(){return ds.nil}});Object.defineProperty(Fe,"Name",{enumerable:!0,get:function(){return ds.Name}});Object.defineProperty(Fe,"CodeGen",{enumerable:!0,get:function(){return ds.CodeGen}});var Mz=ba(),Bv=So(),qz=bl(),To=$a(),Dz=Y(),Eo=wo(),Ta=_o(),Bl=ce(),Fv=zv(),Zz=Vv(),Gv=(t,e)=>new RegExp(t,e);Gv.code="new RegExp";var Lz=["removeAdditional","useDefaults","coerceTypes"],Vz=new Set(["validate","serialize","parse","wrapper","root","schema","keyword","pattern","formats","validate$data","func","obj","Error"]),Fz={errorDataPath:"",format:"`validateFormats: false` can be used instead.",nullable:'"nullable" keyword is supported by default.',jsonPointers:"Deprecated jsPropertySyntax can be used instead.",extendRefs:"Deprecated ignoreKeywordsWithRef can be used instead.",missingRefs:"Pass empty schema with $id that should be ignored to ajv.addSchema.",processCode:"Use option `code: {process: (code, schemaEnv: object) => string}`",sourceCode:"Use option `code: {source: true}`",strictDefaults:"It is default now, see option `strict`.",strictKeywords:"It is default now, see option `strict`.",uniqueItems:'"uniqueItems" keyword is always validated.',unknownFormats:"Disable strict mode or pass `true` to `ajv.addFormat` (or `formats` option).",cache:"Map is used as cache, schema object as key.",serialize:"Map is used as cache, schema object as key.",ajvErrors:"It is default now."},Uz={ignoreKeywordsWithRef:"",jsPropertySyntax:"",unicode:'"minLength"/"maxLength" account for unicode characters by default.'},Uv=200;function Hz(t){var e,r,n,s,o,i,a,c,u,l,d,f,p,m,h,g,y,$,w,S,x,C,ee,fe,F;let ge=t.strict,Ae=(e=t.code)===null||e===void 0?void 0:e.optimize,Gr=Ae===!0||Ae===void 0?1:Ae||0,As=(n=(r=t.code)===null||r===void 0?void 0:r.regExp)!==null&&n!==void 0?n:Gv,Ic=(s=t.uriResolver)!==null&&s!==void 0?s:Zz.default;return{strictSchema:(i=(o=t.strictSchema)!==null&&o!==void 0?o:ge)!==null&&i!==void 0?i:!0,strictNumbers:(c=(a=t.strictNumbers)!==null&&a!==void 0?a:ge)!==null&&c!==void 0?c:!0,strictTypes:(l=(u=t.strictTypes)!==null&&u!==void 0?u:ge)!==null&&l!==void 0?l:"log",strictTuples:(f=(d=t.strictTuples)!==null&&d!==void 0?d:ge)!==null&&f!==void 0?f:"log",strictRequired:(m=(p=t.strictRequired)!==null&&p!==void 0?p:ge)!==null&&m!==void 0?m:!1,code:t.code?{...t.code,optimize:Gr,regExp:As}:{optimize:Gr,regExp:As},loopRequired:(h=t.loopRequired)!==null&&h!==void 0?h:Uv,loopEnum:(g=t.loopEnum)!==null&&g!==void 0?g:Uv,meta:(y=t.meta)!==null&&y!==void 0?y:!0,messages:($=t.messages)!==null&&$!==void 0?$:!0,inlineRefs:(w=t.inlineRefs)!==null&&w!==void 0?w:!0,schemaId:(S=t.schemaId)!==null&&S!==void 0?S:"$id",addUsedSchema:(x=t.addUsedSchema)!==null&&x!==void 0?x:!0,validateSchema:(C=t.validateSchema)!==null&&C!==void 0?C:!0,validateFormats:(ee=t.validateFormats)!==null&&ee!==void 0?ee:!0,unicodeRegExp:(fe=t.unicodeRegExp)!==null&&fe!==void 0?fe:!0,int32range:(F=t.int32range)!==null&&F!==void 0?F:!0,uriResolver:Ic}}var zo=class{constructor(e={}){this.schemas={},this.refs={},this.formats={},this._compilations=new Set,this._loading={},this._cache=new Map,e=this.opts={...e,...Hz(e)};let{es5:r,lines:n}=this.opts.code;this.scope=new Dz.ValueScope({scope:{},prefixes:Vz,es5:r,lines:n}),this.logger=Yz(e.logger);let s=e.validateFormats;e.validateFormats=!1,this.RULES=(0,qz.getRules)(),Hv.call(this,Fz,e,"NOT SUPPORTED"),Hv.call(this,Uz,e,"DEPRECATED","warn"),this._metaOpts=Wz.call(this),e.formats&&Bz.call(this),this._addVocabularies(),this._addDefaultMetaSchema(),e.keywords&&Gz.call(this,e.keywords),typeof e.meta=="object"&&this.addMetaSchema(e.meta),Kz.call(this),e.validateFormats=s}_addVocabularies(){this.addKeyword("$async")}_addDefaultMetaSchema(){let{$data:e,meta:r,schemaId:n}=this.opts,s=Fv;n==="id"&&(s={...Fv},s.id=s.$id,delete s.$id),r&&e&&this.addMetaSchema(s,s[n],!1)}defaultMeta(){let{meta:e,schemaId:r}=this.opts;return this.opts.defaultMeta=typeof e=="object"?e[r]||e:void 0}validate(e,r){let n;if(typeof e=="string"){if(n=this.getSchema(e),!n)throw new Error(`no schema with key or ref "${e}"`)}else n=this.compile(e);let s=n(r);return"$async"in n||(this.errors=n.errors),s}compile(e,r){let n=this._addSchema(e,r);return n.validate||this._compileSchemaEnv(n)}compileAsync(e,r){if(typeof this.opts.loadSchema!="function")throw new Error("options.loadSchema should be a function");let{loadSchema:n}=this.opts;return s.call(this,e,r);async function s(l,d){await o.call(this,l.$schema);let f=this._addSchema(l,d);return f.validate||i.call(this,f)}async function o(l){l&&!this.getSchema(l)&&await s.call(this,{$ref:l},!0)}async function i(l){try{return this._compileSchemaEnv(l)}catch(d){if(!(d instanceof Bv.default))throw d;return a.call(this,d),await c.call(this,d.missingSchema),i.call(this,l)}}function a({missingSchema:l,missingRef:d}){if(this.refs[l])throw new Error(`AnySchema ${l} is loaded but ${d} cannot be resolved`)}async function c(l){let d=await u.call(this,l);this.refs[l]||await o.call(this,d.$schema),this.refs[l]||this.addSchema(d,l,r)}async function u(l){let d=this._loading[l];if(d)return d;try{return await(this._loading[l]=n(l))}finally{delete this._loading[l]}}}addSchema(e,r,n,s=this.opts.validateSchema){if(Array.isArray(e)){for(let i of e)this.addSchema(i,void 0,n,s);return this}let o;if(typeof e=="object"){let{schemaId:i}=this.opts;if(o=e[i],o!==void 0&&typeof o!="string")throw new Error(`schema ${i} must be string`)}return r=(0,Eo.normalizeId)(r||o),this._checkUnique(r),this.schemas[r]=this._addSchema(e,n,r,s,!0),this}addMetaSchema(e,r,n=this.opts.validateSchema){return this.addSchema(e,r,!0,n),this}validateSchema(e,r){if(typeof e=="boolean")return!0;let n;if(n=e.$schema,n!==void 0&&typeof n!="string")throw new Error("$schema must be a string");if(n=n||this.opts.defaultMeta||this.defaultMeta(),!n)return this.logger.warn("meta-schema not available"),this.errors=null,!0;let s=this.validate(n,e);if(!s&&r){let o="schema is invalid: "+this.errorsText();if(this.opts.validateSchema==="log")this.logger.error(o);else throw new Error(o)}return s}getSchema(e){let r;for(;typeof(r=Kv.call(this,e))=="string";)e=r;if(r===void 0){let{schemaId:n}=this.opts,s=new To.SchemaEnv({schema:{},schemaId:n});if(r=To.resolveSchema.call(this,s,e),!r)return;this.refs[e]=r}return r.validate||this._compileSchemaEnv(r)}removeSchema(e){if(e instanceof RegExp)return this._removeAllSchemas(this.schemas,e),this._removeAllSchemas(this.refs,e),this;switch(typeof e){case"undefined":return this._removeAllSchemas(this.schemas),this._removeAllSchemas(this.refs),this._cache.clear(),this;case"string":{let r=Kv.call(this,e);return typeof r=="object"&&this._cache.delete(r.schema),delete this.schemas[e],delete this.refs[e],this}case"object":{let r=e;this._cache.delete(r);let n=e[this.opts.schemaId];return n&&(n=(0,Eo.normalizeId)(n),delete this.schemas[n],delete this.refs[n]),this}default:throw new Error("ajv.removeSchema: invalid parameter")}}addVocabulary(e){for(let r of e)this.addKeyword(r);return this}addKeyword(e,r){let n;if(typeof e=="string")n=e,typeof r=="object"&&(this.logger.warn("these parameters are deprecated, see docs for addKeyword"),r.keyword=n);else if(typeof e=="object"&&r===void 0){if(r=e,n=r.keyword,Array.isArray(n)&&!n.length)throw new Error("addKeywords: keyword must be string or non-empty array")}else throw new Error("invalid addKeywords parameters");if(Xz.call(this,n,r),!r)return(0,Bl.eachItem)(n,o=>Kl.call(this,o)),this;tC.call(this,r);let s={...r,type:(0,Ta.getJSONTypes)(r.type),schemaType:(0,Ta.getJSONTypes)(r.schemaType)};return(0,Bl.eachItem)(n,s.type.length===0?o=>Kl.call(this,o,s):o=>s.type.forEach(i=>Kl.call(this,o,s,i))),this}getKeyword(e){let r=this.RULES.all[e];return typeof r=="object"?r.definition:!!r}removeKeyword(e){let{RULES:r}=this;delete r.keywords[e],delete r.all[e];for(let n of r.rules){let s=n.rules.findIndex(o=>o.keyword===e);s>=0&&n.rules.splice(s,1)}return this}addFormat(e,r){return typeof r=="string"&&(r=new RegExp(r)),this.formats[e]=r,this}errorsText(e=this.errors,{separator:r=", ",dataVar:n="data"}={}){return!e||e.length===0?"No errors":e.map(s=>`${n}${s.instancePath} ${s.message}`).reduce((s,o)=>s+r+o)}$dataMetaSchema(e,r){let n=this.RULES.all;e=JSON.parse(JSON.stringify(e));for(let s of r){let o=s.split("/").slice(1),i=e;for(let a of o)i=i[a];for(let a in n){let c=n[a];if(typeof c!="object")continue;let{$data:u}=c.definition,l=i[a];u&&l&&(i[a]=Wv(l))}}return e}_removeAllSchemas(e,r){for(let n in e){let s=e[n];(!r||r.test(n))&&(typeof s=="string"?delete e[n]:s&&!s.meta&&(this._cache.delete(s.schema),delete e[n]))}}_addSchema(e,r,n,s=this.opts.validateSchema,o=this.opts.addUsedSchema){let i,{schemaId:a}=this.opts;if(typeof e=="object")i=e[a];else{if(this.opts.jtd)throw new Error("schema must be object");if(typeof e!="boolean")throw new Error("schema must be object or boolean")}let c=this._cache.get(e);if(c!==void 0)return c;n=(0,Eo.normalizeId)(i||n);let u=Eo.getSchemaRefs.call(this,e,n);return c=new To.SchemaEnv({schema:e,schemaId:a,meta:r,baseId:n,localRefs:u}),this._cache.set(c.schema,c),o&&!n.startsWith("#")&&(n&&this._checkUnique(n),this.refs[n]=c),s&&this.validateSchema(e,!0),c}_checkUnique(e){if(this.schemas[e]||this.refs[e])throw new Error(`schema with key or id "${e}" already exists`)}_compileSchemaEnv(e){if(e.meta?this._compileMetaSchema(e):To.compileSchema.call(this,e),!e.validate)throw new Error("ajv implementation error");return e.validate}_compileMetaSchema(e){let r=this.opts;this.opts=this._metaOpts;try{To.compileSchema.call(this,e)}finally{this.opts=r}}};zo.ValidationError=Mz.default;zo.MissingRefError=Bv.default;Fe.default=zo;function Hv(t,e,r,n="error"){for(let s in t){let o=s;o in e&&this.logger[n](`${r}: option ${s}. ${t[o]}`)}}function Kv(t){return t=(0,Eo.normalizeId)(t),this.schemas[t]||this.refs[t]}function Kz(){let t=this.opts.schemas;if(t)if(Array.isArray(t))this.addSchema(t);else for(let e in t)this.addSchema(t[e],e)}function Bz(){for(let t in this.opts.formats){let e=this.opts.formats[t];e&&this.addFormat(t,e)}}function Gz(t){if(Array.isArray(t)){this.addVocabulary(t);return}this.logger.warn("keywords option as map is deprecated, pass array");for(let e in t){let r=t[e];r.keyword||(r.keyword=e),this.addKeyword(r)}}function Wz(){let t={...this.opts};for(let e of Lz)delete t[e];return t}var Jz={log(){},warn(){},error(){}};function Yz(t){if(t===!1)return Jz;if(t===void 0)return console;if(t.log&&t.warn&&t.error)return t;throw new Error("logger must implement log, warn and error methods")}var Qz=/^[a-z_$][a-z0-9_$:-]*$/i;function Xz(t,e){let{RULES:r}=this;if((0,Bl.eachItem)(t,n=>{if(r.keywords[n])throw new Error(`Keyword ${n} is already defined`);if(!Qz.test(n))throw new Error(`Keyword ${n} has invalid name`)}),!!e&&e.$data&&!("code"in e||"validate"in e))throw new Error('$data keyword must have "code" or "validate" function')}function Kl(t,e,r){var n;let s=e?.post;if(r&&s)throw new Error('keyword with "post" flag cannot have "type"');let{RULES:o}=this,i=s?o.post:o.rules.find(({type:c})=>c===r);if(i||(i={type:r,rules:[]},o.rules.push(i)),o.keywords[t]=!0,!e)return;let a={keyword:t,definition:{...e,type:(0,Ta.getJSONTypes)(e.type),schemaType:(0,Ta.getJSONTypes)(e.schemaType)}};e.before?eC.call(this,i,a,e.before):i.rules.push(a),o.all[t]=a,(n=e.implements)===null||n===void 0||n.forEach(c=>this.addKeyword(c))}function eC(t,e,r){let n=t.rules.findIndex(s=>s.keyword===r);n>=0?t.rules.splice(n,0,e):(t.rules.push(e),this.logger.warn(`rule ${r} is not defined`))}function tC(t){let{metaSchema:e}=t;e!==void 0&&(t.$data&&this.opts.$data&&(e=Wv(e)),t.validateSchema=this.compile(e,!0))}var rC={$ref:"https://raw.githubusercontent.com/ajv-validator/ajv/master/lib/refs/data.json#"};function Wv(t){return{anyOf:[t,rC]}}});var Yv=v(Gl=>{"use strict";Object.defineProperty(Gl,"__esModule",{value:!0});var nC={keyword:"id",code(){throw new Error('NOT SUPPORTED: keyword "id", use "$id" for schema ID')}};Gl.default=nC});var t_=v(Tn=>{"use strict";Object.defineProperty(Tn,"__esModule",{value:!0});Tn.callRef=Tn.getValidate=void 0;var sC=So(),Qv=kt(),pt=Y(),ps=yr(),Xv=$a(),Ea=ce(),oC={keyword:"$ref",schemaType:"string",code(t){let{gen:e,schema:r,it:n}=t,{baseId:s,schemaEnv:o,validateName:i,opts:a,self:c}=n,{root:u}=o;if((r==="#"||r==="#/")&&s===u.baseId)return d();let l=Xv.resolveRef.call(c,u,s,r);if(l===void 0)throw new sC.default(n.opts.uriResolver,s,r);if(l instanceof Xv.SchemaEnv)return f(l);return p(l);function d(){if(o===u)return za(t,i,o,o.$async);let m=e.scopeValue("root",{ref:u});return za(t,(0,pt._)`${m}.validate`,u,u.$async)}function f(m){let h=e_(t,m);za(t,h,m,m.$async)}function p(m){let h=e.scopeValue("schema",a.code.source===!0?{ref:m,code:(0,pt.stringify)(m)}:{ref:m}),g=e.name("valid"),y=t.subschema({schema:m,dataTypes:[],schemaPath:pt.nil,topSchemaRef:h,errSchemaPath:r},g);t.mergeEvaluated(y),t.ok(g)}}};function e_(t,e){let{gen:r}=t;return e.validate?r.scopeValue("validate",{ref:e.validate}):(0,pt._)`${r.scopeValue("wrapper",{ref:e})}.validate`}Tn.getValidate=e_;function za(t,e,r,n){let{gen:s,it:o}=t,{allErrors:i,schemaEnv:a,opts:c}=o,u=c.passContext?ps.default.this:pt.nil;n?l():d();function l(){if(!a.$async)throw new Error("async schema referenced by sync schema");let m=s.let("valid");s.try(()=>{s.code((0,pt._)`await ${(0,Qv.callValidateCode)(t,e,u)}`),p(e),i||s.assign(m,!0)},h=>{s.if((0,pt._)`!(${h} instanceof ${o.ValidationError})`,()=>s.throw(h)),f(h),i||s.assign(m,!1)}),t.ok(m)}function d(){t.result((0,Qv.callValidateCode)(t,e,u),()=>p(e),()=>f(e))}function f(m){let h=(0,pt._)`${m}.errors`;s.assign(ps.default.vErrors,(0,pt._)`${ps.default.vErrors} === null ? ${h} : ${ps.default.vErrors}.concat(${h})`),s.assign(ps.default.errors,(0,pt._)`${ps.default.vErrors}.length`)}function p(m){var h;if(!o.opts.unevaluated)return;let g=(h=r?.validate)===null||h===void 0?void 0:h.evaluated;if(o.props!==!0)if(g&&!g.dynamicProps)g.props!==void 0&&(o.props=Ea.mergeEvaluated.props(s,g.props,o.props));else{let y=s.var("props",(0,pt._)`${m}.evaluated.props`);o.props=Ea.mergeEvaluated.props(s,y,o.props,pt.Name)}if(o.items!==!0)if(g&&!g.dynamicItems)g.items!==void 0&&(o.items=Ea.mergeEvaluated.items(s,g.items,o.items));else{let y=s.var("items",(0,pt._)`${m}.evaluated.items`);o.items=Ea.mergeEvaluated.items(s,y,o.items,pt.Name)}}}Tn.callRef=za;Tn.default=oC});var r_=v(Wl=>{"use strict";Object.defineProperty(Wl,"__esModule",{value:!0});var iC=Yv(),aC=t_(),cC=["$schema","$id","$defs","$vocabulary",{keyword:"$comment"},"definitions",iC.default,aC.default];Wl.default=cC});var n_=v(Jl=>{"use strict";Object.defineProperty(Jl,"__esModule",{value:!0});var Ca=Y(),Dr=Ca.operators,Ia={maximum:{okStr:"<=",ok:Dr.LTE,fail:Dr.GT},minimum:{okStr:">=",ok:Dr.GTE,fail:Dr.LT},exclusiveMaximum:{okStr:"<",ok:Dr.LT,fail:Dr.GTE},exclusiveMinimum:{okStr:">",ok:Dr.GT,fail:Dr.LTE}},uC={message:({keyword:t,schemaCode:e})=>(0,Ca.str)`must be ${Ia[t].okStr} ${e}`,params:({keyword:t,schemaCode:e})=>(0,Ca._)`{comparison: ${Ia[t].okStr}, limit: ${e}}`},lC={keyword:Object.keys(Ia),type:"number",schemaType:"number",$data:!0,error:uC,code(t){let{keyword:e,data:r,schemaCode:n}=t;t.fail$data((0,Ca._)`${r} ${Ia[e].fail} ${n} || isNaN(${r})`)}};Jl.default=lC});var s_=v(Yl=>{"use strict";Object.defineProperty(Yl,"__esModule",{value:!0});var Co=Y(),dC={message:({schemaCode:t})=>(0,Co.str)`must be multiple of ${t}`,params:({schemaCode:t})=>(0,Co._)`{multipleOf: ${t}}`},pC={keyword:"multipleOf",type:"number",schemaType:"number",$data:!0,error:dC,code(t){let{gen:e,data:r,schemaCode:n,it:s}=t,o=s.opts.multipleOfPrecision,i=e.let("res"),a=o?(0,Co._)`Math.abs(Math.round(${i}) - ${i}) > 1e-${o}`:(0,Co._)`${i} !== parseInt(${i})`;t.fail$data((0,Co._)`(${n} === 0 || (${i} = ${r}/${n}, ${a}))`)}};Yl.default=pC});var i_=v(Ql=>{"use strict";Object.defineProperty(Ql,"__esModule",{value:!0});function o_(t){let e=t.length,r=0,n=0,s;for(;n<e;)r++,s=t.charCodeAt(n++),s>=55296&&s<=56319&&n<e&&(s=t.charCodeAt(n),(s&64512)===56320&&n++);return r}Ql.default=o_;o_.code='require("ajv/dist/runtime/ucs2length").default'});var a_=v(Xl=>{"use strict";Object.defineProperty(Xl,"__esModule",{value:!0});var En=Y(),fC=ce(),mC=i_(),hC={message({keyword:t,schemaCode:e}){let r=t==="maxLength"?"more":"fewer";return(0,En.str)`must NOT have ${r} than ${e} characters`},params:({schemaCode:t})=>(0,En._)`{limit: ${t}}`},gC={keyword:["maxLength","minLength"],type:"string",schemaType:"number",$data:!0,error:hC,code(t){let{keyword:e,data:r,schemaCode:n,it:s}=t,o=e==="maxLength"?En.operators.GT:En.operators.LT,i=s.opts.unicode===!1?(0,En._)`${r}.length`:(0,En._)`${(0,fC.useFunc)(t.gen,mC.default)}(${r})`;t.fail$data((0,En._)`${i} ${o} ${n}`)}};Xl.default=gC});var c_=v(ed=>{"use strict";Object.defineProperty(ed,"__esModule",{value:!0});var yC=kt(),Ra=Y(),vC={message:({schemaCode:t})=>(0,Ra.str)`must match pattern "${t}"`,params:({schemaCode:t})=>(0,Ra._)`{pattern: ${t}}`},_C={keyword:"pattern",type:"string",schemaType:"string",$data:!0,error:vC,code(t){let{data:e,$data:r,schema:n,schemaCode:s,it:o}=t,i=o.opts.unicodeRegExp?"u":"",a=r?(0,Ra._)`(new RegExp(${s}, ${i}))`:(0,yC.usePattern)(t,n);t.fail$data((0,Ra._)`!${a}.test(${e})`)}};ed.default=_C});var u_=v(td=>{"use strict";Object.defineProperty(td,"__esModule",{value:!0});var Io=Y(),bC={message({keyword:t,schemaCode:e}){let r=t==="maxProperties"?"more":"fewer";return(0,Io.str)`must NOT have ${r} than ${e} properties`},params:({schemaCode:t})=>(0,Io._)`{limit: ${t}}`},wC={keyword:["maxProperties","minProperties"],type:"object",schemaType:"number",$data:!0,error:bC,code(t){let{keyword:e,data:r,schemaCode:n}=t,s=e==="maxProperties"?Io.operators.GT:Io.operators.LT;t.fail$data((0,Io._)`Object.keys(${r}).length ${s} ${n}`)}};td.default=wC});var l_=v(rd=>{"use strict";Object.defineProperty(rd,"__esModule",{value:!0});var Ro=kt(),Oo=Y(),$C=ce(),xC={message:({params:{missingProperty:t}})=>(0,Oo.str)`must have required property '${t}'`,params:({params:{missingProperty:t}})=>(0,Oo._)`{missingProperty: ${t}}`},kC={keyword:"required",type:"object",schemaType:"array",$data:!0,error:xC,code(t){let{gen:e,schema:r,schemaCode:n,data:s,$data:o,it:i}=t,{opts:a}=i;if(!o&&r.length===0)return;let c=r.length>=a.loopRequired;if(i.allErrors?u():l(),a.strictRequired){let p=t.parentSchema.properties,{definedProperties:m}=t.it;for(let h of r)if(p?.[h]===void 0&&!m.has(h)){let g=i.schemaEnv.baseId+i.errSchemaPath,y=`required property "${h}" is not defined at "${g}" (strictRequired)`;(0,$C.checkStrictMode)(i,y,i.opts.strictRequired)}}function u(){if(c||o)t.block$data(Oo.nil,d);else for(let p of r)(0,Ro.checkReportMissingProp)(t,p)}function l(){let p=e.let("missing");if(c||o){let m=e.let("valid",!0);t.block$data(m,()=>f(p,m)),t.ok(m)}else e.if((0,Ro.checkMissingProp)(t,r,p)),(0,Ro.reportMissingProp)(t,p),e.else()}function d(){e.forOf("prop",n,p=>{t.setParams({missingProperty:p}),e.if((0,Ro.noPropertyInData)(e,s,p,a.ownProperties),()=>t.error())})}function f(p,m){t.setParams({missingProperty:p}),e.forOf(p,n,()=>{e.assign(m,(0,Ro.propertyInData)(e,s,p,a.ownProperties)),e.if((0,Oo.not)(m),()=>{t.error(),e.break()})},Oo.nil)}}};rd.default=kC});var d_=v(nd=>{"use strict";Object.defineProperty(nd,"__esModule",{value:!0});var No=Y(),SC={message({keyword:t,schemaCode:e}){let r=t==="maxItems"?"more":"fewer";return(0,No.str)`must NOT have ${r} than ${e} items`},params:({schemaCode:t})=>(0,No._)`{limit: ${t}}`},PC={keyword:["maxItems","minItems"],type:"array",schemaType:"number",$data:!0,error:SC,code(t){let{keyword:e,data:r,schemaCode:n}=t,s=e==="maxItems"?No.operators.GT:No.operators.LT;t.fail$data((0,No._)`${r}.length ${s} ${n}`)}};nd.default=PC});var Oa=v(sd=>{"use strict";Object.defineProperty(sd,"__esModule",{value:!0});var p_=bo();p_.code='require("ajv/dist/runtime/equal").default';sd.default=p_});var f_=v(id=>{"use strict";Object.defineProperty(id,"__esModule",{value:!0});var od=_o(),Ue=Y(),TC=ce(),EC=Oa(),zC={message:({params:{i:t,j:e}})=>(0,Ue.str)`must NOT have duplicate items (items ## ${e} and ${t} are identical)`,params:({params:{i:t,j:e}})=>(0,Ue._)`{i: ${t}, j: ${e}}`},CC={keyword:"uniqueItems",type:"array",schemaType:"boolean",$data:!0,error:zC,code(t){let{gen:e,data:r,$data:n,schema:s,parentSchema:o,schemaCode:i,it:a}=t;if(!n&&!s)return;let c=e.let("valid"),u=o.items?(0,od.getSchemaTypes)(o.items):[];t.block$data(c,l,(0,Ue._)`${i} === false`),t.ok(c);function l(){let m=e.let("i",(0,Ue._)`${r}.length`),h=e.let("j");t.setParams({i:m,j:h}),e.assign(c,!0),e.if((0,Ue._)`${m} > 1`,()=>(d()?f:p)(m,h))}function d(){return u.length>0&&!u.some(m=>m==="object"||m==="array")}function f(m,h){let g=e.name("item"),y=(0,od.checkDataTypes)(u,g,a.opts.strictNumbers,od.DataType.Wrong),$=e.const("indices",(0,Ue._)`{}`);e.for((0,Ue._)`;${m}--;`,()=>{e.let(g,(0,Ue._)`${r}[${m}]`),e.if(y,(0,Ue._)`continue`),u.length>1&&e.if((0,Ue._)`typeof ${g} == "string"`,(0,Ue._)`${g} += "_"`),e.if((0,Ue._)`typeof ${$}[${g}] == "number"`,()=>{e.assign(h,(0,Ue._)`${$}[${g}]`),t.error(),e.assign(c,!1).break()}).code((0,Ue._)`${$}[${g}] = ${m}`)})}function p(m,h){let g=(0,TC.useFunc)(e,EC.default),y=e.name("outer");e.label(y).for((0,Ue._)`;${m}--;`,()=>e.for((0,Ue._)`${h} = ${m}; ${h}--;`,()=>e.if((0,Ue._)`${g}(${r}[${m}], ${r}[${h}])`,()=>{t.error(),e.assign(c,!1).break(y)})))}}};id.default=CC});var m_=v(cd=>{"use strict";Object.defineProperty(cd,"__esModule",{value:!0});var ad=Y(),IC=ce(),RC=Oa(),OC={message:"must be equal to constant",params:({schemaCode:t})=>(0,ad._)`{allowedValue: ${t}}`},NC={keyword:"const",$data:!0,error:OC,code(t){let{gen:e,data:r,$data:n,schemaCode:s,schema:o}=t;n||o&&typeof o=="object"?t.fail$data((0,ad._)`!${(0,IC.useFunc)(e,RC.default)}(${r}, ${s})`):t.fail((0,ad._)`${o} !== ${r}`)}};cd.default=NC});var h_=v(ud=>{"use strict";Object.defineProperty(ud,"__esModule",{value:!0});var jo=Y(),jC=ce(),AC=Oa(),MC={message:"must be equal to one of the allowed values",params:({schemaCode:t})=>(0,jo._)`{allowedValues: ${t}}`},qC={keyword:"enum",schemaType:"array",$data:!0,error:MC,code(t){let{gen:e,data:r,$data:n,schema:s,schemaCode:o,it:i}=t;if(!n&&s.length===0)throw new Error("enum must have non-empty array");let a=s.length>=i.opts.loopEnum,c,u=()=>c??(c=(0,jC.useFunc)(e,AC.default)),l;if(a||n)l=e.let("valid"),t.block$data(l,d);else{if(!Array.isArray(s))throw new Error("ajv implementation error");let p=e.const("vSchema",o);l=(0,jo.or)(...s.map((m,h)=>f(p,h)))}t.pass(l);function d(){e.assign(l,!1),e.forOf("v",o,p=>e.if((0,jo._)`${u()}(${r}, ${p})`,()=>e.assign(l,!0).break()))}function f(p,m){let h=s[m];return typeof h=="object"&&h!==null?(0,jo._)`${u()}(${r}, ${p}[${m}])`:(0,jo._)`${r} === ${h}`}}};ud.default=qC});var g_=v(ld=>{"use strict";Object.defineProperty(ld,"__esModule",{value:!0});var DC=n_(),ZC=s_(),LC=a_(),VC=c_(),FC=u_(),UC=l_(),HC=d_(),KC=f_(),BC=m_(),GC=h_(),WC=[DC.default,ZC.default,LC.default,VC.default,FC.default,UC.default,HC.default,KC.default,{keyword:"type",schemaType:["string","array"]},{keyword:"nullable",schemaType:"boolean"},BC.default,GC.default];ld.default=WC});var pd=v(Ao=>{"use strict";Object.defineProperty(Ao,"__esModule",{value:!0});Ao.validateAdditionalItems=void 0;var zn=Y(),dd=ce(),JC={message:({params:{len:t}})=>(0,zn.str)`must NOT have more than ${t} items`,params:({params:{len:t}})=>(0,zn._)`{limit: ${t}}`},YC={keyword:"additionalItems",type:"array",schemaType:["boolean","object"],before:"uniqueItems",error:JC,code(t){let{parentSchema:e,it:r}=t,{items:n}=e;if(!Array.isArray(n)){(0,dd.checkStrictMode)(r,'"additionalItems" is ignored when "items" is not an array of schemas');return}y_(t,n)}};function y_(t,e){let{gen:r,schema:n,data:s,keyword:o,it:i}=t;i.items=!0;let a=r.const("len",(0,zn._)`${s}.length`);if(n===!1)t.setParams({len:e.length}),t.pass((0,zn._)`${a} <= ${e.length}`);else if(typeof n=="object"&&!(0,dd.alwaysValidSchema)(i,n)){let u=r.var("valid",(0,zn._)`${a} <= ${e.length}`);r.if((0,zn.not)(u),()=>c(u)),t.ok(u)}function c(u){r.forRange("i",e.length,a,l=>{t.subschema({keyword:o,dataProp:l,dataPropType:dd.Type.Num},u),i.allErrors||r.if((0,zn.not)(u),()=>r.break())})}}Ao.validateAdditionalItems=y_;Ao.default=YC});var fd=v(Mo=>{"use strict";Object.defineProperty(Mo,"__esModule",{value:!0});Mo.validateTuple=void 0;var v_=Y(),Na=ce(),QC=kt(),XC={keyword:"items",type:"array",schemaType:["object","array","boolean"],before:"uniqueItems",code(t){let{schema:e,it:r}=t;if(Array.isArray(e))return __(t,"additionalItems",e);r.items=!0,!(0,Na.alwaysValidSchema)(r,e)&&t.ok((0,QC.validateArray)(t))}};function __(t,e,r=t.schema){let{gen:n,parentSchema:s,data:o,keyword:i,it:a}=t;l(s),a.opts.unevaluated&&r.length&&a.items!==!0&&(a.items=Na.mergeEvaluated.items(n,r.length,a.items));let c=n.name("valid"),u=n.const("len",(0,v_._)`${o}.length`);r.forEach((d,f)=>{(0,Na.alwaysValidSchema)(a,d)||(n.if((0,v_._)`${u} > ${f}`,()=>t.subschema({keyword:i,schemaProp:f,dataProp:f},c)),t.ok(c))});function l(d){let{opts:f,errSchemaPath:p}=a,m=r.length,h=m===d.minItems&&(m===d.maxItems||d[e]===!1);if(f.strictTuples&&!h){let g=`"${i}" is ${m}-tuple, but minItems or maxItems/${e} are not specified or different at path "${p}"`;(0,Na.checkStrictMode)(a,g,f.strictTuples)}}}Mo.validateTuple=__;Mo.default=XC});var b_=v(md=>{"use strict";Object.defineProperty(md,"__esModule",{value:!0});var eI=fd(),tI={keyword:"prefixItems",type:"array",schemaType:["array"],before:"uniqueItems",code:t=>(0,eI.validateTuple)(t,"items")};md.default=tI});var $_=v(hd=>{"use strict";Object.defineProperty(hd,"__esModule",{value:!0});var w_=Y(),rI=ce(),nI=kt(),sI=pd(),oI={message:({params:{len:t}})=>(0,w_.str)`must NOT have more than ${t} items`,params:({params:{len:t}})=>(0,w_._)`{limit: ${t}}`},iI={keyword:"items",type:"array",schemaType:["object","boolean"],before:"uniqueItems",error:oI,code(t){let{schema:e,parentSchema:r,it:n}=t,{prefixItems:s}=r;n.items=!0,!(0,rI.alwaysValidSchema)(n,e)&&(s?(0,sI.validateAdditionalItems)(t,s):t.ok((0,nI.validateArray)(t)))}};hd.default=iI});var x_=v(gd=>{"use strict";Object.defineProperty(gd,"__esModule",{value:!0});var Pt=Y(),ja=ce(),aI={message:({params:{min:t,max:e}})=>e===void 0?(0,Pt.str)`must contain at least ${t} valid item(s)`:(0,Pt.str)`must contain at least ${t} and no more than ${e} valid item(s)`,params:({params:{min:t,max:e}})=>e===void 0?(0,Pt._)`{minContains: ${t}}`:(0,Pt._)`{minContains: ${t}, maxContains: ${e}}`},cI={keyword:"contains",type:"array",schemaType:["object","boolean"],before:"uniqueItems",trackErrors:!0,error:aI,code(t){let{gen:e,schema:r,parentSchema:n,data:s,it:o}=t,i,a,{minContains:c,maxContains:u}=n;o.opts.next?(i=c===void 0?1:c,a=u):i=1;let l=e.const("len",(0,Pt._)`${s}.length`);if(t.setParams({min:i,max:a}),a===void 0&&i===0){(0,ja.checkStrictMode)(o,'"minContains" == 0 without "maxContains": "contains" keyword ignored');return}if(a!==void 0&&i>a){(0,ja.checkStrictMode)(o,'"minContains" > "maxContains" is always invalid'),t.fail();return}if((0,ja.alwaysValidSchema)(o,r)){let h=(0,Pt._)`${l} >= ${i}`;a!==void 0&&(h=(0,Pt._)`${h} && ${l} <= ${a}`),t.pass(h);return}o.items=!0;let d=e.name("valid");a===void 0&&i===1?p(d,()=>e.if(d,()=>e.break())):i===0?(e.let(d,!0),a!==void 0&&e.if((0,Pt._)`${s}.length > 0`,f)):(e.let(d,!1),f()),t.result(d,()=>t.reset());function f(){let h=e.name("_valid"),g=e.let("count",0);p(h,()=>e.if(h,()=>m(g)))}function p(h,g){e.forRange("i",0,l,y=>{t.subschema({keyword:"contains",dataProp:y,dataPropType:ja.Type.Num,compositeRule:!0},h),g()})}function m(h){e.code((0,Pt._)`${h}++`),a===void 0?e.if((0,Pt._)`${h} >= ${i}`,()=>e.assign(d,!0).break()):(e.if((0,Pt._)`${h} > ${a}`,()=>e.assign(d,!1).break()),i===1?e.assign(d,!0):e.if((0,Pt._)`${h} >= ${i}`,()=>e.assign(d,!0)))}}};gd.default=cI});var P_=v(tr=>{"use strict";Object.defineProperty(tr,"__esModule",{value:!0});tr.validateSchemaDeps=tr.validatePropertyDeps=tr.error=void 0;var yd=Y(),uI=ce(),qo=kt();tr.error={message:({params:{property:t,depsCount:e,deps:r}})=>{let n=e===1?"property":"properties";return(0,yd.str)`must have ${n} ${r} when property ${t} is present`},params:({params:{property:t,depsCount:e,deps:r,missingProperty:n}})=>(0,yd._)`{property: ${t},
    missingProperty: ${n},
    depsCount: ${e},
    deps: ${r}}`};var lI={keyword:"dependencies",type:"object",schemaType:"object",error:tr.error,code(t){let[e,r]=dI(t);k_(t,e),S_(t,r)}};function dI({schema:t}){let e={},r={};for(let n in t){if(n==="__proto__")continue;let s=Array.isArray(t[n])?e:r;s[n]=t[n]}return[e,r]}function k_(t,e=t.schema){let{gen:r,data:n,it:s}=t;if(Object.keys(e).length===0)return;let o=r.let("missing");for(let i in e){let a=e[i];if(a.length===0)continue;let c=(0,qo.propertyInData)(r,n,i,s.opts.ownProperties);t.setParams({property:i,depsCount:a.length,deps:a.join(", ")}),s.allErrors?r.if(c,()=>{for(let u of a)(0,qo.checkReportMissingProp)(t,u)}):(r.if((0,yd._)`${c} && (${(0,qo.checkMissingProp)(t,a,o)})`),(0,qo.reportMissingProp)(t,o),r.else())}}tr.validatePropertyDeps=k_;function S_(t,e=t.schema){let{gen:r,data:n,keyword:s,it:o}=t,i=r.name("valid");for(let a in e)(0,uI.alwaysValidSchema)(o,e[a])||(r.if((0,qo.propertyInData)(r,n,a,o.opts.ownProperties),()=>{let c=t.subschema({keyword:s,schemaProp:a},i);t.mergeValidEvaluated(c,i)},()=>r.var(i,!0)),t.ok(i))}tr.validateSchemaDeps=S_;tr.default=lI});var E_=v(vd=>{"use strict";Object.defineProperty(vd,"__esModule",{value:!0});var T_=Y(),pI=ce(),fI={message:"property name must be valid",params:({params:t})=>(0,T_._)`{propertyName: ${t.propertyName}}`},mI={keyword:"propertyNames",type:"object",schemaType:["object","boolean"],error:fI,code(t){let{gen:e,schema:r,data:n,it:s}=t;if((0,pI.alwaysValidSchema)(s,r))return;let o=e.name("valid");e.forIn("key",n,i=>{t.setParams({propertyName:i}),t.subschema({keyword:"propertyNames",data:i,dataTypes:["string"],propertyName:i,compositeRule:!0},o),e.if((0,T_.not)(o),()=>{t.error(!0),s.allErrors||e.break()})}),t.ok(o)}};vd.default=mI});var bd=v(_d=>{"use strict";Object.defineProperty(_d,"__esModule",{value:!0});var Aa=kt(),Mt=Y(),hI=yr(),Ma=ce(),gI={message:"must NOT have additional properties",params:({params:t})=>(0,Mt._)`{additionalProperty: ${t.additionalProperty}}`},yI={keyword:"additionalProperties",type:["object"],schemaType:["boolean","object"],allowUndefined:!0,trackErrors:!0,error:gI,code(t){let{gen:e,schema:r,parentSchema:n,data:s,errsCount:o,it:i}=t;if(!o)throw new Error("ajv implementation error");let{allErrors:a,opts:c}=i;if(i.props=!0,c.removeAdditional!=="all"&&(0,Ma.alwaysValidSchema)(i,r))return;let u=(0,Aa.allSchemaProperties)(n.properties),l=(0,Aa.allSchemaProperties)(n.patternProperties);d(),t.ok((0,Mt._)`${o} === ${hI.default.errors}`);function d(){e.forIn("key",s,g=>{!u.length&&!l.length?m(g):e.if(f(g),()=>m(g))})}function f(g){let y;if(u.length>8){let $=(0,Ma.schemaRefOrVal)(i,n.properties,"properties");y=(0,Aa.isOwnProperty)(e,$,g)}else u.length?y=(0,Mt.or)(...u.map($=>(0,Mt._)`${g} === ${$}`)):y=Mt.nil;return l.length&&(y=(0,Mt.or)(y,...l.map($=>(0,Mt._)`${(0,Aa.usePattern)(t,$)}.test(${g})`))),(0,Mt.not)(y)}function p(g){e.code((0,Mt._)`delete ${s}[${g}]`)}function m(g){if(c.removeAdditional==="all"||c.removeAdditional&&r===!1){p(g);return}if(r===!1){t.setParams({additionalProperty:g}),t.error(),a||e.break();return}if(typeof r=="object"&&!(0,Ma.alwaysValidSchema)(i,r)){let y=e.name("valid");c.removeAdditional==="failing"?(h(g,y,!1),e.if((0,Mt.not)(y),()=>{t.reset(),p(g)})):(h(g,y),a||e.if((0,Mt.not)(y),()=>e.break()))}}function h(g,y,$){let w={keyword:"additionalProperties",dataProp:g,dataPropType:Ma.Type.Str};$===!1&&Object.assign(w,{compositeRule:!0,createErrors:!1,allErrors:!1}),t.subschema(w,y)}}};_d.default=yI});var I_=v($d=>{"use strict";Object.defineProperty($d,"__esModule",{value:!0});var vI=ko(),z_=kt(),wd=ce(),C_=bd(),_I={keyword:"properties",type:"object",schemaType:"object",code(t){let{gen:e,schema:r,parentSchema:n,data:s,it:o}=t;o.opts.removeAdditional==="all"&&n.additionalProperties===void 0&&C_.default.code(new vI.KeywordCxt(o,C_.default,"additionalProperties"));let i=(0,z_.allSchemaProperties)(r);for(let d of i)o.definedProperties.add(d);o.opts.unevaluated&&i.length&&o.props!==!0&&(o.props=wd.mergeEvaluated.props(e,(0,wd.toHash)(i),o.props));let a=i.filter(d=>!(0,wd.alwaysValidSchema)(o,r[d]));if(a.length===0)return;let c=e.name("valid");for(let d of a)u(d)?l(d):(e.if((0,z_.propertyInData)(e,s,d,o.opts.ownProperties)),l(d),o.allErrors||e.else().var(c,!0),e.endIf()),t.it.definedProperties.add(d),t.ok(c);function u(d){return o.opts.useDefaults&&!o.compositeRule&&r[d].default!==void 0}function l(d){t.subschema({keyword:"properties",schemaProp:d,dataProp:d},c)}}};$d.default=_I});var j_=v(xd=>{"use strict";Object.defineProperty(xd,"__esModule",{value:!0});var R_=kt(),qa=Y(),O_=ce(),N_=ce(),bI={keyword:"patternProperties",type:"object",schemaType:"object",code(t){let{gen:e,schema:r,data:n,parentSchema:s,it:o}=t,{opts:i}=o,a=(0,R_.allSchemaProperties)(r),c=a.filter(h=>(0,O_.alwaysValidSchema)(o,r[h]));if(a.length===0||c.length===a.length&&(!o.opts.unevaluated||o.props===!0))return;let u=i.strictSchema&&!i.allowMatchingProperties&&s.properties,l=e.name("valid");o.props!==!0&&!(o.props instanceof qa.Name)&&(o.props=(0,N_.evaluatedPropsToName)(e,o.props));let{props:d}=o;f();function f(){for(let h of a)u&&p(h),o.allErrors?m(h):(e.var(l,!0),m(h),e.if(l))}function p(h){for(let g in u)new RegExp(h).test(g)&&(0,O_.checkStrictMode)(o,`property ${g} matches pattern ${h} (use allowMatchingProperties)`)}function m(h){e.forIn("key",n,g=>{e.if((0,qa._)`${(0,R_.usePattern)(t,h)}.test(${g})`,()=>{let y=c.includes(h);y||t.subschema({keyword:"patternProperties",schemaProp:h,dataProp:g,dataPropType:N_.Type.Str},l),o.opts.unevaluated&&d!==!0?e.assign((0,qa._)`${d}[${g}]`,!0):!y&&!o.allErrors&&e.if((0,qa.not)(l),()=>e.break())})})}}};xd.default=bI});var A_=v(kd=>{"use strict";Object.defineProperty(kd,"__esModule",{value:!0});var wI=ce(),$I={keyword:"not",schemaType:["object","boolean"],trackErrors:!0,code(t){let{gen:e,schema:r,it:n}=t;if((0,wI.alwaysValidSchema)(n,r)){t.fail();return}let s=e.name("valid");t.subschema({keyword:"not",compositeRule:!0,createErrors:!1,allErrors:!1},s),t.failResult(s,()=>t.reset(),()=>t.error())},error:{message:"must NOT be valid"}};kd.default=$I});var M_=v(Sd=>{"use strict";Object.defineProperty(Sd,"__esModule",{value:!0});var xI=kt(),kI={keyword:"anyOf",schemaType:"array",trackErrors:!0,code:xI.validateUnion,error:{message:"must match a schema in anyOf"}};Sd.default=kI});var q_=v(Pd=>{"use strict";Object.defineProperty(Pd,"__esModule",{value:!0});var Da=Y(),SI=ce(),PI={message:"must match exactly one schema in oneOf",params:({params:t})=>(0,Da._)`{passingSchemas: ${t.passing}}`},TI={keyword:"oneOf",schemaType:"array",trackErrors:!0,error:PI,code(t){let{gen:e,schema:r,parentSchema:n,it:s}=t;if(!Array.isArray(r))throw new Error("ajv implementation error");if(s.opts.discriminator&&n.discriminator)return;let o=r,i=e.let("valid",!1),a=e.let("passing",null),c=e.name("_valid");t.setParams({passing:a}),e.block(u),t.result(i,()=>t.reset(),()=>t.error(!0));function u(){o.forEach((l,d)=>{let f;(0,SI.alwaysValidSchema)(s,l)?e.var(c,!0):f=t.subschema({keyword:"oneOf",schemaProp:d,compositeRule:!0},c),d>0&&e.if((0,Da._)`${c} && ${i}`).assign(i,!1).assign(a,(0,Da._)`[${a}, ${d}]`).else(),e.if(c,()=>{e.assign(i,!0),e.assign(a,d),f&&t.mergeEvaluated(f,Da.Name)})})}}};Pd.default=TI});var D_=v(Td=>{"use strict";Object.defineProperty(Td,"__esModule",{value:!0});var EI=ce(),zI={keyword:"allOf",schemaType:"array",code(t){let{gen:e,schema:r,it:n}=t;if(!Array.isArray(r))throw new Error("ajv implementation error");let s=e.name("valid");r.forEach((o,i)=>{if((0,EI.alwaysValidSchema)(n,o))return;let a=t.subschema({keyword:"allOf",schemaProp:i},s);t.ok(s),t.mergeEvaluated(a)})}};Td.default=zI});var V_=v(Ed=>{"use strict";Object.defineProperty(Ed,"__esModule",{value:!0});var Za=Y(),L_=ce(),CI={message:({params:t})=>(0,Za.str)`must match "${t.ifClause}" schema`,params:({params:t})=>(0,Za._)`{failingKeyword: ${t.ifClause}}`},II={keyword:"if",schemaType:["object","boolean"],trackErrors:!0,error:CI,code(t){let{gen:e,parentSchema:r,it:n}=t;r.then===void 0&&r.else===void 0&&(0,L_.checkStrictMode)(n,'"if" without "then" and "else" is ignored');let s=Z_(n,"then"),o=Z_(n,"else");if(!s&&!o)return;let i=e.let("valid",!0),a=e.name("_valid");if(c(),t.reset(),s&&o){let l=e.let("ifClause");t.setParams({ifClause:l}),e.if(a,u("then",l),u("else",l))}else s?e.if(a,u("then")):e.if((0,Za.not)(a),u("else"));t.pass(i,()=>t.error(!0));function c(){let l=t.subschema({keyword:"if",compositeRule:!0,createErrors:!1,allErrors:!1},a);t.mergeEvaluated(l)}function u(l,d){return()=>{let f=t.subschema({keyword:l},a);e.assign(i,a),t.mergeValidEvaluated(f,i),d?e.assign(d,(0,Za._)`${l}`):t.setParams({ifClause:l})}}}};function Z_(t,e){let r=t.schema[e];return r!==void 0&&!(0,L_.alwaysValidSchema)(t,r)}Ed.default=II});var F_=v(zd=>{"use strict";Object.defineProperty(zd,"__esModule",{value:!0});var RI=ce(),OI={keyword:["then","else"],schemaType:["object","boolean"],code({keyword:t,parentSchema:e,it:r}){e.if===void 0&&(0,RI.checkStrictMode)(r,`"${t}" without "if" is ignored`)}};zd.default=OI});var U_=v(Cd=>{"use strict";Object.defineProperty(Cd,"__esModule",{value:!0});var NI=pd(),jI=b_(),AI=fd(),MI=$_(),qI=x_(),DI=P_(),ZI=E_(),LI=bd(),VI=I_(),FI=j_(),UI=A_(),HI=M_(),KI=q_(),BI=D_(),GI=V_(),WI=F_();function JI(t=!1){let e=[UI.default,HI.default,KI.default,BI.default,GI.default,WI.default,ZI.default,LI.default,DI.default,VI.default,FI.default];return t?e.push(jI.default,MI.default):e.push(NI.default,AI.default),e.push(qI.default),e}Cd.default=JI});var H_=v(Id=>{"use strict";Object.defineProperty(Id,"__esModule",{value:!0});var Re=Y(),YI={message:({schemaCode:t})=>(0,Re.str)`must match format "${t}"`,params:({schemaCode:t})=>(0,Re._)`{format: ${t}}`},QI={keyword:"format",type:["number","string"],schemaType:"string",$data:!0,error:YI,code(t,e){let{gen:r,data:n,$data:s,schema:o,schemaCode:i,it:a}=t,{opts:c,errSchemaPath:u,schemaEnv:l,self:d}=a;if(!c.validateFormats)return;s?f():p();function f(){let m=r.scopeValue("formats",{ref:d.formats,code:c.code.formats}),h=r.const("fDef",(0,Re._)`${m}[${i}]`),g=r.let("fType"),y=r.let("format");r.if((0,Re._)`typeof ${h} == "object" && !(${h} instanceof RegExp)`,()=>r.assign(g,(0,Re._)`${h}.type || "string"`).assign(y,(0,Re._)`${h}.validate`),()=>r.assign(g,(0,Re._)`"string"`).assign(y,h)),t.fail$data((0,Re.or)($(),w()));function $(){return c.strictSchema===!1?Re.nil:(0,Re._)`${i} && !${y}`}function w(){let S=l.$async?(0,Re._)`(${h}.async ? await ${y}(${n}) : ${y}(${n}))`:(0,Re._)`${y}(${n})`,x=(0,Re._)`(typeof ${y} == "function" ? ${S} : ${y}.test(${n}))`;return(0,Re._)`${y} && ${y} !== true && ${g} === ${e} && !${x}`}}function p(){let m=d.formats[o];if(!m){$();return}if(m===!0)return;let[h,g,y]=w(m);h===e&&t.pass(S());function $(){if(c.strictSchema===!1){d.logger.warn(x());return}throw new Error(x());function x(){return`unknown format "${o}" ignored in schema at path "${u}"`}}function w(x){let C=x instanceof RegExp?(0,Re.regexpCode)(x):c.code.formats?(0,Re._)`${c.code.formats}${(0,Re.getProperty)(o)}`:void 0,ee=r.scopeValue("formats",{key:o,ref:x,code:C});return typeof x=="object"&&!(x instanceof RegExp)?[x.type||"string",x.validate,(0,Re._)`${ee}.validate`]:["string",x,ee]}function S(){if(typeof m=="object"&&!(m instanceof RegExp)&&m.async){if(!l.$async)throw new Error("async format in sync schema");return(0,Re._)`await ${y}(${n})`}return typeof g=="function"?(0,Re._)`${y}(${n})`:(0,Re._)`${y}.test(${n})`}}}};Id.default=QI});var K_=v(Rd=>{"use strict";Object.defineProperty(Rd,"__esModule",{value:!0});var XI=H_(),eR=[XI.default];Rd.default=eR});var B_=v(fs=>{"use strict";Object.defineProperty(fs,"__esModule",{value:!0});fs.contentVocabulary=fs.metadataVocabulary=void 0;fs.metadataVocabulary=["title","description","default","deprecated","readOnly","writeOnly","examples"];fs.contentVocabulary=["contentMediaType","contentEncoding","contentSchema"]});var W_=v(Od=>{"use strict";Object.defineProperty(Od,"__esModule",{value:!0});var tR=r_(),rR=g_(),nR=U_(),sR=K_(),G_=B_(),oR=[tR.default,rR.default,(0,nR.default)(),sR.default,G_.metadataVocabulary,G_.contentVocabulary];Od.default=oR});var Y_=v(La=>{"use strict";Object.defineProperty(La,"__esModule",{value:!0});La.DiscrError=void 0;var J_;(function(t){t.Tag="tag",t.Mapping="mapping"})(J_||(La.DiscrError=J_={}))});var X_=v(jd=>{"use strict";Object.defineProperty(jd,"__esModule",{value:!0});var ms=Y(),Nd=Y_(),Q_=$a(),iR=So(),aR=ce(),cR={message:({params:{discrError:t,tagName:e}})=>t===Nd.DiscrError.Tag?`tag "${e}" must be string`:`value of tag "${e}" must be in oneOf`,params:({params:{discrError:t,tag:e,tagName:r}})=>(0,ms._)`{error: ${t}, tag: ${r}, tagValue: ${e}}`},uR={keyword:"discriminator",type:"object",schemaType:"object",error:cR,code(t){let{gen:e,data:r,schema:n,parentSchema:s,it:o}=t,{oneOf:i}=s;if(!o.opts.discriminator)throw new Error("discriminator: requires discriminator option");let a=n.propertyName;if(typeof a!="string")throw new Error("discriminator: requires propertyName");if(n.mapping)throw new Error("discriminator: mapping is not supported");if(!i)throw new Error("discriminator: requires oneOf keyword");let c=e.let("valid",!1),u=e.const("tag",(0,ms._)`${r}${(0,ms.getProperty)(a)}`);e.if((0,ms._)`typeof ${u} == "string"`,()=>l(),()=>t.error(!1,{discrError:Nd.DiscrError.Tag,tag:u,tagName:a})),t.ok(c);function l(){let p=f();e.if(!1);for(let m in p)e.elseIf((0,ms._)`${u} === ${m}`),e.assign(c,d(p[m]));e.else(),t.error(!1,{discrError:Nd.DiscrError.Mapping,tag:u,tagName:a}),e.endIf()}function d(p){let m=e.name("valid"),h=t.subschema({keyword:"oneOf",schemaProp:p},m);return t.mergeEvaluated(h,ms.Name),m}function f(){var p;let m={},h=y(s),g=!0;for(let S=0;S<i.length;S++){let x=i[S];if(x?.$ref&&!(0,aR.schemaHasRulesButRef)(x,o.self.RULES)){let ee=x.$ref;if(x=Q_.resolveRef.call(o.self,o.schemaEnv.root,o.baseId,ee),x instanceof Q_.SchemaEnv&&(x=x.schema),x===void 0)throw new iR.default(o.opts.uriResolver,o.baseId,ee)}let C=(p=x?.properties)===null||p===void 0?void 0:p[a];if(typeof C!="object")throw new Error(`discriminator: oneOf subschemas (or referenced schemas) must have "properties/${a}"`);g=g&&(h||y(x)),$(C,S)}if(!g)throw new Error(`discriminator: "${a}" must be required`);return m;function y({required:S}){return Array.isArray(S)&&S.includes(a)}function $(S,x){if(S.const)w(S.const,x);else if(S.enum)for(let C of S.enum)w(C,x);else throw new Error(`discriminator: "properties/${a}" must have "const" or "enum"`)}function w(S,x){if(typeof S!="string"||S in m)throw new Error(`discriminator: "${a}" values must be unique strings`);m[S]=x}}}};jd.default=uR});var e0=v((yV,lR)=>{lR.exports={$schema:"http://json-schema.org/draft-07/schema#",$id:"http://json-schema.org/draft-07/schema#",title:"Core schema meta-schema",definitions:{schemaArray:{type:"array",minItems:1,items:{$ref:"#"}},nonNegativeInteger:{type:"integer",minimum:0},nonNegativeIntegerDefault0:{allOf:[{$ref:"#/definitions/nonNegativeInteger"},{default:0}]},simpleTypes:{enum:["array","boolean","integer","null","number","object","string"]},stringArray:{type:"array",items:{type:"string"},uniqueItems:!0,default:[]}},type:["object","boolean"],properties:{$id:{type:"string",format:"uri-reference"},$schema:{type:"string",format:"uri"},$ref:{type:"string",format:"uri-reference"},$comment:{type:"string"},title:{type:"string"},description:{type:"string"},default:!0,readOnly:{type:"boolean",default:!1},examples:{type:"array",items:!0},multipleOf:{type:"number",exclusiveMinimum:0},maximum:{type:"number"},exclusiveMaximum:{type:"number"},minimum:{type:"number"},exclusiveMinimum:{type:"number"},maxLength:{$ref:"#/definitions/nonNegativeInteger"},minLength:{$ref:"#/definitions/nonNegativeIntegerDefault0"},pattern:{type:"string",format:"regex"},additionalItems:{$ref:"#"},items:{anyOf:[{$ref:"#"},{$ref:"#/definitions/schemaArray"}],default:!0},maxItems:{$ref:"#/definitions/nonNegativeInteger"},minItems:{$ref:"#/definitions/nonNegativeIntegerDefault0"},uniqueItems:{type:"boolean",default:!1},contains:{$ref:"#"},maxProperties:{$ref:"#/definitions/nonNegativeInteger"},minProperties:{$ref:"#/definitions/nonNegativeIntegerDefault0"},required:{$ref:"#/definitions/stringArray"},additionalProperties:{$ref:"#"},definitions:{type:"object",additionalProperties:{$ref:"#"},default:{}},properties:{type:"object",additionalProperties:{$ref:"#"},default:{}},patternProperties:{type:"object",additionalProperties:{$ref:"#"},propertyNames:{format:"regex"},default:{}},dependencies:{type:"object",additionalProperties:{anyOf:[{$ref:"#"},{$ref:"#/definitions/stringArray"}]}},propertyNames:{$ref:"#"},const:!0,enum:{type:"array",items:!0,minItems:1,uniqueItems:!0},type:{anyOf:[{$ref:"#/definitions/simpleTypes"},{type:"array",items:{$ref:"#/definitions/simpleTypes"},minItems:1,uniqueItems:!0}]},format:{type:"string"},contentMediaType:{type:"string"},contentEncoding:{type:"string"},if:{$ref:"#"},then:{$ref:"#"},else:{$ref:"#"},allOf:{$ref:"#/definitions/schemaArray"},anyOf:{$ref:"#/definitions/schemaArray"},oneOf:{$ref:"#/definitions/schemaArray"},not:{$ref:"#"}},default:!0}});var r0=v((Pe,Ad)=>{"use strict";Object.defineProperty(Pe,"__esModule",{value:!0});Pe.MissingRefError=Pe.ValidationError=Pe.CodeGen=Pe.Name=Pe.nil=Pe.stringify=Pe.str=Pe._=Pe.KeywordCxt=Pe.Ajv=void 0;var dR=Jv(),pR=W_(),fR=X_(),t0=e0(),mR=["/properties"],Va="http://json-schema.org/draft-07/schema",hs=class extends dR.default{_addVocabularies(){super._addVocabularies(),pR.default.forEach(e=>this.addVocabulary(e)),this.opts.discriminator&&this.addKeyword(fR.default)}_addDefaultMetaSchema(){if(super._addDefaultMetaSchema(),!this.opts.meta)return;let e=this.opts.$data?this.$dataMetaSchema(t0,mR):t0;this.addMetaSchema(e,Va,!1),this.refs["http://json-schema.org/schema"]=Va}defaultMeta(){return this.opts.defaultMeta=super.defaultMeta()||(this.getSchema(Va)?Va:void 0)}};Pe.Ajv=hs;Ad.exports=Pe=hs;Ad.exports.Ajv=hs;Object.defineProperty(Pe,"__esModule",{value:!0});Pe.default=hs;var hR=ko();Object.defineProperty(Pe,"KeywordCxt",{enumerable:!0,get:function(){return hR.KeywordCxt}});var gs=Y();Object.defineProperty(Pe,"_",{enumerable:!0,get:function(){return gs._}});Object.defineProperty(Pe,"str",{enumerable:!0,get:function(){return gs.str}});Object.defineProperty(Pe,"stringify",{enumerable:!0,get:function(){return gs.stringify}});Object.defineProperty(Pe,"nil",{enumerable:!0,get:function(){return gs.nil}});Object.defineProperty(Pe,"Name",{enumerable:!0,get:function(){return gs.Name}});Object.defineProperty(Pe,"CodeGen",{enumerable:!0,get:function(){return gs.CodeGen}});var gR=ba();Object.defineProperty(Pe,"ValidationError",{enumerable:!0,get:function(){return gR.default}});var yR=So();Object.defineProperty(Pe,"MissingRefError",{enumerable:!0,get:function(){return yR.default}})});var l0=v(nr=>{"use strict";Object.defineProperty(nr,"__esModule",{value:!0});nr.formatNames=nr.fastFormats=nr.fullFormats=void 0;function rr(t,e){return{validate:t,compare:e}}nr.fullFormats={date:rr(i0,Zd),time:rr(qd(!0),Ld),"date-time":rr(n0(!0),c0),"iso-time":rr(qd(),a0),"iso-date-time":rr(n0(),u0),duration:/^P(?!$)((\d+Y)?(\d+M)?(\d+D)?(T(?=\d)(\d+H)?(\d+M)?(\d+S)?)?|(\d+W)?)$/,uri:xR,"uri-reference":/^(?:[a-z][a-z0-9+\-.]*:)?(?:\/?\/(?:(?:[a-z0-9\-._~!$&'()*+,;=:]|%[0-9a-f]{2})*@)?(?:\[(?:(?:(?:(?:[0-9a-f]{1,4}:){6}|::(?:[0-9a-f]{1,4}:){5}|(?:[0-9a-f]{1,4})?::(?:[0-9a-f]{1,4}:){4}|(?:(?:[0-9a-f]{1,4}:){0,1}[0-9a-f]{1,4})?::(?:[0-9a-f]{1,4}:){3}|(?:(?:[0-9a-f]{1,4}:){0,2}[0-9a-f]{1,4})?::(?:[0-9a-f]{1,4}:){2}|(?:(?:[0-9a-f]{1,4}:){0,3}[0-9a-f]{1,4})?::[0-9a-f]{1,4}:|(?:(?:[0-9a-f]{1,4}:){0,4}[0-9a-f]{1,4})?::)(?:[0-9a-f]{1,4}:[0-9a-f]{1,4}|(?:(?:25[0-5]|2[0-4]\d|[01]?\d\d?)\.){3}(?:25[0-5]|2[0-4]\d|[01]?\d\d?))|(?:(?:[0-9a-f]{1,4}:){0,5}[0-9a-f]{1,4})?::[0-9a-f]{1,4}|(?:(?:[0-9a-f]{1,4}:){0,6}[0-9a-f]{1,4})?::)|[Vv][0-9a-f]+\.[a-z0-9\-._~!$&'()*+,;=:]+)\]|(?:(?:25[0-5]|2[0-4]\d|[01]?\d\d?)\.){3}(?:25[0-5]|2[0-4]\d|[01]?\d\d?)|(?:[a-z0-9\-._~!$&'"()*+,;=]|%[0-9a-f]{2})*)(?::\d*)?(?:\/(?:[a-z0-9\-._~!$&'"()*+,;=:@]|%[0-9a-f]{2})*)*|\/(?:(?:[a-z0-9\-._~!$&'"()*+,;=:@]|%[0-9a-f]{2})+(?:\/(?:[a-z0-9\-._~!$&'"()*+,;=:@]|%[0-9a-f]{2})*)*)?|(?:[a-z0-9\-._~!$&'"()*+,;=:@]|%[0-9a-f]{2})+(?:\/(?:[a-z0-9\-._~!$&'"()*+,;=:@]|%[0-9a-f]{2})*)*)?(?:\?(?:[a-z0-9\-._~!$&'"()*+,;=:@/?]|%[0-9a-f]{2})*)?(?:#(?:[a-z0-9\-._~!$&'"()*+,;=:@/?]|%[0-9a-f]{2})*)?$/i,"uri-template":/^(?:(?:[^\x00-\x20"'<>%\\^`{|}]|%[0-9a-f]{2})|\{[+#./;?&=,!@|]?(?:[a-z0-9_]|%[0-9a-f]{2})+(?::[1-9][0-9]{0,3}|\*)?(?:,(?:[a-z0-9_]|%[0-9a-f]{2})+(?::[1-9][0-9]{0,3}|\*)?)*\})*$/i,url:/^(?:https?|ftp):\/\/(?:\S+(?::\S*)?@)?(?:(?!(?:10|127)(?:\.\d{1,3}){3})(?!(?:169\.254|192\.168)(?:\.\d{1,3}){2})(?!172\.(?:1[6-9]|2\d|3[0-1])(?:\.\d{1,3}){2})(?:[1-9]\d?|1\d\d|2[01]\d|22[0-3])(?:\.(?:1?\d{1,2}|2[0-4]\d|25[0-5])){2}(?:\.(?:[1-9]\d?|1\d\d|2[0-4]\d|25[0-4]))|(?:(?:[a-z0-9\u{00a1}-\u{ffff}]+-)*[a-z0-9\u{00a1}-\u{ffff}]+)(?:\.(?:[a-z0-9\u{00a1}-\u{ffff}]+-)*[a-z0-9\u{00a1}-\u{ffff}]+)*(?:\.(?:[a-z\u{00a1}-\u{ffff}]{2,})))(?::\d{2,5})?(?:\/[^\s]*)?$/iu,email:/^[a-z0-9!#$%&'*+/=?^_`{|}~-]+(?:\.[a-z0-9!#$%&'*+/=?^_`{|}~-]+)*@(?:[a-z0-9](?:[a-z0-9-]*[a-z0-9])?\.)+[a-z0-9](?:[a-z0-9-]*[a-z0-9])?$/i,hostname:/^(?=.{1,253}\.?$)[a-z0-9](?:[a-z0-9-]{0,61}[a-z0-9])?(?:\.[a-z0-9](?:[-0-9a-z]{0,61}[0-9a-z])?)*\.?$/i,ipv4:/^(?:(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)\.){3}(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)$/,ipv6:/^((([0-9a-f]{1,4}:){7}([0-9a-f]{1,4}|:))|(([0-9a-f]{1,4}:){6}(:[0-9a-f]{1,4}|((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3})|:))|(([0-9a-f]{1,4}:){5}(((:[0-9a-f]{1,4}){1,2})|:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3})|:))|(([0-9a-f]{1,4}:){4}(((:[0-9a-f]{1,4}){1,3})|((:[0-9a-f]{1,4})?:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(([0-9a-f]{1,4}:){3}(((:[0-9a-f]{1,4}){1,4})|((:[0-9a-f]{1,4}){0,2}:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(([0-9a-f]{1,4}:){2}(((:[0-9a-f]{1,4}){1,5})|((:[0-9a-f]{1,4}){0,3}:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(([0-9a-f]{1,4}:){1}(((:[0-9a-f]{1,4}){1,6})|((:[0-9a-f]{1,4}){0,4}:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(:(((:[0-9a-f]{1,4}){1,7})|((:[0-9a-f]{1,4}){0,5}:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:)))$/i,regex:CR,uuid:/^(?:urn:uuid:)?[0-9a-f]{8}-(?:[0-9a-f]{4}-){3}[0-9a-f]{12}$/i,"json-pointer":/^(?:\/(?:[^~/]|~0|~1)*)*$/,"json-pointer-uri-fragment":/^#(?:\/(?:[a-z0-9_\-.!$&'()*+,;:=@]|%[0-9a-f]{2}|~0|~1)*)*$/i,"relative-json-pointer":/^(?:0|[1-9][0-9]*)(?:#|(?:\/(?:[^~/]|~0|~1)*)*)$/,byte:kR,int32:{type:"number",validate:TR},int64:{type:"number",validate:ER},float:{type:"number",validate:o0},double:{type:"number",validate:o0},password:!0,binary:!0};nr.fastFormats={...nr.fullFormats,date:rr(/^\d\d\d\d-[0-1]\d-[0-3]\d$/,Zd),time:rr(/^(?:[0-2]\d:[0-5]\d:[0-5]\d|23:59:60)(?:\.\d+)?(?:z|[+-]\d\d(?::?\d\d)?)$/i,Ld),"date-time":rr(/^\d\d\d\d-[0-1]\d-[0-3]\dt(?:[0-2]\d:[0-5]\d:[0-5]\d|23:59:60)(?:\.\d+)?(?:z|[+-]\d\d(?::?\d\d)?)$/i,c0),"iso-time":rr(/^(?:[0-2]\d:[0-5]\d:[0-5]\d|23:59:60)(?:\.\d+)?(?:z|[+-]\d\d(?::?\d\d)?)?$/i,a0),"iso-date-time":rr(/^\d\d\d\d-[0-1]\d-[0-3]\d[t\s](?:[0-2]\d:[0-5]\d:[0-5]\d|23:59:60)(?:\.\d+)?(?:z|[+-]\d\d(?::?\d\d)?)?$/i,u0),uri:/^(?:[a-z][a-z0-9+\-.]*:)(?:\/?\/)?[^\s]*$/i,"uri-reference":/^(?:(?:[a-z][a-z0-9+\-.]*:)?\/?\/)?(?:[^\\\s#][^\s#]*)?(?:#[^\\\s]*)?$/i,email:/^[a-z0-9.!#$%&'*+/=?^_`{|}~-]+@[a-z0-9](?:[a-z0-9-]{0,61}[a-z0-9])?(?:\.[a-z0-9](?:[a-z0-9-]{0,61}[a-z0-9])?)*$/i};nr.formatNames=Object.keys(nr.fullFormats);function vR(t){return t%4===0&&(t%100!==0||t%400===0)}var _R=/^(\d\d\d\d)-(\d\d)-(\d\d)$/,bR=[0,31,28,31,30,31,30,31,31,30,31,30,31];function i0(t){let e=_R.exec(t);if(!e)return!1;let r=+e[1],n=+e[2],s=+e[3];return n>=1&&n<=12&&s>=1&&s<=(n===2&&vR(r)?29:bR[n])}function Zd(t,e){if(t&&e)return t>e?1:t<e?-1:0}var Md=/^(\d\d):(\d\d):(\d\d(?:\.\d+)?)(z|([+-])(\d\d)(?::?(\d\d))?)?$/i;function qd(t){return function(r){let n=Md.exec(r);if(!n)return!1;let s=+n[1],o=+n[2],i=+n[3],a=n[4],c=n[5]==="-"?-1:1,u=+(n[6]||0),l=+(n[7]||0);if(u>23||l>59||t&&!a)return!1;if(s<=23&&o<=59&&i<60)return!0;let d=o-l*c,f=s-u*c-(d<0?1:0);return(f===23||f===-1)&&(d===59||d===-1)&&i<61}}function Ld(t,e){if(!(t&&e))return;let r=new Date("2020-01-01T"+t).valueOf(),n=new Date("2020-01-01T"+e).valueOf();if(r&&n)return r-n}function a0(t,e){if(!(t&&e))return;let r=Md.exec(t),n=Md.exec(e);if(r&&n)return t=r[1]+r[2]+r[3],e=n[1]+n[2]+n[3],t>e?1:t<e?-1:0}var Dd=/t|\s/i;function n0(t){let e=qd(t);return function(n){let s=n.split(Dd);return s.length===2&&i0(s[0])&&e(s[1])}}function c0(t,e){if(!(t&&e))return;let r=new Date(t).valueOf(),n=new Date(e).valueOf();if(r&&n)return r-n}function u0(t,e){if(!(t&&e))return;let[r,n]=t.split(Dd),[s,o]=e.split(Dd),i=Zd(r,s);if(i!==void 0)return i||Ld(n,o)}var wR=/\/|:/,$R=/^(?:[a-z][a-z0-9+\-.]*:)(?:\/?\/(?:(?:[a-z0-9\-._~!$&'()*+,;=:]|%[0-9a-f]{2})*@)?(?:\[(?:(?:(?:(?:[0-9a-f]{1,4}:){6}|::(?:[0-9a-f]{1,4}:){5}|(?:[0-9a-f]{1,4})?::(?:[0-9a-f]{1,4}:){4}|(?:(?:[0-9a-f]{1,4}:){0,1}[0-9a-f]{1,4})?::(?:[0-9a-f]{1,4}:){3}|(?:(?:[0-9a-f]{1,4}:){0,2}[0-9a-f]{1,4})?::(?:[0-9a-f]{1,4}:){2}|(?:(?:[0-9a-f]{1,4}:){0,3}[0-9a-f]{1,4})?::[0-9a-f]{1,4}:|(?:(?:[0-9a-f]{1,4}:){0,4}[0-9a-f]{1,4})?::)(?:[0-9a-f]{1,4}:[0-9a-f]{1,4}|(?:(?:25[0-5]|2[0-4]\d|[01]?\d\d?)\.){3}(?:25[0-5]|2[0-4]\d|[01]?\d\d?))|(?:(?:[0-9a-f]{1,4}:){0,5}[0-9a-f]{1,4})?::[0-9a-f]{1,4}|(?:(?:[0-9a-f]{1,4}:){0,6}[0-9a-f]{1,4})?::)|[Vv][0-9a-f]+\.[a-z0-9\-._~!$&'()*+,;=:]+)\]|(?:(?:25[0-5]|2[0-4]\d|[01]?\d\d?)\.){3}(?:25[0-5]|2[0-4]\d|[01]?\d\d?)|(?:[a-z0-9\-._~!$&'()*+,;=]|%[0-9a-f]{2})*)(?::\d*)?(?:\/(?:[a-z0-9\-._~!$&'()*+,;=:@]|%[0-9a-f]{2})*)*|\/(?:(?:[a-z0-9\-._~!$&'()*+,;=:@]|%[0-9a-f]{2})+(?:\/(?:[a-z0-9\-._~!$&'()*+,;=:@]|%[0-9a-f]{2})*)*)?|(?:[a-z0-9\-._~!$&'()*+,;=:@]|%[0-9a-f]{2})+(?:\/(?:[a-z0-9\-._~!$&'()*+,;=:@]|%[0-9a-f]{2})*)*)(?:\?(?:[a-z0-9\-._~!$&'()*+,;=:@/?]|%[0-9a-f]{2})*)?(?:#(?:[a-z0-9\-._~!$&'()*+,;=:@/?]|%[0-9a-f]{2})*)?$/i;function xR(t){return wR.test(t)&&$R.test(t)}var s0=/^(?:[A-Za-z0-9+/]{4})*(?:[A-Za-z0-9+/]{2}==|[A-Za-z0-9+/]{3}=)?$/gm;function kR(t){return s0.lastIndex=0,s0.test(t)}var SR=-(2**31),PR=2**31-1;function TR(t){return Number.isInteger(t)&&t<=PR&&t>=SR}function ER(t){return Number.isInteger(t)}function o0(){return!0}var zR=/[^\\]\\Z/;function CR(t){if(zR.test(t))return!1;try{return new RegExp(t),!0}catch{return!1}}});var Lo=v(ue=>{"use strict";Object.defineProperty(ue,"__esModule",{value:!0});ue.regexpCode=ue.getEsmExportName=ue.getProperty=ue.safeStringify=ue.stringify=ue.strConcat=ue.addCodeArg=ue.str=ue._=ue.nil=ue._Code=ue.Name=ue.IDENTIFIER=ue._CodeOrName=void 0;var Do=class{};ue._CodeOrName=Do;ue.IDENTIFIER=/^[a-z$_][a-z$_0-9]*$/i;var Cn=class extends Do{constructor(e){if(super(),!ue.IDENTIFIER.test(e))throw new Error("CodeGen: name must be a valid identifier");this.str=e}toString(){return this.str}emptyStr(){return!1}get names(){return{[this.str]:1}}};ue.Name=Cn;var Tt=class extends Do{constructor(e){super(),this._items=typeof e=="string"?[e]:e}toString(){return this.str}emptyStr(){if(this._items.length>1)return!1;let e=this._items[0];return e===""||e==='""'}get str(){var e;return(e=this._str)!==null&&e!==void 0?e:this._str=this._items.reduce((r,n)=>`${r}${n}`,"")}get names(){var e;return(e=this._names)!==null&&e!==void 0?e:this._names=this._items.reduce((r,n)=>(n instanceof Cn&&(r[n.str]=(r[n.str]||0)+1),r),{})}};ue._Code=Tt;ue.nil=new Tt("");function d0(t,...e){let r=[t[0]],n=0;for(;n<e.length;)Fd(r,e[n]),r.push(t[++n]);return new Tt(r)}ue._=d0;var Vd=new Tt("+");function p0(t,...e){let r=[Zo(t[0])],n=0;for(;n<e.length;)r.push(Vd),Fd(r,e[n]),r.push(Vd,Zo(t[++n]));return IR(r),new Tt(r)}ue.str=p0;function Fd(t,e){e instanceof Tt?t.push(...e._items):e instanceof Cn?t.push(e):t.push(NR(e))}ue.addCodeArg=Fd;function IR(t){let e=1;for(;e<t.length-1;){if(t[e]===Vd){let r=RR(t[e-1],t[e+1]);if(r!==void 0){t.splice(e-1,3,r);continue}t[e++]="+"}e++}}function RR(t,e){if(e==='""')return t;if(t==='""')return e;if(typeof t=="string")return e instanceof Cn||t[t.length-1]!=='"'?void 0:typeof e!="string"?`${t.slice(0,-1)}${e}"`:e[0]==='"'?t.slice(0,-1)+e.slice(1):void 0;if(typeof e=="string"&&e[0]==='"'&&!(t instanceof Cn))return`"${t}${e.slice(1)}`}function OR(t,e){return e.emptyStr()?t:t.emptyStr()?e:p0`${t}${e}`}ue.strConcat=OR;function NR(t){return typeof t=="number"||typeof t=="boolean"||t===null?t:Zo(Array.isArray(t)?t.join(","):t)}function jR(t){return new Tt(Zo(t))}ue.stringify=jR;function Zo(t){return JSON.stringify(t).replace(/\u2028/g,"\\u2028").replace(/\u2029/g,"\\u2029")}ue.safeStringify=Zo;function AR(t){return typeof t=="string"&&ue.IDENTIFIER.test(t)?new Tt(`.${t}`):d0`[${t}]`}ue.getProperty=AR;function MR(t){if(typeof t=="string"&&ue.IDENTIFIER.test(t))return new Tt(`${t}`);throw new Error(`CodeGen: invalid export name: ${t}, use explicit $id name mapping`)}ue.getEsmExportName=MR;function qR(t){return new Tt(t.toString())}ue.regexpCode=qR});var Kd=v(mt=>{"use strict";Object.defineProperty(mt,"__esModule",{value:!0});mt.ValueScope=mt.ValueScopeName=mt.Scope=mt.varKinds=mt.UsedValueState=void 0;var ft=Lo(),Ud=class extends Error{constructor(e){super(`CodeGen: "code" for ${e} not defined`),this.value=e.value}},Fa;(function(t){t[t.Started=0]="Started",t[t.Completed=1]="Completed"})(Fa||(mt.UsedValueState=Fa={}));mt.varKinds={const:new ft.Name("const"),let:new ft.Name("let"),var:new ft.Name("var")};var Ua=class{constructor({prefixes:e,parent:r}={}){this._names={},this._prefixes=e,this._parent=r}toName(e){return e instanceof ft.Name?e:this.name(e)}name(e){return new ft.Name(this._newName(e))}_newName(e){let r=this._names[e]||this._nameGroup(e);return`${e}${r.index++}`}_nameGroup(e){var r,n;if(!((n=(r=this._parent)===null||r===void 0?void 0:r._prefixes)===null||n===void 0)&&n.has(e)||this._prefixes&&!this._prefixes.has(e))throw new Error(`CodeGen: prefix "${e}" is not allowed in this scope`);return this._names[e]={prefix:e,index:0}}};mt.Scope=Ua;var Ha=class extends ft.Name{constructor(e,r){super(r),this.prefix=e}setValue(e,{property:r,itemIndex:n}){this.value=e,this.scopePath=(0,ft._)`.${new ft.Name(r)}[${n}]`}};mt.ValueScopeName=Ha;var DR=(0,ft._)`\n`,Hd=class extends Ua{constructor(e){super(e),this._values={},this._scope=e.scope,this.opts={...e,_n:e.lines?DR:ft.nil}}get(){return this._scope}name(e){return new Ha(e,this._newName(e))}value(e,r){var n;if(r.ref===void 0)throw new Error("CodeGen: ref must be passed in value");let s=this.toName(e),{prefix:o}=s,i=(n=r.key)!==null&&n!==void 0?n:r.ref,a=this._values[o];if(a){let l=a.get(i);if(l)return l}else a=this._values[o]=new Map;a.set(i,s);let c=this._scope[o]||(this._scope[o]=[]),u=c.length;return c[u]=r.ref,s.setValue(r,{property:o,itemIndex:u}),s}getValue(e,r){let n=this._values[e];if(n)return n.get(r)}scopeRefs(e,r=this._values){return this._reduceValues(r,n=>{if(n.scopePath===void 0)throw new Error(`CodeGen: name "${n}" has no value`);return(0,ft._)`${e}${n.scopePath}`})}scopeCode(e=this._values,r,n){return this._reduceValues(e,s=>{if(s.value===void 0)throw new Error(`CodeGen: name "${s}" has no value`);return s.value.code},r,n)}_reduceValues(e,r,n={},s){let o=ft.nil;for(let i in e){let a=e[i];if(!a)continue;let c=n[i]=n[i]||new Map;a.forEach(u=>{if(c.has(u))return;c.set(u,Fa.Started);let l=r(u);if(l){let d=this.opts.es5?mt.varKinds.var:mt.varKinds.const;o=(0,ft._)`${o}${d} ${u} = ${l};${this.opts._n}`}else if(l=s?.(u))o=(0,ft._)`${o}${l}${this.opts._n}`;else throw new Ud(u);c.set(u,Fa.Completed)})}return o}};mt.ValueScope=Hd});var G=v(J=>{"use strict";Object.defineProperty(J,"__esModule",{value:!0});J.or=J.and=J.not=J.CodeGen=J.operators=J.varKinds=J.ValueScopeName=J.ValueScope=J.Scope=J.Name=J.regexpCode=J.stringify=J.getProperty=J.nil=J.strConcat=J.str=J._=void 0;var se=Lo(),qt=Kd(),Zr=Lo();Object.defineProperty(J,"_",{enumerable:!0,get:function(){return Zr._}});Object.defineProperty(J,"str",{enumerable:!0,get:function(){return Zr.str}});Object.defineProperty(J,"strConcat",{enumerable:!0,get:function(){return Zr.strConcat}});Object.defineProperty(J,"nil",{enumerable:!0,get:function(){return Zr.nil}});Object.defineProperty(J,"getProperty",{enumerable:!0,get:function(){return Zr.getProperty}});Object.defineProperty(J,"stringify",{enumerable:!0,get:function(){return Zr.stringify}});Object.defineProperty(J,"regexpCode",{enumerable:!0,get:function(){return Zr.regexpCode}});Object.defineProperty(J,"Name",{enumerable:!0,get:function(){return Zr.Name}});var Wa=Kd();Object.defineProperty(J,"Scope",{enumerable:!0,get:function(){return Wa.Scope}});Object.defineProperty(J,"ValueScope",{enumerable:!0,get:function(){return Wa.ValueScope}});Object.defineProperty(J,"ValueScopeName",{enumerable:!0,get:function(){return Wa.ValueScopeName}});Object.defineProperty(J,"varKinds",{enumerable:!0,get:function(){return Wa.varKinds}});J.operators={GT:new se._Code(">"),GTE:new se._Code(">="),LT:new se._Code("<"),LTE:new se._Code("<="),EQ:new se._Code("==="),NEQ:new se._Code("!=="),NOT:new se._Code("!"),OR:new se._Code("||"),AND:new se._Code("&&"),ADD:new se._Code("+")};var br=class{optimizeNodes(){return this}optimizeNames(e,r){return this}},Bd=class extends br{constructor(e,r,n){super(),this.varKind=e,this.name=r,this.rhs=n}render({es5:e,_n:r}){let n=e?qt.varKinds.var:this.varKind,s=this.rhs===void 0?"":` = ${this.rhs}`;return`${n} ${this.name}${s};`+r}optimizeNames(e,r){if(e[this.name.str])return this.rhs&&(this.rhs=vs(this.rhs,e,r)),this}get names(){return this.rhs instanceof se._CodeOrName?this.rhs.names:{}}},Ka=class extends br{constructor(e,r,n){super(),this.lhs=e,this.rhs=r,this.sideEffects=n}render({_n:e}){return`${this.lhs} = ${this.rhs};`+e}optimizeNames(e,r){if(!(this.lhs instanceof se.Name&&!e[this.lhs.str]&&!this.sideEffects))return this.rhs=vs(this.rhs,e,r),this}get names(){let e=this.lhs instanceof se.Name?{}:{...this.lhs.names};return Ga(e,this.rhs)}},Gd=class extends Ka{constructor(e,r,n,s){super(e,n,s),this.op=r}render({_n:e}){return`${this.lhs} ${this.op}= ${this.rhs};`+e}},Wd=class extends br{constructor(e){super(),this.label=e,this.names={}}render({_n:e}){return`${this.label}:`+e}},Jd=class extends br{constructor(e){super(),this.label=e,this.names={}}render({_n:e}){return`break${this.label?` ${this.label}`:""};`+e}},Yd=class extends br{constructor(e){super(),this.error=e}render({_n:e}){return`throw ${this.error};`+e}get names(){return this.error.names}},Qd=class extends br{constructor(e){super(),this.code=e}render({_n:e}){return`${this.code};`+e}optimizeNodes(){return`${this.code}`?this:void 0}optimizeNames(e,r){return this.code=vs(this.code,e,r),this}get names(){return this.code instanceof se._CodeOrName?this.code.names:{}}},Vo=class extends br{constructor(e=[]){super(),this.nodes=e}render(e){return this.nodes.reduce((r,n)=>r+n.render(e),"")}optimizeNodes(){let{nodes:e}=this,r=e.length;for(;r--;){let n=e[r].optimizeNodes();Array.isArray(n)?e.splice(r,1,...n):n?e[r]=n:e.splice(r,1)}return e.length>0?this:void 0}optimizeNames(e,r){let{nodes:n}=this,s=n.length;for(;s--;){let o=n[s];o.optimizeNames(e,r)||(ZR(e,o.names),n.splice(s,1))}return n.length>0?this:void 0}get names(){return this.nodes.reduce((e,r)=>On(e,r.names),{})}},wr=class extends Vo{render(e){return"{"+e._n+super.render(e)+"}"+e._n}},Xd=class extends Vo{},ys=class extends wr{};ys.kind="else";var In=class t extends wr{constructor(e,r){super(r),this.condition=e}render(e){let r=`if(${this.condition})`+super.render(e);return this.else&&(r+="else "+this.else.render(e)),r}optimizeNodes(){super.optimizeNodes();let e=this.condition;if(e===!0)return this.nodes;let r=this.else;if(r){let n=r.optimizeNodes();r=this.else=Array.isArray(n)?new ys(n):n}if(r)return e===!1?r instanceof t?r:r.nodes:this.nodes.length?this:new t(f0(e),r instanceof t?[r]:r.nodes);if(!(e===!1||!this.nodes.length))return this}optimizeNames(e,r){var n;if(this.else=(n=this.else)===null||n===void 0?void 0:n.optimizeNames(e,r),!!(super.optimizeNames(e,r)||this.else))return this.condition=vs(this.condition,e,r),this}get names(){let e=super.names;return Ga(e,this.condition),this.else&&On(e,this.else.names),e}};In.kind="if";var Rn=class extends wr{};Rn.kind="for";var ep=class extends Rn{constructor(e){super(),this.iteration=e}render(e){return`for(${this.iteration})`+super.render(e)}optimizeNames(e,r){if(super.optimizeNames(e,r))return this.iteration=vs(this.iteration,e,r),this}get names(){return On(super.names,this.iteration.names)}},tp=class extends Rn{constructor(e,r,n,s){super(),this.varKind=e,this.name=r,this.from=n,this.to=s}render(e){let r=e.es5?qt.varKinds.var:this.varKind,{name:n,from:s,to:o}=this;return`for(${r} ${n}=${s}; ${n}<${o}; ${n}++)`+super.render(e)}get names(){let e=Ga(super.names,this.from);return Ga(e,this.to)}},Ba=class extends Rn{constructor(e,r,n,s){super(),this.loop=e,this.varKind=r,this.name=n,this.iterable=s}render(e){return`for(${this.varKind} ${this.name} ${this.loop} ${this.iterable})`+super.render(e)}optimizeNames(e,r){if(super.optimizeNames(e,r))return this.iterable=vs(this.iterable,e,r),this}get names(){return On(super.names,this.iterable.names)}},Fo=class extends wr{constructor(e,r,n){super(),this.name=e,this.args=r,this.async=n}render(e){return`${this.async?"async ":""}function ${this.name}(${this.args})`+super.render(e)}};Fo.kind="func";var Uo=class extends Vo{render(e){return"return "+super.render(e)}};Uo.kind="return";var rp=class extends wr{render(e){let r="try"+super.render(e);return this.catch&&(r+=this.catch.render(e)),this.finally&&(r+=this.finally.render(e)),r}optimizeNodes(){var e,r;return super.optimizeNodes(),(e=this.catch)===null||e===void 0||e.optimizeNodes(),(r=this.finally)===null||r===void 0||r.optimizeNodes(),this}optimizeNames(e,r){var n,s;return super.optimizeNames(e,r),(n=this.catch)===null||n===void 0||n.optimizeNames(e,r),(s=this.finally)===null||s===void 0||s.optimizeNames(e,r),this}get names(){let e=super.names;return this.catch&&On(e,this.catch.names),this.finally&&On(e,this.finally.names),e}},Ho=class extends wr{constructor(e){super(),this.error=e}render(e){return`catch(${this.error})`+super.render(e)}};Ho.kind="catch";var Ko=class extends wr{render(e){return"finally"+super.render(e)}};Ko.kind="finally";var np=class{constructor(e,r={}){this._values={},this._blockStarts=[],this._constants={},this.opts={...r,_n:r.lines?`
`:""},this._extScope=e,this._scope=new qt.Scope({parent:e}),this._nodes=[new Xd]}toString(){return this._root.render(this.opts)}name(e){return this._scope.name(e)}scopeName(e){return this._extScope.name(e)}scopeValue(e,r){let n=this._extScope.value(e,r);return(this._values[n.prefix]||(this._values[n.prefix]=new Set)).add(n),n}getScopeValue(e,r){return this._extScope.getValue(e,r)}scopeRefs(e){return this._extScope.scopeRefs(e,this._values)}scopeCode(){return this._extScope.scopeCode(this._values)}_def(e,r,n,s){let o=this._scope.toName(r);return n!==void 0&&s&&(this._constants[o.str]=n),this._leafNode(new Bd(e,o,n)),o}const(e,r,n){return this._def(qt.varKinds.const,e,r,n)}let(e,r,n){return this._def(qt.varKinds.let,e,r,n)}var(e,r,n){return this._def(qt.varKinds.var,e,r,n)}assign(e,r,n){return this._leafNode(new Ka(e,r,n))}add(e,r){return this._leafNode(new Gd(e,J.operators.ADD,r))}code(e){return typeof e=="function"?e():e!==se.nil&&this._leafNode(new Qd(e)),this}object(...e){let r=["{"];for(let[n,s]of e)r.length>1&&r.push(","),r.push(n),(n!==s||this.opts.es5)&&(r.push(":"),(0,se.addCodeArg)(r,s));return r.push("}"),new se._Code(r)}if(e,r,n){if(this._blockNode(new In(e)),r&&n)this.code(r).else().code(n).endIf();else if(r)this.code(r).endIf();else if(n)throw new Error('CodeGen: "else" body without "then" body');return this}elseIf(e){return this._elseNode(new In(e))}else(){return this._elseNode(new ys)}endIf(){return this._endBlockNode(In,ys)}_for(e,r){return this._blockNode(e),r&&this.code(r).endFor(),this}for(e,r){return this._for(new ep(e),r)}forRange(e,r,n,s,o=this.opts.es5?qt.varKinds.var:qt.varKinds.let){let i=this._scope.toName(e);return this._for(new tp(o,i,r,n),()=>s(i))}forOf(e,r,n,s=qt.varKinds.const){let o=this._scope.toName(e);if(this.opts.es5){let i=r instanceof se.Name?r:this.var("_arr",r);return this.forRange("_i",0,(0,se._)`${i}.length`,a=>{this.var(o,(0,se._)`${i}[${a}]`),n(o)})}return this._for(new Ba("of",s,o,r),()=>n(o))}forIn(e,r,n,s=this.opts.es5?qt.varKinds.var:qt.varKinds.const){if(this.opts.ownProperties)return this.forOf(e,(0,se._)`Object.keys(${r})`,n);let o=this._scope.toName(e);return this._for(new Ba("in",s,o,r),()=>n(o))}endFor(){return this._endBlockNode(Rn)}label(e){return this._leafNode(new Wd(e))}break(e){return this._leafNode(new Jd(e))}return(e){let r=new Uo;if(this._blockNode(r),this.code(e),r.nodes.length!==1)throw new Error('CodeGen: "return" should have one node');return this._endBlockNode(Uo)}try(e,r,n){if(!r&&!n)throw new Error('CodeGen: "try" without "catch" and "finally"');let s=new rp;if(this._blockNode(s),this.code(e),r){let o=this.name("e");this._currNode=s.catch=new Ho(o),r(o)}return n&&(this._currNode=s.finally=new Ko,this.code(n)),this._endBlockNode(Ho,Ko)}throw(e){return this._leafNode(new Yd(e))}block(e,r){return this._blockStarts.push(this._nodes.length),e&&this.code(e).endBlock(r),this}endBlock(e){let r=this._blockStarts.pop();if(r===void 0)throw new Error("CodeGen: not in self-balancing block");let n=this._nodes.length-r;if(n<0||e!==void 0&&n!==e)throw new Error(`CodeGen: wrong number of nodes: ${n} vs ${e} expected`);return this._nodes.length=r,this}func(e,r=se.nil,n,s){return this._blockNode(new Fo(e,r,n)),s&&this.code(s).endFunc(),this}endFunc(){return this._endBlockNode(Fo)}optimize(e=1){for(;e-- >0;)this._root.optimizeNodes(),this._root.optimizeNames(this._root.names,this._constants)}_leafNode(e){return this._currNode.nodes.push(e),this}_blockNode(e){this._currNode.nodes.push(e),this._nodes.push(e)}_endBlockNode(e,r){let n=this._currNode;if(n instanceof e||r&&n instanceof r)return this._nodes.pop(),this;throw new Error(`CodeGen: not in block "${r?`${e.kind}/${r.kind}`:e.kind}"`)}_elseNode(e){let r=this._currNode;if(!(r instanceof In))throw new Error('CodeGen: "else" without "if"');return this._currNode=r.else=e,this}get _root(){return this._nodes[0]}get _currNode(){let e=this._nodes;return e[e.length-1]}set _currNode(e){let r=this._nodes;r[r.length-1]=e}};J.CodeGen=np;function On(t,e){for(let r in e)t[r]=(t[r]||0)+(e[r]||0);return t}function Ga(t,e){return e instanceof se._CodeOrName?On(t,e.names):t}function vs(t,e,r){if(t instanceof se.Name)return n(t);if(!s(t))return t;return new se._Code(t._items.reduce((o,i)=>(i instanceof se.Name&&(i=n(i)),i instanceof se._Code?o.push(...i._items):o.push(i),o),[]));function n(o){let i=r[o.str];return i===void 0||e[o.str]!==1?o:(delete e[o.str],i)}function s(o){return o instanceof se._Code&&o._items.some(i=>i instanceof se.Name&&e[i.str]===1&&r[i.str]!==void 0)}}function ZR(t,e){for(let r in e)t[r]=(t[r]||0)-(e[r]||0)}function f0(t){return typeof t=="boolean"||typeof t=="number"||t===null?!t:(0,se._)`!${sp(t)}`}J.not=f0;var LR=m0(J.operators.AND);function VR(...t){return t.reduce(LR)}J.and=VR;var FR=m0(J.operators.OR);function UR(...t){return t.reduce(FR)}J.or=UR;function m0(t){return(e,r)=>e===se.nil?r:r===se.nil?e:(0,se._)`${sp(e)} ${t} ${sp(r)}`}function sp(t){return t instanceof se.Name?t:(0,se._)`(${t})`}});var le=v(X=>{"use strict";Object.defineProperty(X,"__esModule",{value:!0});X.checkStrictMode=X.getErrorPath=X.Type=X.useFunc=X.setEvaluated=X.evaluatedPropsToName=X.mergeEvaluated=X.eachItem=X.unescapeJsonPointer=X.escapeJsonPointer=X.escapeFragment=X.unescapeFragment=X.schemaRefOrVal=X.schemaHasRulesButRef=X.schemaHasRules=X.checkUnknownRules=X.alwaysValidSchema=X.toHash=void 0;var be=G(),HR=Lo();function KR(t){let e={};for(let r of t)e[r]=!0;return e}X.toHash=KR;function BR(t,e){return typeof e=="boolean"?e:Object.keys(e).length===0?!0:(y0(t,e),!v0(e,t.self.RULES.all))}X.alwaysValidSchema=BR;function y0(t,e=t.schema){let{opts:r,self:n}=t;if(!r.strictSchema||typeof e=="boolean")return;let s=n.RULES.keywords;for(let o in e)s[o]||w0(t,`unknown keyword: "${o}"`)}X.checkUnknownRules=y0;function v0(t,e){if(typeof t=="boolean")return!t;for(let r in t)if(e[r])return!0;return!1}X.schemaHasRules=v0;function GR(t,e){if(typeof t=="boolean")return!t;for(let r in t)if(r!=="$ref"&&e.all[r])return!0;return!1}X.schemaHasRulesButRef=GR;function WR({topSchemaRef:t,schemaPath:e},r,n,s){if(!s){if(typeof r=="number"||typeof r=="boolean")return r;if(typeof r=="string")return(0,be._)`${r}`}return(0,be._)`${t}${e}${(0,be.getProperty)(n)}`}X.schemaRefOrVal=WR;function JR(t){return _0(decodeURIComponent(t))}X.unescapeFragment=JR;function YR(t){return encodeURIComponent(ip(t))}X.escapeFragment=YR;function ip(t){return typeof t=="number"?`${t}`:t.replace(/~/g,"~0").replace(/\//g,"~1")}X.escapeJsonPointer=ip;function _0(t){return t.replace(/~1/g,"/").replace(/~0/g,"~")}X.unescapeJsonPointer=_0;function QR(t,e){if(Array.isArray(t))for(let r of t)e(r);else e(t)}X.eachItem=QR;function h0({mergeNames:t,mergeToName:e,mergeValues:r,resultToName:n}){return(s,o,i,a)=>{let c=i===void 0?o:i instanceof be.Name?(o instanceof be.Name?t(s,o,i):e(s,o,i),i):o instanceof be.Name?(e(s,i,o),o):r(o,i);return a===be.Name&&!(c instanceof be.Name)?n(s,c):c}}X.mergeEvaluated={props:h0({mergeNames:(t,e,r)=>t.if((0,be._)`${r} !== true && ${e} !== undefined`,()=>{t.if((0,be._)`${e} === true`,()=>t.assign(r,!0),()=>t.assign(r,(0,be._)`${r} || {}`).code((0,be._)`Object.assign(${r}, ${e})`))}),mergeToName:(t,e,r)=>t.if((0,be._)`${r} !== true`,()=>{e===!0?t.assign(r,!0):(t.assign(r,(0,be._)`${r} || {}`),ap(t,r,e))}),mergeValues:(t,e)=>t===!0?!0:{...t,...e},resultToName:b0}),items:h0({mergeNames:(t,e,r)=>t.if((0,be._)`${r} !== true && ${e} !== undefined`,()=>t.assign(r,(0,be._)`${e} === true ? true : ${r} > ${e} ? ${r} : ${e}`)),mergeToName:(t,e,r)=>t.if((0,be._)`${r} !== true`,()=>t.assign(r,e===!0?!0:(0,be._)`${r} > ${e} ? ${r} : ${e}`)),mergeValues:(t,e)=>t===!0?!0:Math.max(t,e),resultToName:(t,e)=>t.var("items",e)})};function b0(t,e){if(e===!0)return t.var("props",!0);let r=t.var("props",(0,be._)`{}`);return e!==void 0&&ap(t,r,e),r}X.evaluatedPropsToName=b0;function ap(t,e,r){Object.keys(r).forEach(n=>t.assign((0,be._)`${e}${(0,be.getProperty)(n)}`,!0))}X.setEvaluated=ap;var g0={};function XR(t,e){return t.scopeValue("func",{ref:e,code:g0[e.code]||(g0[e.code]=new HR._Code(e.code))})}X.useFunc=XR;var op;(function(t){t[t.Num=0]="Num",t[t.Str=1]="Str"})(op||(X.Type=op={}));function e1(t,e,r){if(t instanceof be.Name){let n=e===op.Num;return r?n?(0,be._)`"[" + ${t} + "]"`:(0,be._)`"['" + ${t} + "']"`:n?(0,be._)`"/" + ${t}`:(0,be._)`"/" + ${t}.replace(/~/g, "~0").replace(/\\//g, "~1")`}return r?(0,be.getProperty)(t).toString():"/"+ip(t)}X.getErrorPath=e1;function w0(t,e,r=t.opts.strictSchema){if(r){if(e=`strict mode: ${e}`,r===!0)throw new Error(e);t.self.logger.warn(e)}}X.checkStrictMode=w0});var $r=v(cp=>{"use strict";Object.defineProperty(cp,"__esModule",{value:!0});var Xe=G(),t1={data:new Xe.Name("data"),valCxt:new Xe.Name("valCxt"),instancePath:new Xe.Name("instancePath"),parentData:new Xe.Name("parentData"),parentDataProperty:new Xe.Name("parentDataProperty"),rootData:new Xe.Name("rootData"),dynamicAnchors:new Xe.Name("dynamicAnchors"),vErrors:new Xe.Name("vErrors"),errors:new Xe.Name("errors"),this:new Xe.Name("this"),self:new Xe.Name("self"),scope:new Xe.Name("scope"),json:new Xe.Name("json"),jsonPos:new Xe.Name("jsonPos"),jsonLen:new Xe.Name("jsonLen"),jsonPart:new Xe.Name("jsonPart")};cp.default=t1});var Bo=v(et=>{"use strict";Object.defineProperty(et,"__esModule",{value:!0});et.extendErrors=et.resetErrorsCount=et.reportExtraError=et.reportError=et.keyword$DataError=et.keywordError=void 0;var ie=G(),Ja=le(),st=$r();et.keywordError={message:({keyword:t})=>(0,ie.str)`must pass "${t}" keyword validation`};et.keyword$DataError={message:({keyword:t,schemaType:e})=>e?(0,ie.str)`"${t}" keyword must be ${e} ($data)`:(0,ie.str)`"${t}" keyword is invalid ($data)`};function r1(t,e=et.keywordError,r,n){let{it:s}=t,{gen:o,compositeRule:i,allErrors:a}=s,c=k0(t,e,r);n??(i||a)?$0(o,c):x0(s,(0,ie._)`[${c}]`)}et.reportError=r1;function n1(t,e=et.keywordError,r){let{it:n}=t,{gen:s,compositeRule:o,allErrors:i}=n,a=k0(t,e,r);$0(s,a),o||i||x0(n,st.default.vErrors)}et.reportExtraError=n1;function s1(t,e){t.assign(st.default.errors,e),t.if((0,ie._)`${st.default.vErrors} !== null`,()=>t.if(e,()=>t.assign((0,ie._)`${st.default.vErrors}.length`,e),()=>t.assign(st.default.vErrors,null)))}et.resetErrorsCount=s1;function o1({gen:t,keyword:e,schemaValue:r,data:n,errsCount:s,it:o}){if(s===void 0)throw new Error("ajv implementation error");let i=t.name("err");t.forRange("i",s,st.default.errors,a=>{t.const(i,(0,ie._)`${st.default.vErrors}[${a}]`),t.if((0,ie._)`${i}.instancePath === undefined`,()=>t.assign((0,ie._)`${i}.instancePath`,(0,ie.strConcat)(st.default.instancePath,o.errorPath))),t.assign((0,ie._)`${i}.schemaPath`,(0,ie.str)`${o.errSchemaPath}/${e}`),o.opts.verbose&&(t.assign((0,ie._)`${i}.schema`,r),t.assign((0,ie._)`${i}.data`,n))})}et.extendErrors=o1;function $0(t,e){let r=t.const("err",e);t.if((0,ie._)`${st.default.vErrors} === null`,()=>t.assign(st.default.vErrors,(0,ie._)`[${r}]`),(0,ie._)`${st.default.vErrors}.push(${r})`),t.code((0,ie._)`${st.default.errors}++`)}function x0(t,e){let{gen:r,validateName:n,schemaEnv:s}=t;s.$async?r.throw((0,ie._)`new ${t.ValidationError}(${e})`):(r.assign((0,ie._)`${n}.errors`,e),r.return(!1))}var Nn={keyword:new ie.Name("keyword"),schemaPath:new ie.Name("schemaPath"),params:new ie.Name("params"),propertyName:new ie.Name("propertyName"),message:new ie.Name("message"),schema:new ie.Name("schema"),parentSchema:new ie.Name("parentSchema")};function k0(t,e,r){let{createErrors:n}=t.it;return n===!1?(0,ie._)`{}`:i1(t,e,r)}function i1(t,e,r={}){let{gen:n,it:s}=t,o=[a1(s,r),c1(t,r)];return u1(t,e,o),n.object(...o)}function a1({errorPath:t},{instancePath:e}){let r=e?(0,ie.str)`${t}${(0,Ja.getErrorPath)(e,Ja.Type.Str)}`:t;return[st.default.instancePath,(0,ie.strConcat)(st.default.instancePath,r)]}function c1({keyword:t,it:{errSchemaPath:e}},{schemaPath:r,parentSchema:n}){let s=n?e:(0,ie.str)`${e}/${t}`;return r&&(s=(0,ie.str)`${s}${(0,Ja.getErrorPath)(r,Ja.Type.Str)}`),[Nn.schemaPath,s]}function u1(t,{params:e,message:r},n){let{keyword:s,data:o,schemaValue:i,it:a}=t,{opts:c,propertyName:u,topSchemaRef:l,schemaPath:d}=a;n.push([Nn.keyword,s],[Nn.params,typeof e=="function"?e(t):e||(0,ie._)`{}`]),c.messages&&n.push([Nn.message,typeof r=="function"?r(t):r]),c.verbose&&n.push([Nn.schema,i],[Nn.parentSchema,(0,ie._)`${l}${d}`],[st.default.data,o]),u&&n.push([Nn.propertyName,u])}});var P0=v(_s=>{"use strict";Object.defineProperty(_s,"__esModule",{value:!0});_s.boolOrEmptySchema=_s.topBoolOrEmptySchema=void 0;var l1=Bo(),d1=G(),p1=$r(),f1={message:"boolean schema is false"};function m1(t){let{gen:e,schema:r,validateName:n}=t;r===!1?S0(t,!1):typeof r=="object"&&r.$async===!0?e.return(p1.default.data):(e.assign((0,d1._)`${n}.errors`,null),e.return(!0))}_s.topBoolOrEmptySchema=m1;function h1(t,e){let{gen:r,schema:n}=t;n===!1?(r.var(e,!1),S0(t)):r.var(e,!0)}_s.boolOrEmptySchema=h1;function S0(t,e){let{gen:r,data:n}=t,s={gen:r,keyword:"false schema",data:n,schema:!1,schemaCode:!1,schemaValue:!1,params:{},it:t};(0,l1.reportError)(s,f1,void 0,e)}});var up=v(bs=>{"use strict";Object.defineProperty(bs,"__esModule",{value:!0});bs.getRules=bs.isJSONType=void 0;var g1=["string","number","integer","boolean","null","object","array"],y1=new Set(g1);function v1(t){return typeof t=="string"&&y1.has(t)}bs.isJSONType=v1;function _1(){let t={number:{type:"number",rules:[]},string:{type:"string",rules:[]},array:{type:"array",rules:[]},object:{type:"object",rules:[]}};return{types:{...t,integer:!0,boolean:!0,null:!0},rules:[{rules:[]},t.number,t.string,t.array,t.object],post:{rules:[]},all:{},keywords:{}}}bs.getRules=_1});var lp=v(Lr=>{"use strict";Object.defineProperty(Lr,"__esModule",{value:!0});Lr.shouldUseRule=Lr.shouldUseGroup=Lr.schemaHasRulesForType=void 0;function b1({schema:t,self:e},r){let n=e.RULES.types[r];return n&&n!==!0&&T0(t,n)}Lr.schemaHasRulesForType=b1;function T0(t,e){return e.rules.some(r=>E0(t,r))}Lr.shouldUseGroup=T0;function E0(t,e){var r;return t[e.keyword]!==void 0||((r=e.definition.implements)===null||r===void 0?void 0:r.some(n=>t[n]!==void 0))}Lr.shouldUseRule=E0});var Go=v(tt=>{"use strict";Object.defineProperty(tt,"__esModule",{value:!0});tt.reportTypeError=tt.checkDataTypes=tt.checkDataType=tt.coerceAndCheckDataType=tt.getJSONTypes=tt.getSchemaTypes=tt.DataType=void 0;var w1=up(),$1=lp(),x1=Bo(),K=G(),z0=le(),ws;(function(t){t[t.Correct=0]="Correct",t[t.Wrong=1]="Wrong"})(ws||(tt.DataType=ws={}));function k1(t){let e=C0(t.type);if(e.includes("null")){if(t.nullable===!1)throw new Error("type: null contradicts nullable: false")}else{if(!e.length&&t.nullable!==void 0)throw new Error('"nullable" cannot be used without "type"');t.nullable===!0&&e.push("null")}return e}tt.getSchemaTypes=k1;function C0(t){let e=Array.isArray(t)?t:t?[t]:[];if(e.every(w1.isJSONType))return e;throw new Error("type must be JSONType or JSONType[]: "+e.join(","))}tt.getJSONTypes=C0;function S1(t,e){let{gen:r,data:n,opts:s}=t,o=P1(e,s.coerceTypes),i=e.length>0&&!(o.length===0&&e.length===1&&(0,$1.schemaHasRulesForType)(t,e[0]));if(i){let a=pp(e,n,s.strictNumbers,ws.Wrong);r.if(a,()=>{o.length?T1(t,e,o):fp(t)})}return i}tt.coerceAndCheckDataType=S1;var I0=new Set(["string","number","integer","boolean","null"]);function P1(t,e){return e?t.filter(r=>I0.has(r)||e==="array"&&r==="array"):[]}function T1(t,e,r){let{gen:n,data:s,opts:o}=t,i=n.let("dataType",(0,K._)`typeof ${s}`),a=n.let("coerced",(0,K._)`undefined`);o.coerceTypes==="array"&&n.if((0,K._)`${i} == 'object' && Array.isArray(${s}) && ${s}.length == 1`,()=>n.assign(s,(0,K._)`${s}[0]`).assign(i,(0,K._)`typeof ${s}`).if(pp(e,s,o.strictNumbers),()=>n.assign(a,s))),n.if((0,K._)`${a} !== undefined`);for(let u of r)(I0.has(u)||u==="array"&&o.coerceTypes==="array")&&c(u);n.else(),fp(t),n.endIf(),n.if((0,K._)`${a} !== undefined`,()=>{n.assign(s,a),E1(t,a)});function c(u){switch(u){case"string":n.elseIf((0,K._)`${i} == "number" || ${i} == "boolean"`).assign(a,(0,K._)`"" + ${s}`).elseIf((0,K._)`${s} === null`).assign(a,(0,K._)`""`);return;case"number":n.elseIf((0,K._)`${i} == "boolean" || ${s} === null
              || (${i} == "string" && ${s} && ${s} == +${s})`).assign(a,(0,K._)`+${s}`);return;case"integer":n.elseIf((0,K._)`${i} === "boolean" || ${s} === null
              || (${i} === "string" && ${s} && ${s} == +${s} && !(${s} % 1))`).assign(a,(0,K._)`+${s}`);return;case"boolean":n.elseIf((0,K._)`${s} === "false" || ${s} === 0 || ${s} === null`).assign(a,!1).elseIf((0,K._)`${s} === "true" || ${s} === 1`).assign(a,!0);return;case"null":n.elseIf((0,K._)`${s} === "" || ${s} === 0 || ${s} === false`),n.assign(a,null);return;case"array":n.elseIf((0,K._)`${i} === "string" || ${i} === "number"
              || ${i} === "boolean" || ${s} === null`).assign(a,(0,K._)`[${s}]`)}}}function E1({gen:t,parentData:e,parentDataProperty:r},n){t.if((0,K._)`${e} !== undefined`,()=>t.assign((0,K._)`${e}[${r}]`,n))}function dp(t,e,r,n=ws.Correct){let s=n===ws.Correct?K.operators.EQ:K.operators.NEQ,o;switch(t){case"null":return(0,K._)`${e} ${s} null`;case"array":o=(0,K._)`Array.isArray(${e})`;break;case"object":o=(0,K._)`${e} && typeof ${e} == "object" && !Array.isArray(${e})`;break;case"integer":o=i((0,K._)`!(${e} % 1) && !isNaN(${e})`);break;case"number":o=i();break;default:return(0,K._)`typeof ${e} ${s} ${t}`}return n===ws.Correct?o:(0,K.not)(o);function i(a=K.nil){return(0,K.and)((0,K._)`typeof ${e} == "number"`,a,r?(0,K._)`isFinite(${e})`:K.nil)}}tt.checkDataType=dp;function pp(t,e,r,n){if(t.length===1)return dp(t[0],e,r,n);let s,o=(0,z0.toHash)(t);if(o.array&&o.object){let i=(0,K._)`typeof ${e} != "object"`;s=o.null?i:(0,K._)`!${e} || ${i}`,delete o.null,delete o.array,delete o.object}else s=K.nil;o.number&&delete o.integer;for(let i in o)s=(0,K.and)(s,dp(i,e,r,n));return s}tt.checkDataTypes=pp;var z1={message:({schema:t})=>`must be ${t}`,params:({schema:t,schemaValue:e})=>typeof t=="string"?(0,K._)`{type: ${t}}`:(0,K._)`{type: ${e}}`};function fp(t){let e=C1(t);(0,x1.reportError)(e,z1)}tt.reportTypeError=fp;function C1(t){let{gen:e,data:r,schema:n}=t,s=(0,z0.schemaRefOrVal)(t,n,"type");return{gen:e,keyword:"type",data:r,schema:n.type,schemaCode:s,schemaValue:s,parentSchema:n,params:{},it:t}}});var O0=v(Ya=>{"use strict";Object.defineProperty(Ya,"__esModule",{value:!0});Ya.assignDefaults=void 0;var $s=G(),I1=le();function R1(t,e){let{properties:r,items:n}=t.schema;if(e==="object"&&r)for(let s in r)R0(t,s,r[s].default);else e==="array"&&Array.isArray(n)&&n.forEach((s,o)=>R0(t,o,s.default))}Ya.assignDefaults=R1;function R0(t,e,r){let{gen:n,compositeRule:s,data:o,opts:i}=t;if(r===void 0)return;let a=(0,$s._)`${o}${(0,$s.getProperty)(e)}`;if(s){(0,I1.checkStrictMode)(t,`default is ignored for: ${a}`);return}let c=(0,$s._)`${a} === undefined`;i.useDefaults==="empty"&&(c=(0,$s._)`${c} || ${a} === null || ${a} === ""`),n.if(c,(0,$s._)`${a} = ${(0,$s.stringify)(r)}`)}});var Et=v(he=>{"use strict";Object.defineProperty(he,"__esModule",{value:!0});he.validateUnion=he.validateArray=he.usePattern=he.callValidateCode=he.schemaProperties=he.allSchemaProperties=he.noPropertyInData=he.propertyInData=he.isOwnProperty=he.hasPropFunc=he.reportMissingProp=he.checkMissingProp=he.checkReportMissingProp=void 0;var Te=G(),mp=le(),Vr=$r(),O1=le();function N1(t,e){let{gen:r,data:n,it:s}=t;r.if(gp(r,n,e,s.opts.ownProperties),()=>{t.setParams({missingProperty:(0,Te._)`${e}`},!0),t.error()})}he.checkReportMissingProp=N1;function j1({gen:t,data:e,it:{opts:r}},n,s){return(0,Te.or)(...n.map(o=>(0,Te.and)(gp(t,e,o,r.ownProperties),(0,Te._)`${s} = ${o}`)))}he.checkMissingProp=j1;function A1(t,e){t.setParams({missingProperty:e},!0),t.error()}he.reportMissingProp=A1;function N0(t){return t.scopeValue("func",{ref:Object.prototype.hasOwnProperty,code:(0,Te._)`Object.prototype.hasOwnProperty`})}he.hasPropFunc=N0;function hp(t,e,r){return(0,Te._)`${N0(t)}.call(${e}, ${r})`}he.isOwnProperty=hp;function M1(t,e,r,n){let s=(0,Te._)`${e}${(0,Te.getProperty)(r)} !== undefined`;return n?(0,Te._)`${s} && ${hp(t,e,r)}`:s}he.propertyInData=M1;function gp(t,e,r,n){let s=(0,Te._)`${e}${(0,Te.getProperty)(r)} === undefined`;return n?(0,Te.or)(s,(0,Te.not)(hp(t,e,r))):s}he.noPropertyInData=gp;function j0(t){return t?Object.keys(t).filter(e=>e!=="__proto__"):[]}he.allSchemaProperties=j0;function q1(t,e){return j0(e).filter(r=>!(0,mp.alwaysValidSchema)(t,e[r]))}he.schemaProperties=q1;function D1({schemaCode:t,data:e,it:{gen:r,topSchemaRef:n,schemaPath:s,errorPath:o},it:i},a,c,u){let l=u?(0,Te._)`${t}, ${e}, ${n}${s}`:e,d=[[Vr.default.instancePath,(0,Te.strConcat)(Vr.default.instancePath,o)],[Vr.default.parentData,i.parentData],[Vr.default.parentDataProperty,i.parentDataProperty],[Vr.default.rootData,Vr.default.rootData]];i.opts.dynamicRef&&d.push([Vr.default.dynamicAnchors,Vr.default.dynamicAnchors]);let f=(0,Te._)`${l}, ${r.object(...d)}`;return c!==Te.nil?(0,Te._)`${a}.call(${c}, ${f})`:(0,Te._)`${a}(${f})`}he.callValidateCode=D1;var Z1=(0,Te._)`new RegExp`;function L1({gen:t,it:{opts:e}},r){let n=e.unicodeRegExp?"u":"",{regExp:s}=e.code,o=s(r,n);return t.scopeValue("pattern",{key:o.toString(),ref:o,code:(0,Te._)`${s.code==="new RegExp"?Z1:(0,O1.useFunc)(t,s)}(${r}, ${n})`})}he.usePattern=L1;function V1(t){let{gen:e,data:r,keyword:n,it:s}=t,o=e.name("valid");if(s.allErrors){let a=e.let("valid",!0);return i(()=>e.assign(a,!1)),a}return e.var(o,!0),i(()=>e.break()),o;function i(a){let c=e.const("len",(0,Te._)`${r}.length`);e.forRange("i",0,c,u=>{t.subschema({keyword:n,dataProp:u,dataPropType:mp.Type.Num},o),e.if((0,Te.not)(o),a)})}}he.validateArray=V1;function F1(t){let{gen:e,schema:r,keyword:n,it:s}=t;if(!Array.isArray(r))throw new Error("ajv implementation error");if(r.some(c=>(0,mp.alwaysValidSchema)(s,c))&&!s.opts.unevaluated)return;let i=e.let("valid",!1),a=e.name("_valid");e.block(()=>r.forEach((c,u)=>{let l=t.subschema({keyword:n,schemaProp:u,compositeRule:!0},a);e.assign(i,(0,Te._)`${i} || ${a}`),t.mergeValidEvaluated(l,a)||e.if((0,Te.not)(i))})),t.result(i,()=>t.reset(),()=>t.error(!0))}he.validateUnion=F1});var q0=v(sr=>{"use strict";Object.defineProperty(sr,"__esModule",{value:!0});sr.validateKeywordUsage=sr.validSchemaType=sr.funcKeywordCode=sr.macroKeywordCode=void 0;var ot=G(),jn=$r(),U1=Et(),H1=Bo();function K1(t,e){let{gen:r,keyword:n,schema:s,parentSchema:o,it:i}=t,a=e.macro.call(i.self,s,o,i),c=M0(r,n,a);i.opts.validateSchema!==!1&&i.self.validateSchema(a,!0);let u=r.name("valid");t.subschema({schema:a,schemaPath:ot.nil,errSchemaPath:`${i.errSchemaPath}/${n}`,topSchemaRef:c,compositeRule:!0},u),t.pass(u,()=>t.error(!0))}sr.macroKeywordCode=K1;function B1(t,e){var r;let{gen:n,keyword:s,schema:o,parentSchema:i,$data:a,it:c}=t;W1(c,e);let u=!a&&e.compile?e.compile.call(c.self,o,i,c):e.validate,l=M0(n,s,u),d=n.let("valid");t.block$data(d,f),t.ok((r=e.valid)!==null&&r!==void 0?r:d);function f(){if(e.errors===!1)h(),e.modifying&&A0(t),g(()=>t.error());else{let y=e.async?p():m();e.modifying&&A0(t),g(()=>G1(t,y))}}function p(){let y=n.let("ruleErrs",null);return n.try(()=>h((0,ot._)`await `),$=>n.assign(d,!1).if((0,ot._)`${$} instanceof ${c.ValidationError}`,()=>n.assign(y,(0,ot._)`${$}.errors`),()=>n.throw($))),y}function m(){let y=(0,ot._)`${l}.errors`;return n.assign(y,null),h(ot.nil),y}function h(y=e.async?(0,ot._)`await `:ot.nil){let $=c.opts.passContext?jn.default.this:jn.default.self,w=!("compile"in e&&!a||e.schema===!1);n.assign(d,(0,ot._)`${y}${(0,U1.callValidateCode)(t,l,$,w)}`,e.modifying)}function g(y){var $;n.if((0,ot.not)(($=e.valid)!==null&&$!==void 0?$:d),y)}}sr.funcKeywordCode=B1;function A0(t){let{gen:e,data:r,it:n}=t;e.if(n.parentData,()=>e.assign(r,(0,ot._)`${n.parentData}[${n.parentDataProperty}]`))}function G1(t,e){let{gen:r}=t;r.if((0,ot._)`Array.isArray(${e})`,()=>{r.assign(jn.default.vErrors,(0,ot._)`${jn.default.vErrors} === null ? ${e} : ${jn.default.vErrors}.concat(${e})`).assign(jn.default.errors,(0,ot._)`${jn.default.vErrors}.length`),(0,H1.extendErrors)(t)},()=>t.error())}function W1({schemaEnv:t},e){if(e.async&&!t.$async)throw new Error("async keyword in sync schema")}function M0(t,e,r){if(r===void 0)throw new Error(`keyword "${e}" failed to compile`);return t.scopeValue("keyword",typeof r=="function"?{ref:r}:{ref:r,code:(0,ot.stringify)(r)})}function J1(t,e,r=!1){return!e.length||e.some(n=>n==="array"?Array.isArray(t):n==="object"?t&&typeof t=="object"&&!Array.isArray(t):typeof t==n||r&&typeof t>"u")}sr.validSchemaType=J1;function Y1({schema:t,opts:e,self:r,errSchemaPath:n},s,o){if(Array.isArray(s.keyword)?!s.keyword.includes(o):s.keyword!==o)throw new Error("ajv implementation error");let i=s.dependencies;if(i?.some(a=>!Object.prototype.hasOwnProperty.call(t,a)))throw new Error(`parent schema must have dependencies of ${o}: ${i.join(",")}`);if(s.validateSchema&&!s.validateSchema(t[o])){let c=`keyword "${o}" value is invalid at path "${n}": `+r.errorsText(s.validateSchema.errors);if(e.validateSchema==="log")r.logger.error(c);else throw new Error(c)}}sr.validateKeywordUsage=Y1});var Z0=v(Fr=>{"use strict";Object.defineProperty(Fr,"__esModule",{value:!0});Fr.extendSubschemaMode=Fr.extendSubschemaData=Fr.getSubschema=void 0;var or=G(),D0=le();function Q1(t,{keyword:e,schemaProp:r,schema:n,schemaPath:s,errSchemaPath:o,topSchemaRef:i}){if(e!==void 0&&n!==void 0)throw new Error('both "keyword" and "schema" passed, only one allowed');if(e!==void 0){let a=t.schema[e];return r===void 0?{schema:a,schemaPath:(0,or._)`${t.schemaPath}${(0,or.getProperty)(e)}`,errSchemaPath:`${t.errSchemaPath}/${e}`}:{schema:a[r],schemaPath:(0,or._)`${t.schemaPath}${(0,or.getProperty)(e)}${(0,or.getProperty)(r)}`,errSchemaPath:`${t.errSchemaPath}/${e}/${(0,D0.escapeFragment)(r)}`}}if(n!==void 0){if(s===void 0||o===void 0||i===void 0)throw new Error('"schemaPath", "errSchemaPath" and "topSchemaRef" are required with "schema"');return{schema:n,schemaPath:s,topSchemaRef:i,errSchemaPath:o}}throw new Error('either "keyword" or "schema" must be passed')}Fr.getSubschema=Q1;function X1(t,e,{dataProp:r,dataPropType:n,data:s,dataTypes:o,propertyName:i}){if(s!==void 0&&r!==void 0)throw new Error('both "data" and "dataProp" passed, only one allowed');let{gen:a}=e;if(r!==void 0){let{errorPath:u,dataPathArr:l,opts:d}=e,f=a.let("data",(0,or._)`${e.data}${(0,or.getProperty)(r)}`,!0);c(f),t.errorPath=(0,or.str)`${u}${(0,D0.getErrorPath)(r,n,d.jsPropertySyntax)}`,t.parentDataProperty=(0,or._)`${r}`,t.dataPathArr=[...l,t.parentDataProperty]}if(s!==void 0){let u=s instanceof or.Name?s:a.let("data",s,!0);c(u),i!==void 0&&(t.propertyName=i)}o&&(t.dataTypes=o);function c(u){t.data=u,t.dataLevel=e.dataLevel+1,t.dataTypes=[],e.definedProperties=new Set,t.parentData=e.data,t.dataNames=[...e.dataNames,u]}}Fr.extendSubschemaData=X1;function eO(t,{jtdDiscriminator:e,jtdMetadata:r,compositeRule:n,createErrors:s,allErrors:o}){n!==void 0&&(t.compositeRule=n),s!==void 0&&(t.createErrors=s),o!==void 0&&(t.allErrors=o),t.jtdDiscriminator=e,t.jtdMetadata=r}Fr.extendSubschemaMode=eO});var V0=v((OV,L0)=>{"use strict";var Ur=L0.exports=function(t,e,r){typeof e=="function"&&(r=e,e={}),r=e.cb||r;var n=typeof r=="function"?r:r.pre||function(){},s=r.post||function(){};Qa(e,n,s,t,"",t)};Ur.keywords={additionalItems:!0,items:!0,contains:!0,additionalProperties:!0,propertyNames:!0,not:!0,if:!0,then:!0,else:!0};Ur.arrayKeywords={items:!0,allOf:!0,anyOf:!0,oneOf:!0};Ur.propsKeywords={$defs:!0,definitions:!0,properties:!0,patternProperties:!0,dependencies:!0};Ur.skipKeywords={default:!0,enum:!0,const:!0,required:!0,maximum:!0,minimum:!0,exclusiveMaximum:!0,exclusiveMinimum:!0,multipleOf:!0,maxLength:!0,minLength:!0,pattern:!0,format:!0,maxItems:!0,minItems:!0,uniqueItems:!0,maxProperties:!0,minProperties:!0};function Qa(t,e,r,n,s,o,i,a,c,u){if(n&&typeof n=="object"&&!Array.isArray(n)){e(n,s,o,i,a,c,u);for(var l in n){var d=n[l];if(Array.isArray(d)){if(l in Ur.arrayKeywords)for(var f=0;f<d.length;f++)Qa(t,e,r,d[f],s+"/"+l+"/"+f,o,s,l,n,f)}else if(l in Ur.propsKeywords){if(d&&typeof d=="object")for(var p in d)Qa(t,e,r,d[p],s+"/"+l+"/"+tO(p),o,s,l,n,p)}else(l in Ur.keywords||t.allKeys&&!(l in Ur.skipKeywords))&&Qa(t,e,r,d,s+"/"+l,o,s,l,n)}r(n,s,o,i,a,c,u)}}function tO(t){return t.replace(/~/g,"~0").replace(/\//g,"~1")}});var Wo=v(ht=>{"use strict";Object.defineProperty(ht,"__esModule",{value:!0});ht.getSchemaRefs=ht.resolveUrl=ht.normalizeId=ht._getFullPath=ht.getFullPath=ht.inlineRef=void 0;var rO=le(),nO=bo(),sO=V0(),oO=new Set(["type","format","pattern","maxLength","minLength","maxProperties","minProperties","maxItems","minItems","maximum","minimum","uniqueItems","multipleOf","required","enum","const"]);function iO(t,e=!0){return typeof t=="boolean"?!0:e===!0?!yp(t):e?F0(t)<=e:!1}ht.inlineRef=iO;var aO=new Set(["$ref","$recursiveRef","$recursiveAnchor","$dynamicRef","$dynamicAnchor"]);function yp(t){for(let e in t){if(aO.has(e))return!0;let r=t[e];if(Array.isArray(r)&&r.some(yp)||typeof r=="object"&&yp(r))return!0}return!1}function F0(t){let e=0;for(let r in t){if(r==="$ref")return 1/0;if(e++,!oO.has(r)&&(typeof t[r]=="object"&&(0,rO.eachItem)(t[r],n=>e+=F0(n)),e===1/0))return 1/0}return e}function U0(t,e="",r){r!==!1&&(e=xs(e));let n=t.parse(e);return H0(t,n)}ht.getFullPath=U0;function H0(t,e){return t.serialize(e).split("#")[0]+"#"}ht._getFullPath=H0;var cO=/#\/?$/;function xs(t){return t?t.replace(cO,""):""}ht.normalizeId=xs;function uO(t,e,r){return r=xs(r),t.resolve(e,r)}ht.resolveUrl=uO;var lO=/^[a-z_][-a-z0-9._]*$/i;function dO(t,e){if(typeof t=="boolean")return{};let{schemaId:r,uriResolver:n}=this.opts,s=xs(t[r]||e),o={"":s},i=U0(n,s,!1),a={},c=new Set;return sO(t,{allKeys:!0},(d,f,p,m)=>{if(m===void 0)return;let h=i+f,g=o[m];typeof d[r]=="string"&&(g=y.call(this,d[r])),$.call(this,d.$anchor),$.call(this,d.$dynamicAnchor),o[f]=g;function y(w){let S=this.opts.uriResolver.resolve;if(w=xs(g?S(g,w):w),c.has(w))throw l(w);c.add(w);let x=this.refs[w];return typeof x=="string"&&(x=this.refs[x]),typeof x=="object"?u(d,x.schema,w):w!==xs(h)&&(w[0]==="#"?(u(d,a[w],w),a[w]=d):this.refs[w]=h),w}function $(w){if(typeof w=="string"){if(!lO.test(w))throw new Error(`invalid anchor "${w}"`);y.call(this,`#${w}`)}}}),a;function u(d,f,p){if(f!==void 0&&!nO(d,f))throw l(p)}function l(d){return new Error(`reference "${d}" resolves to more than one schema`)}}ht.getSchemaRefs=dO});var Qo=v(Hr=>{"use strict";Object.defineProperty(Hr,"__esModule",{value:!0});Hr.getData=Hr.KeywordCxt=Hr.validateFunctionCode=void 0;var J0=P0(),K0=Go(),_p=lp(),Xa=Go(),pO=O0(),Yo=q0(),vp=Z0(),j=G(),V=$r(),fO=Wo(),xr=le(),Jo=Bo();function mO(t){if(X0(t)&&(eb(t),Q0(t))){yO(t);return}Y0(t,()=>(0,J0.topBoolOrEmptySchema)(t))}Hr.validateFunctionCode=mO;function Y0({gen:t,validateName:e,schema:r,schemaEnv:n,opts:s},o){s.code.es5?t.func(e,(0,j._)`${V.default.data}, ${V.default.valCxt}`,n.$async,()=>{t.code((0,j._)`"use strict"; ${B0(r,s)}`),gO(t,s),t.code(o)}):t.func(e,(0,j._)`${V.default.data}, ${hO(s)}`,n.$async,()=>t.code(B0(r,s)).code(o))}function hO(t){return(0,j._)`{${V.default.instancePath}="", ${V.default.parentData}, ${V.default.parentDataProperty}, ${V.default.rootData}=${V.default.data}${t.dynamicRef?(0,j._)`, ${V.default.dynamicAnchors}={}`:j.nil}}={}`}function gO(t,e){t.if(V.default.valCxt,()=>{t.var(V.default.instancePath,(0,j._)`${V.default.valCxt}.${V.default.instancePath}`),t.var(V.default.parentData,(0,j._)`${V.default.valCxt}.${V.default.parentData}`),t.var(V.default.parentDataProperty,(0,j._)`${V.default.valCxt}.${V.default.parentDataProperty}`),t.var(V.default.rootData,(0,j._)`${V.default.valCxt}.${V.default.rootData}`),e.dynamicRef&&t.var(V.default.dynamicAnchors,(0,j._)`${V.default.valCxt}.${V.default.dynamicAnchors}`)},()=>{t.var(V.default.instancePath,(0,j._)`""`),t.var(V.default.parentData,(0,j._)`undefined`),t.var(V.default.parentDataProperty,(0,j._)`undefined`),t.var(V.default.rootData,V.default.data),e.dynamicRef&&t.var(V.default.dynamicAnchors,(0,j._)`{}`)})}function yO(t){let{schema:e,opts:r,gen:n}=t;Y0(t,()=>{r.$comment&&e.$comment&&rb(t),$O(t),n.let(V.default.vErrors,null),n.let(V.default.errors,0),r.unevaluated&&vO(t),tb(t),SO(t)})}function vO(t){let{gen:e,validateName:r}=t;t.evaluated=e.const("evaluated",(0,j._)`${r}.evaluated`),e.if((0,j._)`${t.evaluated}.dynamicProps`,()=>e.assign((0,j._)`${t.evaluated}.props`,(0,j._)`undefined`)),e.if((0,j._)`${t.evaluated}.dynamicItems`,()=>e.assign((0,j._)`${t.evaluated}.items`,(0,j._)`undefined`))}function B0(t,e){let r=typeof t=="object"&&t[e.schemaId];return r&&(e.code.source||e.code.process)?(0,j._)`/*# sourceURL=${r} */`:j.nil}function _O(t,e){if(X0(t)&&(eb(t),Q0(t))){bO(t,e);return}(0,J0.boolOrEmptySchema)(t,e)}function Q0({schema:t,self:e}){if(typeof t=="boolean")return!t;for(let r in t)if(e.RULES.all[r])return!0;return!1}function X0(t){return typeof t.schema!="boolean"}function bO(t,e){let{schema:r,gen:n,opts:s}=t;s.$comment&&r.$comment&&rb(t),xO(t),kO(t);let o=n.const("_errs",V.default.errors);tb(t,o),n.var(e,(0,j._)`${o} === ${V.default.errors}`)}function eb(t){(0,xr.checkUnknownRules)(t),wO(t)}function tb(t,e){if(t.opts.jtd)return G0(t,[],!1,e);let r=(0,K0.getSchemaTypes)(t.schema),n=(0,K0.coerceAndCheckDataType)(t,r);G0(t,r,!n,e)}function wO(t){let{schema:e,errSchemaPath:r,opts:n,self:s}=t;e.$ref&&n.ignoreKeywordsWithRef&&(0,xr.schemaHasRulesButRef)(e,s.RULES)&&s.logger.warn(`$ref: keywords ignored in schema at path "${r}"`)}function $O(t){let{schema:e,opts:r}=t;e.default!==void 0&&r.useDefaults&&r.strictSchema&&(0,xr.checkStrictMode)(t,"default is ignored in the schema root")}function xO(t){let e=t.schema[t.opts.schemaId];e&&(t.baseId=(0,fO.resolveUrl)(t.opts.uriResolver,t.baseId,e))}function kO(t){if(t.schema.$async&&!t.schemaEnv.$async)throw new Error("async schema in sync schema")}function rb({gen:t,schemaEnv:e,schema:r,errSchemaPath:n,opts:s}){let o=r.$comment;if(s.$comment===!0)t.code((0,j._)`${V.default.self}.logger.log(${o})`);else if(typeof s.$comment=="function"){let i=(0,j.str)`${n}/$comment`,a=t.scopeValue("root",{ref:e.root});t.code((0,j._)`${V.default.self}.opts.$comment(${o}, ${i}, ${a}.schema)`)}}function SO(t){let{gen:e,schemaEnv:r,validateName:n,ValidationError:s,opts:o}=t;r.$async?e.if((0,j._)`${V.default.errors} === 0`,()=>e.return(V.default.data),()=>e.throw((0,j._)`new ${s}(${V.default.vErrors})`)):(e.assign((0,j._)`${n}.errors`,V.default.vErrors),o.unevaluated&&PO(t),e.return((0,j._)`${V.default.errors} === 0`))}function PO({gen:t,evaluated:e,props:r,items:n}){r instanceof j.Name&&t.assign((0,j._)`${e}.props`,r),n instanceof j.Name&&t.assign((0,j._)`${e}.items`,n)}function G0(t,e,r,n){let{gen:s,schema:o,data:i,allErrors:a,opts:c,self:u}=t,{RULES:l}=u;if(o.$ref&&(c.ignoreKeywordsWithRef||!(0,xr.schemaHasRulesButRef)(o,l))){s.block(()=>sb(t,"$ref",l.all.$ref.definition));return}c.jtd||TO(t,e),s.block(()=>{for(let f of l.rules)d(f);d(l.post)});function d(f){(0,_p.shouldUseGroup)(o,f)&&(f.type?(s.if((0,Xa.checkDataType)(f.type,i,c.strictNumbers)),W0(t,f),e.length===1&&e[0]===f.type&&r&&(s.else(),(0,Xa.reportTypeError)(t)),s.endIf()):W0(t,f),a||s.if((0,j._)`${V.default.errors} === ${n||0}`))}}function W0(t,e){let{gen:r,schema:n,opts:{useDefaults:s}}=t;s&&(0,pO.assignDefaults)(t,e.type),r.block(()=>{for(let o of e.rules)(0,_p.shouldUseRule)(n,o)&&sb(t,o.keyword,o.definition,e.type)})}function TO(t,e){t.schemaEnv.meta||!t.opts.strictTypes||(EO(t,e),t.opts.allowUnionTypes||zO(t,e),CO(t,t.dataTypes))}function EO(t,e){if(e.length){if(!t.dataTypes.length){t.dataTypes=e;return}e.forEach(r=>{nb(t.dataTypes,r)||bp(t,`type "${r}" not allowed by context "${t.dataTypes.join(",")}"`)}),RO(t,e)}}function zO(t,e){e.length>1&&!(e.length===2&&e.includes("null"))&&bp(t,"use allowUnionTypes to allow union type keyword")}function CO(t,e){let r=t.self.RULES.all;for(let n in r){let s=r[n];if(typeof s=="object"&&(0,_p.shouldUseRule)(t.schema,s)){let{type:o}=s.definition;o.length&&!o.some(i=>IO(e,i))&&bp(t,`missing type "${o.join(",")}" for keyword "${n}"`)}}}function IO(t,e){return t.includes(e)||e==="number"&&t.includes("integer")}function nb(t,e){return t.includes(e)||e==="integer"&&t.includes("number")}function RO(t,e){let r=[];for(let n of t.dataTypes)nb(e,n)?r.push(n):e.includes("integer")&&n==="number"&&r.push("integer");t.dataTypes=r}function bp(t,e){let r=t.schemaEnv.baseId+t.errSchemaPath;e+=` at "${r}" (strictTypes)`,(0,xr.checkStrictMode)(t,e,t.opts.strictTypes)}var ec=class{constructor(e,r,n){if((0,Yo.validateKeywordUsage)(e,r,n),this.gen=e.gen,this.allErrors=e.allErrors,this.keyword=n,this.data=e.data,this.schema=e.schema[n],this.$data=r.$data&&e.opts.$data&&this.schema&&this.schema.$data,this.schemaValue=(0,xr.schemaRefOrVal)(e,this.schema,n,this.$data),this.schemaType=r.schemaType,this.parentSchema=e.schema,this.params={},this.it=e,this.def=r,this.$data)this.schemaCode=e.gen.const("vSchema",ob(this.$data,e));else if(this.schemaCode=this.schemaValue,!(0,Yo.validSchemaType)(this.schema,r.schemaType,r.allowUndefined))throw new Error(`${n} value must be ${JSON.stringify(r.schemaType)}`);("code"in r?r.trackErrors:r.errors!==!1)&&(this.errsCount=e.gen.const("_errs",V.default.errors))}result(e,r,n){this.failResult((0,j.not)(e),r,n)}failResult(e,r,n){this.gen.if(e),n?n():this.error(),r?(this.gen.else(),r(),this.allErrors&&this.gen.endIf()):this.allErrors?this.gen.endIf():this.gen.else()}pass(e,r){this.failResult((0,j.not)(e),void 0,r)}fail(e){if(e===void 0){this.error(),this.allErrors||this.gen.if(!1);return}this.gen.if(e),this.error(),this.allErrors?this.gen.endIf():this.gen.else()}fail$data(e){if(!this.$data)return this.fail(e);let{schemaCode:r}=this;this.fail((0,j._)`${r} !== undefined && (${(0,j.or)(this.invalid$data(),e)})`)}error(e,r,n){if(r){this.setParams(r),this._error(e,n),this.setParams({});return}this._error(e,n)}_error(e,r){(e?Jo.reportExtraError:Jo.reportError)(this,this.def.error,r)}$dataError(){(0,Jo.reportError)(this,this.def.$dataError||Jo.keyword$DataError)}reset(){if(this.errsCount===void 0)throw new Error('add "trackErrors" to keyword definition');(0,Jo.resetErrorsCount)(this.gen,this.errsCount)}ok(e){this.allErrors||this.gen.if(e)}setParams(e,r){r?Object.assign(this.params,e):this.params=e}block$data(e,r,n=j.nil){this.gen.block(()=>{this.check$data(e,n),r()})}check$data(e=j.nil,r=j.nil){if(!this.$data)return;let{gen:n,schemaCode:s,schemaType:o,def:i}=this;n.if((0,j.or)((0,j._)`${s} === undefined`,r)),e!==j.nil&&n.assign(e,!0),(o.length||i.validateSchema)&&(n.elseIf(this.invalid$data()),this.$dataError(),e!==j.nil&&n.assign(e,!1)),n.else()}invalid$data(){let{gen:e,schemaCode:r,schemaType:n,def:s,it:o}=this;return(0,j.or)(i(),a());function i(){if(n.length){if(!(r instanceof j.Name))throw new Error("ajv implementation error");let c=Array.isArray(n)?n:[n];return(0,j._)`${(0,Xa.checkDataTypes)(c,r,o.opts.strictNumbers,Xa.DataType.Wrong)}`}return j.nil}function a(){if(s.validateSchema){let c=e.scopeValue("validate$data",{ref:s.validateSchema});return(0,j._)`!${c}(${r})`}return j.nil}}subschema(e,r){let n=(0,vp.getSubschema)(this.it,e);(0,vp.extendSubschemaData)(n,this.it,e),(0,vp.extendSubschemaMode)(n,e);let s={...this.it,...n,items:void 0,props:void 0};return _O(s,r),s}mergeEvaluated(e,r){let{it:n,gen:s}=this;n.opts.unevaluated&&(n.props!==!0&&e.props!==void 0&&(n.props=xr.mergeEvaluated.props(s,e.props,n.props,r)),n.items!==!0&&e.items!==void 0&&(n.items=xr.mergeEvaluated.items(s,e.items,n.items,r)))}mergeValidEvaluated(e,r){let{it:n,gen:s}=this;if(n.opts.unevaluated&&(n.props!==!0||n.items!==!0))return s.if(r,()=>this.mergeEvaluated(e,j.Name)),!0}};Hr.KeywordCxt=ec;function sb(t,e,r,n){let s=new ec(t,r,e);"code"in r?r.code(s,n):s.$data&&r.validate?(0,Yo.funcKeywordCode)(s,r):"macro"in r?(0,Yo.macroKeywordCode)(s,r):(r.compile||r.validate)&&(0,Yo.funcKeywordCode)(s,r)}var OO=/^\/(?:[^~]|~0|~1)*$/,NO=/^([0-9]+)(#|\/(?:[^~]|~0|~1)*)?$/;function ob(t,{dataLevel:e,dataNames:r,dataPathArr:n}){let s,o;if(t==="")return V.default.rootData;if(t[0]==="/"){if(!OO.test(t))throw new Error(`Invalid JSON-pointer: ${t}`);s=t,o=V.default.rootData}else{let u=NO.exec(t);if(!u)throw new Error(`Invalid JSON-pointer: ${t}`);let l=+u[1];if(s=u[2],s==="#"){if(l>=e)throw new Error(c("property/index",l));return n[e-l]}if(l>e)throw new Error(c("data",l));if(o=r[e-l],!s)return o}let i=o,a=s.split("/");for(let u of a)u&&(o=(0,j._)`${o}${(0,j.getProperty)((0,xr.unescapeJsonPointer)(u))}`,i=(0,j._)`${i} && ${o}`);return i;function c(u,l){return`Cannot access ${u} ${l} levels up, current level is ${e}`}}Hr.getData=ob});var tc=v($p=>{"use strict";Object.defineProperty($p,"__esModule",{value:!0});var wp=class extends Error{constructor(e){super("validation failed"),this.errors=e,this.ajv=this.validation=!0}};$p.default=wp});var Xo=v(Sp=>{"use strict";Object.defineProperty(Sp,"__esModule",{value:!0});var xp=Wo(),kp=class extends Error{constructor(e,r,n,s){super(s||`can't resolve reference ${n} from id ${r}`),this.missingRef=(0,xp.resolveUrl)(e,r,n),this.missingSchema=(0,xp.normalizeId)((0,xp.getFullPath)(e,this.missingRef))}};Sp.default=kp});var nc=v(zt=>{"use strict";Object.defineProperty(zt,"__esModule",{value:!0});zt.resolveSchema=zt.getCompilingSchema=zt.resolveRef=zt.compileSchema=zt.SchemaEnv=void 0;var Dt=G(),jO=tc(),An=$r(),Zt=Wo(),ib=le(),AO=Qo(),ks=class{constructor(e){var r;this.refs={},this.dynamicAnchors={};let n;typeof e.schema=="object"&&(n=e.schema),this.schema=e.schema,this.schemaId=e.schemaId,this.root=e.root||this,this.baseId=(r=e.baseId)!==null&&r!==void 0?r:(0,Zt.normalizeId)(n?.[e.schemaId||"$id"]),this.schemaPath=e.schemaPath,this.localRefs=e.localRefs,this.meta=e.meta,this.$async=n?.$async,this.refs={}}};zt.SchemaEnv=ks;function Tp(t){let e=ab.call(this,t);if(e)return e;let r=(0,Zt.getFullPath)(this.opts.uriResolver,t.root.baseId),{es5:n,lines:s}=this.opts.code,{ownProperties:o}=this.opts,i=new Dt.CodeGen(this.scope,{es5:n,lines:s,ownProperties:o}),a;t.$async&&(a=i.scopeValue("Error",{ref:jO.default,code:(0,Dt._)`require("ajv/dist/runtime/validation_error").default`}));let c=i.scopeName("validate");t.validateName=c;let u={gen:i,allErrors:this.opts.allErrors,data:An.default.data,parentData:An.default.parentData,parentDataProperty:An.default.parentDataProperty,dataNames:[An.default.data],dataPathArr:[Dt.nil],dataLevel:0,dataTypes:[],definedProperties:new Set,topSchemaRef:i.scopeValue("schema",this.opts.code.source===!0?{ref:t.schema,code:(0,Dt.stringify)(t.schema)}:{ref:t.schema}),validateName:c,ValidationError:a,schema:t.schema,schemaEnv:t,rootId:r,baseId:t.baseId||r,schemaPath:Dt.nil,errSchemaPath:t.schemaPath||(this.opts.jtd?"":"#"),errorPath:(0,Dt._)`""`,opts:this.opts,self:this},l;try{this._compilations.add(t),(0,AO.validateFunctionCode)(u),i.optimize(this.opts.code.optimize);let d=i.toString();l=`${i.scopeRefs(An.default.scope)}return ${d}`,this.opts.code.process&&(l=this.opts.code.process(l,t));let p=new Function(`${An.default.self}`,`${An.default.scope}`,l)(this,this.scope.get());if(this.scope.value(c,{ref:p}),p.errors=null,p.schema=t.schema,p.schemaEnv=t,t.$async&&(p.$async=!0),this.opts.code.source===!0&&(p.source={validateName:c,validateCode:d,scopeValues:i._values}),this.opts.unevaluated){let{props:m,items:h}=u;p.evaluated={props:m instanceof Dt.Name?void 0:m,items:h instanceof Dt.Name?void 0:h,dynamicProps:m instanceof Dt.Name,dynamicItems:h instanceof Dt.Name},p.source&&(p.source.evaluated=(0,Dt.stringify)(p.evaluated))}return t.validate=p,t}catch(d){throw delete t.validate,delete t.validateName,l&&this.logger.error("Error compiling schema, function code:",l),d}finally{this._compilations.delete(t)}}zt.compileSchema=Tp;function MO(t,e,r){var n;r=(0,Zt.resolveUrl)(this.opts.uriResolver,e,r);let s=t.refs[r];if(s)return s;let o=ZO.call(this,t,r);if(o===void 0){let i=(n=t.localRefs)===null||n===void 0?void 0:n[r],{schemaId:a}=this.opts;i&&(o=new ks({schema:i,schemaId:a,root:t,baseId:e}))}if(o!==void 0)return t.refs[r]=qO.call(this,o)}zt.resolveRef=MO;function qO(t){return(0,Zt.inlineRef)(t.schema,this.opts.inlineRefs)?t.schema:t.validate?t:Tp.call(this,t)}function ab(t){for(let e of this._compilations)if(DO(e,t))return e}zt.getCompilingSchema=ab;function DO(t,e){return t.schema===e.schema&&t.root===e.root&&t.baseId===e.baseId}function ZO(t,e){let r;for(;typeof(r=this.refs[e])=="string";)e=r;return r||this.schemas[e]||rc.call(this,t,e)}function rc(t,e){let r=this.opts.uriResolver.parse(e),n=(0,Zt._getFullPath)(this.opts.uriResolver,r),s=(0,Zt.getFullPath)(this.opts.uriResolver,t.baseId,void 0);if(Object.keys(t.schema).length>0&&n===s)return Pp.call(this,r,t);let o=(0,Zt.normalizeId)(n),i=this.refs[o]||this.schemas[o];if(typeof i=="string"){let a=rc.call(this,t,i);return typeof a?.schema!="object"?void 0:Pp.call(this,r,a)}if(typeof i?.schema=="object"){if(i.validate||Tp.call(this,i),o===(0,Zt.normalizeId)(e)){let{schema:a}=i,{schemaId:c}=this.opts,u=a[c];return u&&(s=(0,Zt.resolveUrl)(this.opts.uriResolver,s,u)),new ks({schema:a,schemaId:c,root:t,baseId:s})}return Pp.call(this,r,i)}}zt.resolveSchema=rc;var LO=new Set(["properties","patternProperties","enum","dependencies","definitions"]);function Pp(t,{baseId:e,schema:r,root:n}){var s;if(((s=t.fragment)===null||s===void 0?void 0:s[0])!=="/")return;for(let a of t.fragment.slice(1).split("/")){if(typeof r=="boolean")return;let c=r[(0,ib.unescapeFragment)(a)];if(c===void 0)return;r=c;let u=typeof r=="object"&&r[this.opts.schemaId];!LO.has(a)&&u&&(e=(0,Zt.resolveUrl)(this.opts.uriResolver,e,u))}let o;if(typeof r!="boolean"&&r.$ref&&!(0,ib.schemaHasRulesButRef)(r,this.RULES)){let a=(0,Zt.resolveUrl)(this.opts.uriResolver,e,r.$ref);o=rc.call(this,n,a)}let{schemaId:i}=this.opts;if(o=o||new ks({schema:r,schemaId:i,root:n,baseId:e}),o.schema!==o.root.schema)return o}});var cb=v((DV,VO)=>{VO.exports={$id:"https://raw.githubusercontent.com/ajv-validator/ajv/master/lib/refs/data.json#",description:"Meta-schema for $data reference (JSON AnySchema extension proposal)",type:"object",required:["$data"],properties:{$data:{type:"string",anyOf:[{format:"relative-json-pointer"},{format:"json-pointer"}]}},additionalProperties:!1}});var lb=v(Ep=>{"use strict";Object.defineProperty(Ep,"__esModule",{value:!0});var ub=Ul();ub.code='require("ajv/dist/runtime/uri").default';Ep.default=ub});var vb=v(He=>{"use strict";Object.defineProperty(He,"__esModule",{value:!0});He.CodeGen=He.Name=He.nil=He.stringify=He.str=He._=He.KeywordCxt=void 0;var FO=Qo();Object.defineProperty(He,"KeywordCxt",{enumerable:!0,get:function(){return FO.KeywordCxt}});var Ss=G();Object.defineProperty(He,"_",{enumerable:!0,get:function(){return Ss._}});Object.defineProperty(He,"str",{enumerable:!0,get:function(){return Ss.str}});Object.defineProperty(He,"stringify",{enumerable:!0,get:function(){return Ss.stringify}});Object.defineProperty(He,"nil",{enumerable:!0,get:function(){return Ss.nil}});Object.defineProperty(He,"Name",{enumerable:!0,get:function(){return Ss.Name}});Object.defineProperty(He,"CodeGen",{enumerable:!0,get:function(){return Ss.CodeGen}});var UO=tc(),hb=Xo(),HO=up(),ei=nc(),KO=G(),ti=Wo(),sc=Go(),Cp=le(),db=cb(),BO=lb(),gb=(t,e)=>new RegExp(t,e);gb.code="new RegExp";var GO=["removeAdditional","useDefaults","coerceTypes"],WO=new Set(["validate","serialize","parse","wrapper","root","schema","keyword","pattern","formats","validate$data","func","obj","Error"]),JO={errorDataPath:"",format:"`validateFormats: false` can be used instead.",nullable:'"nullable" keyword is supported by default.',jsonPointers:"Deprecated jsPropertySyntax can be used instead.",extendRefs:"Deprecated ignoreKeywordsWithRef can be used instead.",missingRefs:"Pass empty schema with $id that should be ignored to ajv.addSchema.",processCode:"Use option `code: {process: (code, schemaEnv: object) => string}`",sourceCode:"Use option `code: {source: true}`",strictDefaults:"It is default now, see option `strict`.",strictKeywords:"It is default now, see option `strict`.",uniqueItems:'"uniqueItems" keyword is always validated.',unknownFormats:"Disable strict mode or pass `true` to `ajv.addFormat` (or `formats` option).",cache:"Map is used as cache, schema object as key.",serialize:"Map is used as cache, schema object as key.",ajvErrors:"It is default now."},YO={ignoreKeywordsWithRef:"",jsPropertySyntax:"",unicode:'"minLength"/"maxLength" account for unicode characters by default.'},pb=200;function QO(t){var e,r,n,s,o,i,a,c,u,l,d,f,p,m,h,g,y,$,w,S,x,C,ee,fe,F;let ge=t.strict,Ae=(e=t.code)===null||e===void 0?void 0:e.optimize,Gr=Ae===!0||Ae===void 0?1:Ae||0,As=(n=(r=t.code)===null||r===void 0?void 0:r.regExp)!==null&&n!==void 0?n:gb,Ic=(s=t.uriResolver)!==null&&s!==void 0?s:BO.default;return{strictSchema:(i=(o=t.strictSchema)!==null&&o!==void 0?o:ge)!==null&&i!==void 0?i:!0,strictNumbers:(c=(a=t.strictNumbers)!==null&&a!==void 0?a:ge)!==null&&c!==void 0?c:!0,strictTypes:(l=(u=t.strictTypes)!==null&&u!==void 0?u:ge)!==null&&l!==void 0?l:"log",strictTuples:(f=(d=t.strictTuples)!==null&&d!==void 0?d:ge)!==null&&f!==void 0?f:"log",strictRequired:(m=(p=t.strictRequired)!==null&&p!==void 0?p:ge)!==null&&m!==void 0?m:!1,code:t.code?{...t.code,optimize:Gr,regExp:As}:{optimize:Gr,regExp:As},loopRequired:(h=t.loopRequired)!==null&&h!==void 0?h:pb,loopEnum:(g=t.loopEnum)!==null&&g!==void 0?g:pb,meta:(y=t.meta)!==null&&y!==void 0?y:!0,messages:($=t.messages)!==null&&$!==void 0?$:!0,inlineRefs:(w=t.inlineRefs)!==null&&w!==void 0?w:!0,schemaId:(S=t.schemaId)!==null&&S!==void 0?S:"$id",addUsedSchema:(x=t.addUsedSchema)!==null&&x!==void 0?x:!0,validateSchema:(C=t.validateSchema)!==null&&C!==void 0?C:!0,validateFormats:(ee=t.validateFormats)!==null&&ee!==void 0?ee:!0,unicodeRegExp:(fe=t.unicodeRegExp)!==null&&fe!==void 0?fe:!0,int32range:(F=t.int32range)!==null&&F!==void 0?F:!0,uriResolver:Ic}}var ri=class{constructor(e={}){this.schemas={},this.refs={},this.formats={},this._compilations=new Set,this._loading={},this._cache=new Map,e=this.opts={...e,...QO(e)};let{es5:r,lines:n}=this.opts.code;this.scope=new KO.ValueScope({scope:{},prefixes:WO,es5:r,lines:n}),this.logger=sN(e.logger);let s=e.validateFormats;e.validateFormats=!1,this.RULES=(0,HO.getRules)(),fb.call(this,JO,e,"NOT SUPPORTED"),fb.call(this,YO,e,"DEPRECATED","warn"),this._metaOpts=rN.call(this),e.formats&&eN.call(this),this._addVocabularies(),this._addDefaultMetaSchema(),e.keywords&&tN.call(this,e.keywords),typeof e.meta=="object"&&this.addMetaSchema(e.meta),XO.call(this),e.validateFormats=s}_addVocabularies(){this.addKeyword("$async")}_addDefaultMetaSchema(){let{$data:e,meta:r,schemaId:n}=this.opts,s=db;n==="id"&&(s={...db},s.id=s.$id,delete s.$id),r&&e&&this.addMetaSchema(s,s[n],!1)}defaultMeta(){let{meta:e,schemaId:r}=this.opts;return this.opts.defaultMeta=typeof e=="object"?e[r]||e:void 0}validate(e,r){let n;if(typeof e=="string"){if(n=this.getSchema(e),!n)throw new Error(`no schema with key or ref "${e}"`)}else n=this.compile(e);let s=n(r);return"$async"in n||(this.errors=n.errors),s}compile(e,r){let n=this._addSchema(e,r);return n.validate||this._compileSchemaEnv(n)}compileAsync(e,r){if(typeof this.opts.loadSchema!="function")throw new Error("options.loadSchema should be a function");let{loadSchema:n}=this.opts;return s.call(this,e,r);async function s(l,d){await o.call(this,l.$schema);let f=this._addSchema(l,d);return f.validate||i.call(this,f)}async function o(l){l&&!this.getSchema(l)&&await s.call(this,{$ref:l},!0)}async function i(l){try{return this._compileSchemaEnv(l)}catch(d){if(!(d instanceof hb.default))throw d;return a.call(this,d),await c.call(this,d.missingSchema),i.call(this,l)}}function a({missingSchema:l,missingRef:d}){if(this.refs[l])throw new Error(`AnySchema ${l} is loaded but ${d} cannot be resolved`)}async function c(l){let d=await u.call(this,l);this.refs[l]||await o.call(this,d.$schema),this.refs[l]||this.addSchema(d,l,r)}async function u(l){let d=this._loading[l];if(d)return d;try{return await(this._loading[l]=n(l))}finally{delete this._loading[l]}}}addSchema(e,r,n,s=this.opts.validateSchema){if(Array.isArray(e)){for(let i of e)this.addSchema(i,void 0,n,s);return this}let o;if(typeof e=="object"){let{schemaId:i}=this.opts;if(o=e[i],o!==void 0&&typeof o!="string")throw new Error(`schema ${i} must be string`)}return r=(0,ti.normalizeId)(r||o),this._checkUnique(r),this.schemas[r]=this._addSchema(e,n,r,s,!0),this}addMetaSchema(e,r,n=this.opts.validateSchema){return this.addSchema(e,r,!0,n),this}validateSchema(e,r){if(typeof e=="boolean")return!0;let n;if(n=e.$schema,n!==void 0&&typeof n!="string")throw new Error("$schema must be a string");if(n=n||this.opts.defaultMeta||this.defaultMeta(),!n)return this.logger.warn("meta-schema not available"),this.errors=null,!0;let s=this.validate(n,e);if(!s&&r){let o="schema is invalid: "+this.errorsText();if(this.opts.validateSchema==="log")this.logger.error(o);else throw new Error(o)}return s}getSchema(e){let r;for(;typeof(r=mb.call(this,e))=="string";)e=r;if(r===void 0){let{schemaId:n}=this.opts,s=new ei.SchemaEnv({schema:{},schemaId:n});if(r=ei.resolveSchema.call(this,s,e),!r)return;this.refs[e]=r}return r.validate||this._compileSchemaEnv(r)}removeSchema(e){if(e instanceof RegExp)return this._removeAllSchemas(this.schemas,e),this._removeAllSchemas(this.refs,e),this;switch(typeof e){case"undefined":return this._removeAllSchemas(this.schemas),this._removeAllSchemas(this.refs),this._cache.clear(),this;case"string":{let r=mb.call(this,e);return typeof r=="object"&&this._cache.delete(r.schema),delete this.schemas[e],delete this.refs[e],this}case"object":{let r=e;this._cache.delete(r);let n=e[this.opts.schemaId];return n&&(n=(0,ti.normalizeId)(n),delete this.schemas[n],delete this.refs[n]),this}default:throw new Error("ajv.removeSchema: invalid parameter")}}addVocabulary(e){for(let r of e)this.addKeyword(r);return this}addKeyword(e,r){let n;if(typeof e=="string")n=e,typeof r=="object"&&(this.logger.warn("these parameters are deprecated, see docs for addKeyword"),r.keyword=n);else if(typeof e=="object"&&r===void 0){if(r=e,n=r.keyword,Array.isArray(n)&&!n.length)throw new Error("addKeywords: keyword must be string or non-empty array")}else throw new Error("invalid addKeywords parameters");if(iN.call(this,n,r),!r)return(0,Cp.eachItem)(n,o=>zp.call(this,o)),this;cN.call(this,r);let s={...r,type:(0,sc.getJSONTypes)(r.type),schemaType:(0,sc.getJSONTypes)(r.schemaType)};return(0,Cp.eachItem)(n,s.type.length===0?o=>zp.call(this,o,s):o=>s.type.forEach(i=>zp.call(this,o,s,i))),this}getKeyword(e){let r=this.RULES.all[e];return typeof r=="object"?r.definition:!!r}removeKeyword(e){let{RULES:r}=this;delete r.keywords[e],delete r.all[e];for(let n of r.rules){let s=n.rules.findIndex(o=>o.keyword===e);s>=0&&n.rules.splice(s,1)}return this}addFormat(e,r){return typeof r=="string"&&(r=new RegExp(r)),this.formats[e]=r,this}errorsText(e=this.errors,{separator:r=", ",dataVar:n="data"}={}){return!e||e.length===0?"No errors":e.map(s=>`${n}${s.instancePath} ${s.message}`).reduce((s,o)=>s+r+o)}$dataMetaSchema(e,r){let n=this.RULES.all;e=JSON.parse(JSON.stringify(e));for(let s of r){let o=s.split("/").slice(1),i=e;for(let a of o)i=i[a];for(let a in n){let c=n[a];if(typeof c!="object")continue;let{$data:u}=c.definition,l=i[a];u&&l&&(i[a]=yb(l))}}return e}_removeAllSchemas(e,r){for(let n in e){let s=e[n];(!r||r.test(n))&&(typeof s=="string"?delete e[n]:s&&!s.meta&&(this._cache.delete(s.schema),delete e[n]))}}_addSchema(e,r,n,s=this.opts.validateSchema,o=this.opts.addUsedSchema){let i,{schemaId:a}=this.opts;if(typeof e=="object")i=e[a];else{if(this.opts.jtd)throw new Error("schema must be object");if(typeof e!="boolean")throw new Error("schema must be object or boolean")}let c=this._cache.get(e);if(c!==void 0)return c;n=(0,ti.normalizeId)(i||n);let u=ti.getSchemaRefs.call(this,e,n);return c=new ei.SchemaEnv({schema:e,schemaId:a,meta:r,baseId:n,localRefs:u}),this._cache.set(c.schema,c),o&&!n.startsWith("#")&&(n&&this._checkUnique(n),this.refs[n]=c),s&&this.validateSchema(e,!0),c}_checkUnique(e){if(this.schemas[e]||this.refs[e])throw new Error(`schema with key or id "${e}" already exists`)}_compileSchemaEnv(e){if(e.meta?this._compileMetaSchema(e):ei.compileSchema.call(this,e),!e.validate)throw new Error("ajv implementation error");return e.validate}_compileMetaSchema(e){let r=this.opts;this.opts=this._metaOpts;try{ei.compileSchema.call(this,e)}finally{this.opts=r}}};ri.ValidationError=UO.default;ri.MissingRefError=hb.default;He.default=ri;function fb(t,e,r,n="error"){for(let s in t){let o=s;o in e&&this.logger[n](`${r}: option ${s}. ${t[o]}`)}}function mb(t){return t=(0,ti.normalizeId)(t),this.schemas[t]||this.refs[t]}function XO(){let t=this.opts.schemas;if(t)if(Array.isArray(t))this.addSchema(t);else for(let e in t)this.addSchema(t[e],e)}function eN(){for(let t in this.opts.formats){let e=this.opts.formats[t];e&&this.addFormat(t,e)}}function tN(t){if(Array.isArray(t)){this.addVocabulary(t);return}this.logger.warn("keywords option as map is deprecated, pass array");for(let e in t){let r=t[e];r.keyword||(r.keyword=e),this.addKeyword(r)}}function rN(){let t={...this.opts};for(let e of GO)delete t[e];return t}var nN={log(){},warn(){},error(){}};function sN(t){if(t===!1)return nN;if(t===void 0)return console;if(t.log&&t.warn&&t.error)return t;throw new Error("logger must implement log, warn and error methods")}var oN=/^[a-z_$][a-z0-9_$:-]*$/i;function iN(t,e){let{RULES:r}=this;if((0,Cp.eachItem)(t,n=>{if(r.keywords[n])throw new Error(`Keyword ${n} is already defined`);if(!oN.test(n))throw new Error(`Keyword ${n} has invalid name`)}),!!e&&e.$data&&!("code"in e||"validate"in e))throw new Error('$data keyword must have "code" or "validate" function')}function zp(t,e,r){var n;let s=e?.post;if(r&&s)throw new Error('keyword with "post" flag cannot have "type"');let{RULES:o}=this,i=s?o.post:o.rules.find(({type:c})=>c===r);if(i||(i={type:r,rules:[]},o.rules.push(i)),o.keywords[t]=!0,!e)return;let a={keyword:t,definition:{...e,type:(0,sc.getJSONTypes)(e.type),schemaType:(0,sc.getJSONTypes)(e.schemaType)}};e.before?aN.call(this,i,a,e.before):i.rules.push(a),o.all[t]=a,(n=e.implements)===null||n===void 0||n.forEach(c=>this.addKeyword(c))}function aN(t,e,r){let n=t.rules.findIndex(s=>s.keyword===r);n>=0?t.rules.splice(n,0,e):(t.rules.push(e),this.logger.warn(`rule ${r} is not defined`))}function cN(t){let{metaSchema:e}=t;e!==void 0&&(t.$data&&this.opts.$data&&(e=yb(e)),t.validateSchema=this.compile(e,!0))}var uN={$ref:"https://raw.githubusercontent.com/ajv-validator/ajv/master/lib/refs/data.json#"};function yb(t){return{anyOf:[t,uN]}}});var _b=v(Ip=>{"use strict";Object.defineProperty(Ip,"__esModule",{value:!0});var lN={keyword:"id",code(){throw new Error('NOT SUPPORTED: keyword "id", use "$id" for schema ID')}};Ip.default=lN});var xb=v(Mn=>{"use strict";Object.defineProperty(Mn,"__esModule",{value:!0});Mn.callRef=Mn.getValidate=void 0;var dN=Xo(),bb=Et(),gt=G(),Ps=$r(),wb=nc(),oc=le(),pN={keyword:"$ref",schemaType:"string",code(t){let{gen:e,schema:r,it:n}=t,{baseId:s,schemaEnv:o,validateName:i,opts:a,self:c}=n,{root:u}=o;if((r==="#"||r==="#/")&&s===u.baseId)return d();let l=wb.resolveRef.call(c,u,s,r);if(l===void 0)throw new dN.default(n.opts.uriResolver,s,r);if(l instanceof wb.SchemaEnv)return f(l);return p(l);function d(){if(o===u)return ic(t,i,o,o.$async);let m=e.scopeValue("root",{ref:u});return ic(t,(0,gt._)`${m}.validate`,u,u.$async)}function f(m){let h=$b(t,m);ic(t,h,m,m.$async)}function p(m){let h=e.scopeValue("schema",a.code.source===!0?{ref:m,code:(0,gt.stringify)(m)}:{ref:m}),g=e.name("valid"),y=t.subschema({schema:m,dataTypes:[],schemaPath:gt.nil,topSchemaRef:h,errSchemaPath:r},g);t.mergeEvaluated(y),t.ok(g)}}};function $b(t,e){let{gen:r}=t;return e.validate?r.scopeValue("validate",{ref:e.validate}):(0,gt._)`${r.scopeValue("wrapper",{ref:e})}.validate`}Mn.getValidate=$b;function ic(t,e,r,n){let{gen:s,it:o}=t,{allErrors:i,schemaEnv:a,opts:c}=o,u=c.passContext?Ps.default.this:gt.nil;n?l():d();function l(){if(!a.$async)throw new Error("async schema referenced by sync schema");let m=s.let("valid");s.try(()=>{s.code((0,gt._)`await ${(0,bb.callValidateCode)(t,e,u)}`),p(e),i||s.assign(m,!0)},h=>{s.if((0,gt._)`!(${h} instanceof ${o.ValidationError})`,()=>s.throw(h)),f(h),i||s.assign(m,!1)}),t.ok(m)}function d(){t.result((0,bb.callValidateCode)(t,e,u),()=>p(e),()=>f(e))}function f(m){let h=(0,gt._)`${m}.errors`;s.assign(Ps.default.vErrors,(0,gt._)`${Ps.default.vErrors} === null ? ${h} : ${Ps.default.vErrors}.concat(${h})`),s.assign(Ps.default.errors,(0,gt._)`${Ps.default.vErrors}.length`)}function p(m){var h;if(!o.opts.unevaluated)return;let g=(h=r?.validate)===null||h===void 0?void 0:h.evaluated;if(o.props!==!0)if(g&&!g.dynamicProps)g.props!==void 0&&(o.props=oc.mergeEvaluated.props(s,g.props,o.props));else{let y=s.var("props",(0,gt._)`${m}.evaluated.props`);o.props=oc.mergeEvaluated.props(s,y,o.props,gt.Name)}if(o.items!==!0)if(g&&!g.dynamicItems)g.items!==void 0&&(o.items=oc.mergeEvaluated.items(s,g.items,o.items));else{let y=s.var("items",(0,gt._)`${m}.evaluated.items`);o.items=oc.mergeEvaluated.items(s,y,o.items,gt.Name)}}}Mn.callRef=ic;Mn.default=pN});var kb=v(Rp=>{"use strict";Object.defineProperty(Rp,"__esModule",{value:!0});var fN=_b(),mN=xb(),hN=["$schema","$id","$defs","$vocabulary",{keyword:"$comment"},"definitions",fN.default,mN.default];Rp.default=hN});var Sb=v(Op=>{"use strict";Object.defineProperty(Op,"__esModule",{value:!0});var ac=G(),Kr=ac.operators,cc={maximum:{okStr:"<=",ok:Kr.LTE,fail:Kr.GT},minimum:{okStr:">=",ok:Kr.GTE,fail:Kr.LT},exclusiveMaximum:{okStr:"<",ok:Kr.LT,fail:Kr.GTE},exclusiveMinimum:{okStr:">",ok:Kr.GT,fail:Kr.LTE}},gN={message:({keyword:t,schemaCode:e})=>(0,ac.str)`must be ${cc[t].okStr} ${e}`,params:({keyword:t,schemaCode:e})=>(0,ac._)`{comparison: ${cc[t].okStr}, limit: ${e}}`},yN={keyword:Object.keys(cc),type:"number",schemaType:"number",$data:!0,error:gN,code(t){let{keyword:e,data:r,schemaCode:n}=t;t.fail$data((0,ac._)`${r} ${cc[e].fail} ${n} || isNaN(${r})`)}};Op.default=yN});var Pb=v(Np=>{"use strict";Object.defineProperty(Np,"__esModule",{value:!0});var ni=G(),vN={message:({schemaCode:t})=>(0,ni.str)`must be multiple of ${t}`,params:({schemaCode:t})=>(0,ni._)`{multipleOf: ${t}}`},_N={keyword:"multipleOf",type:"number",schemaType:"number",$data:!0,error:vN,code(t){let{gen:e,data:r,schemaCode:n,it:s}=t,o=s.opts.multipleOfPrecision,i=e.let("res"),a=o?(0,ni._)`Math.abs(Math.round(${i}) - ${i}) > 1e-${o}`:(0,ni._)`${i} !== parseInt(${i})`;t.fail$data((0,ni._)`(${n} === 0 || (${i} = ${r}/${n}, ${a}))`)}};Np.default=_N});var Eb=v(jp=>{"use strict";Object.defineProperty(jp,"__esModule",{value:!0});function Tb(t){let e=t.length,r=0,n=0,s;for(;n<e;)r++,s=t.charCodeAt(n++),s>=55296&&s<=56319&&n<e&&(s=t.charCodeAt(n),(s&64512)===56320&&n++);return r}jp.default=Tb;Tb.code='require("ajv/dist/runtime/ucs2length").default'});var zb=v(Ap=>{"use strict";Object.defineProperty(Ap,"__esModule",{value:!0});var qn=G(),bN=le(),wN=Eb(),$N={message({keyword:t,schemaCode:e}){let r=t==="maxLength"?"more":"fewer";return(0,qn.str)`must NOT have ${r} than ${e} characters`},params:({schemaCode:t})=>(0,qn._)`{limit: ${t}}`},xN={keyword:["maxLength","minLength"],type:"string",schemaType:"number",$data:!0,error:$N,code(t){let{keyword:e,data:r,schemaCode:n,it:s}=t,o=e==="maxLength"?qn.operators.GT:qn.operators.LT,i=s.opts.unicode===!1?(0,qn._)`${r}.length`:(0,qn._)`${(0,bN.useFunc)(t.gen,wN.default)}(${r})`;t.fail$data((0,qn._)`${i} ${o} ${n}`)}};Ap.default=xN});var Cb=v(Mp=>{"use strict";Object.defineProperty(Mp,"__esModule",{value:!0});var kN=Et(),uc=G(),SN={message:({schemaCode:t})=>(0,uc.str)`must match pattern "${t}"`,params:({schemaCode:t})=>(0,uc._)`{pattern: ${t}}`},PN={keyword:"pattern",type:"string",schemaType:"string",$data:!0,error:SN,code(t){let{data:e,$data:r,schema:n,schemaCode:s,it:o}=t,i=o.opts.unicodeRegExp?"u":"",a=r?(0,uc._)`(new RegExp(${s}, ${i}))`:(0,kN.usePattern)(t,n);t.fail$data((0,uc._)`!${a}.test(${e})`)}};Mp.default=PN});var Ib=v(qp=>{"use strict";Object.defineProperty(qp,"__esModule",{value:!0});var si=G(),TN={message({keyword:t,schemaCode:e}){let r=t==="maxProperties"?"more":"fewer";return(0,si.str)`must NOT have ${r} than ${e} properties`},params:({schemaCode:t})=>(0,si._)`{limit: ${t}}`},EN={keyword:["maxProperties","minProperties"],type:"object",schemaType:"number",$data:!0,error:TN,code(t){let{keyword:e,data:r,schemaCode:n}=t,s=e==="maxProperties"?si.operators.GT:si.operators.LT;t.fail$data((0,si._)`Object.keys(${r}).length ${s} ${n}`)}};qp.default=EN});var Rb=v(Dp=>{"use strict";Object.defineProperty(Dp,"__esModule",{value:!0});var oi=Et(),ii=G(),zN=le(),CN={message:({params:{missingProperty:t}})=>(0,ii.str)`must have required property '${t}'`,params:({params:{missingProperty:t}})=>(0,ii._)`{missingProperty: ${t}}`},IN={keyword:"required",type:"object",schemaType:"array",$data:!0,error:CN,code(t){let{gen:e,schema:r,schemaCode:n,data:s,$data:o,it:i}=t,{opts:a}=i;if(!o&&r.length===0)return;let c=r.length>=a.loopRequired;if(i.allErrors?u():l(),a.strictRequired){let p=t.parentSchema.properties,{definedProperties:m}=t.it;for(let h of r)if(p?.[h]===void 0&&!m.has(h)){let g=i.schemaEnv.baseId+i.errSchemaPath,y=`required property "${h}" is not defined at "${g}" (strictRequired)`;(0,zN.checkStrictMode)(i,y,i.opts.strictRequired)}}function u(){if(c||o)t.block$data(ii.nil,d);else for(let p of r)(0,oi.checkReportMissingProp)(t,p)}function l(){let p=e.let("missing");if(c||o){let m=e.let("valid",!0);t.block$data(m,()=>f(p,m)),t.ok(m)}else e.if((0,oi.checkMissingProp)(t,r,p)),(0,oi.reportMissingProp)(t,p),e.else()}function d(){e.forOf("prop",n,p=>{t.setParams({missingProperty:p}),e.if((0,oi.noPropertyInData)(e,s,p,a.ownProperties),()=>t.error())})}function f(p,m){t.setParams({missingProperty:p}),e.forOf(p,n,()=>{e.assign(m,(0,oi.propertyInData)(e,s,p,a.ownProperties)),e.if((0,ii.not)(m),()=>{t.error(),e.break()})},ii.nil)}}};Dp.default=IN});var Ob=v(Zp=>{"use strict";Object.defineProperty(Zp,"__esModule",{value:!0});var ai=G(),RN={message({keyword:t,schemaCode:e}){let r=t==="maxItems"?"more":"fewer";return(0,ai.str)`must NOT have ${r} than ${e} items`},params:({schemaCode:t})=>(0,ai._)`{limit: ${t}}`},ON={keyword:["maxItems","minItems"],type:"array",schemaType:"number",$data:!0,error:RN,code(t){let{keyword:e,data:r,schemaCode:n}=t,s=e==="maxItems"?ai.operators.GT:ai.operators.LT;t.fail$data((0,ai._)`${r}.length ${s} ${n}`)}};Zp.default=ON});var lc=v(Lp=>{"use strict";Object.defineProperty(Lp,"__esModule",{value:!0});var Nb=bo();Nb.code='require("ajv/dist/runtime/equal").default';Lp.default=Nb});var jb=v(Fp=>{"use strict";Object.defineProperty(Fp,"__esModule",{value:!0});var Vp=Go(),Ke=G(),NN=le(),jN=lc(),AN={message:({params:{i:t,j:e}})=>(0,Ke.str)`must NOT have duplicate items (items ## ${e} and ${t} are identical)`,params:({params:{i:t,j:e}})=>(0,Ke._)`{i: ${t}, j: ${e}}`},MN={keyword:"uniqueItems",type:"array",schemaType:"boolean",$data:!0,error:AN,code(t){let{gen:e,data:r,$data:n,schema:s,parentSchema:o,schemaCode:i,it:a}=t;if(!n&&!s)return;let c=e.let("valid"),u=o.items?(0,Vp.getSchemaTypes)(o.items):[];t.block$data(c,l,(0,Ke._)`${i} === false`),t.ok(c);function l(){let m=e.let("i",(0,Ke._)`${r}.length`),h=e.let("j");t.setParams({i:m,j:h}),e.assign(c,!0),e.if((0,Ke._)`${m} > 1`,()=>(d()?f:p)(m,h))}function d(){return u.length>0&&!u.some(m=>m==="object"||m==="array")}function f(m,h){let g=e.name("item"),y=(0,Vp.checkDataTypes)(u,g,a.opts.strictNumbers,Vp.DataType.Wrong),$=e.const("indices",(0,Ke._)`{}`);e.for((0,Ke._)`;${m}--;`,()=>{e.let(g,(0,Ke._)`${r}[${m}]`),e.if(y,(0,Ke._)`continue`),u.length>1&&e.if((0,Ke._)`typeof ${g} == "string"`,(0,Ke._)`${g} += "_"`),e.if((0,Ke._)`typeof ${$}[${g}] == "number"`,()=>{e.assign(h,(0,Ke._)`${$}[${g}]`),t.error(),e.assign(c,!1).break()}).code((0,Ke._)`${$}[${g}] = ${m}`)})}function p(m,h){let g=(0,NN.useFunc)(e,jN.default),y=e.name("outer");e.label(y).for((0,Ke._)`;${m}--;`,()=>e.for((0,Ke._)`${h} = ${m}; ${h}--;`,()=>e.if((0,Ke._)`${g}(${r}[${m}], ${r}[${h}])`,()=>{t.error(),e.assign(c,!1).break(y)})))}}};Fp.default=MN});var Ab=v(Hp=>{"use strict";Object.defineProperty(Hp,"__esModule",{value:!0});var Up=G(),qN=le(),DN=lc(),ZN={message:"must be equal to constant",params:({schemaCode:t})=>(0,Up._)`{allowedValue: ${t}}`},LN={keyword:"const",$data:!0,error:ZN,code(t){let{gen:e,data:r,$data:n,schemaCode:s,schema:o}=t;n||o&&typeof o=="object"?t.fail$data((0,Up._)`!${(0,qN.useFunc)(e,DN.default)}(${r}, ${s})`):t.fail((0,Up._)`${o} !== ${r}`)}};Hp.default=LN});var Mb=v(Kp=>{"use strict";Object.defineProperty(Kp,"__esModule",{value:!0});var ci=G(),VN=le(),FN=lc(),UN={message:"must be equal to one of the allowed values",params:({schemaCode:t})=>(0,ci._)`{allowedValues: ${t}}`},HN={keyword:"enum",schemaType:"array",$data:!0,error:UN,code(t){let{gen:e,data:r,$data:n,schema:s,schemaCode:o,it:i}=t;if(!n&&s.length===0)throw new Error("enum must have non-empty array");let a=s.length>=i.opts.loopEnum,c,u=()=>c??(c=(0,VN.useFunc)(e,FN.default)),l;if(a||n)l=e.let("valid"),t.block$data(l,d);else{if(!Array.isArray(s))throw new Error("ajv implementation error");let p=e.const("vSchema",o);l=(0,ci.or)(...s.map((m,h)=>f(p,h)))}t.pass(l);function d(){e.assign(l,!1),e.forOf("v",o,p=>e.if((0,ci._)`${u()}(${r}, ${p})`,()=>e.assign(l,!0).break()))}function f(p,m){let h=s[m];return typeof h=="object"&&h!==null?(0,ci._)`${u()}(${r}, ${p}[${m}])`:(0,ci._)`${r} === ${h}`}}};Kp.default=HN});var qb=v(Bp=>{"use strict";Object.defineProperty(Bp,"__esModule",{value:!0});var KN=Sb(),BN=Pb(),GN=zb(),WN=Cb(),JN=Ib(),YN=Rb(),QN=Ob(),XN=jb(),ej=Ab(),tj=Mb(),rj=[KN.default,BN.default,GN.default,WN.default,JN.default,YN.default,QN.default,XN.default,{keyword:"type",schemaType:["string","array"]},{keyword:"nullable",schemaType:"boolean"},ej.default,tj.default];Bp.default=rj});var Wp=v(ui=>{"use strict";Object.defineProperty(ui,"__esModule",{value:!0});ui.validateAdditionalItems=void 0;var Dn=G(),Gp=le(),nj={message:({params:{len:t}})=>(0,Dn.str)`must NOT have more than ${t} items`,params:({params:{len:t}})=>(0,Dn._)`{limit: ${t}}`},sj={keyword:"additionalItems",type:"array",schemaType:["boolean","object"],before:"uniqueItems",error:nj,code(t){let{parentSchema:e,it:r}=t,{items:n}=e;if(!Array.isArray(n)){(0,Gp.checkStrictMode)(r,'"additionalItems" is ignored when "items" is not an array of schemas');return}Db(t,n)}};function Db(t,e){let{gen:r,schema:n,data:s,keyword:o,it:i}=t;i.items=!0;let a=r.const("len",(0,Dn._)`${s}.length`);if(n===!1)t.setParams({len:e.length}),t.pass((0,Dn._)`${a} <= ${e.length}`);else if(typeof n=="object"&&!(0,Gp.alwaysValidSchema)(i,n)){let u=r.var("valid",(0,Dn._)`${a} <= ${e.length}`);r.if((0,Dn.not)(u),()=>c(u)),t.ok(u)}function c(u){r.forRange("i",e.length,a,l=>{t.subschema({keyword:o,dataProp:l,dataPropType:Gp.Type.Num},u),i.allErrors||r.if((0,Dn.not)(u),()=>r.break())})}}ui.validateAdditionalItems=Db;ui.default=sj});var Jp=v(li=>{"use strict";Object.defineProperty(li,"__esModule",{value:!0});li.validateTuple=void 0;var Zb=G(),dc=le(),oj=Et(),ij={keyword:"items",type:"array",schemaType:["object","array","boolean"],before:"uniqueItems",code(t){let{schema:e,it:r}=t;if(Array.isArray(e))return Lb(t,"additionalItems",e);r.items=!0,!(0,dc.alwaysValidSchema)(r,e)&&t.ok((0,oj.validateArray)(t))}};function Lb(t,e,r=t.schema){let{gen:n,parentSchema:s,data:o,keyword:i,it:a}=t;l(s),a.opts.unevaluated&&r.length&&a.items!==!0&&(a.items=dc.mergeEvaluated.items(n,r.length,a.items));let c=n.name("valid"),u=n.const("len",(0,Zb._)`${o}.length`);r.forEach((d,f)=>{(0,dc.alwaysValidSchema)(a,d)||(n.if((0,Zb._)`${u} > ${f}`,()=>t.subschema({keyword:i,schemaProp:f,dataProp:f},c)),t.ok(c))});function l(d){let{opts:f,errSchemaPath:p}=a,m=r.length,h=m===d.minItems&&(m===d.maxItems||d[e]===!1);if(f.strictTuples&&!h){let g=`"${i}" is ${m}-tuple, but minItems or maxItems/${e} are not specified or different at path "${p}"`;(0,dc.checkStrictMode)(a,g,f.strictTuples)}}}li.validateTuple=Lb;li.default=ij});var Vb=v(Yp=>{"use strict";Object.defineProperty(Yp,"__esModule",{value:!0});var aj=Jp(),cj={keyword:"prefixItems",type:"array",schemaType:["array"],before:"uniqueItems",code:t=>(0,aj.validateTuple)(t,"items")};Yp.default=cj});var Ub=v(Qp=>{"use strict";Object.defineProperty(Qp,"__esModule",{value:!0});var Fb=G(),uj=le(),lj=Et(),dj=Wp(),pj={message:({params:{len:t}})=>(0,Fb.str)`must NOT have more than ${t} items`,params:({params:{len:t}})=>(0,Fb._)`{limit: ${t}}`},fj={keyword:"items",type:"array",schemaType:["object","boolean"],before:"uniqueItems",error:pj,code(t){let{schema:e,parentSchema:r,it:n}=t,{prefixItems:s}=r;n.items=!0,!(0,uj.alwaysValidSchema)(n,e)&&(s?(0,dj.validateAdditionalItems)(t,s):t.ok((0,lj.validateArray)(t)))}};Qp.default=fj});var Hb=v(Xp=>{"use strict";Object.defineProperty(Xp,"__esModule",{value:!0});var Ct=G(),pc=le(),mj={message:({params:{min:t,max:e}})=>e===void 0?(0,Ct.str)`must contain at least ${t} valid item(s)`:(0,Ct.str)`must contain at least ${t} and no more than ${e} valid item(s)`,params:({params:{min:t,max:e}})=>e===void 0?(0,Ct._)`{minContains: ${t}}`:(0,Ct._)`{minContains: ${t}, maxContains: ${e}}`},hj={keyword:"contains",type:"array",schemaType:["object","boolean"],before:"uniqueItems",trackErrors:!0,error:mj,code(t){let{gen:e,schema:r,parentSchema:n,data:s,it:o}=t,i,a,{minContains:c,maxContains:u}=n;o.opts.next?(i=c===void 0?1:c,a=u):i=1;let l=e.const("len",(0,Ct._)`${s}.length`);if(t.setParams({min:i,max:a}),a===void 0&&i===0){(0,pc.checkStrictMode)(o,'"minContains" == 0 without "maxContains": "contains" keyword ignored');return}if(a!==void 0&&i>a){(0,pc.checkStrictMode)(o,'"minContains" > "maxContains" is always invalid'),t.fail();return}if((0,pc.alwaysValidSchema)(o,r)){let h=(0,Ct._)`${l} >= ${i}`;a!==void 0&&(h=(0,Ct._)`${h} && ${l} <= ${a}`),t.pass(h);return}o.items=!0;let d=e.name("valid");a===void 0&&i===1?p(d,()=>e.if(d,()=>e.break())):i===0?(e.let(d,!0),a!==void 0&&e.if((0,Ct._)`${s}.length > 0`,f)):(e.let(d,!1),f()),t.result(d,()=>t.reset());function f(){let h=e.name("_valid"),g=e.let("count",0);p(h,()=>e.if(h,()=>m(g)))}function p(h,g){e.forRange("i",0,l,y=>{t.subschema({keyword:"contains",dataProp:y,dataPropType:pc.Type.Num,compositeRule:!0},h),g()})}function m(h){e.code((0,Ct._)`${h}++`),a===void 0?e.if((0,Ct._)`${h} >= ${i}`,()=>e.assign(d,!0).break()):(e.if((0,Ct._)`${h} > ${a}`,()=>e.assign(d,!1).break()),i===1?e.assign(d,!0):e.if((0,Ct._)`${h} >= ${i}`,()=>e.assign(d,!0)))}}};Xp.default=hj});var Gb=v(ir=>{"use strict";Object.defineProperty(ir,"__esModule",{value:!0});ir.validateSchemaDeps=ir.validatePropertyDeps=ir.error=void 0;var ef=G(),gj=le(),di=Et();ir.error={message:({params:{property:t,depsCount:e,deps:r}})=>{let n=e===1?"property":"properties";return(0,ef.str)`must have ${n} ${r} when property ${t} is present`},params:({params:{property:t,depsCount:e,deps:r,missingProperty:n}})=>(0,ef._)`{property: ${t},
    missingProperty: ${n},
    depsCount: ${e},
    deps: ${r}}`};var yj={keyword:"dependencies",type:"object",schemaType:"object",error:ir.error,code(t){let[e,r]=vj(t);Kb(t,e),Bb(t,r)}};function vj({schema:t}){let e={},r={};for(let n in t){if(n==="__proto__")continue;let s=Array.isArray(t[n])?e:r;s[n]=t[n]}return[e,r]}function Kb(t,e=t.schema){let{gen:r,data:n,it:s}=t;if(Object.keys(e).length===0)return;let o=r.let("missing");for(let i in e){let a=e[i];if(a.length===0)continue;let c=(0,di.propertyInData)(r,n,i,s.opts.ownProperties);t.setParams({property:i,depsCount:a.length,deps:a.join(", ")}),s.allErrors?r.if(c,()=>{for(let u of a)(0,di.checkReportMissingProp)(t,u)}):(r.if((0,ef._)`${c} && (${(0,di.checkMissingProp)(t,a,o)})`),(0,di.reportMissingProp)(t,o),r.else())}}ir.validatePropertyDeps=Kb;function Bb(t,e=t.schema){let{gen:r,data:n,keyword:s,it:o}=t,i=r.name("valid");for(let a in e)(0,gj.alwaysValidSchema)(o,e[a])||(r.if((0,di.propertyInData)(r,n,a,o.opts.ownProperties),()=>{let c=t.subschema({keyword:s,schemaProp:a},i);t.mergeValidEvaluated(c,i)},()=>r.var(i,!0)),t.ok(i))}ir.validateSchemaDeps=Bb;ir.default=yj});var Jb=v(tf=>{"use strict";Object.defineProperty(tf,"__esModule",{value:!0});var Wb=G(),_j=le(),bj={message:"property name must be valid",params:({params:t})=>(0,Wb._)`{propertyName: ${t.propertyName}}`},wj={keyword:"propertyNames",type:"object",schemaType:["object","boolean"],error:bj,code(t){let{gen:e,schema:r,data:n,it:s}=t;if((0,_j.alwaysValidSchema)(s,r))return;let o=e.name("valid");e.forIn("key",n,i=>{t.setParams({propertyName:i}),t.subschema({keyword:"propertyNames",data:i,dataTypes:["string"],propertyName:i,compositeRule:!0},o),e.if((0,Wb.not)(o),()=>{t.error(!0),s.allErrors||e.break()})}),t.ok(o)}};tf.default=wj});var nf=v(rf=>{"use strict";Object.defineProperty(rf,"__esModule",{value:!0});var fc=Et(),Lt=G(),$j=$r(),mc=le(),xj={message:"must NOT have additional properties",params:({params:t})=>(0,Lt._)`{additionalProperty: ${t.additionalProperty}}`},kj={keyword:"additionalProperties",type:["object"],schemaType:["boolean","object"],allowUndefined:!0,trackErrors:!0,error:xj,code(t){let{gen:e,schema:r,parentSchema:n,data:s,errsCount:o,it:i}=t;if(!o)throw new Error("ajv implementation error");let{allErrors:a,opts:c}=i;if(i.props=!0,c.removeAdditional!=="all"&&(0,mc.alwaysValidSchema)(i,r))return;let u=(0,fc.allSchemaProperties)(n.properties),l=(0,fc.allSchemaProperties)(n.patternProperties);d(),t.ok((0,Lt._)`${o} === ${$j.default.errors}`);function d(){e.forIn("key",s,g=>{!u.length&&!l.length?m(g):e.if(f(g),()=>m(g))})}function f(g){let y;if(u.length>8){let $=(0,mc.schemaRefOrVal)(i,n.properties,"properties");y=(0,fc.isOwnProperty)(e,$,g)}else u.length?y=(0,Lt.or)(...u.map($=>(0,Lt._)`${g} === ${$}`)):y=Lt.nil;return l.length&&(y=(0,Lt.or)(y,...l.map($=>(0,Lt._)`${(0,fc.usePattern)(t,$)}.test(${g})`))),(0,Lt.not)(y)}function p(g){e.code((0,Lt._)`delete ${s}[${g}]`)}function m(g){if(c.removeAdditional==="all"||c.removeAdditional&&r===!1){p(g);return}if(r===!1){t.setParams({additionalProperty:g}),t.error(),a||e.break();return}if(typeof r=="object"&&!(0,mc.alwaysValidSchema)(i,r)){let y=e.name("valid");c.removeAdditional==="failing"?(h(g,y,!1),e.if((0,Lt.not)(y),()=>{t.reset(),p(g)})):(h(g,y),a||e.if((0,Lt.not)(y),()=>e.break()))}}function h(g,y,$){let w={keyword:"additionalProperties",dataProp:g,dataPropType:mc.Type.Str};$===!1&&Object.assign(w,{compositeRule:!0,createErrors:!1,allErrors:!1}),t.subschema(w,y)}}};rf.default=kj});var Xb=v(of=>{"use strict";Object.defineProperty(of,"__esModule",{value:!0});var Sj=Qo(),Yb=Et(),sf=le(),Qb=nf(),Pj={keyword:"properties",type:"object",schemaType:"object",code(t){let{gen:e,schema:r,parentSchema:n,data:s,it:o}=t;o.opts.removeAdditional==="all"&&n.additionalProperties===void 0&&Qb.default.code(new Sj.KeywordCxt(o,Qb.default,"additionalProperties"));let i=(0,Yb.allSchemaProperties)(r);for(let d of i)o.definedProperties.add(d);o.opts.unevaluated&&i.length&&o.props!==!0&&(o.props=sf.mergeEvaluated.props(e,(0,sf.toHash)(i),o.props));let a=i.filter(d=>!(0,sf.alwaysValidSchema)(o,r[d]));if(a.length===0)return;let c=e.name("valid");for(let d of a)u(d)?l(d):(e.if((0,Yb.propertyInData)(e,s,d,o.opts.ownProperties)),l(d),o.allErrors||e.else().var(c,!0),e.endIf()),t.it.definedProperties.add(d),t.ok(c);function u(d){return o.opts.useDefaults&&!o.compositeRule&&r[d].default!==void 0}function l(d){t.subschema({keyword:"properties",schemaProp:d,dataProp:d},c)}}};of.default=Pj});var nw=v(af=>{"use strict";Object.defineProperty(af,"__esModule",{value:!0});var ew=Et(),hc=G(),tw=le(),rw=le(),Tj={keyword:"patternProperties",type:"object",schemaType:"object",code(t){let{gen:e,schema:r,data:n,parentSchema:s,it:o}=t,{opts:i}=o,a=(0,ew.allSchemaProperties)(r),c=a.filter(h=>(0,tw.alwaysValidSchema)(o,r[h]));if(a.length===0||c.length===a.length&&(!o.opts.unevaluated||o.props===!0))return;let u=i.strictSchema&&!i.allowMatchingProperties&&s.properties,l=e.name("valid");o.props!==!0&&!(o.props instanceof hc.Name)&&(o.props=(0,rw.evaluatedPropsToName)(e,o.props));let{props:d}=o;f();function f(){for(let h of a)u&&p(h),o.allErrors?m(h):(e.var(l,!0),m(h),e.if(l))}function p(h){for(let g in u)new RegExp(h).test(g)&&(0,tw.checkStrictMode)(o,`property ${g} matches pattern ${h} (use allowMatchingProperties)`)}function m(h){e.forIn("key",n,g=>{e.if((0,hc._)`${(0,ew.usePattern)(t,h)}.test(${g})`,()=>{let y=c.includes(h);y||t.subschema({keyword:"patternProperties",schemaProp:h,dataProp:g,dataPropType:rw.Type.Str},l),o.opts.unevaluated&&d!==!0?e.assign((0,hc._)`${d}[${g}]`,!0):!y&&!o.allErrors&&e.if((0,hc.not)(l),()=>e.break())})})}}};af.default=Tj});var sw=v(cf=>{"use strict";Object.defineProperty(cf,"__esModule",{value:!0});var Ej=le(),zj={keyword:"not",schemaType:["object","boolean"],trackErrors:!0,code(t){let{gen:e,schema:r,it:n}=t;if((0,Ej.alwaysValidSchema)(n,r)){t.fail();return}let s=e.name("valid");t.subschema({keyword:"not",compositeRule:!0,createErrors:!1,allErrors:!1},s),t.failResult(s,()=>t.reset(),()=>t.error())},error:{message:"must NOT be valid"}};cf.default=zj});var ow=v(uf=>{"use strict";Object.defineProperty(uf,"__esModule",{value:!0});var Cj=Et(),Ij={keyword:"anyOf",schemaType:"array",trackErrors:!0,code:Cj.validateUnion,error:{message:"must match a schema in anyOf"}};uf.default=Ij});var iw=v(lf=>{"use strict";Object.defineProperty(lf,"__esModule",{value:!0});var gc=G(),Rj=le(),Oj={message:"must match exactly one schema in oneOf",params:({params:t})=>(0,gc._)`{passingSchemas: ${t.passing}}`},Nj={keyword:"oneOf",schemaType:"array",trackErrors:!0,error:Oj,code(t){let{gen:e,schema:r,parentSchema:n,it:s}=t;if(!Array.isArray(r))throw new Error("ajv implementation error");if(s.opts.discriminator&&n.discriminator)return;let o=r,i=e.let("valid",!1),a=e.let("passing",null),c=e.name("_valid");t.setParams({passing:a}),e.block(u),t.result(i,()=>t.reset(),()=>t.error(!0));function u(){o.forEach((l,d)=>{let f;(0,Rj.alwaysValidSchema)(s,l)?e.var(c,!0):f=t.subschema({keyword:"oneOf",schemaProp:d,compositeRule:!0},c),d>0&&e.if((0,gc._)`${c} && ${i}`).assign(i,!1).assign(a,(0,gc._)`[${a}, ${d}]`).else(),e.if(c,()=>{e.assign(i,!0),e.assign(a,d),f&&t.mergeEvaluated(f,gc.Name)})})}}};lf.default=Nj});var aw=v(df=>{"use strict";Object.defineProperty(df,"__esModule",{value:!0});var jj=le(),Aj={keyword:"allOf",schemaType:"array",code(t){let{gen:e,schema:r,it:n}=t;if(!Array.isArray(r))throw new Error("ajv implementation error");let s=e.name("valid");r.forEach((o,i)=>{if((0,jj.alwaysValidSchema)(n,o))return;let a=t.subschema({keyword:"allOf",schemaProp:i},s);t.ok(s),t.mergeEvaluated(a)})}};df.default=Aj});var lw=v(pf=>{"use strict";Object.defineProperty(pf,"__esModule",{value:!0});var yc=G(),uw=le(),Mj={message:({params:t})=>(0,yc.str)`must match "${t.ifClause}" schema`,params:({params:t})=>(0,yc._)`{failingKeyword: ${t.ifClause}}`},qj={keyword:"if",schemaType:["object","boolean"],trackErrors:!0,error:Mj,code(t){let{gen:e,parentSchema:r,it:n}=t;r.then===void 0&&r.else===void 0&&(0,uw.checkStrictMode)(n,'"if" without "then" and "else" is ignored');let s=cw(n,"then"),o=cw(n,"else");if(!s&&!o)return;let i=e.let("valid",!0),a=e.name("_valid");if(c(),t.reset(),s&&o){let l=e.let("ifClause");t.setParams({ifClause:l}),e.if(a,u("then",l),u("else",l))}else s?e.if(a,u("then")):e.if((0,yc.not)(a),u("else"));t.pass(i,()=>t.error(!0));function c(){let l=t.subschema({keyword:"if",compositeRule:!0,createErrors:!1,allErrors:!1},a);t.mergeEvaluated(l)}function u(l,d){return()=>{let f=t.subschema({keyword:l},a);e.assign(i,a),t.mergeValidEvaluated(f,i),d?e.assign(d,(0,yc._)`${l}`):t.setParams({ifClause:l})}}}};function cw(t,e){let r=t.schema[e];return r!==void 0&&!(0,uw.alwaysValidSchema)(t,r)}pf.default=qj});var dw=v(ff=>{"use strict";Object.defineProperty(ff,"__esModule",{value:!0});var Dj=le(),Zj={keyword:["then","else"],schemaType:["object","boolean"],code({keyword:t,parentSchema:e,it:r}){e.if===void 0&&(0,Dj.checkStrictMode)(r,`"${t}" without "if" is ignored`)}};ff.default=Zj});var pw=v(mf=>{"use strict";Object.defineProperty(mf,"__esModule",{value:!0});var Lj=Wp(),Vj=Vb(),Fj=Jp(),Uj=Ub(),Hj=Hb(),Kj=Gb(),Bj=Jb(),Gj=nf(),Wj=Xb(),Jj=nw(),Yj=sw(),Qj=ow(),Xj=iw(),eA=aw(),tA=lw(),rA=dw();function nA(t=!1){let e=[Yj.default,Qj.default,Xj.default,eA.default,tA.default,rA.default,Bj.default,Gj.default,Kj.default,Wj.default,Jj.default];return t?e.push(Vj.default,Uj.default):e.push(Lj.default,Fj.default),e.push(Hj.default),e}mf.default=nA});var fw=v(hf=>{"use strict";Object.defineProperty(hf,"__esModule",{value:!0});var Oe=G(),sA={message:({schemaCode:t})=>(0,Oe.str)`must match format "${t}"`,params:({schemaCode:t})=>(0,Oe._)`{format: ${t}}`},oA={keyword:"format",type:["number","string"],schemaType:"string",$data:!0,error:sA,code(t,e){let{gen:r,data:n,$data:s,schema:o,schemaCode:i,it:a}=t,{opts:c,errSchemaPath:u,schemaEnv:l,self:d}=a;if(!c.validateFormats)return;s?f():p();function f(){let m=r.scopeValue("formats",{ref:d.formats,code:c.code.formats}),h=r.const("fDef",(0,Oe._)`${m}[${i}]`),g=r.let("fType"),y=r.let("format");r.if((0,Oe._)`typeof ${h} == "object" && !(${h} instanceof RegExp)`,()=>r.assign(g,(0,Oe._)`${h}.type || "string"`).assign(y,(0,Oe._)`${h}.validate`),()=>r.assign(g,(0,Oe._)`"string"`).assign(y,h)),t.fail$data((0,Oe.or)($(),w()));function $(){return c.strictSchema===!1?Oe.nil:(0,Oe._)`${i} && !${y}`}function w(){let S=l.$async?(0,Oe._)`(${h}.async ? await ${y}(${n}) : ${y}(${n}))`:(0,Oe._)`${y}(${n})`,x=(0,Oe._)`(typeof ${y} == "function" ? ${S} : ${y}.test(${n}))`;return(0,Oe._)`${y} && ${y} !== true && ${g} === ${e} && !${x}`}}function p(){let m=d.formats[o];if(!m){$();return}if(m===!0)return;let[h,g,y]=w(m);h===e&&t.pass(S());function $(){if(c.strictSchema===!1){d.logger.warn(x());return}throw new Error(x());function x(){return`unknown format "${o}" ignored in schema at path "${u}"`}}function w(x){let C=x instanceof RegExp?(0,Oe.regexpCode)(x):c.code.formats?(0,Oe._)`${c.code.formats}${(0,Oe.getProperty)(o)}`:void 0,ee=r.scopeValue("formats",{key:o,ref:x,code:C});return typeof x=="object"&&!(x instanceof RegExp)?[x.type||"string",x.validate,(0,Oe._)`${ee}.validate`]:["string",x,ee]}function S(){if(typeof m=="object"&&!(m instanceof RegExp)&&m.async){if(!l.$async)throw new Error("async format in sync schema");return(0,Oe._)`await ${y}(${n})`}return typeof g=="function"?(0,Oe._)`${y}(${n})`:(0,Oe._)`${y}.test(${n})`}}}};hf.default=oA});var mw=v(gf=>{"use strict";Object.defineProperty(gf,"__esModule",{value:!0});var iA=fw(),aA=[iA.default];gf.default=aA});var hw=v(Ts=>{"use strict";Object.defineProperty(Ts,"__esModule",{value:!0});Ts.contentVocabulary=Ts.metadataVocabulary=void 0;Ts.metadataVocabulary=["title","description","default","deprecated","readOnly","writeOnly","examples"];Ts.contentVocabulary=["contentMediaType","contentEncoding","contentSchema"]});var yw=v(yf=>{"use strict";Object.defineProperty(yf,"__esModule",{value:!0});var cA=kb(),uA=qb(),lA=pw(),dA=mw(),gw=hw(),pA=[cA.default,uA.default,(0,lA.default)(),dA.default,gw.metadataVocabulary,gw.contentVocabulary];yf.default=pA});var _w=v(vc=>{"use strict";Object.defineProperty(vc,"__esModule",{value:!0});vc.DiscrError=void 0;var vw;(function(t){t.Tag="tag",t.Mapping="mapping"})(vw||(vc.DiscrError=vw={}))});var ww=v(_f=>{"use strict";Object.defineProperty(_f,"__esModule",{value:!0});var Es=G(),vf=_w(),bw=nc(),fA=Xo(),mA=le(),hA={message:({params:{discrError:t,tagName:e}})=>t===vf.DiscrError.Tag?`tag "${e}" must be string`:`value of tag "${e}" must be in oneOf`,params:({params:{discrError:t,tag:e,tagName:r}})=>(0,Es._)`{error: ${t}, tag: ${r}, tagValue: ${e}}`},gA={keyword:"discriminator",type:"object",schemaType:"object",error:hA,code(t){let{gen:e,data:r,schema:n,parentSchema:s,it:o}=t,{oneOf:i}=s;if(!o.opts.discriminator)throw new Error("discriminator: requires discriminator option");let a=n.propertyName;if(typeof a!="string")throw new Error("discriminator: requires propertyName");if(n.mapping)throw new Error("discriminator: mapping is not supported");if(!i)throw new Error("discriminator: requires oneOf keyword");let c=e.let("valid",!1),u=e.const("tag",(0,Es._)`${r}${(0,Es.getProperty)(a)}`);e.if((0,Es._)`typeof ${u} == "string"`,()=>l(),()=>t.error(!1,{discrError:vf.DiscrError.Tag,tag:u,tagName:a})),t.ok(c);function l(){let p=f();e.if(!1);for(let m in p)e.elseIf((0,Es._)`${u} === ${m}`),e.assign(c,d(p[m]));e.else(),t.error(!1,{discrError:vf.DiscrError.Mapping,tag:u,tagName:a}),e.endIf()}function d(p){let m=e.name("valid"),h=t.subschema({keyword:"oneOf",schemaProp:p},m);return t.mergeEvaluated(h,Es.Name),m}function f(){var p;let m={},h=y(s),g=!0;for(let S=0;S<i.length;S++){let x=i[S];if(x?.$ref&&!(0,mA.schemaHasRulesButRef)(x,o.self.RULES)){let ee=x.$ref;if(x=bw.resolveRef.call(o.self,o.schemaEnv.root,o.baseId,ee),x instanceof bw.SchemaEnv&&(x=x.schema),x===void 0)throw new fA.default(o.opts.uriResolver,o.baseId,ee)}let C=(p=x?.properties)===null||p===void 0?void 0:p[a];if(typeof C!="object")throw new Error(`discriminator: oneOf subschemas (or referenced schemas) must have "properties/${a}"`);g=g&&(h||y(x)),$(C,S)}if(!g)throw new Error(`discriminator: "${a}" must be required`);return m;function y({required:S}){return Array.isArray(S)&&S.includes(a)}function $(S,x){if(S.const)w(S.const,x);else if(S.enum)for(let C of S.enum)w(C,x);else throw new Error(`discriminator: "properties/${a}" must have "const" or "enum"`)}function w(S,x){if(typeof S!="string"||S in m)throw new Error(`discriminator: "${a}" values must be unique strings`);m[S]=x}}}};_f.default=gA});var $w=v((TF,yA)=>{yA.exports={$schema:"http://json-schema.org/draft-07/schema#",$id:"http://json-schema.org/draft-07/schema#",title:"Core schema meta-schema",definitions:{schemaArray:{type:"array",minItems:1,items:{$ref:"#"}},nonNegativeInteger:{type:"integer",minimum:0},nonNegativeIntegerDefault0:{allOf:[{$ref:"#/definitions/nonNegativeInteger"},{default:0}]},simpleTypes:{enum:["array","boolean","integer","null","number","object","string"]},stringArray:{type:"array",items:{type:"string"},uniqueItems:!0,default:[]}},type:["object","boolean"],properties:{$id:{type:"string",format:"uri-reference"},$schema:{type:"string",format:"uri"},$ref:{type:"string",format:"uri-reference"},$comment:{type:"string"},title:{type:"string"},description:{type:"string"},default:!0,readOnly:{type:"boolean",default:!1},examples:{type:"array",items:!0},multipleOf:{type:"number",exclusiveMinimum:0},maximum:{type:"number"},exclusiveMaximum:{type:"number"},minimum:{type:"number"},exclusiveMinimum:{type:"number"},maxLength:{$ref:"#/definitions/nonNegativeInteger"},minLength:{$ref:"#/definitions/nonNegativeIntegerDefault0"},pattern:{type:"string",format:"regex"},additionalItems:{$ref:"#"},items:{anyOf:[{$ref:"#"},{$ref:"#/definitions/schemaArray"}],default:!0},maxItems:{$ref:"#/definitions/nonNegativeInteger"},minItems:{$ref:"#/definitions/nonNegativeIntegerDefault0"},uniqueItems:{type:"boolean",default:!1},contains:{$ref:"#"},maxProperties:{$ref:"#/definitions/nonNegativeInteger"},minProperties:{$ref:"#/definitions/nonNegativeIntegerDefault0"},required:{$ref:"#/definitions/stringArray"},additionalProperties:{$ref:"#"},definitions:{type:"object",additionalProperties:{$ref:"#"},default:{}},properties:{type:"object",additionalProperties:{$ref:"#"},default:{}},patternProperties:{type:"object",additionalProperties:{$ref:"#"},propertyNames:{format:"regex"},default:{}},dependencies:{type:"object",additionalProperties:{anyOf:[{$ref:"#"},{$ref:"#/definitions/stringArray"}]}},propertyNames:{$ref:"#"},const:!0,enum:{type:"array",items:!0,minItems:1,uniqueItems:!0},type:{anyOf:[{$ref:"#/definitions/simpleTypes"},{type:"array",items:{$ref:"#/definitions/simpleTypes"},minItems:1,uniqueItems:!0}]},format:{type:"string"},contentMediaType:{type:"string"},contentEncoding:{type:"string"},if:{$ref:"#"},then:{$ref:"#"},else:{$ref:"#"},allOf:{$ref:"#/definitions/schemaArray"},anyOf:{$ref:"#/definitions/schemaArray"},oneOf:{$ref:"#/definitions/schemaArray"},not:{$ref:"#"}},default:!0}});var kw=v((Ee,bf)=>{"use strict";Object.defineProperty(Ee,"__esModule",{value:!0});Ee.MissingRefError=Ee.ValidationError=Ee.CodeGen=Ee.Name=Ee.nil=Ee.stringify=Ee.str=Ee._=Ee.KeywordCxt=Ee.Ajv=void 0;var vA=vb(),_A=yw(),bA=ww(),xw=$w(),wA=["/properties"],_c="http://json-schema.org/draft-07/schema",zs=class extends vA.default{_addVocabularies(){super._addVocabularies(),_A.default.forEach(e=>this.addVocabulary(e)),this.opts.discriminator&&this.addKeyword(bA.default)}_addDefaultMetaSchema(){if(super._addDefaultMetaSchema(),!this.opts.meta)return;let e=this.opts.$data?this.$dataMetaSchema(xw,wA):xw;this.addMetaSchema(e,_c,!1),this.refs["http://json-schema.org/schema"]=_c}defaultMeta(){return this.opts.defaultMeta=super.defaultMeta()||(this.getSchema(_c)?_c:void 0)}};Ee.Ajv=zs;bf.exports=Ee=zs;bf.exports.Ajv=zs;Object.defineProperty(Ee,"__esModule",{value:!0});Ee.default=zs;var $A=Qo();Object.defineProperty(Ee,"KeywordCxt",{enumerable:!0,get:function(){return $A.KeywordCxt}});var Cs=G();Object.defineProperty(Ee,"_",{enumerable:!0,get:function(){return Cs._}});Object.defineProperty(Ee,"str",{enumerable:!0,get:function(){return Cs.str}});Object.defineProperty(Ee,"stringify",{enumerable:!0,get:function(){return Cs.stringify}});Object.defineProperty(Ee,"nil",{enumerable:!0,get:function(){return Cs.nil}});Object.defineProperty(Ee,"Name",{enumerable:!0,get:function(){return Cs.Name}});Object.defineProperty(Ee,"CodeGen",{enumerable:!0,get:function(){return Cs.CodeGen}});var xA=tc();Object.defineProperty(Ee,"ValidationError",{enumerable:!0,get:function(){return xA.default}});var kA=Xo();Object.defineProperty(Ee,"MissingRefError",{enumerable:!0,get:function(){return kA.default}})});var Sw=v(Is=>{"use strict";Object.defineProperty(Is,"__esModule",{value:!0});Is.formatLimitDefinition=void 0;var SA=kw(),Vt=G(),Br=Vt.operators,bc={formatMaximum:{okStr:"<=",ok:Br.LTE,fail:Br.GT},formatMinimum:{okStr:">=",ok:Br.GTE,fail:Br.LT},formatExclusiveMaximum:{okStr:"<",ok:Br.LT,fail:Br.GTE},formatExclusiveMinimum:{okStr:">",ok:Br.GT,fail:Br.LTE}},PA={message:({keyword:t,schemaCode:e})=>(0,Vt.str)`should be ${bc[t].okStr} ${e}`,params:({keyword:t,schemaCode:e})=>(0,Vt._)`{comparison: ${bc[t].okStr}, limit: ${e}}`};Is.formatLimitDefinition={keyword:Object.keys(bc),type:"string",schemaType:"string",$data:!0,error:PA,code(t){let{gen:e,data:r,schemaCode:n,keyword:s,it:o}=t,{opts:i,self:a}=o;if(!i.validateFormats)return;let c=new SA.KeywordCxt(o,a.RULES.all.format.definition,"format");c.$data?u():l();function u(){let f=e.scopeValue("formats",{ref:a.formats,code:i.code.formats}),p=e.const("fmt",(0,Vt._)`${f}[${c.schemaCode}]`);t.fail$data((0,Vt.or)((0,Vt._)`typeof ${p} != "object"`,(0,Vt._)`${p} instanceof RegExp`,(0,Vt._)`typeof ${p}.compare != "function"`,d(p)))}function l(){let f=c.schema,p=a.formats[f];if(!p||p===!0)return;if(typeof p!="object"||p instanceof RegExp||typeof p.compare!="function")throw new Error(`"${s}": format "${f}" does not define "compare" function`);let m=e.scopeValue("formats",{key:f,ref:p,code:i.code.formats?(0,Vt._)`${i.code.formats}${(0,Vt.getProperty)(f)}`:void 0});t.fail$data(d(m))}function d(f){return(0,Vt._)`${f}.compare(${r}, ${n}) ${bc[s].fail} 0`}},dependencies:["format"]};var TA=t=>(t.addKeyword(Is.formatLimitDefinition),t);Is.default=TA});var zw=v((pi,Ew)=>{"use strict";Object.defineProperty(pi,"__esModule",{value:!0});var Rs=l0(),EA=Sw(),wf=G(),Pw=new wf.Name("fullFormats"),zA=new wf.Name("fastFormats"),$f=(t,e={keywords:!0})=>{if(Array.isArray(e))return Tw(t,e,Rs.fullFormats,Pw),t;let[r,n]=e.mode==="fast"?[Rs.fastFormats,zA]:[Rs.fullFormats,Pw],s=e.formats||Rs.formatNames;return Tw(t,s,r,n),e.keywords&&(0,EA.default)(t),t};$f.get=(t,e="full")=>{let n=(e==="fast"?Rs.fastFormats:Rs.fullFormats)[t];if(!n)throw new Error(`Unknown format "${t}"`);return n};function Tw(t,e,r,n){var s,o;(s=(o=t.opts.code).formats)!==null&&s!==void 0||(o.formats=(0,wf._)`require("ajv-formats/dist/formats").${n}`);for(let i of e)t.addFormat(i,r[i])}Ew.exports=pi=$f;Object.defineProperty(pi,"__esModule",{value:!0});pi.default=$f});var qw=v((ZF,Mw)=>{Mw.exports=Aw;Aw.sync=OA;var Nw=require("fs");function RA(t,e){var r=e.pathExt!==void 0?e.pathExt:process.env.PATHEXT;if(!r||(r=r.split(";"),r.indexOf("")!==-1))return!0;for(var n=0;n<r.length;n++){var s=r[n].toLowerCase();if(s&&t.substr(-s.length).toLowerCase()===s)return!0}return!1}function jw(t,e,r){return!t.isSymbolicLink()&&!t.isFile()?!1:RA(e,r)}function Aw(t,e,r){Nw.stat(t,function(n,s){r(n,n?!1:jw(s,t,e))})}function OA(t,e){return jw(Nw.statSync(t),t,e)}});var Fw=v((LF,Vw)=>{Vw.exports=Zw;Zw.sync=NA;var Dw=require("fs");function Zw(t,e,r){Dw.stat(t,function(n,s){r(n,n?!1:Lw(s,e))})}function NA(t,e){return Lw(Dw.statSync(t),e)}function Lw(t,e){return t.isFile()&&jA(t,e)}function jA(t,e){var r=t.mode,n=t.uid,s=t.gid,o=e.uid!==void 0?e.uid:process.getuid&&process.getuid(),i=e.gid!==void 0?e.gid:process.getgid&&process.getgid(),a=parseInt("100",8),c=parseInt("010",8),u=parseInt("001",8),l=a|c,d=r&u||r&c&&s===i||r&a&&n===o||r&l&&o===0;return d}});var Hw=v((FF,Uw)=>{var VF=require("fs"),Sc;process.platform==="win32"||global.TESTING_WINDOWS?Sc=qw():Sc=Fw();Uw.exports=xf;xf.sync=AA;function xf(t,e,r){if(typeof e=="function"&&(r=e,e={}),!r){if(typeof Promise!="function")throw new TypeError("callback not provided");return new Promise(function(n,s){xf(t,e||{},function(o,i){o?s(o):n(i)})})}Sc(t,e||{},function(n,s){n&&(n.code==="EACCES"||e&&e.ignoreErrors)&&(n=null,s=!1),r(n,s)})}function AA(t,e){try{return Sc.sync(t,e||{})}catch(r){if(e&&e.ignoreErrors||r.code==="EACCES")return!1;throw r}}});var Qw=v((UF,Yw)=>{var Os=process.platform==="win32"||process.env.OSTYPE==="cygwin"||process.env.OSTYPE==="msys",Kw=require("path"),MA=Os?";":":",Bw=Hw(),Gw=t=>Object.assign(new Error(`not found: ${t}`),{code:"ENOENT"}),Ww=(t,e)=>{let r=e.colon||MA,n=t.match(/\//)||Os&&t.match(/\\/)?[""]:[...Os?[process.cwd()]:[],...(e.path||process.env.PATH||"").split(r)],s=Os?e.pathExt||process.env.PATHEXT||".EXE;.CMD;.BAT;.COM":"",o=Os?s.split(r):[""];return Os&&t.indexOf(".")!==-1&&o[0]!==""&&o.unshift(""),{pathEnv:n,pathExt:o,pathExtExe:s}},Jw=(t,e,r)=>{typeof e=="function"&&(r=e,e={}),e||(e={});let{pathEnv:n,pathExt:s,pathExtExe:o}=Ww(t,e),i=[],a=u=>new Promise((l,d)=>{if(u===n.length)return e.all&&i.length?l(i):d(Gw(t));let f=n[u],p=/^".*"$/.test(f)?f.slice(1,-1):f,m=Kw.join(p,t),h=!p&&/^\.[\\\/]/.test(t)?t.slice(0,2)+m:m;l(c(h,u,0))}),c=(u,l,d)=>new Promise((f,p)=>{if(d===s.length)return f(a(l+1));let m=s[d];Bw(u+m,{pathExt:o},(h,g)=>{if(!h&&g)if(e.all)i.push(u+m);else return f(u+m);return f(c(u,l,d+1))})});return r?a(0).then(u=>r(null,u),r):a(0)},qA=(t,e)=>{e=e||{};let{pathEnv:r,pathExt:n,pathExtExe:s}=Ww(t,e),o=[];for(let i=0;i<r.length;i++){let a=r[i],c=/^".*"$/.test(a)?a.slice(1,-1):a,u=Kw.join(c,t),l=!c&&/^\.[\\\/]/.test(t)?t.slice(0,2)+u:u;for(let d=0;d<n.length;d++){let f=l+n[d];try{if(Bw.sync(f,{pathExt:s}))if(e.all)o.push(f);else return f}catch{}}}if(e.all&&o.length)return o;if(e.nothrow)return null;throw Gw(t)};Yw.exports=Jw;Jw.sync=qA});var e$=v((HF,kf)=>{"use strict";var Xw=(t={})=>{let e=t.env||process.env;return(t.platform||process.platform)!=="win32"?"PATH":Object.keys(e).reverse().find(n=>n.toUpperCase()==="PATH")||"Path"};kf.exports=Xw;kf.exports.default=Xw});var s$=v((KF,n$)=>{"use strict";var t$=require("path"),DA=Qw(),ZA=e$();function r$(t,e){let r=t.options.env||process.env,n=process.cwd(),s=t.options.cwd!=null,o=s&&process.chdir!==void 0&&!process.chdir.disabled;if(o)try{process.chdir(t.options.cwd)}catch{}let i;try{i=DA.sync(t.command,{path:r[ZA({env:r})],pathExt:e?t$.delimiter:void 0})}catch{}finally{o&&process.chdir(n)}return i&&(i=t$.resolve(s?t.options.cwd:"",i)),i}function LA(t){return r$(t)||r$(t,!0)}n$.exports=LA});var o$=v((BF,Pf)=>{"use strict";var Sf=/([()\][%!^"`<>&|;, *?])/g;function VA(t){return t=t.replace(Sf,"^$1"),t}function FA(t,e){return t=`${t}`,t=t.replace(/(?=(\\+?)?)\1"/g,'$1$1\\"'),t=t.replace(/(?=(\\+?)?)\1$/,"$1$1"),t=`"${t}"`,t=t.replace(Sf,"^$1"),e&&(t=t.replace(Sf,"^$1")),t}Pf.exports.command=VA;Pf.exports.argument=FA});var a$=v((GF,i$)=>{"use strict";i$.exports=/^#!(.*)/});var u$=v((WF,c$)=>{"use strict";var UA=a$();c$.exports=(t="")=>{let e=t.match(UA);if(!e)return null;let[r,n]=e[0].replace(/#! ?/,"").split(" "),s=r.split("/").pop();return s==="env"?n:n?`${s} ${n}`:s}});var d$=v((JF,l$)=>{"use strict";var Tf=require("fs"),HA=u$();function KA(t){let r=Buffer.alloc(150),n;try{n=Tf.openSync(t,"r"),Tf.readSync(n,r,0,150,0),Tf.closeSync(n)}catch{}return HA(r.toString())}l$.exports=KA});var h$=v((YF,m$)=>{"use strict";var BA=require("path"),p$=s$(),f$=o$(),GA=d$(),WA=process.platform==="win32",JA=/\.(?:com|exe)$/i,YA=/node_modules[\\/].bin[\\/][^\\/]+\.cmd$/i;function QA(t){t.file=p$(t);let e=t.file&&GA(t.file);return e?(t.args.unshift(t.file),t.command=e,p$(t)):t.file}function XA(t){if(!WA)return t;let e=QA(t),r=!JA.test(e);if(t.options.forceShell||r){let n=YA.test(e);t.command=BA.normalize(t.command),t.command=f$.command(t.command),t.args=t.args.map(o=>f$.argument(o,n));let s=[t.command].concat(t.args).join(" ");t.args=["/d","/s","/c",`"${s}"`],t.command=process.env.comspec||"cmd.exe",t.options.windowsVerbatimArguments=!0}return t}function eM(t,e,r){e&&!Array.isArray(e)&&(r=e,e=null),e=e?e.slice(0):[],r=Object.assign({},r);let n={command:t,args:e,options:r,file:void 0,original:{command:t,args:e}};return r.shell?n:XA(n)}m$.exports=eM});var v$=v((QF,y$)=>{"use strict";var Ef=process.platform==="win32";function zf(t,e){return Object.assign(new Error(`${e} ${t.command} ENOENT`),{code:"ENOENT",errno:"ENOENT",syscall:`${e} ${t.command}`,path:t.command,spawnargs:t.args})}function tM(t,e){if(!Ef)return;let r=t.emit;t.emit=function(n,s){if(n==="exit"){let o=g$(s,e);if(o)return r.call(t,"error",o)}return r.apply(t,arguments)}}function g$(t,e){return Ef&&t===1&&!e.file?zf(e.original,"spawn"):null}function rM(t,e){return Ef&&t===1&&!e.file?zf(e.original,"spawnSync"):null}y$.exports={hookChildProcess:tM,verifyENOENT:g$,verifyENOENTSync:rM,notFoundError:zf}});var w$=v((XF,Ns)=>{"use strict";var _$=require("child_process"),Cf=h$(),If=v$();function b$(t,e,r){let n=Cf(t,e,r),s=_$.spawn(n.command,n.args,n.options);return If.hookChildProcess(s,n),s}function nM(t,e,r){let n=Cf(t,e,r),s=_$.spawnSync(n.command,n.args,n.options);return s.error=s.error||If.verifyENOENTSync(s.status,n),s}Ns.exports=b$;Ns.exports.spawn=b$;Ns.exports.sync=nM;Ns.exports._parse=Cf;Ns.exports._enoent=If});var lM={};gi(lM,{activate:()=>cM,deactivate:()=>uM,getMetricsCollector:()=>Zn});module.exports=R$(lM);var pe=ye(require("vscode")),P$=ye(require("path"));var Zf=ye(require("vscode"));var Wr=ye(require("fs/promises")),vi=ye(require("path")),yi=class{constructor(){this.projectStructure=null;this.masterContext=new Map;this.contextWindowTokens=256*1024}async resolveContext(e){if(!e||e.length===0)return"";let r=`

<context>
`;if(e.length>0&&e[0].path){let n=e[0].path,s=vi.dirname(n);await this.buildProjectStructure(s)}for(let n of e)try{let s=await Wr.readFile(n.path,"utf-8"),o=256,i=s.split(`
`);if(i.length>o){let a=i.slice(0,o).join(`
`)+`
... (content truncated)`;r+=`<file path="${n.path}" truncated="true">
${a}
</file>
`}else r+=`<file path="${n.path}">
${s}
</file>
`}catch(s){console.error(`Failed to read context file ${n.path}`,s),r+=`<file path="${n.path}" error="true">Could not read file.</file>
`}return r+=`</context>
`,r}async buildProjectStructure(e){try{this.projectStructure=await this.buildStructureFromPath(e)}catch(r){console.error("Failed to build project structure",r)}}async buildStructureFromPath(e){let r={root:e,files:[],directories:{}},n=await Wr.readdir(e);for(let s of n){let o=vi.join(e,s),i=await Wr.stat(o);i.isDirectory()?r.directories[s]=await this.buildStructureFromPath(o):i.isFile()&&r.files.push(o)}return r}getProjectStructure(){return this.projectStructure}async getHierarchicalContext(e,r=4096){return this.resolveContext(e)}addToMasterContext(e,r){this.masterContext.set(e,r)}getFromMasterContext(e){return this.masterContext.get(e)}removeFromMasterContext(e){this.masterContext.delete(e)}getAllMasterContext(){return new Map(this.masterContext)}clearMasterContext(){this.masterContext.clear()}generateSlidingWindowContext(){let r="",n=0,s=Array.from(this.masterContext.keys()).sort((o,i)=>o==="task_description"?-1:i==="task_description"?1:o.startsWith("context_")&&!i.startsWith("context_")?-1:!o.startsWith("context_")&&i.startsWith("context_")?1:0);for(let o of s){let i=this.masterContext.get(o)||"",a=this.estimateTokenCount(i);if(n+a>262144){let c=262144-n;if(c>0){let u=c*4;i=i.slice(0,u)+`
... (content truncated)`,a=this.estimateTokenCount(i),r+=`
<master_context key="${o}" truncated="true">
${i}
</master_context>
`,n+=a}break}else r+=`
<master_context key="${o}">
${i}
</master_context>
`,n+=a}return n>262144&&(r+=`
<!-- Context window exceeded, some content omitted -->
`),r}estimateTokenCount(e){return Math.ceil(e.length/4)}async getContextForTask(e,r){this.addToMasterContext("task_description",e);for(let n of r)try{let s=await Wr.readFile(n.path,"utf-8");this.addToMasterContext(`context_${n.path}`,s)}catch(s){console.error(`Failed to read context file ${n.path}`,s),this.addToMasterContext(`context_${n.path}`,`Could not read file: ${n.path}`)}return this.generateSlidingWindowContext()}};async function jf(t,e,r){return await t.getContextForTask(e,r||[])}async function Rc(t,e,r){return await t.chat(e,r)}function Af(t){let e=t.match(/```json[\r\n]+([\s\S]*?)[\r\n]+```/),r=null;if(e)r=e[1].trim(),r.startsWith("json")&&(r=r.slice(4).trim());else{let n=/(\{\s*"(?:thought|tool_calls)"[\s\S]*?\})\s*$/,s=t.match(n);s&&(r=s[1])}if(!r)return{text:t};try{return JSON.parse(r)}catch{return{text:t}}}async function Mf(t,e){return await t.executeTool(e)}function Oc(t,e,r){t.push({role:"tool",content:JSON.stringify({role:"tool_result",tool_call_id:r.id,status:e.status||"success",result:e.result||e,error:e.error||void 0})})}function Jr(t,e){t.push(e)}function qf(t){return t&&t.message?t.message:String(t)}function Df(t){t&&t.abort()}var _i=class{constructor(e,r,n){this.llm=e;this.tools=r;this.abortController=null;this.contextManager=new yi,this.context={workspaceRoot:n,history:[{role:"system",content:this.getSystemPrompt()}]}}cancel(){this.abortController&&(this.abortController.abort(),this.abortController=null)}getSystemPrompt(){let e=Zf.workspace.getConfiguration("vibey"),r=e.get("rules",{}),n=e.get("userGuidelines",""),s="";Object.keys(r).length>0&&(s=`## Rules

${JSON.stringify(r,null,2)}

`);let o="";n&&(o=`## User Guidelines

${n}

`);let i=this.tools.getToolDefinitions().map(a=>`## ${a.name}
${a.description}
Parameters: ${JSON.stringify(a.parameters)}`).join(`

`);return`You are Vibey, an expert autonomous coding agent.
You are running inside VS Code.

## Core Behavior

BE AUTONOMOUS. When given a task:
1. Gather information using tools
2. Plan your approach
3. EXECUTE the plan immediately - do NOT ask for permission
4. Continue working until the task is COMPLETE
5. Only stop when you have fully solved the problem

NEVER respond with "Would you like me to..." or "Should I...?" - just DO IT.
NEVER stop after gathering information - immediately proceed to implementation.
NEVER ask for confirmation before making changes - the user asked you to do something, so do it.

${s}${o}## Available Tools

${i}

## Response Format

When using tools, output ONLY a JSON block:
\`\`\`json
{
  "thought": "Brief reasoning about what I'm doing and why...",
  "tool_calls": [
    {
      "id": "unique_id",
      "name": "tool_name",
      "parameters": { ... }
    }
  ]
}
\`\`\`

When you are DONE with the entire task and have nothing more to do, respond with plain text summarizing what you accomplished.

## Important Rules

- Use tools to READ before you WRITE - understand the code first
- Make targeted, minimal changes - don't rewrite entire files
- If a tool fails, try a different approach
- Keep working until the task is fully complete
- For multi-step tasks, execute ALL steps in sequence without stopping
`}async chat(e,r,n){Df(this.abortController),this.abortController=new AbortController;let s=this.abortController.signal;try{let o=r&&r.length>0?await jf(this.contextManager,e,r):"";Jr(this.context.history,{role:"user",content:e+o}),n&&n({type:"thinking",message:"Strategic planning with full context window..."});let i=256,a=0,c="";for(;a<i;){if(s.aborted)throw new Error("Request cancelled by user");a++,n&&n({type:"thinking",message:a===1?"Analyzing request...":`Turn ${a}: Reasoning...`});let d=await Rc(this.llm,this.context.history,s);if(s.aborted)throw new Error("Request cancelled by user");let f=Af(d);if(!f||f.text){Jr(this.context.history,{role:"assistant",content:d}),c=d;break}if(f.thought&&n&&n({type:"thought",message:f.thought}),f.tool_calls&&Array.isArray(f.tool_calls)){Jr(this.context.history,{role:"assistant",content:d});for(let p of f.tool_calls){if(s.aborted)throw new Error("Request cancelled by user");try{n&&n({type:"tool_start",id:p.id,tool:p.name,parameters:p.parameters});let m=await Mf(this.tools,p);n&&n({type:"tool_end",id:p.id,tool:p.name,success:!0,result:m}),Oc(this.context.history,m,p)}catch(m){n&&n({type:"tool_end",id:p.id,tool:p.name,success:!1,error:m.message}),Oc(this.context.history,{status:"error",error:m.message},p)}}}else{Jr(this.context.history,{role:"assistant",content:d}),c=f.thought||d;break}}if(this.abortController=null,c){let d=Zn();if(d){let f=d.getSummary("tokens_sent")?.currentValue||0,p=d.getSummary("tokens_received")?.currentValue||0;n&&n({type:"tokens",sent:f,received:p})}return c}n&&n({type:"thinking",message:"Max turns reached. Summarizing progress..."}),Jr(this.context.history,{role:"user",content:"You have reached the maximum number of turns. Please provide a concise summary of what you have accomplished so far, what issues you encountered, and what steps should be taken next to complete the task."});let u=await Rc(this.llm,this.context.history,s);Jr(this.context.history,{role:"assistant",content:u});let l=Zn();if(l){let d=l.getSummary("tokens_sent")?.currentValue||0,f=l.getSummary("tokens_received")?.currentValue||0;n&&n({type:"tokens",sent:d,received:f})}return`**Max Turns Reached (${i})**

${u}`}catch(o){this.abortController=null;let i=qf(o);return n&&n({type:"error",message:i}),`**Error:** ${i}`}}};var Lf=ye(require("vscode"));var bi=class{constructor(){}getConfig(){let e=Lf.workspace.getConfiguration("vibey");return{modelName:e.get("model")||"Qwen3-coder-roo-config:latest",baseUrl:e.get("ollamaUrl")||"http://localhost:11434"}}async chat(e,r){let{modelName:n,baseUrl:s}=this.getConfig(),o={model:n,messages:e.map(i=>i.role==="tool"?{role:"tool",content:JSON.stringify(i.content)}:{role:i.role,content:typeof i.content=="string"?i.content:JSON.stringify(i.content)}),stream:!1};try{let i=await fetch(`${s}/api/chat`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(o),signal:r});if(!i.ok)throw new Error(`Ollama API error: ${i.statusText}`);let a=await i.json(),c=Zn();return c&&a.prompt_eval_count!==void 0&&c.record("tokens_sent",a.prompt_eval_count),c&&a.eval_count!==void 0&&c.record("tokens_received",a.eval_count),a.message.content}catch(i){throw i.name==="AbortError"?new Error("Request cancelled by user"):(console.error("Failed to call Ollama:",i),i)}}async listModels(){let{baseUrl:e}=this.getConfig();try{let r=await fetch(`${e}/api/tags`);if(!r.ok)throw new Error(`Failed to fetch models: ${r.statusText}`);return(await r.json()).models.map(s=>s.name)}catch(r){return console.error("Failed to list models:",r),[]}}};var wi=class{constructor(e){this.policy=e;this.tools=new Map}registerTool(e){this.tools.set(e.name,e)}unregisterTool(e){this.tools.delete(e)}getToolDefinitions(){return Array.from(this.tools.values())}async executeTool(e){let r=this.tools.get(e.name);if(!r)return{role:"tool_result",tool_call_id:e.id,status:"error",error:`Tool ${e.name} not found`,output:""};console.log(`[Gateway] Executing ${e.name}`);try{let n=await r.execute(e.parameters,{});return{role:"tool_result",tool_call_id:e.id,status:"success",output:n}}catch(n){return{role:"tool_result",tool_call_id:e.id,status:"error",error:n.message,output:""}}}};var Vf=ye(require("path")),$i=class{constructor(e){this.workspaceRoot=e}checkPathAccess(e,r){let n=Vf.resolve(this.workspaceRoot,e);return n.startsWith(this.workspaceRoot)?!((n.includes(".git")||n.includes("node_modules"))&&r==="write"):(console.warn(`Blocked access to ${n} (outside workspace)`),!1)}checkCommand(e){return!["rm -rf","mkfs","shutdown","reboot","dd "].some(n=>e.includes(n))}};var zr=ye(require("fs/promises"));var E={};gi(E,{BRAND:()=>sx,DIRTY:()=>Yr,EMPTY_PATH:()=>A$,INVALID:()=>M,NEVER:()=>Vx,OK:()=>Be,ParseStatus:()=>qe,Schema:()=>B,ZodAny:()=>Tr,ZodArray:()=>lr,ZodBigInt:()=>Xr,ZodBoolean:()=>en,ZodBranded:()=>qs,ZodCatch:()=>pn,ZodDate:()=>tn,ZodDefault:()=>dn,ZodDiscriminatedUnion:()=>Si,ZodEffects:()=>_t,ZodEnum:()=>un,ZodError:()=>it,ZodFirstPartyTypeKind:()=>D,ZodFunction:()=>Ti,ZodIntersection:()=>on,ZodIssueCode:()=>k,ZodLazy:()=>an,ZodLiteral:()=>cn,ZodMap:()=>Kn,ZodNaN:()=>Gn,ZodNativeEnum:()=>ln,ZodNever:()=>It,ZodNull:()=>nn,ZodNullable:()=>Ht,ZodNumber:()=>Qr,ZodObject:()=>at,ZodOptional:()=>yt,ZodParsedType:()=>z,ZodPipeline:()=>Ds,ZodPromise:()=>Er,ZodReadonly:()=>fn,ZodRecord:()=>Pi,ZodSchema:()=>B,ZodSet:()=>Bn,ZodString:()=>Pr,ZodSymbol:()=>Un,ZodTransformer:()=>_t,ZodTuple:()=>Ut,ZodType:()=>B,ZodUndefined:()=>rn,ZodUnion:()=>sn,ZodUnknown:()=>ur,ZodVoid:()=>Hn,addIssueToContext:()=>T,any:()=>fx,array:()=>yx,bigint:()=>cx,boolean:()=>Xf,coerce:()=>Lx,custom:()=>Jf,date:()=>ux,datetimeRegex:()=>Gf,defaultErrorMap:()=>ar,discriminatedUnion:()=>wx,effect:()=>Ox,enum:()=>Cx,function:()=>Tx,getErrorMap:()=>Ln,getParsedType:()=>Ft,instanceof:()=>ix,intersection:()=>$x,isAborted:()=>xi,isAsync:()=>Vn,isDirty:()=>ki,isValid:()=>Sr,late:()=>ox,lazy:()=>Ex,literal:()=>zx,makeIssue:()=>Ms,map:()=>Sx,nan:()=>ax,nativeEnum:()=>Ix,never:()=>hx,null:()=>px,nullable:()=>jx,number:()=>Qf,object:()=>vx,objectUtil:()=>Nc,oboolean:()=>Zx,onumber:()=>Dx,optional:()=>Nx,ostring:()=>qx,pipeline:()=>Mx,preprocess:()=>Ax,promise:()=>Rx,quotelessJson:()=>O$,record:()=>kx,set:()=>Px,setErrorMap:()=>j$,strictObject:()=>_x,string:()=>Yf,symbol:()=>lx,transformer:()=>Ox,tuple:()=>xx,undefined:()=>dx,union:()=>bx,unknown:()=>mx,util:()=>te,void:()=>gx});var te;(function(t){t.assertEqual=s=>{};function e(s){}t.assertIs=e;function r(s){throw new Error}t.assertNever=r,t.arrayToEnum=s=>{let o={};for(let i of s)o[i]=i;return o},t.getValidEnumValues=s=>{let o=t.objectKeys(s).filter(a=>typeof s[s[a]]!="number"),i={};for(let a of o)i[a]=s[a];return t.objectValues(i)},t.objectValues=s=>t.objectKeys(s).map(function(o){return s[o]}),t.objectKeys=typeof Object.keys=="function"?s=>Object.keys(s):s=>{let o=[];for(let i in s)Object.prototype.hasOwnProperty.call(s,i)&&o.push(i);return o},t.find=(s,o)=>{for(let i of s)if(o(i))return i},t.isInteger=typeof Number.isInteger=="function"?s=>Number.isInteger(s):s=>typeof s=="number"&&Number.isFinite(s)&&Math.floor(s)===s;function n(s,o=" | "){return s.map(i=>typeof i=="string"?`'${i}'`:i).join(o)}t.joinValues=n,t.jsonStringifyReplacer=(s,o)=>typeof o=="bigint"?o.toString():o})(te||(te={}));var Nc;(function(t){t.mergeShapes=(e,r)=>({...e,...r})})(Nc||(Nc={}));var z=te.arrayToEnum(["string","nan","number","integer","float","boolean","date","bigint","symbol","function","undefined","null","array","object","unknown","promise","void","never","map","set"]),Ft=t=>{switch(typeof t){case"undefined":return z.undefined;case"string":return z.string;case"number":return Number.isNaN(t)?z.nan:z.number;case"boolean":return z.boolean;case"function":return z.function;case"bigint":return z.bigint;case"symbol":return z.symbol;case"object":return Array.isArray(t)?z.array:t===null?z.null:t.then&&typeof t.then=="function"&&t.catch&&typeof t.catch=="function"?z.promise:typeof Map<"u"&&t instanceof Map?z.map:typeof Set<"u"&&t instanceof Set?z.set:typeof Date<"u"&&t instanceof Date?z.date:z.object;default:return z.unknown}};var k=te.arrayToEnum(["invalid_type","invalid_literal","custom","invalid_union","invalid_union_discriminator","invalid_enum_value","unrecognized_keys","invalid_arguments","invalid_return_type","invalid_date","invalid_string","too_small","too_big","invalid_intersection_types","not_multiple_of","not_finite"]),O$=t=>JSON.stringify(t,null,2).replace(/"([^"]+)":/g,"$1:"),it=class t extends Error{get errors(){return this.issues}constructor(e){super(),this.issues=[],this.addIssue=n=>{this.issues=[...this.issues,n]},this.addIssues=(n=[])=>{this.issues=[...this.issues,...n]};let r=new.target.prototype;Object.setPrototypeOf?Object.setPrototypeOf(this,r):this.__proto__=r,this.name="ZodError",this.issues=e}format(e){let r=e||function(o){return o.message},n={_errors:[]},s=o=>{for(let i of o.issues)if(i.code==="invalid_union")i.unionErrors.map(s);else if(i.code==="invalid_return_type")s(i.returnTypeError);else if(i.code==="invalid_arguments")s(i.argumentsError);else if(i.path.length===0)n._errors.push(r(i));else{let a=n,c=0;for(;c<i.path.length;){let u=i.path[c];c===i.path.length-1?(a[u]=a[u]||{_errors:[]},a[u]._errors.push(r(i))):a[u]=a[u]||{_errors:[]},a=a[u],c++}}};return s(this),n}static assert(e){if(!(e instanceof t))throw new Error(`Not a ZodError: ${e}`)}toString(){return this.message}get message(){return JSON.stringify(this.issues,te.jsonStringifyReplacer,2)}get isEmpty(){return this.issues.length===0}flatten(e=r=>r.message){let r={},n=[];for(let s of this.issues)if(s.path.length>0){let o=s.path[0];r[o]=r[o]||[],r[o].push(e(s))}else n.push(e(s));return{formErrors:n,fieldErrors:r}}get formErrors(){return this.flatten()}};it.create=t=>new it(t);var N$=(t,e)=>{let r;switch(t.code){case k.invalid_type:t.received===z.undefined?r="Required":r=`Expected ${t.expected}, received ${t.received}`;break;case k.invalid_literal:r=`Invalid literal value, expected ${JSON.stringify(t.expected,te.jsonStringifyReplacer)}`;break;case k.unrecognized_keys:r=`Unrecognized key(s) in object: ${te.joinValues(t.keys,", ")}`;break;case k.invalid_union:r="Invalid input";break;case k.invalid_union_discriminator:r=`Invalid discriminator value. Expected ${te.joinValues(t.options)}`;break;case k.invalid_enum_value:r=`Invalid enum value. Expected ${te.joinValues(t.options)}, received '${t.received}'`;break;case k.invalid_arguments:r="Invalid function arguments";break;case k.invalid_return_type:r="Invalid function return type";break;case k.invalid_date:r="Invalid date";break;case k.invalid_string:typeof t.validation=="object"?"includes"in t.validation?(r=`Invalid input: must include "${t.validation.includes}"`,typeof t.validation.position=="number"&&(r=`${r} at one or more positions greater than or equal to ${t.validation.position}`)):"startsWith"in t.validation?r=`Invalid input: must start with "${t.validation.startsWith}"`:"endsWith"in t.validation?r=`Invalid input: must end with "${t.validation.endsWith}"`:te.assertNever(t.validation):t.validation!=="regex"?r=`Invalid ${t.validation}`:r="Invalid";break;case k.too_small:t.type==="array"?r=`Array must contain ${t.exact?"exactly":t.inclusive?"at least":"more than"} ${t.minimum} element(s)`:t.type==="string"?r=`String must contain ${t.exact?"exactly":t.inclusive?"at least":"over"} ${t.minimum} character(s)`:t.type==="number"?r=`Number must be ${t.exact?"exactly equal to ":t.inclusive?"greater than or equal to ":"greater than "}${t.minimum}`:t.type==="bigint"?r=`Number must be ${t.exact?"exactly equal to ":t.inclusive?"greater than or equal to ":"greater than "}${t.minimum}`:t.type==="date"?r=`Date must be ${t.exact?"exactly equal to ":t.inclusive?"greater than or equal to ":"greater than "}${new Date(Number(t.minimum))}`:r="Invalid input";break;case k.too_big:t.type==="array"?r=`Array must contain ${t.exact?"exactly":t.inclusive?"at most":"less than"} ${t.maximum} element(s)`:t.type==="string"?r=`String must contain ${t.exact?"exactly":t.inclusive?"at most":"under"} ${t.maximum} character(s)`:t.type==="number"?r=`Number must be ${t.exact?"exactly":t.inclusive?"less than or equal to":"less than"} ${t.maximum}`:t.type==="bigint"?r=`BigInt must be ${t.exact?"exactly":t.inclusive?"less than or equal to":"less than"} ${t.maximum}`:t.type==="date"?r=`Date must be ${t.exact?"exactly":t.inclusive?"smaller than or equal to":"smaller than"} ${new Date(Number(t.maximum))}`:r="Invalid input";break;case k.custom:r="Invalid input";break;case k.invalid_intersection_types:r="Intersection results could not be merged";break;case k.not_multiple_of:r=`Number must be a multiple of ${t.multipleOf}`;break;case k.not_finite:r="Number must be finite";break;default:r=e.defaultError,te.assertNever(t)}return{message:r}},ar=N$;var Ff=ar;function j$(t){Ff=t}function Ln(){return Ff}var Ms=t=>{let{data:e,path:r,errorMaps:n,issueData:s}=t,o=[...r,...s.path||[]],i={...s,path:o};if(s.message!==void 0)return{...s,path:o,message:s.message};let a="",c=n.filter(u=>!!u).slice().reverse();for(let u of c)a=u(i,{data:e,defaultError:a}).message;return{...s,path:o,message:a}},A$=[];function T(t,e){let r=Ln(),n=Ms({issueData:e,data:t.data,path:t.path,errorMaps:[t.common.contextualErrorMap,t.schemaErrorMap,r,r===ar?void 0:ar].filter(s=>!!s)});t.common.issues.push(n)}var qe=class t{constructor(){this.value="valid"}dirty(){this.value==="valid"&&(this.value="dirty")}abort(){this.value!=="aborted"&&(this.value="aborted")}static mergeArray(e,r){let n=[];for(let s of r){if(s.status==="aborted")return M;s.status==="dirty"&&e.dirty(),n.push(s.value)}return{status:e.value,value:n}}static async mergeObjectAsync(e,r){let n=[];for(let s of r){let o=await s.key,i=await s.value;n.push({key:o,value:i})}return t.mergeObjectSync(e,n)}static mergeObjectSync(e,r){let n={};for(let s of r){let{key:o,value:i}=s;if(o.status==="aborted"||i.status==="aborted")return M;o.status==="dirty"&&e.dirty(),i.status==="dirty"&&e.dirty(),o.value!=="__proto__"&&(typeof i.value<"u"||s.alwaysSet)&&(n[o.value]=i.value)}return{status:e.value,value:n}}},M=Object.freeze({status:"aborted"}),Yr=t=>({status:"dirty",value:t}),Be=t=>({status:"valid",value:t}),xi=t=>t.status==="aborted",ki=t=>t.status==="dirty",Sr=t=>t.status==="valid",Vn=t=>typeof Promise<"u"&&t instanceof Promise;var I;(function(t){t.errToObj=e=>typeof e=="string"?{message:e}:e||{},t.toString=e=>typeof e=="string"?e:e?.message})(I||(I={}));var vt=class{constructor(e,r,n,s){this._cachedPath=[],this.parent=e,this.data=r,this._path=n,this._key=s}get path(){return this._cachedPath.length||(Array.isArray(this._key)?this._cachedPath.push(...this._path,...this._key):this._cachedPath.push(...this._path,this._key)),this._cachedPath}},Uf=(t,e)=>{if(Sr(e))return{success:!0,data:e.value};if(!t.common.issues.length)throw new Error("Validation failed but no issues detected.");return{success:!1,get error(){if(this._error)return this._error;let r=new it(t.common.issues);return this._error=r,this._error}}};function U(t){if(!t)return{};let{errorMap:e,invalid_type_error:r,required_error:n,description:s}=t;if(e&&(r||n))throw new Error(`Can't use "invalid_type_error" or "required_error" in conjunction with custom error map.`);return e?{errorMap:e,description:s}:{errorMap:(i,a)=>{let{message:c}=t;return i.code==="invalid_enum_value"?{message:c??a.defaultError}:typeof a.data>"u"?{message:c??n??a.defaultError}:i.code!=="invalid_type"?{message:a.defaultError}:{message:c??r??a.defaultError}},description:s}}var B=class{get description(){return this._def.description}_getType(e){return Ft(e.data)}_getOrReturnCtx(e,r){return r||{common:e.parent.common,data:e.data,parsedType:Ft(e.data),schemaErrorMap:this._def.errorMap,path:e.path,parent:e.parent}}_processInputParams(e){return{status:new qe,ctx:{common:e.parent.common,data:e.data,parsedType:Ft(e.data),schemaErrorMap:this._def.errorMap,path:e.path,parent:e.parent}}}_parseSync(e){let r=this._parse(e);if(Vn(r))throw new Error("Synchronous parse encountered promise.");return r}_parseAsync(e){let r=this._parse(e);return Promise.resolve(r)}parse(e,r){let n=this.safeParse(e,r);if(n.success)return n.data;throw n.error}safeParse(e,r){let n={common:{issues:[],async:r?.async??!1,contextualErrorMap:r?.errorMap},path:r?.path||[],schemaErrorMap:this._def.errorMap,parent:null,data:e,parsedType:Ft(e)},s=this._parseSync({data:e,path:n.path,parent:n});return Uf(n,s)}"~validate"(e){let r={common:{issues:[],async:!!this["~standard"].async},path:[],schemaErrorMap:this._def.errorMap,parent:null,data:e,parsedType:Ft(e)};if(!this["~standard"].async)try{let n=this._parseSync({data:e,path:[],parent:r});return Sr(n)?{value:n.value}:{issues:r.common.issues}}catch(n){n?.message?.toLowerCase()?.includes("encountered")&&(this["~standard"].async=!0),r.common={issues:[],async:!0}}return this._parseAsync({data:e,path:[],parent:r}).then(n=>Sr(n)?{value:n.value}:{issues:r.common.issues})}async parseAsync(e,r){let n=await this.safeParseAsync(e,r);if(n.success)return n.data;throw n.error}async safeParseAsync(e,r){let n={common:{issues:[],contextualErrorMap:r?.errorMap,async:!0},path:r?.path||[],schemaErrorMap:this._def.errorMap,parent:null,data:e,parsedType:Ft(e)},s=this._parse({data:e,path:n.path,parent:n}),o=await(Vn(s)?s:Promise.resolve(s));return Uf(n,o)}refine(e,r){let n=s=>typeof r=="string"||typeof r>"u"?{message:r}:typeof r=="function"?r(s):r;return this._refinement((s,o)=>{let i=e(s),a=()=>o.addIssue({code:k.custom,...n(s)});return typeof Promise<"u"&&i instanceof Promise?i.then(c=>c?!0:(a(),!1)):i?!0:(a(),!1)})}refinement(e,r){return this._refinement((n,s)=>e(n)?!0:(s.addIssue(typeof r=="function"?r(n,s):r),!1))}_refinement(e){return new _t({schema:this,typeName:D.ZodEffects,effect:{type:"refinement",refinement:e}})}superRefine(e){return this._refinement(e)}constructor(e){this.spa=this.safeParseAsync,this._def=e,this.parse=this.parse.bind(this),this.safeParse=this.safeParse.bind(this),this.parseAsync=this.parseAsync.bind(this),this.safeParseAsync=this.safeParseAsync.bind(this),this.spa=this.spa.bind(this),this.refine=this.refine.bind(this),this.refinement=this.refinement.bind(this),this.superRefine=this.superRefine.bind(this),this.optional=this.optional.bind(this),this.nullable=this.nullable.bind(this),this.nullish=this.nullish.bind(this),this.array=this.array.bind(this),this.promise=this.promise.bind(this),this.or=this.or.bind(this),this.and=this.and.bind(this),this.transform=this.transform.bind(this),this.brand=this.brand.bind(this),this.default=this.default.bind(this),this.catch=this.catch.bind(this),this.describe=this.describe.bind(this),this.pipe=this.pipe.bind(this),this.readonly=this.readonly.bind(this),this.isNullable=this.isNullable.bind(this),this.isOptional=this.isOptional.bind(this),this["~standard"]={version:1,vendor:"zod",validate:r=>this["~validate"](r)}}optional(){return yt.create(this,this._def)}nullable(){return Ht.create(this,this._def)}nullish(){return this.nullable().optional()}array(){return lr.create(this)}promise(){return Er.create(this,this._def)}or(e){return sn.create([this,e],this._def)}and(e){return on.create(this,e,this._def)}transform(e){return new _t({...U(this._def),schema:this,typeName:D.ZodEffects,effect:{type:"transform",transform:e}})}default(e){let r=typeof e=="function"?e:()=>e;return new dn({...U(this._def),innerType:this,defaultValue:r,typeName:D.ZodDefault})}brand(){return new qs({typeName:D.ZodBranded,type:this,...U(this._def)})}catch(e){let r=typeof e=="function"?e:()=>e;return new pn({...U(this._def),innerType:this,catchValue:r,typeName:D.ZodCatch})}describe(e){let r=this.constructor;return new r({...this._def,description:e})}pipe(e){return Ds.create(this,e)}readonly(){return fn.create(this)}isOptional(){return this.safeParse(void 0).success}isNullable(){return this.safeParse(null).success}},M$=/^c[^\s-]{8,}$/i,q$=/^[0-9a-z]+$/,D$=/^[0-9A-HJKMNP-TV-Z]{26}$/i,Z$=/^[0-9a-fA-F]{8}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{12}$/i,L$=/^[a-z0-9_-]{21}$/i,V$=/^[A-Za-z0-9-_]+\.[A-Za-z0-9-_]+\.[A-Za-z0-9-_]*$/,F$=/^[-+]?P(?!$)(?:(?:[-+]?\d+Y)|(?:[-+]?\d+[.,]\d+Y$))?(?:(?:[-+]?\d+M)|(?:[-+]?\d+[.,]\d+M$))?(?:(?:[-+]?\d+W)|(?:[-+]?\d+[.,]\d+W$))?(?:(?:[-+]?\d+D)|(?:[-+]?\d+[.,]\d+D$))?(?:T(?=[\d+-])(?:(?:[-+]?\d+H)|(?:[-+]?\d+[.,]\d+H$))?(?:(?:[-+]?\d+M)|(?:[-+]?\d+[.,]\d+M$))?(?:[-+]?\d+(?:[.,]\d+)?S)?)??$/,U$=/^(?!\.)(?!.*\.\.)([A-Z0-9_'+\-\.]*)[A-Z0-9_+-]@([A-Z0-9][A-Z0-9\-]*\.)+[A-Z]{2,}$/i,H$="^(\\p{Extended_Pictographic}|\\p{Emoji_Component})+$",jc,K$=/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])$/,B$=/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\/(3[0-2]|[12]?[0-9])$/,G$=/^(([0-9a-fA-F]{1,4}:){7,7}[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,7}:|([0-9a-fA-F]{1,4}:){1,6}:[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,5}(:[0-9a-fA-F]{1,4}){1,2}|([0-9a-fA-F]{1,4}:){1,4}(:[0-9a-fA-F]{1,4}){1,3}|([0-9a-fA-F]{1,4}:){1,3}(:[0-9a-fA-F]{1,4}){1,4}|([0-9a-fA-F]{1,4}:){1,2}(:[0-9a-fA-F]{1,4}){1,5}|[0-9a-fA-F]{1,4}:((:[0-9a-fA-F]{1,4}){1,6})|:((:[0-9a-fA-F]{1,4}){1,7}|:)|fe80:(:[0-9a-fA-F]{0,4}){0,4}%[0-9a-zA-Z]{1,}|::(ffff(:0{1,4}){0,1}:){0,1}((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])|([0-9a-fA-F]{1,4}:){1,4}:((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9]))$/,W$=/^(([0-9a-fA-F]{1,4}:){7,7}[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,7}:|([0-9a-fA-F]{1,4}:){1,6}:[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,5}(:[0-9a-fA-F]{1,4}){1,2}|([0-9a-fA-F]{1,4}:){1,4}(:[0-9a-fA-F]{1,4}){1,3}|([0-9a-fA-F]{1,4}:){1,3}(:[0-9a-fA-F]{1,4}){1,4}|([0-9a-fA-F]{1,4}:){1,2}(:[0-9a-fA-F]{1,4}){1,5}|[0-9a-fA-F]{1,4}:((:[0-9a-fA-F]{1,4}){1,6})|:((:[0-9a-fA-F]{1,4}){1,7}|:)|fe80:(:[0-9a-fA-F]{0,4}){0,4}%[0-9a-zA-Z]{1,}|::(ffff(:0{1,4}){0,1}:){0,1}((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])|([0-9a-fA-F]{1,4}:){1,4}:((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9]))\/(12[0-8]|1[01][0-9]|[1-9]?[0-9])$/,J$=/^([0-9a-zA-Z+/]{4})*(([0-9a-zA-Z+/]{2}==)|([0-9a-zA-Z+/]{3}=))?$/,Y$=/^([0-9a-zA-Z-_]{4})*(([0-9a-zA-Z-_]{2}(==)?)|([0-9a-zA-Z-_]{3}(=)?))?$/,Kf="((\\d\\d[2468][048]|\\d\\d[13579][26]|\\d\\d0[48]|[02468][048]00|[13579][26]00)-02-29|\\d{4}-((0[13578]|1[02])-(0[1-9]|[12]\\d|3[01])|(0[469]|11)-(0[1-9]|[12]\\d|30)|(02)-(0[1-9]|1\\d|2[0-8])))",Q$=new RegExp(`^${Kf}$`);function Bf(t){let e="[0-5]\\d";t.precision?e=`${e}\\.\\d{${t.precision}}`:t.precision==null&&(e=`${e}(\\.\\d+)?`);let r=t.precision?"+":"?";return`([01]\\d|2[0-3]):[0-5]\\d(:${e})${r}`}function X$(t){return new RegExp(`^${Bf(t)}$`)}function Gf(t){let e=`${Kf}T${Bf(t)}`,r=[];return r.push(t.local?"Z?":"Z"),t.offset&&r.push("([+-]\\d{2}:?\\d{2})"),e=`${e}(${r.join("|")})`,new RegExp(`^${e}$`)}function ex(t,e){return!!((e==="v4"||!e)&&K$.test(t)||(e==="v6"||!e)&&G$.test(t))}function tx(t,e){if(!V$.test(t))return!1;try{let[r]=t.split(".");if(!r)return!1;let n=r.replace(/-/g,"+").replace(/_/g,"/").padEnd(r.length+(4-r.length%4)%4,"="),s=JSON.parse(atob(n));return!(typeof s!="object"||s===null||"typ"in s&&s?.typ!=="JWT"||!s.alg||e&&s.alg!==e)}catch{return!1}}function rx(t,e){return!!((e==="v4"||!e)&&B$.test(t)||(e==="v6"||!e)&&W$.test(t))}var Pr=class t extends B{_parse(e){if(this._def.coerce&&(e.data=String(e.data)),this._getType(e)!==z.string){let o=this._getOrReturnCtx(e);return T(o,{code:k.invalid_type,expected:z.string,received:o.parsedType}),M}let n=new qe,s;for(let o of this._def.checks)if(o.kind==="min")e.data.length<o.value&&(s=this._getOrReturnCtx(e,s),T(s,{code:k.too_small,minimum:o.value,type:"string",inclusive:!0,exact:!1,message:o.message}),n.dirty());else if(o.kind==="max")e.data.length>o.value&&(s=this._getOrReturnCtx(e,s),T(s,{code:k.too_big,maximum:o.value,type:"string",inclusive:!0,exact:!1,message:o.message}),n.dirty());else if(o.kind==="length"){let i=e.data.length>o.value,a=e.data.length<o.value;(i||a)&&(s=this._getOrReturnCtx(e,s),i?T(s,{code:k.too_big,maximum:o.value,type:"string",inclusive:!0,exact:!0,message:o.message}):a&&T(s,{code:k.too_small,minimum:o.value,type:"string",inclusive:!0,exact:!0,message:o.message}),n.dirty())}else if(o.kind==="email")U$.test(e.data)||(s=this._getOrReturnCtx(e,s),T(s,{validation:"email",code:k.invalid_string,message:o.message}),n.dirty());else if(o.kind==="emoji")jc||(jc=new RegExp(H$,"u")),jc.test(e.data)||(s=this._getOrReturnCtx(e,s),T(s,{validation:"emoji",code:k.invalid_string,message:o.message}),n.dirty());else if(o.kind==="uuid")Z$.test(e.data)||(s=this._getOrReturnCtx(e,s),T(s,{validation:"uuid",code:k.invalid_string,message:o.message}),n.dirty());else if(o.kind==="nanoid")L$.test(e.data)||(s=this._getOrReturnCtx(e,s),T(s,{validation:"nanoid",code:k.invalid_string,message:o.message}),n.dirty());else if(o.kind==="cuid")M$.test(e.data)||(s=this._getOrReturnCtx(e,s),T(s,{validation:"cuid",code:k.invalid_string,message:o.message}),n.dirty());else if(o.kind==="cuid2")q$.test(e.data)||(s=this._getOrReturnCtx(e,s),T(s,{validation:"cuid2",code:k.invalid_string,message:o.message}),n.dirty());else if(o.kind==="ulid")D$.test(e.data)||(s=this._getOrReturnCtx(e,s),T(s,{validation:"ulid",code:k.invalid_string,message:o.message}),n.dirty());else if(o.kind==="url")try{new URL(e.data)}catch{s=this._getOrReturnCtx(e,s),T(s,{validation:"url",code:k.invalid_string,message:o.message}),n.dirty()}else o.kind==="regex"?(o.regex.lastIndex=0,o.regex.test(e.data)||(s=this._getOrReturnCtx(e,s),T(s,{validation:"regex",code:k.invalid_string,message:o.message}),n.dirty())):o.kind==="trim"?e.data=e.data.trim():o.kind==="includes"?e.data.includes(o.value,o.position)||(s=this._getOrReturnCtx(e,s),T(s,{code:k.invalid_string,validation:{includes:o.value,position:o.position},message:o.message}),n.dirty()):o.kind==="toLowerCase"?e.data=e.data.toLowerCase():o.kind==="toUpperCase"?e.data=e.data.toUpperCase():o.kind==="startsWith"?e.data.startsWith(o.value)||(s=this._getOrReturnCtx(e,s),T(s,{code:k.invalid_string,validation:{startsWith:o.value},message:o.message}),n.dirty()):o.kind==="endsWith"?e.data.endsWith(o.value)||(s=this._getOrReturnCtx(e,s),T(s,{code:k.invalid_string,validation:{endsWith:o.value},message:o.message}),n.dirty()):o.kind==="datetime"?Gf(o).test(e.data)||(s=this._getOrReturnCtx(e,s),T(s,{code:k.invalid_string,validation:"datetime",message:o.message}),n.dirty()):o.kind==="date"?Q$.test(e.data)||(s=this._getOrReturnCtx(e,s),T(s,{code:k.invalid_string,validation:"date",message:o.message}),n.dirty()):o.kind==="time"?X$(o).test(e.data)||(s=this._getOrReturnCtx(e,s),T(s,{code:k.invalid_string,validation:"time",message:o.message}),n.dirty()):o.kind==="duration"?F$.test(e.data)||(s=this._getOrReturnCtx(e,s),T(s,{validation:"duration",code:k.invalid_string,message:o.message}),n.dirty()):o.kind==="ip"?ex(e.data,o.version)||(s=this._getOrReturnCtx(e,s),T(s,{validation:"ip",code:k.invalid_string,message:o.message}),n.dirty()):o.kind==="jwt"?tx(e.data,o.alg)||(s=this._getOrReturnCtx(e,s),T(s,{validation:"jwt",code:k.invalid_string,message:o.message}),n.dirty()):o.kind==="cidr"?rx(e.data,o.version)||(s=this._getOrReturnCtx(e,s),T(s,{validation:"cidr",code:k.invalid_string,message:o.message}),n.dirty()):o.kind==="base64"?J$.test(e.data)||(s=this._getOrReturnCtx(e,s),T(s,{validation:"base64",code:k.invalid_string,message:o.message}),n.dirty()):o.kind==="base64url"?Y$.test(e.data)||(s=this._getOrReturnCtx(e,s),T(s,{validation:"base64url",code:k.invalid_string,message:o.message}),n.dirty()):te.assertNever(o);return{status:n.value,value:e.data}}_regex(e,r,n){return this.refinement(s=>e.test(s),{validation:r,code:k.invalid_string,...I.errToObj(n)})}_addCheck(e){return new t({...this._def,checks:[...this._def.checks,e]})}email(e){return this._addCheck({kind:"email",...I.errToObj(e)})}url(e){return this._addCheck({kind:"url",...I.errToObj(e)})}emoji(e){return this._addCheck({kind:"emoji",...I.errToObj(e)})}uuid(e){return this._addCheck({kind:"uuid",...I.errToObj(e)})}nanoid(e){return this._addCheck({kind:"nanoid",...I.errToObj(e)})}cuid(e){return this._addCheck({kind:"cuid",...I.errToObj(e)})}cuid2(e){return this._addCheck({kind:"cuid2",...I.errToObj(e)})}ulid(e){return this._addCheck({kind:"ulid",...I.errToObj(e)})}base64(e){return this._addCheck({kind:"base64",...I.errToObj(e)})}base64url(e){return this._addCheck({kind:"base64url",...I.errToObj(e)})}jwt(e){return this._addCheck({kind:"jwt",...I.errToObj(e)})}ip(e){return this._addCheck({kind:"ip",...I.errToObj(e)})}cidr(e){return this._addCheck({kind:"cidr",...I.errToObj(e)})}datetime(e){return typeof e=="string"?this._addCheck({kind:"datetime",precision:null,offset:!1,local:!1,message:e}):this._addCheck({kind:"datetime",precision:typeof e?.precision>"u"?null:e?.precision,offset:e?.offset??!1,local:e?.local??!1,...I.errToObj(e?.message)})}date(e){return this._addCheck({kind:"date",message:e})}time(e){return typeof e=="string"?this._addCheck({kind:"time",precision:null,message:e}):this._addCheck({kind:"time",precision:typeof e?.precision>"u"?null:e?.precision,...I.errToObj(e?.message)})}duration(e){return this._addCheck({kind:"duration",...I.errToObj(e)})}regex(e,r){return this._addCheck({kind:"regex",regex:e,...I.errToObj(r)})}includes(e,r){return this._addCheck({kind:"includes",value:e,position:r?.position,...I.errToObj(r?.message)})}startsWith(e,r){return this._addCheck({kind:"startsWith",value:e,...I.errToObj(r)})}endsWith(e,r){return this._addCheck({kind:"endsWith",value:e,...I.errToObj(r)})}min(e,r){return this._addCheck({kind:"min",value:e,...I.errToObj(r)})}max(e,r){return this._addCheck({kind:"max",value:e,...I.errToObj(r)})}length(e,r){return this._addCheck({kind:"length",value:e,...I.errToObj(r)})}nonempty(e){return this.min(1,I.errToObj(e))}trim(){return new t({...this._def,checks:[...this._def.checks,{kind:"trim"}]})}toLowerCase(){return new t({...this._def,checks:[...this._def.checks,{kind:"toLowerCase"}]})}toUpperCase(){return new t({...this._def,checks:[...this._def.checks,{kind:"toUpperCase"}]})}get isDatetime(){return!!this._def.checks.find(e=>e.kind==="datetime")}get isDate(){return!!this._def.checks.find(e=>e.kind==="date")}get isTime(){return!!this._def.checks.find(e=>e.kind==="time")}get isDuration(){return!!this._def.checks.find(e=>e.kind==="duration")}get isEmail(){return!!this._def.checks.find(e=>e.kind==="email")}get isURL(){return!!this._def.checks.find(e=>e.kind==="url")}get isEmoji(){return!!this._def.checks.find(e=>e.kind==="emoji")}get isUUID(){return!!this._def.checks.find(e=>e.kind==="uuid")}get isNANOID(){return!!this._def.checks.find(e=>e.kind==="nanoid")}get isCUID(){return!!this._def.checks.find(e=>e.kind==="cuid")}get isCUID2(){return!!this._def.checks.find(e=>e.kind==="cuid2")}get isULID(){return!!this._def.checks.find(e=>e.kind==="ulid")}get isIP(){return!!this._def.checks.find(e=>e.kind==="ip")}get isCIDR(){return!!this._def.checks.find(e=>e.kind==="cidr")}get isBase64(){return!!this._def.checks.find(e=>e.kind==="base64")}get isBase64url(){return!!this._def.checks.find(e=>e.kind==="base64url")}get minLength(){let e=null;for(let r of this._def.checks)r.kind==="min"&&(e===null||r.value>e)&&(e=r.value);return e}get maxLength(){let e=null;for(let r of this._def.checks)r.kind==="max"&&(e===null||r.value<e)&&(e=r.value);return e}};Pr.create=t=>new Pr({checks:[],typeName:D.ZodString,coerce:t?.coerce??!1,...U(t)});function nx(t,e){let r=(t.toString().split(".")[1]||"").length,n=(e.toString().split(".")[1]||"").length,s=r>n?r:n,o=Number.parseInt(t.toFixed(s).replace(".","")),i=Number.parseInt(e.toFixed(s).replace(".",""));return o%i/10**s}var Qr=class t extends B{constructor(){super(...arguments),this.min=this.gte,this.max=this.lte,this.step=this.multipleOf}_parse(e){if(this._def.coerce&&(e.data=Number(e.data)),this._getType(e)!==z.number){let o=this._getOrReturnCtx(e);return T(o,{code:k.invalid_type,expected:z.number,received:o.parsedType}),M}let n,s=new qe;for(let o of this._def.checks)o.kind==="int"?te.isInteger(e.data)||(n=this._getOrReturnCtx(e,n),T(n,{code:k.invalid_type,expected:"integer",received:"float",message:o.message}),s.dirty()):o.kind==="min"?(o.inclusive?e.data<o.value:e.data<=o.value)&&(n=this._getOrReturnCtx(e,n),T(n,{code:k.too_small,minimum:o.value,type:"number",inclusive:o.inclusive,exact:!1,message:o.message}),s.dirty()):o.kind==="max"?(o.inclusive?e.data>o.value:e.data>=o.value)&&(n=this._getOrReturnCtx(e,n),T(n,{code:k.too_big,maximum:o.value,type:"number",inclusive:o.inclusive,exact:!1,message:o.message}),s.dirty()):o.kind==="multipleOf"?nx(e.data,o.value)!==0&&(n=this._getOrReturnCtx(e,n),T(n,{code:k.not_multiple_of,multipleOf:o.value,message:o.message}),s.dirty()):o.kind==="finite"?Number.isFinite(e.data)||(n=this._getOrReturnCtx(e,n),T(n,{code:k.not_finite,message:o.message}),s.dirty()):te.assertNever(o);return{status:s.value,value:e.data}}gte(e,r){return this.setLimit("min",e,!0,I.toString(r))}gt(e,r){return this.setLimit("min",e,!1,I.toString(r))}lte(e,r){return this.setLimit("max",e,!0,I.toString(r))}lt(e,r){return this.setLimit("max",e,!1,I.toString(r))}setLimit(e,r,n,s){return new t({...this._def,checks:[...this._def.checks,{kind:e,value:r,inclusive:n,message:I.toString(s)}]})}_addCheck(e){return new t({...this._def,checks:[...this._def.checks,e]})}int(e){return this._addCheck({kind:"int",message:I.toString(e)})}positive(e){return this._addCheck({kind:"min",value:0,inclusive:!1,message:I.toString(e)})}negative(e){return this._addCheck({kind:"max",value:0,inclusive:!1,message:I.toString(e)})}nonpositive(e){return this._addCheck({kind:"max",value:0,inclusive:!0,message:I.toString(e)})}nonnegative(e){return this._addCheck({kind:"min",value:0,inclusive:!0,message:I.toString(e)})}multipleOf(e,r){return this._addCheck({kind:"multipleOf",value:e,message:I.toString(r)})}finite(e){return this._addCheck({kind:"finite",message:I.toString(e)})}safe(e){return this._addCheck({kind:"min",inclusive:!0,value:Number.MIN_SAFE_INTEGER,message:I.toString(e)})._addCheck({kind:"max",inclusive:!0,value:Number.MAX_SAFE_INTEGER,message:I.toString(e)})}get minValue(){let e=null;for(let r of this._def.checks)r.kind==="min"&&(e===null||r.value>e)&&(e=r.value);return e}get maxValue(){let e=null;for(let r of this._def.checks)r.kind==="max"&&(e===null||r.value<e)&&(e=r.value);return e}get isInt(){return!!this._def.checks.find(e=>e.kind==="int"||e.kind==="multipleOf"&&te.isInteger(e.value))}get isFinite(){let e=null,r=null;for(let n of this._def.checks){if(n.kind==="finite"||n.kind==="int"||n.kind==="multipleOf")return!0;n.kind==="min"?(r===null||n.value>r)&&(r=n.value):n.kind==="max"&&(e===null||n.value<e)&&(e=n.value)}return Number.isFinite(r)&&Number.isFinite(e)}};Qr.create=t=>new Qr({checks:[],typeName:D.ZodNumber,coerce:t?.coerce||!1,...U(t)});var Xr=class t extends B{constructor(){super(...arguments),this.min=this.gte,this.max=this.lte}_parse(e){if(this._def.coerce)try{e.data=BigInt(e.data)}catch{return this._getInvalidInput(e)}if(this._getType(e)!==z.bigint)return this._getInvalidInput(e);let n,s=new qe;for(let o of this._def.checks)o.kind==="min"?(o.inclusive?e.data<o.value:e.data<=o.value)&&(n=this._getOrReturnCtx(e,n),T(n,{code:k.too_small,type:"bigint",minimum:o.value,inclusive:o.inclusive,message:o.message}),s.dirty()):o.kind==="max"?(o.inclusive?e.data>o.value:e.data>=o.value)&&(n=this._getOrReturnCtx(e,n),T(n,{code:k.too_big,type:"bigint",maximum:o.value,inclusive:o.inclusive,message:o.message}),s.dirty()):o.kind==="multipleOf"?e.data%o.value!==BigInt(0)&&(n=this._getOrReturnCtx(e,n),T(n,{code:k.not_multiple_of,multipleOf:o.value,message:o.message}),s.dirty()):te.assertNever(o);return{status:s.value,value:e.data}}_getInvalidInput(e){let r=this._getOrReturnCtx(e);return T(r,{code:k.invalid_type,expected:z.bigint,received:r.parsedType}),M}gte(e,r){return this.setLimit("min",e,!0,I.toString(r))}gt(e,r){return this.setLimit("min",e,!1,I.toString(r))}lte(e,r){return this.setLimit("max",e,!0,I.toString(r))}lt(e,r){return this.setLimit("max",e,!1,I.toString(r))}setLimit(e,r,n,s){return new t({...this._def,checks:[...this._def.checks,{kind:e,value:r,inclusive:n,message:I.toString(s)}]})}_addCheck(e){return new t({...this._def,checks:[...this._def.checks,e]})}positive(e){return this._addCheck({kind:"min",value:BigInt(0),inclusive:!1,message:I.toString(e)})}negative(e){return this._addCheck({kind:"max",value:BigInt(0),inclusive:!1,message:I.toString(e)})}nonpositive(e){return this._addCheck({kind:"max",value:BigInt(0),inclusive:!0,message:I.toString(e)})}nonnegative(e){return this._addCheck({kind:"min",value:BigInt(0),inclusive:!0,message:I.toString(e)})}multipleOf(e,r){return this._addCheck({kind:"multipleOf",value:e,message:I.toString(r)})}get minValue(){let e=null;for(let r of this._def.checks)r.kind==="min"&&(e===null||r.value>e)&&(e=r.value);return e}get maxValue(){let e=null;for(let r of this._def.checks)r.kind==="max"&&(e===null||r.value<e)&&(e=r.value);return e}};Xr.create=t=>new Xr({checks:[],typeName:D.ZodBigInt,coerce:t?.coerce??!1,...U(t)});var en=class extends B{_parse(e){if(this._def.coerce&&(e.data=!!e.data),this._getType(e)!==z.boolean){let n=this._getOrReturnCtx(e);return T(n,{code:k.invalid_type,expected:z.boolean,received:n.parsedType}),M}return Be(e.data)}};en.create=t=>new en({typeName:D.ZodBoolean,coerce:t?.coerce||!1,...U(t)});var tn=class t extends B{_parse(e){if(this._def.coerce&&(e.data=new Date(e.data)),this._getType(e)!==z.date){let o=this._getOrReturnCtx(e);return T(o,{code:k.invalid_type,expected:z.date,received:o.parsedType}),M}if(Number.isNaN(e.data.getTime())){let o=this._getOrReturnCtx(e);return T(o,{code:k.invalid_date}),M}let n=new qe,s;for(let o of this._def.checks)o.kind==="min"?e.data.getTime()<o.value&&(s=this._getOrReturnCtx(e,s),T(s,{code:k.too_small,message:o.message,inclusive:!0,exact:!1,minimum:o.value,type:"date"}),n.dirty()):o.kind==="max"?e.data.getTime()>o.value&&(s=this._getOrReturnCtx(e,s),T(s,{code:k.too_big,message:o.message,inclusive:!0,exact:!1,maximum:o.value,type:"date"}),n.dirty()):te.assertNever(o);return{status:n.value,value:new Date(e.data.getTime())}}_addCheck(e){return new t({...this._def,checks:[...this._def.checks,e]})}min(e,r){return this._addCheck({kind:"min",value:e.getTime(),message:I.toString(r)})}max(e,r){return this._addCheck({kind:"max",value:e.getTime(),message:I.toString(r)})}get minDate(){let e=null;for(let r of this._def.checks)r.kind==="min"&&(e===null||r.value>e)&&(e=r.value);return e!=null?new Date(e):null}get maxDate(){let e=null;for(let r of this._def.checks)r.kind==="max"&&(e===null||r.value<e)&&(e=r.value);return e!=null?new Date(e):null}};tn.create=t=>new tn({checks:[],coerce:t?.coerce||!1,typeName:D.ZodDate,...U(t)});var Un=class extends B{_parse(e){if(this._getType(e)!==z.symbol){let n=this._getOrReturnCtx(e);return T(n,{code:k.invalid_type,expected:z.symbol,received:n.parsedType}),M}return Be(e.data)}};Un.create=t=>new Un({typeName:D.ZodSymbol,...U(t)});var rn=class extends B{_parse(e){if(this._getType(e)!==z.undefined){let n=this._getOrReturnCtx(e);return T(n,{code:k.invalid_type,expected:z.undefined,received:n.parsedType}),M}return Be(e.data)}};rn.create=t=>new rn({typeName:D.ZodUndefined,...U(t)});var nn=class extends B{_parse(e){if(this._getType(e)!==z.null){let n=this._getOrReturnCtx(e);return T(n,{code:k.invalid_type,expected:z.null,received:n.parsedType}),M}return Be(e.data)}};nn.create=t=>new nn({typeName:D.ZodNull,...U(t)});var Tr=class extends B{constructor(){super(...arguments),this._any=!0}_parse(e){return Be(e.data)}};Tr.create=t=>new Tr({typeName:D.ZodAny,...U(t)});var ur=class extends B{constructor(){super(...arguments),this._unknown=!0}_parse(e){return Be(e.data)}};ur.create=t=>new ur({typeName:D.ZodUnknown,...U(t)});var It=class extends B{_parse(e){let r=this._getOrReturnCtx(e);return T(r,{code:k.invalid_type,expected:z.never,received:r.parsedType}),M}};It.create=t=>new It({typeName:D.ZodNever,...U(t)});var Hn=class extends B{_parse(e){if(this._getType(e)!==z.undefined){let n=this._getOrReturnCtx(e);return T(n,{code:k.invalid_type,expected:z.void,received:n.parsedType}),M}return Be(e.data)}};Hn.create=t=>new Hn({typeName:D.ZodVoid,...U(t)});var lr=class t extends B{_parse(e){let{ctx:r,status:n}=this._processInputParams(e),s=this._def;if(r.parsedType!==z.array)return T(r,{code:k.invalid_type,expected:z.array,received:r.parsedType}),M;if(s.exactLength!==null){let i=r.data.length>s.exactLength.value,a=r.data.length<s.exactLength.value;(i||a)&&(T(r,{code:i?k.too_big:k.too_small,minimum:a?s.exactLength.value:void 0,maximum:i?s.exactLength.value:void 0,type:"array",inclusive:!0,exact:!0,message:s.exactLength.message}),n.dirty())}if(s.minLength!==null&&r.data.length<s.minLength.value&&(T(r,{code:k.too_small,minimum:s.minLength.value,type:"array",inclusive:!0,exact:!1,message:s.minLength.message}),n.dirty()),s.maxLength!==null&&r.data.length>s.maxLength.value&&(T(r,{code:k.too_big,maximum:s.maxLength.value,type:"array",inclusive:!0,exact:!1,message:s.maxLength.message}),n.dirty()),r.common.async)return Promise.all([...r.data].map((i,a)=>s.type._parseAsync(new vt(r,i,r.path,a)))).then(i=>qe.mergeArray(n,i));let o=[...r.data].map((i,a)=>s.type._parseSync(new vt(r,i,r.path,a)));return qe.mergeArray(n,o)}get element(){return this._def.type}min(e,r){return new t({...this._def,minLength:{value:e,message:I.toString(r)}})}max(e,r){return new t({...this._def,maxLength:{value:e,message:I.toString(r)}})}length(e,r){return new t({...this._def,exactLength:{value:e,message:I.toString(r)}})}nonempty(e){return this.min(1,e)}};lr.create=(t,e)=>new lr({type:t,minLength:null,maxLength:null,exactLength:null,typeName:D.ZodArray,...U(e)});function Fn(t){if(t instanceof at){let e={};for(let r in t.shape){let n=t.shape[r];e[r]=yt.create(Fn(n))}return new at({...t._def,shape:()=>e})}else return t instanceof lr?new lr({...t._def,type:Fn(t.element)}):t instanceof yt?yt.create(Fn(t.unwrap())):t instanceof Ht?Ht.create(Fn(t.unwrap())):t instanceof Ut?Ut.create(t.items.map(e=>Fn(e))):t}var at=class t extends B{constructor(){super(...arguments),this._cached=null,this.nonstrict=this.passthrough,this.augment=this.extend}_getCached(){if(this._cached!==null)return this._cached;let e=this._def.shape(),r=te.objectKeys(e);return this._cached={shape:e,keys:r},this._cached}_parse(e){if(this._getType(e)!==z.object){let u=this._getOrReturnCtx(e);return T(u,{code:k.invalid_type,expected:z.object,received:u.parsedType}),M}let{status:n,ctx:s}=this._processInputParams(e),{shape:o,keys:i}=this._getCached(),a=[];if(!(this._def.catchall instanceof It&&this._def.unknownKeys==="strip"))for(let u in s.data)i.includes(u)||a.push(u);let c=[];for(let u of i){let l=o[u],d=s.data[u];c.push({key:{status:"valid",value:u},value:l._parse(new vt(s,d,s.path,u)),alwaysSet:u in s.data})}if(this._def.catchall instanceof It){let u=this._def.unknownKeys;if(u==="passthrough")for(let l of a)c.push({key:{status:"valid",value:l},value:{status:"valid",value:s.data[l]}});else if(u==="strict")a.length>0&&(T(s,{code:k.unrecognized_keys,keys:a}),n.dirty());else if(u!=="strip")throw new Error("Internal ZodObject error: invalid unknownKeys value.")}else{let u=this._def.catchall;for(let l of a){let d=s.data[l];c.push({key:{status:"valid",value:l},value:u._parse(new vt(s,d,s.path,l)),alwaysSet:l in s.data})}}return s.common.async?Promise.resolve().then(async()=>{let u=[];for(let l of c){let d=await l.key,f=await l.value;u.push({key:d,value:f,alwaysSet:l.alwaysSet})}return u}).then(u=>qe.mergeObjectSync(n,u)):qe.mergeObjectSync(n,c)}get shape(){return this._def.shape()}strict(e){return I.errToObj,new t({...this._def,unknownKeys:"strict",...e!==void 0?{errorMap:(r,n)=>{let s=this._def.errorMap?.(r,n).message??n.defaultError;return r.code==="unrecognized_keys"?{message:I.errToObj(e).message??s}:{message:s}}}:{}})}strip(){return new t({...this._def,unknownKeys:"strip"})}passthrough(){return new t({...this._def,unknownKeys:"passthrough"})}extend(e){return new t({...this._def,shape:()=>({...this._def.shape(),...e})})}merge(e){return new t({unknownKeys:e._def.unknownKeys,catchall:e._def.catchall,shape:()=>({...this._def.shape(),...e._def.shape()}),typeName:D.ZodObject})}setKey(e,r){return this.augment({[e]:r})}catchall(e){return new t({...this._def,catchall:e})}pick(e){let r={};for(let n of te.objectKeys(e))e[n]&&this.shape[n]&&(r[n]=this.shape[n]);return new t({...this._def,shape:()=>r})}omit(e){let r={};for(let n of te.objectKeys(this.shape))e[n]||(r[n]=this.shape[n]);return new t({...this._def,shape:()=>r})}deepPartial(){return Fn(this)}partial(e){let r={};for(let n of te.objectKeys(this.shape)){let s=this.shape[n];e&&!e[n]?r[n]=s:r[n]=s.optional()}return new t({...this._def,shape:()=>r})}required(e){let r={};for(let n of te.objectKeys(this.shape))if(e&&!e[n])r[n]=this.shape[n];else{let o=this.shape[n];for(;o instanceof yt;)o=o._def.innerType;r[n]=o}return new t({...this._def,shape:()=>r})}keyof(){return Wf(te.objectKeys(this.shape))}};at.create=(t,e)=>new at({shape:()=>t,unknownKeys:"strip",catchall:It.create(),typeName:D.ZodObject,...U(e)});at.strictCreate=(t,e)=>new at({shape:()=>t,unknownKeys:"strict",catchall:It.create(),typeName:D.ZodObject,...U(e)});at.lazycreate=(t,e)=>new at({shape:t,unknownKeys:"strip",catchall:It.create(),typeName:D.ZodObject,...U(e)});var sn=class extends B{_parse(e){let{ctx:r}=this._processInputParams(e),n=this._def.options;function s(o){for(let a of o)if(a.result.status==="valid")return a.result;for(let a of o)if(a.result.status==="dirty")return r.common.issues.push(...a.ctx.common.issues),a.result;let i=o.map(a=>new it(a.ctx.common.issues));return T(r,{code:k.invalid_union,unionErrors:i}),M}if(r.common.async)return Promise.all(n.map(async o=>{let i={...r,common:{...r.common,issues:[]},parent:null};return{result:await o._parseAsync({data:r.data,path:r.path,parent:i}),ctx:i}})).then(s);{let o,i=[];for(let c of n){let u={...r,common:{...r.common,issues:[]},parent:null},l=c._parseSync({data:r.data,path:r.path,parent:u});if(l.status==="valid")return l;l.status==="dirty"&&!o&&(o={result:l,ctx:u}),u.common.issues.length&&i.push(u.common.issues)}if(o)return r.common.issues.push(...o.ctx.common.issues),o.result;let a=i.map(c=>new it(c));return T(r,{code:k.invalid_union,unionErrors:a}),M}}get options(){return this._def.options}};sn.create=(t,e)=>new sn({options:t,typeName:D.ZodUnion,...U(e)});var cr=t=>t instanceof an?cr(t.schema):t instanceof _t?cr(t.innerType()):t instanceof cn?[t.value]:t instanceof un?t.options:t instanceof ln?te.objectValues(t.enum):t instanceof dn?cr(t._def.innerType):t instanceof rn?[void 0]:t instanceof nn?[null]:t instanceof yt?[void 0,...cr(t.unwrap())]:t instanceof Ht?[null,...cr(t.unwrap())]:t instanceof qs||t instanceof fn?cr(t.unwrap()):t instanceof pn?cr(t._def.innerType):[],Si=class t extends B{_parse(e){let{ctx:r}=this._processInputParams(e);if(r.parsedType!==z.object)return T(r,{code:k.invalid_type,expected:z.object,received:r.parsedType}),M;let n=this.discriminator,s=r.data[n],o=this.optionsMap.get(s);return o?r.common.async?o._parseAsync({data:r.data,path:r.path,parent:r}):o._parseSync({data:r.data,path:r.path,parent:r}):(T(r,{code:k.invalid_union_discriminator,options:Array.from(this.optionsMap.keys()),path:[n]}),M)}get discriminator(){return this._def.discriminator}get options(){return this._def.options}get optionsMap(){return this._def.optionsMap}static create(e,r,n){let s=new Map;for(let o of r){let i=cr(o.shape[e]);if(!i.length)throw new Error(`A discriminator value for key \`${e}\` could not be extracted from all schema options`);for(let a of i){if(s.has(a))throw new Error(`Discriminator property ${String(e)} has duplicate value ${String(a)}`);s.set(a,o)}}return new t({typeName:D.ZodDiscriminatedUnion,discriminator:e,options:r,optionsMap:s,...U(n)})}};function Ac(t,e){let r=Ft(t),n=Ft(e);if(t===e)return{valid:!0,data:t};if(r===z.object&&n===z.object){let s=te.objectKeys(e),o=te.objectKeys(t).filter(a=>s.indexOf(a)!==-1),i={...t,...e};for(let a of o){let c=Ac(t[a],e[a]);if(!c.valid)return{valid:!1};i[a]=c.data}return{valid:!0,data:i}}else if(r===z.array&&n===z.array){if(t.length!==e.length)return{valid:!1};let s=[];for(let o=0;o<t.length;o++){let i=t[o],a=e[o],c=Ac(i,a);if(!c.valid)return{valid:!1};s.push(c.data)}return{valid:!0,data:s}}else return r===z.date&&n===z.date&&+t==+e?{valid:!0,data:t}:{valid:!1}}var on=class extends B{_parse(e){let{status:r,ctx:n}=this._processInputParams(e),s=(o,i)=>{if(xi(o)||xi(i))return M;let a=Ac(o.value,i.value);return a.valid?((ki(o)||ki(i))&&r.dirty(),{status:r.value,value:a.data}):(T(n,{code:k.invalid_intersection_types}),M)};return n.common.async?Promise.all([this._def.left._parseAsync({data:n.data,path:n.path,parent:n}),this._def.right._parseAsync({data:n.data,path:n.path,parent:n})]).then(([o,i])=>s(o,i)):s(this._def.left._parseSync({data:n.data,path:n.path,parent:n}),this._def.right._parseSync({data:n.data,path:n.path,parent:n}))}};on.create=(t,e,r)=>new on({left:t,right:e,typeName:D.ZodIntersection,...U(r)});var Ut=class t extends B{_parse(e){let{status:r,ctx:n}=this._processInputParams(e);if(n.parsedType!==z.array)return T(n,{code:k.invalid_type,expected:z.array,received:n.parsedType}),M;if(n.data.length<this._def.items.length)return T(n,{code:k.too_small,minimum:this._def.items.length,inclusive:!0,exact:!1,type:"array"}),M;!this._def.rest&&n.data.length>this._def.items.length&&(T(n,{code:k.too_big,maximum:this._def.items.length,inclusive:!0,exact:!1,type:"array"}),r.dirty());let o=[...n.data].map((i,a)=>{let c=this._def.items[a]||this._def.rest;return c?c._parse(new vt(n,i,n.path,a)):null}).filter(i=>!!i);return n.common.async?Promise.all(o).then(i=>qe.mergeArray(r,i)):qe.mergeArray(r,o)}get items(){return this._def.items}rest(e){return new t({...this._def,rest:e})}};Ut.create=(t,e)=>{if(!Array.isArray(t))throw new Error("You must pass an array of schemas to z.tuple([ ... ])");return new Ut({items:t,typeName:D.ZodTuple,rest:null,...U(e)})};var Pi=class t extends B{get keySchema(){return this._def.keyType}get valueSchema(){return this._def.valueType}_parse(e){let{status:r,ctx:n}=this._processInputParams(e);if(n.parsedType!==z.object)return T(n,{code:k.invalid_type,expected:z.object,received:n.parsedType}),M;let s=[],o=this._def.keyType,i=this._def.valueType;for(let a in n.data)s.push({key:o._parse(new vt(n,a,n.path,a)),value:i._parse(new vt(n,n.data[a],n.path,a)),alwaysSet:a in n.data});return n.common.async?qe.mergeObjectAsync(r,s):qe.mergeObjectSync(r,s)}get element(){return this._def.valueType}static create(e,r,n){return r instanceof B?new t({keyType:e,valueType:r,typeName:D.ZodRecord,...U(n)}):new t({keyType:Pr.create(),valueType:e,typeName:D.ZodRecord,...U(r)})}},Kn=class extends B{get keySchema(){return this._def.keyType}get valueSchema(){return this._def.valueType}_parse(e){let{status:r,ctx:n}=this._processInputParams(e);if(n.parsedType!==z.map)return T(n,{code:k.invalid_type,expected:z.map,received:n.parsedType}),M;let s=this._def.keyType,o=this._def.valueType,i=[...n.data.entries()].map(([a,c],u)=>({key:s._parse(new vt(n,a,n.path,[u,"key"])),value:o._parse(new vt(n,c,n.path,[u,"value"]))}));if(n.common.async){let a=new Map;return Promise.resolve().then(async()=>{for(let c of i){let u=await c.key,l=await c.value;if(u.status==="aborted"||l.status==="aborted")return M;(u.status==="dirty"||l.status==="dirty")&&r.dirty(),a.set(u.value,l.value)}return{status:r.value,value:a}})}else{let a=new Map;for(let c of i){let u=c.key,l=c.value;if(u.status==="aborted"||l.status==="aborted")return M;(u.status==="dirty"||l.status==="dirty")&&r.dirty(),a.set(u.value,l.value)}return{status:r.value,value:a}}}};Kn.create=(t,e,r)=>new Kn({valueType:e,keyType:t,typeName:D.ZodMap,...U(r)});var Bn=class t extends B{_parse(e){let{status:r,ctx:n}=this._processInputParams(e);if(n.parsedType!==z.set)return T(n,{code:k.invalid_type,expected:z.set,received:n.parsedType}),M;let s=this._def;s.minSize!==null&&n.data.size<s.minSize.value&&(T(n,{code:k.too_small,minimum:s.minSize.value,type:"set",inclusive:!0,exact:!1,message:s.minSize.message}),r.dirty()),s.maxSize!==null&&n.data.size>s.maxSize.value&&(T(n,{code:k.too_big,maximum:s.maxSize.value,type:"set",inclusive:!0,exact:!1,message:s.maxSize.message}),r.dirty());let o=this._def.valueType;function i(c){let u=new Set;for(let l of c){if(l.status==="aborted")return M;l.status==="dirty"&&r.dirty(),u.add(l.value)}return{status:r.value,value:u}}let a=[...n.data.values()].map((c,u)=>o._parse(new vt(n,c,n.path,u)));return n.common.async?Promise.all(a).then(c=>i(c)):i(a)}min(e,r){return new t({...this._def,minSize:{value:e,message:I.toString(r)}})}max(e,r){return new t({...this._def,maxSize:{value:e,message:I.toString(r)}})}size(e,r){return this.min(e,r).max(e,r)}nonempty(e){return this.min(1,e)}};Bn.create=(t,e)=>new Bn({valueType:t,minSize:null,maxSize:null,typeName:D.ZodSet,...U(e)});var Ti=class t extends B{constructor(){super(...arguments),this.validate=this.implement}_parse(e){let{ctx:r}=this._processInputParams(e);if(r.parsedType!==z.function)return T(r,{code:k.invalid_type,expected:z.function,received:r.parsedType}),M;function n(a,c){return Ms({data:a,path:r.path,errorMaps:[r.common.contextualErrorMap,r.schemaErrorMap,Ln(),ar].filter(u=>!!u),issueData:{code:k.invalid_arguments,argumentsError:c}})}function s(a,c){return Ms({data:a,path:r.path,errorMaps:[r.common.contextualErrorMap,r.schemaErrorMap,Ln(),ar].filter(u=>!!u),issueData:{code:k.invalid_return_type,returnTypeError:c}})}let o={errorMap:r.common.contextualErrorMap},i=r.data;if(this._def.returns instanceof Er){let a=this;return Be(async function(...c){let u=new it([]),l=await a._def.args.parseAsync(c,o).catch(p=>{throw u.addIssue(n(c,p)),u}),d=await Reflect.apply(i,this,l);return await a._def.returns._def.type.parseAsync(d,o).catch(p=>{throw u.addIssue(s(d,p)),u})})}else{let a=this;return Be(function(...c){let u=a._def.args.safeParse(c,o);if(!u.success)throw new it([n(c,u.error)]);let l=Reflect.apply(i,this,u.data),d=a._def.returns.safeParse(l,o);if(!d.success)throw new it([s(l,d.error)]);return d.data})}}parameters(){return this._def.args}returnType(){return this._def.returns}args(...e){return new t({...this._def,args:Ut.create(e).rest(ur.create())})}returns(e){return new t({...this._def,returns:e})}implement(e){return this.parse(e)}strictImplement(e){return this.parse(e)}static create(e,r,n){return new t({args:e||Ut.create([]).rest(ur.create()),returns:r||ur.create(),typeName:D.ZodFunction,...U(n)})}},an=class extends B{get schema(){return this._def.getter()}_parse(e){let{ctx:r}=this._processInputParams(e);return this._def.getter()._parse({data:r.data,path:r.path,parent:r})}};an.create=(t,e)=>new an({getter:t,typeName:D.ZodLazy,...U(e)});var cn=class extends B{_parse(e){if(e.data!==this._def.value){let r=this._getOrReturnCtx(e);return T(r,{received:r.data,code:k.invalid_literal,expected:this._def.value}),M}return{status:"valid",value:e.data}}get value(){return this._def.value}};cn.create=(t,e)=>new cn({value:t,typeName:D.ZodLiteral,...U(e)});function Wf(t,e){return new un({values:t,typeName:D.ZodEnum,...U(e)})}var un=class t extends B{_parse(e){if(typeof e.data!="string"){let r=this._getOrReturnCtx(e),n=this._def.values;return T(r,{expected:te.joinValues(n),received:r.parsedType,code:k.invalid_type}),M}if(this._cache||(this._cache=new Set(this._def.values)),!this._cache.has(e.data)){let r=this._getOrReturnCtx(e),n=this._def.values;return T(r,{received:r.data,code:k.invalid_enum_value,options:n}),M}return Be(e.data)}get options(){return this._def.values}get enum(){let e={};for(let r of this._def.values)e[r]=r;return e}get Values(){let e={};for(let r of this._def.values)e[r]=r;return e}get Enum(){let e={};for(let r of this._def.values)e[r]=r;return e}extract(e,r=this._def){return t.create(e,{...this._def,...r})}exclude(e,r=this._def){return t.create(this.options.filter(n=>!e.includes(n)),{...this._def,...r})}};un.create=Wf;var ln=class extends B{_parse(e){let r=te.getValidEnumValues(this._def.values),n=this._getOrReturnCtx(e);if(n.parsedType!==z.string&&n.parsedType!==z.number){let s=te.objectValues(r);return T(n,{expected:te.joinValues(s),received:n.parsedType,code:k.invalid_type}),M}if(this._cache||(this._cache=new Set(te.getValidEnumValues(this._def.values))),!this._cache.has(e.data)){let s=te.objectValues(r);return T(n,{received:n.data,code:k.invalid_enum_value,options:s}),M}return Be(e.data)}get enum(){return this._def.values}};ln.create=(t,e)=>new ln({values:t,typeName:D.ZodNativeEnum,...U(e)});var Er=class extends B{unwrap(){return this._def.type}_parse(e){let{ctx:r}=this._processInputParams(e);if(r.parsedType!==z.promise&&r.common.async===!1)return T(r,{code:k.invalid_type,expected:z.promise,received:r.parsedType}),M;let n=r.parsedType===z.promise?r.data:Promise.resolve(r.data);return Be(n.then(s=>this._def.type.parseAsync(s,{path:r.path,errorMap:r.common.contextualErrorMap})))}};Er.create=(t,e)=>new Er({type:t,typeName:D.ZodPromise,...U(e)});var _t=class extends B{innerType(){return this._def.schema}sourceType(){return this._def.schema._def.typeName===D.ZodEffects?this._def.schema.sourceType():this._def.schema}_parse(e){let{status:r,ctx:n}=this._processInputParams(e),s=this._def.effect||null,o={addIssue:i=>{T(n,i),i.fatal?r.abort():r.dirty()},get path(){return n.path}};if(o.addIssue=o.addIssue.bind(o),s.type==="preprocess"){let i=s.transform(n.data,o);if(n.common.async)return Promise.resolve(i).then(async a=>{if(r.value==="aborted")return M;let c=await this._def.schema._parseAsync({data:a,path:n.path,parent:n});return c.status==="aborted"?M:c.status==="dirty"?Yr(c.value):r.value==="dirty"?Yr(c.value):c});{if(r.value==="aborted")return M;let a=this._def.schema._parseSync({data:i,path:n.path,parent:n});return a.status==="aborted"?M:a.status==="dirty"?Yr(a.value):r.value==="dirty"?Yr(a.value):a}}if(s.type==="refinement"){let i=a=>{let c=s.refinement(a,o);if(n.common.async)return Promise.resolve(c);if(c instanceof Promise)throw new Error("Async refinement encountered during synchronous parse operation. Use .parseAsync instead.");return a};if(n.common.async===!1){let a=this._def.schema._parseSync({data:n.data,path:n.path,parent:n});return a.status==="aborted"?M:(a.status==="dirty"&&r.dirty(),i(a.value),{status:r.value,value:a.value})}else return this._def.schema._parseAsync({data:n.data,path:n.path,parent:n}).then(a=>a.status==="aborted"?M:(a.status==="dirty"&&r.dirty(),i(a.value).then(()=>({status:r.value,value:a.value}))))}if(s.type==="transform")if(n.common.async===!1){let i=this._def.schema._parseSync({data:n.data,path:n.path,parent:n});if(!Sr(i))return M;let a=s.transform(i.value,o);if(a instanceof Promise)throw new Error("Asynchronous transform encountered during synchronous parse operation. Use .parseAsync instead.");return{status:r.value,value:a}}else return this._def.schema._parseAsync({data:n.data,path:n.path,parent:n}).then(i=>Sr(i)?Promise.resolve(s.transform(i.value,o)).then(a=>({status:r.value,value:a})):M);te.assertNever(s)}};_t.create=(t,e,r)=>new _t({schema:t,typeName:D.ZodEffects,effect:e,...U(r)});_t.createWithPreprocess=(t,e,r)=>new _t({schema:e,effect:{type:"preprocess",transform:t},typeName:D.ZodEffects,...U(r)});var yt=class extends B{_parse(e){return this._getType(e)===z.undefined?Be(void 0):this._def.innerType._parse(e)}unwrap(){return this._def.innerType}};yt.create=(t,e)=>new yt({innerType:t,typeName:D.ZodOptional,...U(e)});var Ht=class extends B{_parse(e){return this._getType(e)===z.null?Be(null):this._def.innerType._parse(e)}unwrap(){return this._def.innerType}};Ht.create=(t,e)=>new Ht({innerType:t,typeName:D.ZodNullable,...U(e)});var dn=class extends B{_parse(e){let{ctx:r}=this._processInputParams(e),n=r.data;return r.parsedType===z.undefined&&(n=this._def.defaultValue()),this._def.innerType._parse({data:n,path:r.path,parent:r})}removeDefault(){return this._def.innerType}};dn.create=(t,e)=>new dn({innerType:t,typeName:D.ZodDefault,defaultValue:typeof e.default=="function"?e.default:()=>e.default,...U(e)});var pn=class extends B{_parse(e){let{ctx:r}=this._processInputParams(e),n={...r,common:{...r.common,issues:[]}},s=this._def.innerType._parse({data:n.data,path:n.path,parent:{...n}});return Vn(s)?s.then(o=>({status:"valid",value:o.status==="valid"?o.value:this._def.catchValue({get error(){return new it(n.common.issues)},input:n.data})})):{status:"valid",value:s.status==="valid"?s.value:this._def.catchValue({get error(){return new it(n.common.issues)},input:n.data})}}removeCatch(){return this._def.innerType}};pn.create=(t,e)=>new pn({innerType:t,typeName:D.ZodCatch,catchValue:typeof e.catch=="function"?e.catch:()=>e.catch,...U(e)});var Gn=class extends B{_parse(e){if(this._getType(e)!==z.nan){let n=this._getOrReturnCtx(e);return T(n,{code:k.invalid_type,expected:z.nan,received:n.parsedType}),M}return{status:"valid",value:e.data}}};Gn.create=t=>new Gn({typeName:D.ZodNaN,...U(t)});var sx=Symbol("zod_brand"),qs=class extends B{_parse(e){let{ctx:r}=this._processInputParams(e),n=r.data;return this._def.type._parse({data:n,path:r.path,parent:r})}unwrap(){return this._def.type}},Ds=class t extends B{_parse(e){let{status:r,ctx:n}=this._processInputParams(e);if(n.common.async)return(async()=>{let o=await this._def.in._parseAsync({data:n.data,path:n.path,parent:n});return o.status==="aborted"?M:o.status==="dirty"?(r.dirty(),Yr(o.value)):this._def.out._parseAsync({data:o.value,path:n.path,parent:n})})();{let s=this._def.in._parseSync({data:n.data,path:n.path,parent:n});return s.status==="aborted"?M:s.status==="dirty"?(r.dirty(),{status:"dirty",value:s.value}):this._def.out._parseSync({data:s.value,path:n.path,parent:n})}}static create(e,r){return new t({in:e,out:r,typeName:D.ZodPipeline})}},fn=class extends B{_parse(e){let r=this._def.innerType._parse(e),n=s=>(Sr(s)&&(s.value=Object.freeze(s.value)),s);return Vn(r)?r.then(s=>n(s)):n(r)}unwrap(){return this._def.innerType}};fn.create=(t,e)=>new fn({innerType:t,typeName:D.ZodReadonly,...U(e)});function Hf(t,e){let r=typeof t=="function"?t(e):typeof t=="string"?{message:t}:t;return typeof r=="string"?{message:r}:r}function Jf(t,e={},r){return t?Tr.create().superRefine((n,s)=>{let o=t(n);if(o instanceof Promise)return o.then(i=>{if(!i){let a=Hf(e,n),c=a.fatal??r??!0;s.addIssue({code:"custom",...a,fatal:c})}});if(!o){let i=Hf(e,n),a=i.fatal??r??!0;s.addIssue({code:"custom",...i,fatal:a})}}):Tr.create()}var ox={object:at.lazycreate},D;(function(t){t.ZodString="ZodString",t.ZodNumber="ZodNumber",t.ZodNaN="ZodNaN",t.ZodBigInt="ZodBigInt",t.ZodBoolean="ZodBoolean",t.ZodDate="ZodDate",t.ZodSymbol="ZodSymbol",t.ZodUndefined="ZodUndefined",t.ZodNull="ZodNull",t.ZodAny="ZodAny",t.ZodUnknown="ZodUnknown",t.ZodNever="ZodNever",t.ZodVoid="ZodVoid",t.ZodArray="ZodArray",t.ZodObject="ZodObject",t.ZodUnion="ZodUnion",t.ZodDiscriminatedUnion="ZodDiscriminatedUnion",t.ZodIntersection="ZodIntersection",t.ZodTuple="ZodTuple",t.ZodRecord="ZodRecord",t.ZodMap="ZodMap",t.ZodSet="ZodSet",t.ZodFunction="ZodFunction",t.ZodLazy="ZodLazy",t.ZodLiteral="ZodLiteral",t.ZodEnum="ZodEnum",t.ZodEffects="ZodEffects",t.ZodNativeEnum="ZodNativeEnum",t.ZodOptional="ZodOptional",t.ZodNullable="ZodNullable",t.ZodDefault="ZodDefault",t.ZodCatch="ZodCatch",t.ZodPromise="ZodPromise",t.ZodBranded="ZodBranded",t.ZodPipeline="ZodPipeline",t.ZodReadonly="ZodReadonly"})(D||(D={}));var ix=(t,e={message:`Input not instance of ${t.name}`})=>Jf(r=>r instanceof t,e),Yf=Pr.create,Qf=Qr.create,ax=Gn.create,cx=Xr.create,Xf=en.create,ux=tn.create,lx=Un.create,dx=rn.create,px=nn.create,fx=Tr.create,mx=ur.create,hx=It.create,gx=Hn.create,yx=lr.create,vx=at.create,_x=at.strictCreate,bx=sn.create,wx=Si.create,$x=on.create,xx=Ut.create,kx=Pi.create,Sx=Kn.create,Px=Bn.create,Tx=Ti.create,Ex=an.create,zx=cn.create,Cx=un.create,Ix=ln.create,Rx=Er.create,Ox=_t.create,Nx=yt.create,jx=Ht.create,Ax=_t.createWithPreprocess,Mx=Ds.create,qx=()=>Yf().optional(),Dx=()=>Qf().optional(),Zx=()=>Xf().optional(),Lx={string:(t=>Pr.create({...t,coerce:!0})),number:(t=>Qr.create({...t,coerce:!0})),boolean:(t=>en.create({...t,coerce:!0})),bigint:(t=>Xr.create({...t,coerce:!0})),date:(t=>tn.create({...t,coerce:!0}))};var Vx=M;var Kt=ye(require("path"));function em(t,e){let r=n=>Kt.isAbsolute(n)?n:Kt.join(e,n);return[{name:"read_file",description:"Read file content. Relative paths are resolved against the workspace root.",parameters:E.object({path:E.string()}),execute:async n=>{let s=r(n.path);if(!t.checkPathAccess(s,"read"))throw new Error(`Access Denied by Policy: ${s}`);return await zr.readFile(s,"utf-8")}},{name:"write_file",description:"Write file content. Relative paths are resolved against the workspace root.",parameters:E.object({path:E.string(),content:E.string()}),execute:async n=>{let s=r(n.path);if(!t.checkPathAccess(s,"write"))throw new Error(`Access Denied by Policy: ${s}`);return await zr.mkdir(Kt.dirname(s),{recursive:!0}),await zr.writeFile(s,n.content),`Successfully wrote to ${s}`}},{name:"scan_project",description:"List all files in the workspace (excluding .git, node_modules, etc). Useful for understanding project structure.",parameters:E.object({}),execute:async()=>{let n=[];async function s(o){let i=await zr.readdir(o,{withFileTypes:!0});for(let a of i){let c=Kt.relative(e,Kt.join(o,a.name));if(a.name===".git"||a.name==="node_modules"||a.name===".DS_Store"||a.name==="out"||a.name==="dist"){a.isDirectory()&&n.push(c+"/ (ignored)");continue}a.isDirectory()?await s(Kt.join(o,a.name)):n.push(c)}}return await s(e),`Project Files (${n.length}):
`+n.slice(0,100).join(`
`)+(n.length>100?`
... ${n.length-100} more files`:"")}}]}var Cr=ye(require("fs/promises"));var Ei=ye(require("path"));function tm(t,e){let r=n=>Ei.isAbsolute(n)?n:Ei.join(e,n);return[{name:"str_replace",description:"Replace a specific string in a file with new content. The old_str must match EXACTLY (including whitespace and indentation). Use this for precise edits.",parameters:E.object({path:E.string().describe("Path to the file to edit"),old_str:E.string().describe("The exact string to find and replace (must match exactly)"),new_str:E.string().describe("The new string to replace old_str with")}),execute:async n=>{let s=r(n.path);if(!t.checkPathAccess(s,"write"))throw new Error(`Access Denied by Policy: ${s}`);let o=await Cr.readFile(s,"utf-8"),i=n.old_str,a=n.new_str,c=o;if(!o.includes(i)){if(c=o.replace(/\r\n/g,`
`),i=i.replace(/\r\n/g,`
`),a=a.replace(/\r\n/g,`
`),!c.includes(i))throw new Error("old_str not found in file. Make sure it matches exactly including whitespace and indentation.");o=c}let u=o.split(i).length-1;if(u>1)throw new Error(`old_str found ${u} times. It must be unique. Add more context to make it unique.`);let l=o.replace(i,a);return await Cr.writeFile(s,l),`Successfully replaced content in ${s}`}},{name:"insert_after",description:"Insert new content after a specific string in a file. The marker string must match exactly.",parameters:E.object({path:E.string().describe("Path to the file to edit"),marker:E.string().describe("The exact string after which to insert new content"),content:E.string().describe("The content to insert after the marker")}),execute:async n=>{let s=r(n.path);if(!t.checkPathAccess(s,"write"))throw new Error(`Access Denied by Policy: ${s}`);let o=await Cr.readFile(s,"utf-8"),i=n.marker,a=n.content;if(!o.includes(i)&&(o=o.replace(/\r\n/g,`
`),i=i.replace(/\r\n/g,`
`),a=a.replace(/\r\n/g,`
`),!o.includes(i)))throw new Error("Marker string not found in file.");let c=o.split(i).length-1;if(c>1)throw new Error(`Marker found ${c} times. It must be unique.`);let u=o.replace(i,i+a);return await Cr.writeFile(s,u),`Successfully inserted content after marker in ${s}`}},{name:"apply_patch",description:"Apply a unified diff patch to a file. Supports standard unified diff format with @@ line markers.",parameters:E.object({path:E.string(),patch:E.string().describe("Unified diff format patch content")}),execute:async n=>{let s=r(n.path);if(!t.checkPathAccess(s,"write"))throw new Error(`Access Denied by Policy: ${s}`);let o=await Cr.readFile(s,"utf-8"),i=Fx(o,n.patch);return await Cr.writeFile(s,i),`Successfully applied patch to ${s}`}}]}function Fx(t,e){let r=t.split(`
`),n=e.split(`
`),s=[],o=null;for(let a of n){if(a.startsWith("---")||a.startsWith("+++"))continue;let c=a.match(/^@@ -(\d+)(?:,(\d+))? \+(\d+)(?:,(\d+))? @@/);if(c){o&&s.push(o),o={oldStart:parseInt(c[1],10),oldCount:parseInt(c[2]||"1",10),newStart:parseInt(c[3],10),newCount:parseInt(c[4]||"1",10),changes:[]};continue}o&&(a.startsWith("-")?o.changes.push({type:"remove",line:a.slice(1)}):a.startsWith("+")?o.changes.push({type:"add",line:a.slice(1)}):(a.startsWith(" ")||a==="")&&o.changes.push({type:"context",line:a.slice(1)||""}))}if(o&&s.push(o),s.length===0)throw new Error("No valid hunks found in patch. Use unified diff format with @@ markers.");let i=[...r];for(let a of s.reverse()){let c=a.oldStart-1,u=0,l=[];for(let p of a.changes)(p.type==="remove"||p.type==="context")&&u++,(p.type==="add"||p.type==="context")&&l.push(p.line);let d=a.changes.filter(p=>p.type==="remove").length,f=a.changes.filter(p=>p.type==="add").map(p=>p.line);i.splice(c,a.oldCount,...f.concat(a.changes.filter(p=>p.type==="context").map(p=>p.line)))}return i.join(`
`)}var rm=t=>({name:"manage_task",description:"Create, update, or list tasks to track complex goals. Use this to break down large user requests into steps. Supports atomic changes tracking.",parameters:E.object({action:E.enum(["create","update_status","update_step","list","create_atomic_change","get_progress","start_step","complete_step"]).describe("The action to perform"),title:E.string().optional().describe("Title for new task"),description:E.string().optional().describe("Description for atomic change task"),steps:E.array(E.string()).optional().describe("List of step descriptions for new task"),taskId:E.string().optional().describe("ID of the task to update"),status:E.enum(["pending","in-progress","completed","failed"]).optional().describe("New status for task or step"),stepIndex:E.number().optional().describe("Index of the step to update (0-based)"),contextItems:E.array(E.string()).optional().describe("List of context items for atomic change task")}),execute:async e=>{if(e.action==="create"){if(!e.title)throw new Error("Title required for create");let r=t.createTask(e.title,e.steps||[]);return`Task created: [${r.id}] ${r.title}`}if(e.action==="list"){let r=t.listTasks();return JSON.stringify(r,null,2)}if(e.action==="update_status"){if(!e.taskId||!e.status)throw new Error("taskId and status required");return t.updateTaskStatus(e.taskId,e.status)?`Task ${e.taskId} status updated to ${e.status}`:`Task ${e.taskId} not found`}if(e.action==="update_step"){if(!e.taskId||e.stepIndex===void 0||!e.status)throw new Error("taskId, stepIndex, and status required");return t.updateStepStatus(e.taskId,e.stepIndex,e.status)?`Task ${e.taskId} step ${e.stepIndex} updated to ${e.status}`:`Task ${e.taskId} not found or step invalid`}if(e.action==="create_atomic_change"){if(!e.title)throw new Error("Title required for atomic change task");let r=t.createAtomicChangeTask(e.title,e.description||"",e.contextItems||[]);return`Atomic change task created: [${r.id}] ${r.title}`}if(e.action==="get_progress"){if(!e.taskId)throw new Error("taskId required");let r=t.getTaskProgress(e.taskId);return r?JSON.stringify(r,null,2):`Task ${e.taskId} not found`}if(e.action==="start_step"){if(!e.taskId||e.stepIndex===void 0)throw new Error("taskId and stepIndex required");return t.startStep(e.taskId,e.stepIndex)?`Step ${e.stepIndex} started for task ${e.taskId}`:`Failed to start step ${e.stepIndex} for task ${e.taskId}`}if(e.action==="complete_step"){if(!e.taskId||e.stepIndex===void 0)throw new Error("taskId and stepIndex required");return t.completeStep(e.taskId,e.stepIndex)?`Step ${e.stepIndex} completed for task ${e.taskId}`:`Failed to complete step ${e.stepIndex} for task ${e.taskId}`}return"Invalid action"}});var Mc=ye(require("crypto")),zi=class{constructor(){this.tasks=new Map}createTask(e,r=[]){let n=Mc.randomUUID(),s={id:n,title:e,status:"pending",steps:r.map(o=>({id:Mc.randomUUID(),description:o,status:"pending",createdAt:Date.now()})),createdAt:Date.now(),updatedAt:Date.now()};return this.tasks.set(n,s),s}updateTaskStatus(e,r){let n=this.tasks.get(e);return n&&(n.status=r,n.updatedAt=Date.now(),this.tasks.set(e,n)),n}updateStepStatus(e,r,n){let s=this.tasks.get(e);if(s&&s.steps[r])return s.steps[r].status=n,s.steps[r].updatedAt=Date.now(),s.updatedAt=Date.now(),this.tasks.set(e,s),s}createAtomicChangeTask(e,r,n){let s=this.createTask(e,["Analyze requirements","Plan atomic changes","Implement changes","Verify changes","Document changes"]);return s.description=r,s.contextItems=n||[],s}getTaskProgress(e){let r=this.tasks.get(e);if(!r)return null;let n=r.steps.length;if(n===0)return{completedSteps:0,totalSteps:0,percentage:0};let s=r.steps.filter(i=>i.status==="completed").length,o=Math.round(s/n*100);return{completedSteps:s,totalSteps:n,percentage:o}}getCurrentStep(e){let r=this.tasks.get(e);return r?(r.steps.find(s=>s.status==="in-progress"||s.status==="pending"),r):void 0}startStep(e,r){let n=this.tasks.get(e);return!n||n.steps[r]===void 0||n.steps[r].status!=="pending"?!1:(n.steps[r].status="in-progress",n.steps[r].startedAt=Date.now(),n.updatedAt=Date.now(),this.tasks.set(e,n),!0)}completeStep(e,r){let n=this.tasks.get(e);return!n||n.steps[r]===void 0||n.steps[r].status!=="in-progress"?!1:(n.steps[r].status="completed",n.steps[r].completedAt=Date.now(),n.updatedAt=Date.now(),this.tasks.set(e,n),!0)}getDetailedTask(e){let r=this.tasks.get(e);if(!r)return;let n=this.getTaskProgress(e);return n&&(r.progress=n),r}getTask(e){return this.tasks.get(e)}listTasks(){return Array.from(this.tasks.values()).sort((e,r)=>r.createdAt-e.createdAt)}toJSON(){return Array.from(this.tasks.values())}};var Bt=ye(require("vscode")),Zs=class{constructor(e,r,n,s){this._extensionUri=e;this.orchestrator=r;this.taskManager=n;this.historyManager=s;this.currentHistory=[];this.isGenerating=!1;this.webviewReady=!1;this.ongoingAgentProcess=null;this.lastAgentUpdate=null;this.agentUpdatesBuffer=[];this.pendingAgentUpdates=[]}static{this.viewType="vibey.chatView"}async resolveWebviewView(e,r,n){this._view=e,e.webview.options={enableScripts:!0,localResourceRoots:[this._extensionUri]},this.currentHistory=await this.historyManager.loadHistory(),console.log("[VIBEY][ChatPanel] Loaded history:",this.currentHistory),e.webview.html=this._getHtmlForWebview(e.webview),e.webview.onDidReceiveMessage(async s=>{switch(s.type){case"webviewReady":{this.webviewReady=!0,console.log("[VIBEY][ChatPanel] webviewReady received. History:",this.currentHistory),this.currentHistory.length>0?(console.log("[VIBEY][ChatPanel] Posting restoreHistory to webview:",this.currentHistory),this._view?.webview.postMessage({type:"restoreHistory",messages:this.currentHistory})):console.log("[VIBEY][ChatPanel] No history to restore."),this.isGenerating&&(this._view?.webview.postMessage({type:"restoreState",busy:!0}),this.lastAgentUpdate&&this._view?.webview.postMessage({type:"agentUpdate",update:this.lastAgentUpdate}),this.ongoingAgentProcess&&this.ongoingAgentProcess.reconnect(o=>{this.lastAgentUpdate=o,this.agentUpdatesBuffer.push(o),this.webviewReady&&this._view?.webview.postMessage({type:"agentUpdate",update:o})}));break}case"sendMessage":{if(!s.text)return;let o={role:"user",content:s.text};this.currentHistory.push(o),this.webviewReady&&this._view?.webview.postMessage({type:"addMessage",role:o.role,content:o.content}),await this.historyManager.saveHistory(this.currentHistory),this.isGenerating=!0,this.agentUpdatesBuffer=[],this.pendingAgentUpdates=[];let i=!1;try{let a=l=>{this.lastAgentUpdate=l,this.agentUpdatesBuffer.push(l),this.pendingAgentUpdates.push(l),this.webviewReady&&this._view?.webview.postMessage({type:"agentUpdate",update:l})},c=l=>{a=l};this.ongoingAgentProcess={cancel:()=>{i=!0,this.orchestrator.cancel()},reconnect:c};let u=await this.orchestrator.chat(s.text,s.context,l=>{i||a(l)});this.webviewReady&&this._view?.webview.postMessage({type:"addMessage",role:"assistant",content:u}),this.currentHistory.push({role:"assistant",content:u,agentUpdates:[...this.pendingAgentUpdates]}),await this.historyManager.saveHistory(this.currentHistory),u!=="Request cancelled."&&this.webviewReady&&this._view?.webview.postMessage({type:"requestComplete"})}catch(a){this.webviewReady&&this._view?.webview.postMessage({type:"addMessage",role:"assistant",content:`Error: ${a.message}`}),this.webviewReady&&this._view?.webview.postMessage({type:"requestComplete"})}finally{this.isGenerating=!1,this.ongoingAgentProcess=null,this.lastAgentUpdate=null,await this.historyManager.saveSession(this.currentHistory)}break}case"openSettings":{Bt.commands.executeCommand("vibey.openSettings");break}case"selectModel":{Bt.commands.executeCommand("vibey.selectModel");break}case"selectContext":{let o=await Bt.window.showOpenDialog({canSelectMany:!0,openLabel:"Add to Context"});o&&o.forEach(i=>{this.webviewReady&&e.webview.postMessage({type:"appendContext",file:{name:i.path.split("/").pop(),path:i.fsPath}})});break}case"stopRequest":{this.orchestrator.cancel(),this.webviewReady&&e.webview.postMessage({type:"requestStopped"});break}case"retryRequest":break;case"getTasks":{let o=this.taskManager.listTasks();this.webviewReady&&e.webview.postMessage({type:"updateTasks",tasks:o});break}case"error":{Bt.window.showErrorMessage(s.message);break}case"voiceInput":{this.handleVoiceInput().catch(o=>{console.error("Voice input error:",o),this.webviewReady&&this._view?.webview.postMessage({type:"voiceInputError",message:o.message||"Failed to process voice input"})});break}}})}async handleVoiceInput(){Bt.commands.executeCommand("vibey.voiceInput")}addTranscriptToInput(e){this.webviewReady&&e&&this._view?.webview.postMessage({type:"voiceInputReceived",text:e})}_getHtmlForWebview(e){let r=e.asWebviewUri(Bt.Uri.joinPath(this._extensionUri,"src","ui","media","main.js"));return`<!DOCTYPE html>
        <html lang="en">
        <head>
            <meta charset="UTF-8">
            <meta name="viewport" content="width=device-width, initial-scale=1.0">
            <title>Vibey Chat</title>
            <link rel="stylesheet" href="${e.asWebviewUri(Bt.Uri.joinPath(this._extensionUri,"src","ui","media","main.css"))}">
        </head>
        <body>
            <div class="tabs">
                <div class="tab active" data-tab="chat">Chat</div>
                <div class="tab" data-tab="tasks">Tasks</div>
            </div>

            <div id="chat-view" class="view active">
                <div id="chat-container"></div>

                <div id="input-area">
                    <div id="context-area"></div>
                    <div class="input-container">
                        <textarea id="InputBox" placeholder="Ask Vibey... (Shift+Enter for new line)"></textarea>
                        <div class="input-actions">
                            <div class="toolbar">
                                <button id="attach-btn" class="icon-btn" title="Add Context">\u{1F4CE}</button>
                                <button id="models-btn" class="icon-btn" title="Select Model">\u{1F916}</button>
                                <button id="settings-btn" class="icon-btn" title="Settings">\u2699\uFE0F</button>
                            </div>
                            <button id="send-btn">Send \u27A4</button>
                        </div>
                    </div>
                </div>
            </div>

            <div id="tasks-view" class="view">
                <div id="task-list">
                    <!-- Tasks will be rendered here -->
                    <div class="empty-state">No active tasks. Ask Vibey to start a task!</div>
                </div>
            </div>

            <script type="module" src="${r}"></script>
        </body>
        </html>`}};var Wn=ye(require("vscode")),Ci=class t{constructor(e,r,n){this.disposables=[];this.panel=e,this.onTranscriptCallback=n,this.panel.webview.html=this.getHtmlContent(),this.panel.webview.onDidReceiveMessage(s=>{switch(s.type){case"transcript":this.onTranscriptCallback&&s.text&&this.onTranscriptCallback(s.text);break;case"error":Wn.window.showErrorMessage(`Voice Input Error: ${s.message}`);break;case"status":console.log("Mic status:",s.message);break;case"close":this.dispose();break}},null,this.disposables),this.panel.onDidDispose(()=>this.dispose(),null,this.disposables)}static createOrShow(e,r){if(t.currentPanel)return t.currentPanel.panel.reveal(Wn.ViewColumn.Two),t.currentPanel.onTranscriptCallback=r,t.currentPanel;let n=Wn.window.createWebviewPanel("vibeyMic","\u{1F3A4} Vibey Voice Input",Wn.ViewColumn.Two,{enableScripts:!0,retainContextWhenHidden:!0});return t.currentPanel=new t(n,e,r),t.currentPanel}dispose(){for(t.currentPanel=void 0,this.panel.dispose();this.disposables.length;){let e=this.disposables.pop();e&&e.dispose()}}getHtmlContent(){return`<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Vibey Voice Input</title>
    <style>
        body {
            font-family: var(--vscode-font-family, system-ui);
            padding: 20px;
            text-align: center;
            background: var(--vscode-editor-background, #1e1e1e);
            color: var(--vscode-editor-foreground, #fff);
        }
        .mic-container { margin: 40px auto; }
        .mic-btn {
            width: 120px; height: 120px;
            border-radius: 50%;
            border: none;
            font-size: 48px;
            cursor: pointer;
            background: #333;
            transition: all 0.3s;
        }
        .mic-btn:hover { background: #444; }
        .mic-btn.listening {
            background: #e74c3c;
            animation: pulse 1.5s infinite;
        }
        @keyframes pulse {
            0%, 100% { transform: scale(1); opacity: 1; }
            50% { transform: scale(1.1); opacity: 0.8; }
        }
        .status { margin: 20px 0; font-size: 14px; color: #888; }
        .transcript {
            margin: 20px;
            padding: 15px;
            background: #2d2d2d;
            border-radius: 8px;
            min-height: 60px;
            text-align: left;
        }
        .transcript-label { font-size: 12px; color: #888; margin-bottom: 8px; }
        .transcript-text { font-size: 16px; line-height: 1.5; }
        .interim { color: #888; font-style: italic; }
        .actions { margin-top: 20px; }
        .actions button {
            padding: 10px 20px;
            margin: 5px;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            font-size: 14px;
        }
        .send-btn { background: #007acc; color: white; }
        .send-btn:hover { background: #005a9e; }
        .cancel-btn { background: #444; color: white; }
        .cancel-btn:hover { background: #555; }
        .error { color: #e74c3c; margin: 10px 0; }
        .instructions { font-size: 12px; color: #666; margin-top: 30px; }
    </style>
</head>
<body>
    <h2>\u{1F3A4} Voice Input</h2>
    
    <div class="mic-container">
        <button id="micBtn" class="mic-btn">\u{1F3A4}</button>
    </div>
    
    <div id="status" class="status">Click the microphone to start</div>
    <div id="error" class="error" style="display:none;"></div>
    
    <div class="transcript">
        <div class="transcript-label">Transcript:</div>
        <div id="transcriptText" class="transcript-text">
            <span id="finalText"></span>
            <span id="interimText" class="interim"></span>
        </div>
    </div>
    
    <div class="actions">
        <button id="sendBtn" class="send-btn" disabled>Send to Chat</button>
        <button id="cancelBtn" class="cancel-btn">Cancel</button>
    </div>
    
    <div class="instructions">
        Click the mic button to start/stop recording.<br>
        Your speech will be transcribed in real-time.
    </div>

    <script>
        const vscodeApi = acquireVsCodeApi();
        const micBtn = document.getElementById('micBtn');
        const status = document.getElementById('status');
        const errorDiv = document.getElementById('error');
        const finalText = document.getElementById('finalText');
        const interimText = document.getElementById('interimText');
        const sendBtn = document.getElementById('sendBtn');
        const cancelBtn = document.getElementById('cancelBtn');

        let isListening = false;
        let recognition = null;
        let fullTranscript = '';

        // Check for speech recognition support
        const SpeechRecognition = window.SpeechRecognition || window.webkitSpeechRecognition;
        
        if (!SpeechRecognition) {
            status.textContent = 'Speech recognition not supported';
            errorDiv.textContent = 'Your browser does not support the Web Speech API.';
            errorDiv.style.display = 'block';
            micBtn.disabled = true;
        }

        async function requestMicPermission() {
            try {
                const stream = await navigator.mediaDevices.getUserMedia({ audio: true });
                // Stop the stream immediately - we just needed permission
                stream.getTracks().forEach(track => track.stop());
                return true;
            } catch (err) {
                errorDiv.textContent = 'Microphone access denied: ' + err.message;
                errorDiv.style.display = 'block';
                vscodeApi.postMessage({ type: 'error', message: err.message });
                return false;
            }
        }

        async function toggleListening() {
            if (isListening) {
                stopListening();
            } else {
                await startListening();
            }
        }

        async function startListening() {
            errorDiv.style.display = 'none';
            
            // Request mic permission first
            const hasPermission = await requestMicPermission();
            if (!hasPermission) return;

            recognition = new SpeechRecognition();
            recognition.continuous = true;
            recognition.interimResults = true;
            recognition.lang = 'en-US';

            recognition.onstart = () => {
                isListening = true;
                micBtn.classList.add('listening');
                status.textContent = 'Listening... Speak now';
                vscodeApi.postMessage({ type: 'status', message: 'listening' });
            };

            recognition.onresult = (event) => {
                let interim = '';
                let final = '';
                
                for (let i = event.resultIndex; i < event.results.length; i++) {
                    const result = event.results[i];
                    if (result.isFinal) {
                        final += result[0].transcript + ' ';
                    } else {
                        interim += result[0].transcript;
                    }
                }
                
                if (final) {
                    fullTranscript += final;
                    finalText.textContent = fullTranscript;
                    sendBtn.disabled = false;
                }
                interimText.textContent = interim;
            };

            recognition.onerror = (event) => {
                if (event.error !== 'no-speech') {
                    errorDiv.textContent = 'Recognition error: ' + event.error;
                    errorDiv.style.display = 'block';
                    vscodeApi.postMessage({ type: 'error', message: event.error });
                }
            };

            recognition.onend = () => {
                if (isListening) {
                    // Restart if we're still supposed to be listening
                    try { recognition.start(); } catch (e) {}
                } else {
                    micBtn.classList.remove('listening');
                    status.textContent = fullTranscript 
                        ? 'Recording stopped. Click Send or speak more.' 
                        : 'Click the microphone to start';
                }
            };

            try {
                recognition.start();
            } catch (err) {
                errorDiv.textContent = 'Failed to start: ' + err.message;
                errorDiv.style.display = 'block';
            }
        }

        function stopListening() {
            isListening = false;
            if (recognition) {
                recognition.stop();
                recognition = null;
            }
            micBtn.classList.remove('listening');
            status.textContent = fullTranscript 
                ? 'Recording stopped. Click Send or speak more.' 
                : 'Click the microphone to start';
        }

        function sendTranscript() {
            if (fullTranscript.trim()) {
                vscodeApi.postMessage({ type: 'transcript', text: fullTranscript.trim() });
                vscodeApi.postMessage({ type: 'close' });
            }
        }

        function cancel() {
            stopListening();
            vscodeApi.postMessage({ type: 'close' });
        }

        micBtn.addEventListener('click', toggleListening);
        sendBtn.addEventListener('click', sendTranscript);
        cancelBtn.addEventListener('click', cancel);

        // Auto-request permission on load
        requestMicPermission();
    </script>
</body>
</html>`}};var qc={win32:{powershell:{path:"powershell.exe",args:["-NoLogo"],displayName:"PowerShell"},cmd:{path:"cmd.exe",displayName:"Command Prompt"},bash:{path:"bash.exe",displayName:"Bash (WSL/Git)"},zsh:void 0,sh:void 0,fish:void 0,auto:void 0},linux:{powershell:{path:"pwsh",displayName:"PowerShell Core"},cmd:void 0,bash:{path:"/bin/bash",displayName:"Bash"},zsh:{path:"/bin/zsh",displayName:"Zsh"},sh:{path:"/bin/sh",displayName:"Shell"},fish:{path:"/usr/bin/fish",displayName:"Fish"},auto:void 0},darwin:{powershell:{path:"pwsh",displayName:"PowerShell Core"},cmd:void 0,bash:{path:"/bin/bash",displayName:"Bash"},zsh:{path:"/bin/zsh",displayName:"Zsh"},sh:{path:"/bin/sh",displayName:"Shell"},fish:{path:"/usr/bin/fish",displayName:"Fish"},auto:void 0}};var dr=ye(require("vscode")),Dc=ye(require("path")),pr=ye(require("fs")),nm=ye(require("os"));function Ii(){return`vibey-${Date.now()}-${Math.random().toString(36).substring(2,11)}`}var Ls=class{constructor(e,r,n){this.workspaceRoot=e;this.context=r;this.iconPath=n;this.terminals=new Map;this.terminalStates=new Map;this.eventListeners=[];this.disposables=[];this.terminalOutputBuffers=new Map;this.history=this.context.globalState.get("vibey.terminalHistory")||{entries:[],maxEntries:500},this.outputChannel=dr.window.createOutputChannel("Vibey Terminal"),this.disposables.push(dr.window.onDidCloseTerminal(s=>{this.handleTerminalClosed(s)})),this.disposables.push(dr.window.onDidChangeActiveTerminal(s=>{s&&this.updateActiveState(s)}))}getPreferredShell(){return dr.workspace.getConfiguration("vibey").get("preferredShell")||"auto"}getShellConfig(e){let r=process.platform,n=qc[r]||qc.linux;if(e!=="auto")return n[e]}getIconPath(){return dr.Uri.file(this.iconPath)}async createTerminal(e={}){let r=e.shellType||this.getPreferredShell(),n=this.getShellConfig(r),s=Ii(),o=e.name||`Vibey ${this.terminals.size+1}`,i={name:o,cwd:e.cwd||this.workspaceRoot,iconPath:this.getIconPath()};n&&(i.shellPath=n.path,i.shellArgs=n.args);let a=dr.window.createTerminal(i);this.terminals.set(s,a),this.terminalOutputBuffers.set(s,"");let c={id:s,name:o,shellType:r,createdAt:Date.now(),isActive:!0};return this.terminalStates.set(s,c),this.emitEvent({type:"terminal-created",terminalId:s}),this.outputChannel.appendLine(`[Terminal] Created: ${o} (${s})`),s}async getOrCreateTerminal(e={}){if(e.reuseExisting){for(let[r,n]of this.terminalStates.entries())if(n.isActive)return this.outputChannel.appendLine(`[Terminal] Reusing: ${n.name} (${r})`),r}return this.createTerminal(e)}async sendCommand(e,r){let n=this.terminals.get(e);if(!n)throw new Error(`Terminal ${e} not found`);let s=this.terminalStates.get(e);s&&(s.lastCommandAt=Date.now());let o={id:Ii(),terminalId:e,command:r,executedAt:Date.now()};this.addHistoryEntry(o),n.sendText(r),this.outputChannel.appendLine(`[Terminal ${e}] > ${r}`),this.emitEvent({type:"command-executed",terminalId:e,data:{command:r}})}async runCommand(e,r={}){let n=await this.getOrCreateTerminal({...r,reuseExisting:!0}),s=this.terminals.get(n),o=Date.now();if(!s)throw new Error(`Terminal ${n} not found`);return r.showTerminal!==!1&&s.show(!0),s.shellIntegration?this.runWithShellIntegration(s,n,e,o,r.timeout):this.runWithFileRedirect(s,n,e,o,r.timeout)}async runWithShellIntegration(e,r,n,s,o=3e4){let i=e.shellIntegration;try{let a=i.executeCommand(n),c="",u=a.read(),l=new Promise((m,h)=>{setTimeout(()=>h(new Error("Command timeout")),o)}),d=(async()=>{for await(let m of u)c+=m;return c})();c=await Promise.race([d,l]);let f=a.exitCode,p={id:Ii(),terminalId:r,command:n,executedAt:s,output:c.substring(0,1e4),exitCode:f,duration:Date.now()-s};return this.addHistoryEntry(p),this.outputChannel.appendLine(`[Terminal ${r}] Command completed (shell integration)`),this.emitEvent({type:"command-completed",terminalId:r,data:{command:n,exitCode:f,output:c}}),{success:f===void 0||f===0,output:c,terminalId:r,command:n,duration:Date.now()-s,exitCode:f,captureMethod:"shell_integration"}}catch(a){return this.outputChannel.appendLine(`[Terminal ${r}] Shell integration error: ${a.message}`),this.runWithFileRedirect(e,r,n,s,o)}}async runWithFileRedirect(e,r,n,s,o=3e4){let i=nm.tmpdir(),a=Dc.join(i,`vibey-output-${r}-${Date.now()}.txt`),c=Dc.join(i,`vibey-exit-${r}-${Date.now()}.txt`),l=this.terminalStates.get(r)?.shellType||"auto",d=this.buildRedirectCommand(n,a,c,l);e.sendText(d),this.outputChannel.appendLine(`[Terminal ${r}] > ${n} (file redirect)`);let f=100,p=o/f,m=0,h="",g;for(;m<p;)if(await this.sleep(f),m++,pr.existsSync(c)){try{let w=pr.readFileSync(c,"utf-8").trim();g=parseInt(w,10),isNaN(g)&&(g=void 0)}catch{}if(pr.existsSync(a))try{h=pr.readFileSync(a,"utf-8")}catch{}this.cleanupTempFiles(a,c);break}let y={id:Ii(),terminalId:r,command:n,executedAt:s,output:h.substring(0,1e4),exitCode:g,duration:Date.now()-s};this.addHistoryEntry(y);let $=m>=p;return $&&(this.cleanupTempFiles(a,c),h=`Command timed out after ${o}ms. Check terminal for output.`),this.emitEvent({type:"command-completed",terminalId:r,data:{command:n,exitCode:g,output:h}}),{success:!$&&(g===void 0||g===0),output:h||"No output captured",terminalId:r,command:n,duration:Date.now()-s,exitCode:g,captureMethod:"file_redirect"}}buildRedirectCommand(e,r,n,s){let o=process.platform,i=s;s==="auto"&&(i=o==="win32"?"powershell":"bash");let a=r.replace(/\\/g,"/"),c=n.replace(/\\/g,"/");switch(i){case"powershell":return`& { ${e} } 2>&1 | Out-File -FilePath "${a}" -Encoding utf8; $LASTEXITCODE | Out-File -FilePath "${c}" -Encoding utf8`;case"cmd":return`(${e}) > "${a}" 2>&1 & echo %ERRORLEVEL% > "${c}"`;case"bash":case"zsh":case"sh":default:return`{ ${e}; } > "${a}" 2>&1; echo $? > "${c}"`}}cleanupTempFiles(...e){for(let r of e)try{pr.existsSync(r)&&pr.unlinkSync(r)}catch{}}sleep(e){return new Promise(r=>setTimeout(r,e))}showTerminal(e,r=!0){let n=this.terminals.get(e);n&&n.show(r)}hideTerminal(e){let r=this.terminals.get(e);r&&r.hide()}closeTerminal(e){let r=this.terminals.get(e);r&&(r.dispose(),this.terminals.delete(e),this.terminalStates.delete(e),this.terminalOutputBuffers.delete(e))}listTerminals(){return Array.from(this.terminalStates.values())}getTerminalState(e){return this.terminalStates.get(e)}getHistory(e){let r=this.history.entries;return e?r.slice(-e):r}getTerminalHistory(e){return this.history.entries.filter(r=>r.terminalId===e)}getLastOutput(e){let r=this.getTerminalHistory(e);if(r.length!==0)return r[r.length-1].output}getRecentOutputs(e,r=5){return this.getTerminalHistory(e).slice(-r)}async clearHistory(){this.history.entries=[],await this.saveHistory()}addEventListener(e){this.eventListeners.push(e)}removeEventListener(e){let r=this.eventListeners.indexOf(e);r>=0&&this.eventListeners.splice(r,1)}dispose(){this.disposables.forEach(e=>e.dispose()),this.outputChannel.dispose()}handleTerminalClosed(e){for(let[r,n]of this.terminals.entries())if(n===e){let s=this.terminalStates.get(r);s&&(s.isActive=!1),this.terminals.delete(r),this.terminalOutputBuffers.delete(r),this.emitEvent({type:"terminal-closed",terminalId:r}),this.outputChannel.appendLine(`[Terminal] Closed: ${s?.name||r}`);break}}updateActiveState(e){for(let[r,n]of this.terminals.entries()){let s=this.terminalStates.get(r);s&&(s.isActive=n===e)}}addHistoryEntry(e){this.history.entries.push(e),this.history.entries.length>this.history.maxEntries&&(this.history.entries=this.history.entries.slice(-this.history.maxEntries)),this.saveHistory()}async saveHistory(){await this.context.globalState.update("vibey.terminalHistory",this.history)}emitEvent(e){for(let r of this.eventListeners)try{r(e)}catch(n){console.error("[VibeyTerminal] Event listener error:",n)}}};var sm=E.enum(["powershell","cmd","bash","zsh","sh","fish","auto"]).optional();function om(t){return[{name:"terminal_create",description:"Create a new Vibey terminal. Returns a terminal ID.",parameters:E.object({name:E.string().optional().describe("Custom name for the terminal"),shell:sm.describe("Shell type: powershell, cmd, bash, zsh, sh, fish, or auto"),cwd:E.string().optional().describe("Working directory for the terminal")}),execute:async e=>{let r=await t.createTerminal({name:e.name,shellType:e.shell,cwd:e.cwd});return t.showTerminal(r),`Terminal created with ID: ${r}`}},{name:"terminal_run",description:"Run a command in a Vibey terminal and capture output. Reuses existing or creates new.",parameters:E.object({command:E.string().describe("The command to run"),shell:sm.describe("Shell type preference"),newTerminal:E.boolean().optional().describe("Force create a new terminal"),timeout:E.number().optional().describe("Timeout in ms (default 30000)")}),execute:async e=>{let r=await t.runCommand(e.command,{shellType:e.shell,reuseExisting:!e.newTerminal,timeout:e.timeout});t.showTerminal(r.terminalId);let n={terminalId:r.terminalId,command:e.command,success:r.success,exitCode:r.exitCode,output:r.output,captureMethod:r.captureMethod,duration:r.duration};return JSON.stringify(n,null,2)}},{name:"terminal_send",description:"Send a command to a specific terminal by ID.",parameters:E.object({terminalId:E.string().describe("The terminal ID"),command:E.string().describe("The command to send")}),execute:async e=>(await t.sendCommand(e.terminalId,e.command),`Command sent to terminal ${e.terminalId}`)},{name:"terminal_list",description:"List all Vibey terminals with their IDs and status.",parameters:E.object({}),execute:async()=>{let e=t.listTerminals();return e.length===0?"No Vibey terminals are currently open.":e.map(r=>`- ${r.id}: "${r.name}" (${r.shellType}, ${r.isActive?"active":"inactive"})`).join(`
`)}},{name:"terminal_show",description:"Show/focus a terminal by ID.",parameters:E.object({terminalId:E.string()}),execute:async e=>(t.showTerminal(e.terminalId,!1),`Terminal ${e.terminalId} is now visible.`)},{name:"terminal_close",description:"Close a terminal by ID.",parameters:E.object({terminalId:E.string()}),execute:async e=>(t.closeTerminal(e.terminalId),`Terminal ${e.terminalId} closed.`)},{name:"terminal_history",description:"Get command history for terminals including output.",parameters:E.object({terminalId:E.string().optional().describe("Filter by terminal ID"),limit:E.number().optional().describe("Max entries (default 20)"),includeOutput:E.boolean().optional().describe("Include command output (default false)")}),execute:async e=>{let r=e.limit||20,n=e.terminalId?t.getTerminalHistory(e.terminalId):t.getHistory(r);return n.length===0?"No history available.":e.includeOutput?JSON.stringify(n.slice(-r).map(s=>({time:new Date(s.executedAt).toISOString(),command:s.command,output:s.output||null,exitCode:s.exitCode,duration:s.duration})),null,2):n.slice(-r).map(s=>`[${new Date(s.executedAt).toLocaleTimeString()}] ${s.command}`).join(`
`)}},{name:"terminal_read_output",description:"Read the output from the last command(s) in a terminal.",parameters:E.object({terminalId:E.string().describe("The terminal ID to read from"),count:E.number().optional().describe("Number of recent commands to read (default 1)")}),execute:async e=>{let r=e.count||1,n=t.getRecentOutputs(e.terminalId,r);if(n.length===0)return JSON.stringify({error:"No output available for this terminal"});if(r===1){let s=n[n.length-1];return JSON.stringify({command:s.command,output:s.output||"No output captured",exitCode:s.exitCode,executedAt:new Date(s.executedAt).toISOString()},null,2)}return JSON.stringify(n.map(s=>({command:s.command,output:s.output||"No output captured",exitCode:s.exitCode,executedAt:new Date(s.executedAt).toISOString()})),null,2)}}]}var Me=ye(require("vscode"));function im(){return[{name:"get_problems",description:"Get diagnostics (problems) from the current workspace. Can be filtered by severity or file.",parameters:E.object({filepath:E.string().optional().describe("Filter by specific file path"),severity:E.enum(["error","warning","info","hint"]).optional().describe("Filter by severity level. If omitted, returns all.")}),execute:async t=>{let e=Me.languages.getDiagnostics();if(t.filepath){let o=Me.Uri.file(t.filepath);e=Me.languages.getDiagnostics(o).map(i=>[o,[i]])}let r={error:Me.DiagnosticSeverity.Error,warning:Me.DiagnosticSeverity.Warning,info:Me.DiagnosticSeverity.Information,hint:Me.DiagnosticSeverity.Hint},n=t.severity?r[t.severity]:void 0,s=[];for(let[o,i]of e){if(i.length===0)continue;let a=i.filter(c=>n===void 0||c.severity===n);a.length>0&&s.push({file:Me.workspace.asRelativePath(o),problems:a.map(c=>({message:c.message,severity:Me.DiagnosticSeverity[c.severity],line:c.range.start.line+1,source:c.source,code:typeof c.code=="object"?c.code.value:c.code}))})}return s.length===0?"No problems found matching criteria.":JSON.stringify(s,null,2)}},{name:"get_open_editors",description:"List all currently visible text editors.",parameters:E.object({}),execute:async()=>{let t=Me.window.visibleTextEditors;return t.length===0?"No editors are currently visible.":JSON.stringify(t.map(e=>({file:Me.workspace.asRelativePath(e.document.uri),language:e.document.languageId,isDirty:e.document.isDirty,active:e===Me.window.activeTextEditor})),null,2)}},{name:"get_active_terminal",description:"Get information about the currently active terminal.",parameters:E.object({}),execute:async()=>{let t=Me.window.activeTerminal;return t?JSON.stringify({name:t.name,processId:await t.processId,state:t.state},null,2):"No terminal is currently active/focused."}}]}var Ie=ye(require("fs")),Vs=ye(require("path")),Ri=class t{constructor(e,r){this.context=e;this.workspaceRoot=r;this.currentSessionId=null;this.gitIgnoreChecked=!1;this.historyDir=Vs.join(this.workspaceRoot,".vibey"),this.historyFile=Vs.join(this.historyDir,"chat_history.json"),this.sessionsFile=Vs.join(this.historyDir,"sessions.json")}static{this.KEY="vibey.chatHistory"}static{this.SESSIONS_KEY="vibey.chatSessions"}async saveHistory(e){await this.context.workspaceState.update(t.KEY,e);try{await this.ensureHistoryDirectory(),await this.ensureGitIgnore(),await Ie.promises.writeFile(this.historyFile,JSON.stringify(e,null,2),"utf-8")}catch(r){console.error("Failed to save chat history to file:",r)}await this.saveSession(e)}async loadHistory(){try{if(Ie.existsSync(this.historyFile)){let r=await Ie.promises.readFile(this.historyFile,"utf-8"),n=JSON.parse(r);if(Array.isArray(n))return n}}catch(r){console.error("Failed to load chat history from file:",r)}return this.context.workspaceState.get(t.KEY)||[]}async clearHistory(){await this.context.workspaceState.update(t.KEY,void 0);try{Ie.existsSync(this.historyFile)&&await Ie.promises.unlink(this.historyFile)}catch(e){console.error("Failed to delete chat history file:",e)}await this.clearSessions()}async saveSession(e){let r=this.generateSessionId();this.currentSessionId=r;let n={sessionId:r,history:e,createdAt:Date.now(),updatedAt:Date.now()},s=await this.loadSessions();s.push(n),s.length>10&&s.shift();try{await this.ensureHistoryDirectory(),await Ie.promises.writeFile(this.sessionsFile,JSON.stringify(s,null,2),"utf-8")}catch(o){console.error("Failed to save chat sessions:",o)}}async loadSession(e){try{if(Ie.existsSync(this.sessionsFile)){let r=await Ie.promises.readFile(this.sessionsFile,"utf-8"),s=JSON.parse(r).find(o=>o.sessionId===e);return s?s.history:null}}catch(r){console.error("Failed to load chat session:",r)}return null}async loadLatestSession(){try{if(Ie.existsSync(this.sessionsFile)){let e=await Ie.promises.readFile(this.sessionsFile,"utf-8"),r=JSON.parse(e);if(r.length>0)return r[r.length-1].history}}catch(e){console.error("Failed to load latest chat session:",e)}return null}async loadSessions(){try{if(Ie.existsSync(this.sessionsFile)){let e=await Ie.promises.readFile(this.sessionsFile,"utf-8");return JSON.parse(e)}}catch(e){console.error("Failed to load chat sessions:",e)}return[]}async clearSessions(){try{Ie.existsSync(this.sessionsFile)&&await Ie.promises.unlink(this.sessionsFile)}catch(e){console.error("Failed to delete chat sessions file:",e)}}generateSessionId(){return"session_"+Date.now()+"_"+Math.random().toString(36).substr(2,9)}async ensureHistoryDirectory(){Ie.existsSync(this.historyDir)||await Ie.promises.mkdir(this.historyDir,{recursive:!0})}async ensureGitIgnore(){if(this.gitIgnoreChecked)return;let e=Vs.join(this.workspaceRoot,".gitignore"),r=".vibey/";try{let n="";if(Ie.existsSync(e)&&(n=await Ie.promises.readFile(e,"utf-8")),!n.includes(r)&&!n.includes(".vibey")){let s=n.endsWith(`
`)||n.length===0?`${n}${r}
`:`${n}
${r}
`;await Ie.promises.writeFile(e,s,"utf-8")}}catch(n){console.error("Failed to update .gitignore:",n)}finally{this.gitIgnoreChecked=!0}}};var js=ye(require("vscode"));var jq=Object.freeze({status:"aborted"});function b(t,e,r){function n(a,c){var u;Object.defineProperty(a,"_zod",{value:a._zod??{},enumerable:!1}),(u=a._zod).traits??(u.traits=new Set),a._zod.traits.add(t),e(a,c);for(let l in i.prototype)l in a||Object.defineProperty(a,l,{value:i.prototype[l].bind(a)});a._zod.constr=i,a._zod.def=c}let s=r?.Parent??Object;class o extends s{}Object.defineProperty(o,"name",{value:t});function i(a){var c;let u=r?.Parent?new o:this;n(u,a),(c=u._zod).deferred??(c.deferred=[]);for(let l of u._zod.deferred)l();return u}return Object.defineProperty(i,"init",{value:n}),Object.defineProperty(i,Symbol.hasInstance,{value:a=>r?.Parent&&a instanceof r.Parent?!0:a?._zod?.traits?.has(t)}),Object.defineProperty(i,"name",{value:t}),i}var fr=class extends Error{constructor(){super("Encountered Promise during synchronous parse. Use .parseAsync() instead.")}},Oi={};function bt(t){return t&&Object.assign(Oi,t),Oi}var de={};gi(de,{BIGINT_FORMAT_RANGES:()=>cm,Class:()=>Lc,NUMBER_FORMAT_RANGES:()=>Wc,aborted:()=>hn,allowsEval:()=>Kc,assert:()=>Gx,assertEqual:()=>Ux,assertIs:()=>Kx,assertNever:()=>Bx,assertNotEqual:()=>Hx,assignProp:()=>Hc,cached:()=>Us,captureStackTrace:()=>ji,cleanEnum:()=>ak,cleanRegex:()=>Ks,clone:()=>Gt,createTransparentProxy:()=>ek,defineLazy:()=>we,esc:()=>mn,escapeRegex:()=>Ir,extend:()=>nk,finalizeIssue:()=>Rt,floatSafeRemainder:()=>Uc,getElementAtPath:()=>Wx,getEnumValues:()=>Vc,getLengthableOrigin:()=>Bs,getParsedType:()=>Xx,getSizableOrigin:()=>um,isObject:()=>Jn,isPlainObject:()=>Yn,issue:()=>Jc,joinValues:()=>Ni,jsonStringifyReplacer:()=>Fc,merge:()=>sk,normalizeParams:()=>q,nullish:()=>Hs,numKeys:()=>Qx,omit:()=>rk,optionalKeys:()=>Gc,partial:()=>ok,pick:()=>tk,prefixIssues:()=>Wt,primitiveTypes:()=>am,promiseAllObject:()=>Jx,propertyKeyTypes:()=>Bc,randomString:()=>Yx,required:()=>ik,stringifyPrimitive:()=>Ai,unwrapMessage:()=>Fs});function Ux(t){return t}function Hx(t){return t}function Kx(t){}function Bx(t){throw new Error}function Gx(t){}function Vc(t){let e=Object.values(t).filter(n=>typeof n=="number");return Object.entries(t).filter(([n,s])=>e.indexOf(+n)===-1).map(([n,s])=>s)}function Ni(t,e="|"){return t.map(r=>Ai(r)).join(e)}function Fc(t,e){return typeof e=="bigint"?e.toString():e}function Us(t){return{get value(){{let r=t();return Object.defineProperty(this,"value",{value:r}),r}throw new Error("cached value already set")}}}function Hs(t){return t==null}function Ks(t){let e=t.startsWith("^")?1:0,r=t.endsWith("$")?t.length-1:t.length;return t.slice(e,r)}function Uc(t,e){let r=(t.toString().split(".")[1]||"").length,n=(e.toString().split(".")[1]||"").length,s=r>n?r:n,o=Number.parseInt(t.toFixed(s).replace(".","")),i=Number.parseInt(e.toFixed(s).replace(".",""));return o%i/10**s}function we(t,e,r){Object.defineProperty(t,e,{get(){{let s=r();return t[e]=s,s}throw new Error("cached value already set")},set(s){Object.defineProperty(t,e,{value:s})},configurable:!0})}function Hc(t,e,r){Object.defineProperty(t,e,{value:r,writable:!0,enumerable:!0,configurable:!0})}function Wx(t,e){return e?e.reduce((r,n)=>r?.[n],t):t}function Jx(t){let e=Object.keys(t),r=e.map(n=>t[n]);return Promise.all(r).then(n=>{let s={};for(let o=0;o<e.length;o++)s[e[o]]=n[o];return s})}function Yx(t=10){let e="abcdefghijklmnopqrstuvwxyz",r="";for(let n=0;n<t;n++)r+=e[Math.floor(Math.random()*e.length)];return r}function mn(t){return JSON.stringify(t)}var ji=Error.captureStackTrace?Error.captureStackTrace:(...t)=>{};function Jn(t){return typeof t=="object"&&t!==null&&!Array.isArray(t)}var Kc=Us(()=>{if(typeof navigator<"u"&&navigator?.userAgent?.includes("Cloudflare"))return!1;try{let t=Function;return new t(""),!0}catch{return!1}});function Yn(t){if(Jn(t)===!1)return!1;let e=t.constructor;if(e===void 0)return!0;let r=e.prototype;return!(Jn(r)===!1||Object.prototype.hasOwnProperty.call(r,"isPrototypeOf")===!1)}function Qx(t){let e=0;for(let r in t)Object.prototype.hasOwnProperty.call(t,r)&&e++;return e}var Xx=t=>{let e=typeof t;switch(e){case"undefined":return"undefined";case"string":return"string";case"number":return Number.isNaN(t)?"nan":"number";case"boolean":return"boolean";case"function":return"function";case"bigint":return"bigint";case"symbol":return"symbol";case"object":return Array.isArray(t)?"array":t===null?"null":t.then&&typeof t.then=="function"&&t.catch&&typeof t.catch=="function"?"promise":typeof Map<"u"&&t instanceof Map?"map":typeof Set<"u"&&t instanceof Set?"set":typeof Date<"u"&&t instanceof Date?"date":typeof File<"u"&&t instanceof File?"file":"object";default:throw new Error(`Unknown data type: ${e}`)}},Bc=new Set(["string","number","symbol"]),am=new Set(["string","number","bigint","boolean","symbol","undefined"]);function Ir(t){return t.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}function Gt(t,e,r){let n=new t._zod.constr(e??t._zod.def);return(!e||r?.parent)&&(n._zod.parent=t),n}function q(t){let e=t;if(!e)return{};if(typeof e=="string")return{error:()=>e};if(e?.message!==void 0){if(e?.error!==void 0)throw new Error("Cannot specify both `message` and `error` params");e.error=e.message}return delete e.message,typeof e.error=="string"?{...e,error:()=>e.error}:e}function ek(t){let e;return new Proxy({},{get(r,n,s){return e??(e=t()),Reflect.get(e,n,s)},set(r,n,s,o){return e??(e=t()),Reflect.set(e,n,s,o)},has(r,n){return e??(e=t()),Reflect.has(e,n)},deleteProperty(r,n){return e??(e=t()),Reflect.deleteProperty(e,n)},ownKeys(r){return e??(e=t()),Reflect.ownKeys(e)},getOwnPropertyDescriptor(r,n){return e??(e=t()),Reflect.getOwnPropertyDescriptor(e,n)},defineProperty(r,n,s){return e??(e=t()),Reflect.defineProperty(e,n,s)}})}function Ai(t){return typeof t=="bigint"?t.toString()+"n":typeof t=="string"?`"${t}"`:`${t}`}function Gc(t){return Object.keys(t).filter(e=>t[e]._zod.optin==="optional"&&t[e]._zod.optout==="optional")}var Wc={safeint:[Number.MIN_SAFE_INTEGER,Number.MAX_SAFE_INTEGER],int32:[-2147483648,2147483647],uint32:[0,4294967295],float32:[-34028234663852886e22,34028234663852886e22],float64:[-Number.MAX_VALUE,Number.MAX_VALUE]},cm={int64:[BigInt("-9223372036854775808"),BigInt("9223372036854775807")],uint64:[BigInt(0),BigInt("18446744073709551615")]};function tk(t,e){let r={},n=t._zod.def;for(let s in e){if(!(s in n.shape))throw new Error(`Unrecognized key: "${s}"`);e[s]&&(r[s]=n.shape[s])}return Gt(t,{...t._zod.def,shape:r,checks:[]})}function rk(t,e){let r={...t._zod.def.shape},n=t._zod.def;for(let s in e){if(!(s in n.shape))throw new Error(`Unrecognized key: "${s}"`);e[s]&&delete r[s]}return Gt(t,{...t._zod.def,shape:r,checks:[]})}function nk(t,e){if(!Yn(e))throw new Error("Invalid input to extend: expected a plain object");let r={...t._zod.def,get shape(){let n={...t._zod.def.shape,...e};return Hc(this,"shape",n),n},checks:[]};return Gt(t,r)}function sk(t,e){return Gt(t,{...t._zod.def,get shape(){let r={...t._zod.def.shape,...e._zod.def.shape};return Hc(this,"shape",r),r},catchall:e._zod.def.catchall,checks:[]})}function ok(t,e,r){let n=e._zod.def.shape,s={...n};if(r)for(let o in r){if(!(o in n))throw new Error(`Unrecognized key: "${o}"`);r[o]&&(s[o]=t?new t({type:"optional",innerType:n[o]}):n[o])}else for(let o in n)s[o]=t?new t({type:"optional",innerType:n[o]}):n[o];return Gt(e,{...e._zod.def,shape:s,checks:[]})}function ik(t,e,r){let n=e._zod.def.shape,s={...n};if(r)for(let o in r){if(!(o in s))throw new Error(`Unrecognized key: "${o}"`);r[o]&&(s[o]=new t({type:"nonoptional",innerType:n[o]}))}else for(let o in n)s[o]=new t({type:"nonoptional",innerType:n[o]});return Gt(e,{...e._zod.def,shape:s,checks:[]})}function hn(t,e=0){for(let r=e;r<t.issues.length;r++)if(t.issues[r]?.continue!==!0)return!0;return!1}function Wt(t,e){return e.map(r=>{var n;return(n=r).path??(n.path=[]),r.path.unshift(t),r})}function Fs(t){return typeof t=="string"?t:t?.message}function Rt(t,e,r){let n={...t,path:t.path??[]};if(!t.message){let s=Fs(t.inst?._zod.def?.error?.(t))??Fs(e?.error?.(t))??Fs(r.customError?.(t))??Fs(r.localeError?.(t))??"Invalid input";n.message=s}return delete n.inst,delete n.continue,e?.reportInput||delete n.input,n}function um(t){return t instanceof Set?"set":t instanceof Map?"map":t instanceof File?"file":"unknown"}function Bs(t){return Array.isArray(t)?"array":typeof t=="string"?"string":"unknown"}function Jc(...t){let[e,r,n]=t;return typeof e=="string"?{message:e,code:"custom",input:r,inst:n}:{...e}}function ak(t){return Object.entries(t).filter(([e,r])=>Number.isNaN(Number.parseInt(e,10))).map(e=>e[1])}var Lc=class{constructor(...e){}};var lm=(t,e)=>{t.name="$ZodError",Object.defineProperty(t,"_zod",{value:t._zod,enumerable:!1}),Object.defineProperty(t,"issues",{value:e,enumerable:!1}),Object.defineProperty(t,"message",{get(){return JSON.stringify(e,Fc,2)},enumerable:!0}),Object.defineProperty(t,"toString",{value:()=>t.message,enumerable:!1})},Mi=b("$ZodError",lm),Yc=b("$ZodError",lm,{Parent:Error});function dm(t,e=r=>r.message){let r={},n=[];for(let s of t.issues)s.path.length>0?(r[s.path[0]]=r[s.path[0]]||[],r[s.path[0]].push(e(s))):n.push(e(s));return{formErrors:n,fieldErrors:r}}function pm(t,e){let r=e||function(o){return o.message},n={_errors:[]},s=o=>{for(let i of o.issues)if(i.code==="invalid_union"&&i.errors.length)i.errors.map(a=>s({issues:a}));else if(i.code==="invalid_key")s({issues:i.issues});else if(i.code==="invalid_element")s({issues:i.issues});else if(i.path.length===0)n._errors.push(r(i));else{let a=n,c=0;for(;c<i.path.length;){let u=i.path[c];c===i.path.length-1?(a[u]=a[u]||{_errors:[]},a[u]._errors.push(r(i))):a[u]=a[u]||{_errors:[]},a=a[u],c++}}};return s(t),n}var fm=t=>(e,r,n,s)=>{let o=n?Object.assign(n,{async:!1}):{async:!1},i=e._zod.run({value:r,issues:[]},o);if(i instanceof Promise)throw new fr;if(i.issues.length){let a=new(s?.Err??t)(i.issues.map(c=>Rt(c,o,bt())));throw ji(a,s?.callee),a}return i.value};var mm=t=>async(e,r,n,s)=>{let o=n?Object.assign(n,{async:!0}):{async:!0},i=e._zod.run({value:r,issues:[]},o);if(i instanceof Promise&&(i=await i),i.issues.length){let a=new(s?.Err??t)(i.issues.map(c=>Rt(c,o,bt())));throw ji(a,s?.callee),a}return i.value};var Qc=t=>(e,r,n)=>{let s=n?{...n,async:!1}:{async:!1},o=e._zod.run({value:r,issues:[]},s);if(o instanceof Promise)throw new fr;return o.issues.length?{success:!1,error:new(t??Mi)(o.issues.map(i=>Rt(i,s,bt())))}:{success:!0,data:o.value}},Gs=Qc(Yc),Xc=t=>async(e,r,n)=>{let s=n?Object.assign(n,{async:!0}):{async:!0},o=e._zod.run({value:r,issues:[]},s);return o instanceof Promise&&(o=await o),o.issues.length?{success:!1,error:new t(o.issues.map(i=>Rt(i,s,bt())))}:{success:!0,data:o.value}},qi=Xc(Yc);var hm=/^[cC][^\s-]{8,}$/,gm=/^[0-9a-z]+$/,ym=/^[0-9A-HJKMNP-TV-Za-hjkmnp-tv-z]{26}$/,vm=/^[0-9a-vA-V]{20}$/,_m=/^[A-Za-z0-9]{27}$/,bm=/^[a-zA-Z0-9_-]{21}$/,wm=/^P(?:(\d+W)|(?!.*W)(?=\d|T\d)(\d+Y)?(\d+M)?(\d+D)?(T(?=\d)(\d+H)?(\d+M)?(\d+([.,]\d+)?S)?)?)$/;var $m=/^([0-9a-fA-F]{8}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{12})$/,eu=t=>t?new RegExp(`^([0-9a-fA-F]{8}-[0-9a-fA-F]{4}-${t}[0-9a-fA-F]{3}-[89abAB][0-9a-fA-F]{3}-[0-9a-fA-F]{12})$`):/^([0-9a-fA-F]{8}-[0-9a-fA-F]{4}-[1-8][0-9a-fA-F]{3}-[89abAB][0-9a-fA-F]{3}-[0-9a-fA-F]{12}|00000000-0000-0000-0000-000000000000)$/;var xm=/^(?!\.)(?!.*\.\.)([A-Za-z0-9_'+\-\.]*)[A-Za-z0-9_+-]@([A-Za-z0-9][A-Za-z0-9\-]*\.)+[A-Za-z]{2,}$/;var uk="^(\\p{Extended_Pictographic}|\\p{Emoji_Component})+$";function km(){return new RegExp(uk,"u")}var Sm=/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])$/,Pm=/^(([0-9a-fA-F]{1,4}:){7}[0-9a-fA-F]{1,4}|::|([0-9a-fA-F]{1,4})?::([0-9a-fA-F]{1,4}:?){0,6})$/,Tm=/^((25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\/([0-9]|[1-2][0-9]|3[0-2])$/,Em=/^(([0-9a-fA-F]{1,4}:){7}[0-9a-fA-F]{1,4}|::|([0-9a-fA-F]{1,4})?::([0-9a-fA-F]{1,4}:?){0,6})\/(12[0-8]|1[01][0-9]|[1-9]?[0-9])$/,zm=/^$|^(?:[0-9a-zA-Z+/]{4})*(?:(?:[0-9a-zA-Z+/]{2}==)|(?:[0-9a-zA-Z+/]{3}=))?$/,tu=/^[A-Za-z0-9_-]*$/,Cm=/^([a-zA-Z0-9-]+\.)*[a-zA-Z0-9-]+$/;var Im=/^\+(?:[0-9]){6,14}[0-9]$/,Rm="(?:(?:\\d\\d[2468][048]|\\d\\d[13579][26]|\\d\\d0[48]|[02468][048]00|[13579][26]00)-02-29|\\d{4}-(?:(?:0[13578]|1[02])-(?:0[1-9]|[12]\\d|3[01])|(?:0[469]|11)-(?:0[1-9]|[12]\\d|30)|(?:02)-(?:0[1-9]|1\\d|2[0-8])))",Om=new RegExp(`^${Rm}$`);function Nm(t){let e="(?:[01]\\d|2[0-3]):[0-5]\\d";return typeof t.precision=="number"?t.precision===-1?`${e}`:t.precision===0?`${e}:[0-5]\\d`:`${e}:[0-5]\\d\\.\\d{${t.precision}}`:`${e}(?::[0-5]\\d(?:\\.\\d+)?)?`}function jm(t){return new RegExp(`^${Nm(t)}$`)}function Am(t){let e=Nm({precision:t.precision}),r=["Z"];t.local&&r.push(""),t.offset&&r.push("([+-]\\d{2}:\\d{2})");let n=`${e}(?:${r.join("|")})`;return new RegExp(`^${Rm}T(?:${n})$`)}var Mm=t=>{let e=t?`[\\s\\S]{${t?.minimum??0},${t?.maximum??""}}`:"[\\s\\S]*";return new RegExp(`^${e}$`)};var qm=/^\d+$/,Dm=/^-?\d+(?:\.\d+)?/i,Zm=/true|false/i,Lm=/null/i;var Vm=/^[^A-Z]*$/,Fm=/^[^a-z]*$/;var Ge=b("$ZodCheck",(t,e)=>{var r;t._zod??(t._zod={}),t._zod.def=e,(r=t._zod).onattach??(r.onattach=[])}),Um={number:"number",bigint:"bigint",object:"date"},nu=b("$ZodCheckLessThan",(t,e)=>{Ge.init(t,e);let r=Um[typeof e.value];t._zod.onattach.push(n=>{let s=n._zod.bag,o=(e.inclusive?s.maximum:s.exclusiveMaximum)??Number.POSITIVE_INFINITY;e.value<o&&(e.inclusive?s.maximum=e.value:s.exclusiveMaximum=e.value)}),t._zod.check=n=>{(e.inclusive?n.value<=e.value:n.value<e.value)||n.issues.push({origin:r,code:"too_big",maximum:e.value,input:n.value,inclusive:e.inclusive,inst:t,continue:!e.abort})}}),su=b("$ZodCheckGreaterThan",(t,e)=>{Ge.init(t,e);let r=Um[typeof e.value];t._zod.onattach.push(n=>{let s=n._zod.bag,o=(e.inclusive?s.minimum:s.exclusiveMinimum)??Number.NEGATIVE_INFINITY;e.value>o&&(e.inclusive?s.minimum=e.value:s.exclusiveMinimum=e.value)}),t._zod.check=n=>{(e.inclusive?n.value>=e.value:n.value>e.value)||n.issues.push({origin:r,code:"too_small",minimum:e.value,input:n.value,inclusive:e.inclusive,inst:t,continue:!e.abort})}}),Hm=b("$ZodCheckMultipleOf",(t,e)=>{Ge.init(t,e),t._zod.onattach.push(r=>{var n;(n=r._zod.bag).multipleOf??(n.multipleOf=e.value)}),t._zod.check=r=>{if(typeof r.value!=typeof e.value)throw new Error("Cannot mix number and bigint in multiple_of check.");(typeof r.value=="bigint"?r.value%e.value===BigInt(0):Uc(r.value,e.value)===0)||r.issues.push({origin:typeof r.value,code:"not_multiple_of",divisor:e.value,input:r.value,inst:t,continue:!e.abort})}}),Km=b("$ZodCheckNumberFormat",(t,e)=>{Ge.init(t,e),e.format=e.format||"float64";let r=e.format?.includes("int"),n=r?"int":"number",[s,o]=Wc[e.format];t._zod.onattach.push(i=>{let a=i._zod.bag;a.format=e.format,a.minimum=s,a.maximum=o,r&&(a.pattern=qm)}),t._zod.check=i=>{let a=i.value;if(r){if(!Number.isInteger(a)){i.issues.push({expected:n,format:e.format,code:"invalid_type",input:a,inst:t});return}if(!Number.isSafeInteger(a)){a>0?i.issues.push({input:a,code:"too_big",maximum:Number.MAX_SAFE_INTEGER,note:"Integers must be within the safe integer range.",inst:t,origin:n,continue:!e.abort}):i.issues.push({input:a,code:"too_small",minimum:Number.MIN_SAFE_INTEGER,note:"Integers must be within the safe integer range.",inst:t,origin:n,continue:!e.abort});return}}a<s&&i.issues.push({origin:"number",input:a,code:"too_small",minimum:s,inclusive:!0,inst:t,continue:!e.abort}),a>o&&i.issues.push({origin:"number",input:a,code:"too_big",maximum:o,inst:t})}});var Bm=b("$ZodCheckMaxLength",(t,e)=>{var r;Ge.init(t,e),(r=t._zod.def).when??(r.when=n=>{let s=n.value;return!Hs(s)&&s.length!==void 0}),t._zod.onattach.push(n=>{let s=n._zod.bag.maximum??Number.POSITIVE_INFINITY;e.maximum<s&&(n._zod.bag.maximum=e.maximum)}),t._zod.check=n=>{let s=n.value;if(s.length<=e.maximum)return;let i=Bs(s);n.issues.push({origin:i,code:"too_big",maximum:e.maximum,inclusive:!0,input:s,inst:t,continue:!e.abort})}}),Gm=b("$ZodCheckMinLength",(t,e)=>{var r;Ge.init(t,e),(r=t._zod.def).when??(r.when=n=>{let s=n.value;return!Hs(s)&&s.length!==void 0}),t._zod.onattach.push(n=>{let s=n._zod.bag.minimum??Number.NEGATIVE_INFINITY;e.minimum>s&&(n._zod.bag.minimum=e.minimum)}),t._zod.check=n=>{let s=n.value;if(s.length>=e.minimum)return;let i=Bs(s);n.issues.push({origin:i,code:"too_small",minimum:e.minimum,inclusive:!0,input:s,inst:t,continue:!e.abort})}}),Wm=b("$ZodCheckLengthEquals",(t,e)=>{var r;Ge.init(t,e),(r=t._zod.def).when??(r.when=n=>{let s=n.value;return!Hs(s)&&s.length!==void 0}),t._zod.onattach.push(n=>{let s=n._zod.bag;s.minimum=e.length,s.maximum=e.length,s.length=e.length}),t._zod.check=n=>{let s=n.value,o=s.length;if(o===e.length)return;let i=Bs(s),a=o>e.length;n.issues.push({origin:i,...a?{code:"too_big",maximum:e.length}:{code:"too_small",minimum:e.length},inclusive:!0,exact:!0,input:n.value,inst:t,continue:!e.abort})}}),Ws=b("$ZodCheckStringFormat",(t,e)=>{var r,n;Ge.init(t,e),t._zod.onattach.push(s=>{let o=s._zod.bag;o.format=e.format,e.pattern&&(o.patterns??(o.patterns=new Set),o.patterns.add(e.pattern))}),e.pattern?(r=t._zod).check??(r.check=s=>{e.pattern.lastIndex=0,!e.pattern.test(s.value)&&s.issues.push({origin:"string",code:"invalid_format",format:e.format,input:s.value,...e.pattern?{pattern:e.pattern.toString()}:{},inst:t,continue:!e.abort})}):(n=t._zod).check??(n.check=()=>{})}),Jm=b("$ZodCheckRegex",(t,e)=>{Ws.init(t,e),t._zod.check=r=>{e.pattern.lastIndex=0,!e.pattern.test(r.value)&&r.issues.push({origin:"string",code:"invalid_format",format:"regex",input:r.value,pattern:e.pattern.toString(),inst:t,continue:!e.abort})}}),Ym=b("$ZodCheckLowerCase",(t,e)=>{e.pattern??(e.pattern=Vm),Ws.init(t,e)}),Qm=b("$ZodCheckUpperCase",(t,e)=>{e.pattern??(e.pattern=Fm),Ws.init(t,e)}),Xm=b("$ZodCheckIncludes",(t,e)=>{Ge.init(t,e);let r=Ir(e.includes),n=new RegExp(typeof e.position=="number"?`^.{${e.position}}${r}`:r);e.pattern=n,t._zod.onattach.push(s=>{let o=s._zod.bag;o.patterns??(o.patterns=new Set),o.patterns.add(n)}),t._zod.check=s=>{s.value.includes(e.includes,e.position)||s.issues.push({origin:"string",code:"invalid_format",format:"includes",includes:e.includes,input:s.value,inst:t,continue:!e.abort})}}),eh=b("$ZodCheckStartsWith",(t,e)=>{Ge.init(t,e);let r=new RegExp(`^${Ir(e.prefix)}.*`);e.pattern??(e.pattern=r),t._zod.onattach.push(n=>{let s=n._zod.bag;s.patterns??(s.patterns=new Set),s.patterns.add(r)}),t._zod.check=n=>{n.value.startsWith(e.prefix)||n.issues.push({origin:"string",code:"invalid_format",format:"starts_with",prefix:e.prefix,input:n.value,inst:t,continue:!e.abort})}}),th=b("$ZodCheckEndsWith",(t,e)=>{Ge.init(t,e);let r=new RegExp(`.*${Ir(e.suffix)}$`);e.pattern??(e.pattern=r),t._zod.onattach.push(n=>{let s=n._zod.bag;s.patterns??(s.patterns=new Set),s.patterns.add(r)}),t._zod.check=n=>{n.value.endsWith(e.suffix)||n.issues.push({origin:"string",code:"invalid_format",format:"ends_with",suffix:e.suffix,input:n.value,inst:t,continue:!e.abort})}});var rh=b("$ZodCheckOverwrite",(t,e)=>{Ge.init(t,e),t._zod.check=r=>{r.value=e.tx(r.value)}});var Di=class{constructor(e=[]){this.content=[],this.indent=0,this&&(this.args=e)}indented(e){this.indent+=1,e(this),this.indent-=1}write(e){if(typeof e=="function"){e(this,{execution:"sync"}),e(this,{execution:"async"});return}let n=e.split(`
`).filter(i=>i),s=Math.min(...n.map(i=>i.length-i.trimStart().length)),o=n.map(i=>i.slice(s)).map(i=>" ".repeat(this.indent*2)+i);for(let i of o)this.content.push(i)}compile(){let e=Function,r=this?.args,s=[...(this?.content??[""]).map(o=>`  ${o}`)];return new e(...r,s.join(`
`))}};var sh={major:4,minor:0,patch:0};var $e=b("$ZodType",(t,e)=>{var r;t??(t={}),t._zod.def=e,t._zod.bag=t._zod.bag||{},t._zod.version=sh;let n=[...t._zod.def.checks??[]];t._zod.traits.has("$ZodCheck")&&n.unshift(t);for(let s of n)for(let o of s._zod.onattach)o(t);if(n.length===0)(r=t._zod).deferred??(r.deferred=[]),t._zod.deferred?.push(()=>{t._zod.run=t._zod.parse});else{let s=(o,i,a)=>{let c=hn(o),u;for(let l of i){if(l._zod.def.when){if(!l._zod.def.when(o))continue}else if(c)continue;let d=o.issues.length,f=l._zod.check(o);if(f instanceof Promise&&a?.async===!1)throw new fr;if(u||f instanceof Promise)u=(u??Promise.resolve()).then(async()=>{await f,o.issues.length!==d&&(c||(c=hn(o,d)))});else{if(o.issues.length===d)continue;c||(c=hn(o,d))}}return u?u.then(()=>o):o};t._zod.run=(o,i)=>{let a=t._zod.parse(o,i);if(a instanceof Promise){if(i.async===!1)throw new fr;return a.then(c=>s(c,n,i))}return s(a,n,i)}}t["~standard"]={validate:s=>{try{let o=Gs(t,s);return o.success?{value:o.data}:{issues:o.error?.issues}}catch{return qi(t,s).then(i=>i.success?{value:i.data}:{issues:i.error?.issues})}},vendor:"zod",version:1}}),Li=b("$ZodString",(t,e)=>{$e.init(t,e),t._zod.pattern=[...t?._zod.bag?.patterns??[]].pop()??Mm(t._zod.bag),t._zod.parse=(r,n)=>{if(e.coerce)try{r.value=String(r.value)}catch{}return typeof r.value=="string"||r.issues.push({expected:"string",code:"invalid_type",input:r.value,inst:t}),r}}),xe=b("$ZodStringFormat",(t,e)=>{Ws.init(t,e),Li.init(t,e)}),mh=b("$ZodGUID",(t,e)=>{e.pattern??(e.pattern=$m),xe.init(t,e)}),hh=b("$ZodUUID",(t,e)=>{if(e.version){let n={v1:1,v2:2,v3:3,v4:4,v5:5,v6:6,v7:7,v8:8}[e.version];if(n===void 0)throw new Error(`Invalid UUID version: "${e.version}"`);e.pattern??(e.pattern=eu(n))}else e.pattern??(e.pattern=eu());xe.init(t,e)}),gh=b("$ZodEmail",(t,e)=>{e.pattern??(e.pattern=xm),xe.init(t,e)}),yh=b("$ZodURL",(t,e)=>{xe.init(t,e),t._zod.check=r=>{try{let n=r.value,s=new URL(n),o=s.href;e.hostname&&(e.hostname.lastIndex=0,e.hostname.test(s.hostname)||r.issues.push({code:"invalid_format",format:"url",note:"Invalid hostname",pattern:Cm.source,input:r.value,inst:t,continue:!e.abort})),e.protocol&&(e.protocol.lastIndex=0,e.protocol.test(s.protocol.endsWith(":")?s.protocol.slice(0,-1):s.protocol)||r.issues.push({code:"invalid_format",format:"url",note:"Invalid protocol",pattern:e.protocol.source,input:r.value,inst:t,continue:!e.abort})),!n.endsWith("/")&&o.endsWith("/")?r.value=o.slice(0,-1):r.value=o;return}catch{r.issues.push({code:"invalid_format",format:"url",input:r.value,inst:t,continue:!e.abort})}}}),vh=b("$ZodEmoji",(t,e)=>{e.pattern??(e.pattern=km()),xe.init(t,e)}),_h=b("$ZodNanoID",(t,e)=>{e.pattern??(e.pattern=bm),xe.init(t,e)}),bh=b("$ZodCUID",(t,e)=>{e.pattern??(e.pattern=hm),xe.init(t,e)}),wh=b("$ZodCUID2",(t,e)=>{e.pattern??(e.pattern=gm),xe.init(t,e)}),$h=b("$ZodULID",(t,e)=>{e.pattern??(e.pattern=ym),xe.init(t,e)}),xh=b("$ZodXID",(t,e)=>{e.pattern??(e.pattern=vm),xe.init(t,e)}),kh=b("$ZodKSUID",(t,e)=>{e.pattern??(e.pattern=_m),xe.init(t,e)}),Sh=b("$ZodISODateTime",(t,e)=>{e.pattern??(e.pattern=Am(e)),xe.init(t,e)}),Ph=b("$ZodISODate",(t,e)=>{e.pattern??(e.pattern=Om),xe.init(t,e)}),Th=b("$ZodISOTime",(t,e)=>{e.pattern??(e.pattern=jm(e)),xe.init(t,e)}),Eh=b("$ZodISODuration",(t,e)=>{e.pattern??(e.pattern=wm),xe.init(t,e)}),zh=b("$ZodIPv4",(t,e)=>{e.pattern??(e.pattern=Sm),xe.init(t,e),t._zod.onattach.push(r=>{let n=r._zod.bag;n.format="ipv4"})}),Ch=b("$ZodIPv6",(t,e)=>{e.pattern??(e.pattern=Pm),xe.init(t,e),t._zod.onattach.push(r=>{let n=r._zod.bag;n.format="ipv6"}),t._zod.check=r=>{try{new URL(`http://[${r.value}]`)}catch{r.issues.push({code:"invalid_format",format:"ipv6",input:r.value,inst:t,continue:!e.abort})}}}),Ih=b("$ZodCIDRv4",(t,e)=>{e.pattern??(e.pattern=Tm),xe.init(t,e)}),Rh=b("$ZodCIDRv6",(t,e)=>{e.pattern??(e.pattern=Em),xe.init(t,e),t._zod.check=r=>{let[n,s]=r.value.split("/");try{if(!s)throw new Error;let o=Number(s);if(`${o}`!==s)throw new Error;if(o<0||o>128)throw new Error;new URL(`http://[${n}]`)}catch{r.issues.push({code:"invalid_format",format:"cidrv6",input:r.value,inst:t,continue:!e.abort})}}});function Oh(t){if(t==="")return!0;if(t.length%4!==0)return!1;try{return atob(t),!0}catch{return!1}}var Nh=b("$ZodBase64",(t,e)=>{e.pattern??(e.pattern=zm),xe.init(t,e),t._zod.onattach.push(r=>{r._zod.bag.contentEncoding="base64"}),t._zod.check=r=>{Oh(r.value)||r.issues.push({code:"invalid_format",format:"base64",input:r.value,inst:t,continue:!e.abort})}});function lk(t){if(!tu.test(t))return!1;let e=t.replace(/[-_]/g,n=>n==="-"?"+":"/"),r=e.padEnd(Math.ceil(e.length/4)*4,"=");return Oh(r)}var jh=b("$ZodBase64URL",(t,e)=>{e.pattern??(e.pattern=tu),xe.init(t,e),t._zod.onattach.push(r=>{r._zod.bag.contentEncoding="base64url"}),t._zod.check=r=>{lk(r.value)||r.issues.push({code:"invalid_format",format:"base64url",input:r.value,inst:t,continue:!e.abort})}}),Ah=b("$ZodE164",(t,e)=>{e.pattern??(e.pattern=Im),xe.init(t,e)});function dk(t,e=null){try{let r=t.split(".");if(r.length!==3)return!1;let[n]=r;if(!n)return!1;let s=JSON.parse(atob(n));return!("typ"in s&&s?.typ!=="JWT"||!s.alg||e&&(!("alg"in s)||s.alg!==e))}catch{return!1}}var Mh=b("$ZodJWT",(t,e)=>{xe.init(t,e),t._zod.check=r=>{dk(r.value,e.alg)||r.issues.push({code:"invalid_format",format:"jwt",input:r.value,inst:t,continue:!e.abort})}});var iu=b("$ZodNumber",(t,e)=>{$e.init(t,e),t._zod.pattern=t._zod.bag.pattern??Dm,t._zod.parse=(r,n)=>{if(e.coerce)try{r.value=Number(r.value)}catch{}let s=r.value;if(typeof s=="number"&&!Number.isNaN(s)&&Number.isFinite(s))return r;let o=typeof s=="number"?Number.isNaN(s)?"NaN":Number.isFinite(s)?void 0:"Infinity":void 0;return r.issues.push({expected:"number",code:"invalid_type",input:s,inst:t,...o?{received:o}:{}}),r}}),qh=b("$ZodNumber",(t,e)=>{Km.init(t,e),iu.init(t,e)}),Dh=b("$ZodBoolean",(t,e)=>{$e.init(t,e),t._zod.pattern=Zm,t._zod.parse=(r,n)=>{if(e.coerce)try{r.value=!!r.value}catch{}let s=r.value;return typeof s=="boolean"||r.issues.push({expected:"boolean",code:"invalid_type",input:s,inst:t}),r}});var Zh=b("$ZodNull",(t,e)=>{$e.init(t,e),t._zod.pattern=Lm,t._zod.values=new Set([null]),t._zod.parse=(r,n)=>{let s=r.value;return s===null||r.issues.push({expected:"null",code:"invalid_type",input:s,inst:t}),r}});var Lh=b("$ZodUnknown",(t,e)=>{$e.init(t,e),t._zod.parse=r=>r}),Vh=b("$ZodNever",(t,e)=>{$e.init(t,e),t._zod.parse=(r,n)=>(r.issues.push({expected:"never",code:"invalid_type",input:r.value,inst:t}),r)});function oh(t,e,r){t.issues.length&&e.issues.push(...Wt(r,t.issues)),e.value[r]=t.value}var Fh=b("$ZodArray",(t,e)=>{$e.init(t,e),t._zod.parse=(r,n)=>{let s=r.value;if(!Array.isArray(s))return r.issues.push({expected:"array",code:"invalid_type",input:s,inst:t}),r;r.value=Array(s.length);let o=[];for(let i=0;i<s.length;i++){let a=s[i],c=e.element._zod.run({value:a,issues:[]},n);c instanceof Promise?o.push(c.then(u=>oh(u,r,i))):oh(c,r,i)}return o.length?Promise.all(o).then(()=>r):r}});function Zi(t,e,r){t.issues.length&&e.issues.push(...Wt(r,t.issues)),e.value[r]=t.value}function ih(t,e,r,n){t.issues.length?n[r]===void 0?r in n?e.value[r]=void 0:e.value[r]=t.value:e.issues.push(...Wt(r,t.issues)):t.value===void 0?r in n&&(e.value[r]=void 0):e.value[r]=t.value}var Uh=b("$ZodObject",(t,e)=>{$e.init(t,e);let r=Us(()=>{let d=Object.keys(e.shape);for(let p of d)if(!(e.shape[p]instanceof $e))throw new Error(`Invalid element at key "${p}": expected a Zod schema`);let f=Gc(e.shape);return{shape:e.shape,keys:d,keySet:new Set(d),numKeys:d.length,optionalKeys:new Set(f)}});we(t._zod,"propValues",()=>{let d=e.shape,f={};for(let p in d){let m=d[p]._zod;if(m.values){f[p]??(f[p]=new Set);for(let h of m.values)f[p].add(h)}}return f});let n=d=>{let f=new Di(["shape","payload","ctx"]),p=r.value,m=$=>{let w=mn($);return`shape[${w}]._zod.run({ value: input[${w}], issues: [] }, ctx)`};f.write("const input = payload.value;");let h=Object.create(null),g=0;for(let $ of p.keys)h[$]=`key_${g++}`;f.write("const newResult = {}");for(let $ of p.keys)if(p.optionalKeys.has($)){let w=h[$];f.write(`const ${w} = ${m($)};`);let S=mn($);f.write(`
        if (${w}.issues.length) {
          if (input[${S}] === undefined) {
            if (${S} in input) {
              newResult[${S}] = undefined;
            }
          } else {
            payload.issues = payload.issues.concat(
              ${w}.issues.map((iss) => ({
                ...iss,
                path: iss.path ? [${S}, ...iss.path] : [${S}],
              }))
            );
          }
        } else if (${w}.value === undefined) {
          if (${S} in input) newResult[${S}] = undefined;
        } else {
          newResult[${S}] = ${w}.value;
        }
        `)}else{let w=h[$];f.write(`const ${w} = ${m($)};`),f.write(`
          if (${w}.issues.length) payload.issues = payload.issues.concat(${w}.issues.map(iss => ({
            ...iss,
            path: iss.path ? [${mn($)}, ...iss.path] : [${mn($)}]
          })));`),f.write(`newResult[${mn($)}] = ${w}.value`)}f.write("payload.value = newResult;"),f.write("return payload;");let y=f.compile();return($,w)=>y(d,$,w)},s,o=Jn,i=!Oi.jitless,c=i&&Kc.value,u=e.catchall,l;t._zod.parse=(d,f)=>{l??(l=r.value);let p=d.value;if(!o(p))return d.issues.push({expected:"object",code:"invalid_type",input:p,inst:t}),d;let m=[];if(i&&c&&f?.async===!1&&f.jitless!==!0)s||(s=n(e.shape)),d=s(d,f);else{d.value={};let w=l.shape;for(let S of l.keys){let x=w[S],C=x._zod.run({value:p[S],issues:[]},f),ee=x._zod.optin==="optional"&&x._zod.optout==="optional";C instanceof Promise?m.push(C.then(fe=>ee?ih(fe,d,S,p):Zi(fe,d,S))):ee?ih(C,d,S,p):Zi(C,d,S)}}if(!u)return m.length?Promise.all(m).then(()=>d):d;let h=[],g=l.keySet,y=u._zod,$=y.def.type;for(let w of Object.keys(p)){if(g.has(w))continue;if($==="never"){h.push(w);continue}let S=y.run({value:p[w],issues:[]},f);S instanceof Promise?m.push(S.then(x=>Zi(x,d,w))):Zi(S,d,w)}return h.length&&d.issues.push({code:"unrecognized_keys",keys:h,input:p,inst:t}),m.length?Promise.all(m).then(()=>d):d}});function ah(t,e,r,n){for(let s of t)if(s.issues.length===0)return e.value=s.value,e;return e.issues.push({code:"invalid_union",input:e.value,inst:r,errors:t.map(s=>s.issues.map(o=>Rt(o,n,bt())))}),e}var au=b("$ZodUnion",(t,e)=>{$e.init(t,e),we(t._zod,"optin",()=>e.options.some(r=>r._zod.optin==="optional")?"optional":void 0),we(t._zod,"optout",()=>e.options.some(r=>r._zod.optout==="optional")?"optional":void 0),we(t._zod,"values",()=>{if(e.options.every(r=>r._zod.values))return new Set(e.options.flatMap(r=>Array.from(r._zod.values)))}),we(t._zod,"pattern",()=>{if(e.options.every(r=>r._zod.pattern)){let r=e.options.map(n=>n._zod.pattern);return new RegExp(`^(${r.map(n=>Ks(n.source)).join("|")})$`)}}),t._zod.parse=(r,n)=>{let s=!1,o=[];for(let i of e.options){let a=i._zod.run({value:r.value,issues:[]},n);if(a instanceof Promise)o.push(a),s=!0;else{if(a.issues.length===0)return a;o.push(a)}}return s?Promise.all(o).then(i=>ah(i,r,t,n)):ah(o,r,t,n)}}),Hh=b("$ZodDiscriminatedUnion",(t,e)=>{au.init(t,e);let r=t._zod.parse;we(t._zod,"propValues",()=>{let s={};for(let o of e.options){let i=o._zod.propValues;if(!i||Object.keys(i).length===0)throw new Error(`Invalid discriminated union option at index "${e.options.indexOf(o)}"`);for(let[a,c]of Object.entries(i)){s[a]||(s[a]=new Set);for(let u of c)s[a].add(u)}}return s});let n=Us(()=>{let s=e.options,o=new Map;for(let i of s){let a=i._zod.propValues[e.discriminator];if(!a||a.size===0)throw new Error(`Invalid discriminated union option at index "${e.options.indexOf(i)}"`);for(let c of a){if(o.has(c))throw new Error(`Duplicate discriminator value "${String(c)}"`);o.set(c,i)}}return o});t._zod.parse=(s,o)=>{let i=s.value;if(!Jn(i))return s.issues.push({code:"invalid_type",expected:"object",input:i,inst:t}),s;let a=n.value.get(i?.[e.discriminator]);return a?a._zod.run(s,o):e.unionFallback?r(s,o):(s.issues.push({code:"invalid_union",errors:[],note:"No matching discriminator",input:i,path:[e.discriminator],inst:t}),s)}}),Kh=b("$ZodIntersection",(t,e)=>{$e.init(t,e),t._zod.parse=(r,n)=>{let s=r.value,o=e.left._zod.run({value:s,issues:[]},n),i=e.right._zod.run({value:s,issues:[]},n);return o instanceof Promise||i instanceof Promise?Promise.all([o,i]).then(([c,u])=>ch(r,c,u)):ch(r,o,i)}});function ou(t,e){if(t===e)return{valid:!0,data:t};if(t instanceof Date&&e instanceof Date&&+t==+e)return{valid:!0,data:t};if(Yn(t)&&Yn(e)){let r=Object.keys(e),n=Object.keys(t).filter(o=>r.indexOf(o)!==-1),s={...t,...e};for(let o of n){let i=ou(t[o],e[o]);if(!i.valid)return{valid:!1,mergeErrorPath:[o,...i.mergeErrorPath]};s[o]=i.data}return{valid:!0,data:s}}if(Array.isArray(t)&&Array.isArray(e)){if(t.length!==e.length)return{valid:!1,mergeErrorPath:[]};let r=[];for(let n=0;n<t.length;n++){let s=t[n],o=e[n],i=ou(s,o);if(!i.valid)return{valid:!1,mergeErrorPath:[n,...i.mergeErrorPath]};r.push(i.data)}return{valid:!0,data:r}}return{valid:!1,mergeErrorPath:[]}}function ch(t,e,r){if(e.issues.length&&t.issues.push(...e.issues),r.issues.length&&t.issues.push(...r.issues),hn(t))return t;let n=ou(e.value,r.value);if(!n.valid)throw new Error(`Unmergable intersection. Error path: ${JSON.stringify(n.mergeErrorPath)}`);return t.value=n.data,t}var Bh=b("$ZodRecord",(t,e)=>{$e.init(t,e),t._zod.parse=(r,n)=>{let s=r.value;if(!Yn(s))return r.issues.push({expected:"record",code:"invalid_type",input:s,inst:t}),r;let o=[];if(e.keyType._zod.values){let i=e.keyType._zod.values;r.value={};for(let c of i)if(typeof c=="string"||typeof c=="number"||typeof c=="symbol"){let u=e.valueType._zod.run({value:s[c],issues:[]},n);u instanceof Promise?o.push(u.then(l=>{l.issues.length&&r.issues.push(...Wt(c,l.issues)),r.value[c]=l.value})):(u.issues.length&&r.issues.push(...Wt(c,u.issues)),r.value[c]=u.value)}let a;for(let c in s)i.has(c)||(a=a??[],a.push(c));a&&a.length>0&&r.issues.push({code:"unrecognized_keys",input:s,inst:t,keys:a})}else{r.value={};for(let i of Reflect.ownKeys(s)){if(i==="__proto__")continue;let a=e.keyType._zod.run({value:i,issues:[]},n);if(a instanceof Promise)throw new Error("Async schemas not supported in object keys currently");if(a.issues.length){r.issues.push({origin:"record",code:"invalid_key",issues:a.issues.map(u=>Rt(u,n,bt())),input:i,path:[i],inst:t}),r.value[a.value]=a.value;continue}let c=e.valueType._zod.run({value:s[i],issues:[]},n);c instanceof Promise?o.push(c.then(u=>{u.issues.length&&r.issues.push(...Wt(i,u.issues)),r.value[a.value]=u.value})):(c.issues.length&&r.issues.push(...Wt(i,c.issues)),r.value[a.value]=c.value)}}return o.length?Promise.all(o).then(()=>r):r}});var Gh=b("$ZodEnum",(t,e)=>{$e.init(t,e);let r=Vc(e.entries);t._zod.values=new Set(r),t._zod.pattern=new RegExp(`^(${r.filter(n=>Bc.has(typeof n)).map(n=>typeof n=="string"?Ir(n):n.toString()).join("|")})$`),t._zod.parse=(n,s)=>{let o=n.value;return t._zod.values.has(o)||n.issues.push({code:"invalid_value",values:r,input:o,inst:t}),n}}),Wh=b("$ZodLiteral",(t,e)=>{$e.init(t,e),t._zod.values=new Set(e.values),t._zod.pattern=new RegExp(`^(${e.values.map(r=>typeof r=="string"?Ir(r):r?r.toString():String(r)).join("|")})$`),t._zod.parse=(r,n)=>{let s=r.value;return t._zod.values.has(s)||r.issues.push({code:"invalid_value",values:e.values,input:s,inst:t}),r}});var Jh=b("$ZodTransform",(t,e)=>{$e.init(t,e),t._zod.parse=(r,n)=>{let s=e.transform(r.value,r);if(n.async)return(s instanceof Promise?s:Promise.resolve(s)).then(i=>(r.value=i,r));if(s instanceof Promise)throw new fr;return r.value=s,r}}),Yh=b("$ZodOptional",(t,e)=>{$e.init(t,e),t._zod.optin="optional",t._zod.optout="optional",we(t._zod,"values",()=>e.innerType._zod.values?new Set([...e.innerType._zod.values,void 0]):void 0),we(t._zod,"pattern",()=>{let r=e.innerType._zod.pattern;return r?new RegExp(`^(${Ks(r.source)})?$`):void 0}),t._zod.parse=(r,n)=>e.innerType._zod.optin==="optional"?e.innerType._zod.run(r,n):r.value===void 0?r:e.innerType._zod.run(r,n)}),Qh=b("$ZodNullable",(t,e)=>{$e.init(t,e),we(t._zod,"optin",()=>e.innerType._zod.optin),we(t._zod,"optout",()=>e.innerType._zod.optout),we(t._zod,"pattern",()=>{let r=e.innerType._zod.pattern;return r?new RegExp(`^(${Ks(r.source)}|null)$`):void 0}),we(t._zod,"values",()=>e.innerType._zod.values?new Set([...e.innerType._zod.values,null]):void 0),t._zod.parse=(r,n)=>r.value===null?r:e.innerType._zod.run(r,n)}),Xh=b("$ZodDefault",(t,e)=>{$e.init(t,e),t._zod.optin="optional",we(t._zod,"values",()=>e.innerType._zod.values),t._zod.parse=(r,n)=>{if(r.value===void 0)return r.value=e.defaultValue,r;let s=e.innerType._zod.run(r,n);return s instanceof Promise?s.then(o=>uh(o,e)):uh(s,e)}});function uh(t,e){return t.value===void 0&&(t.value=e.defaultValue),t}var eg=b("$ZodPrefault",(t,e)=>{$e.init(t,e),t._zod.optin="optional",we(t._zod,"values",()=>e.innerType._zod.values),t._zod.parse=(r,n)=>(r.value===void 0&&(r.value=e.defaultValue),e.innerType._zod.run(r,n))}),tg=b("$ZodNonOptional",(t,e)=>{$e.init(t,e),we(t._zod,"values",()=>{let r=e.innerType._zod.values;return r?new Set([...r].filter(n=>n!==void 0)):void 0}),t._zod.parse=(r,n)=>{let s=e.innerType._zod.run(r,n);return s instanceof Promise?s.then(o=>lh(o,t)):lh(s,t)}});function lh(t,e){return!t.issues.length&&t.value===void 0&&t.issues.push({code:"invalid_type",expected:"nonoptional",input:t.value,inst:e}),t}var rg=b("$ZodCatch",(t,e)=>{$e.init(t,e),t._zod.optin="optional",we(t._zod,"optout",()=>e.innerType._zod.optout),we(t._zod,"values",()=>e.innerType._zod.values),t._zod.parse=(r,n)=>{let s=e.innerType._zod.run(r,n);return s instanceof Promise?s.then(o=>(r.value=o.value,o.issues.length&&(r.value=e.catchValue({...r,error:{issues:o.issues.map(i=>Rt(i,n,bt()))},input:r.value}),r.issues=[]),r)):(r.value=s.value,s.issues.length&&(r.value=e.catchValue({...r,error:{issues:s.issues.map(o=>Rt(o,n,bt()))},input:r.value}),r.issues=[]),r)}});var ng=b("$ZodPipe",(t,e)=>{$e.init(t,e),we(t._zod,"values",()=>e.in._zod.values),we(t._zod,"optin",()=>e.in._zod.optin),we(t._zod,"optout",()=>e.out._zod.optout),t._zod.parse=(r,n)=>{let s=e.in._zod.run(r,n);return s instanceof Promise?s.then(o=>dh(o,e,n)):dh(s,e,n)}});function dh(t,e,r){return hn(t)?t:e.out._zod.run({value:t.value,issues:t.issues},r)}var sg=b("$ZodReadonly",(t,e)=>{$e.init(t,e),we(t._zod,"propValues",()=>e.innerType._zod.propValues),we(t._zod,"values",()=>e.innerType._zod.values),we(t._zod,"optin",()=>e.innerType._zod.optin),we(t._zod,"optout",()=>e.innerType._zod.optout),t._zod.parse=(r,n)=>{let s=e.innerType._zod.run(r,n);return s instanceof Promise?s.then(ph):ph(s)}});function ph(t){return t.value=Object.freeze(t.value),t}var og=b("$ZodCustom",(t,e)=>{Ge.init(t,e),$e.init(t,e),t._zod.parse=(r,n)=>r,t._zod.check=r=>{let n=r.value,s=e.fn(n);if(s instanceof Promise)return s.then(o=>fh(o,r,n,t));fh(s,r,n,t)}});function fh(t,e,r,n){if(!t){let s={code:"custom",input:r,inst:n,path:[...n._zod.def.path??[]],continue:!n._zod.def.abort};n._zod.def.params&&(s.params=n._zod.def.params),e.issues.push(Jc(s))}}var pk=t=>{let e=typeof t;switch(e){case"number":return Number.isNaN(t)?"NaN":"number";case"object":{if(Array.isArray(t))return"array";if(t===null)return"null";if(Object.getPrototypeOf(t)!==Object.prototype&&t.constructor)return t.constructor.name}}return e},fk=()=>{let t={string:{unit:"characters",verb:"to have"},file:{unit:"bytes",verb:"to have"},array:{unit:"items",verb:"to have"},set:{unit:"items",verb:"to have"}};function e(n){return t[n]??null}let r={regex:"input",email:"email address",url:"URL",emoji:"emoji",uuid:"UUID",uuidv4:"UUIDv4",uuidv6:"UUIDv6",nanoid:"nanoid",guid:"GUID",cuid:"cuid",cuid2:"cuid2",ulid:"ULID",xid:"XID",ksuid:"KSUID",datetime:"ISO datetime",date:"ISO date",time:"ISO time",duration:"ISO duration",ipv4:"IPv4 address",ipv6:"IPv6 address",cidrv4:"IPv4 range",cidrv6:"IPv6 range",base64:"base64-encoded string",base64url:"base64url-encoded string",json_string:"JSON string",e164:"E.164 number",jwt:"JWT",template_literal:"input"};return n=>{switch(n.code){case"invalid_type":return`Invalid input: expected ${n.expected}, received ${pk(n.input)}`;case"invalid_value":return n.values.length===1?`Invalid input: expected ${Ai(n.values[0])}`:`Invalid option: expected one of ${Ni(n.values,"|")}`;case"too_big":{let s=n.inclusive?"<=":"<",o=e(n.origin);return o?`Too big: expected ${n.origin??"value"} to have ${s}${n.maximum.toString()} ${o.unit??"elements"}`:`Too big: expected ${n.origin??"value"} to be ${s}${n.maximum.toString()}`}case"too_small":{let s=n.inclusive?">=":">",o=e(n.origin);return o?`Too small: expected ${n.origin} to have ${s}${n.minimum.toString()} ${o.unit}`:`Too small: expected ${n.origin} to be ${s}${n.minimum.toString()}`}case"invalid_format":{let s=n;return s.format==="starts_with"?`Invalid string: must start with "${s.prefix}"`:s.format==="ends_with"?`Invalid string: must end with "${s.suffix}"`:s.format==="includes"?`Invalid string: must include "${s.includes}"`:s.format==="regex"?`Invalid string: must match pattern ${s.pattern}`:`Invalid ${r[s.format]??n.format}`}case"not_multiple_of":return`Invalid number: must be a multiple of ${n.divisor}`;case"unrecognized_keys":return`Unrecognized key${n.keys.length>1?"s":""}: ${Ni(n.keys,", ")}`;case"invalid_key":return`Invalid key in ${n.origin}`;case"invalid_union":return"Invalid input";case"invalid_element":return`Invalid value in ${n.origin}`;default:return"Invalid input"}}};function ig(){return{localeError:fk()}}var cu=class{constructor(){this._map=new Map,this._idmap=new Map}add(e,...r){let n=r[0];if(this._map.set(e,n),n&&typeof n=="object"&&"id"in n){if(this._idmap.has(n.id))throw new Error(`ID ${n.id} already exists in the registry`);this._idmap.set(n.id,e)}return this}clear(){return this._map=new Map,this._idmap=new Map,this}remove(e){let r=this._map.get(e);return r&&typeof r=="object"&&"id"in r&&this._idmap.delete(r.id),this._map.delete(e),this}get(e){let r=e._zod.parent;if(r){let n={...this.get(r)??{}};return delete n.id,{...n,...this._map.get(e)}}return this._map.get(e)}has(e){return this._map.has(e)}};function mk(){return new cu}var Js=mk();function ag(t,e){return new t({type:"string",...q(e)})}function cg(t,e){return new t({type:"string",format:"email",check:"string_format",abort:!1,...q(e)})}function uu(t,e){return new t({type:"string",format:"guid",check:"string_format",abort:!1,...q(e)})}function ug(t,e){return new t({type:"string",format:"uuid",check:"string_format",abort:!1,...q(e)})}function lg(t,e){return new t({type:"string",format:"uuid",check:"string_format",abort:!1,version:"v4",...q(e)})}function dg(t,e){return new t({type:"string",format:"uuid",check:"string_format",abort:!1,version:"v6",...q(e)})}function pg(t,e){return new t({type:"string",format:"uuid",check:"string_format",abort:!1,version:"v7",...q(e)})}function fg(t,e){return new t({type:"string",format:"url",check:"string_format",abort:!1,...q(e)})}function mg(t,e){return new t({type:"string",format:"emoji",check:"string_format",abort:!1,...q(e)})}function hg(t,e){return new t({type:"string",format:"nanoid",check:"string_format",abort:!1,...q(e)})}function gg(t,e){return new t({type:"string",format:"cuid",check:"string_format",abort:!1,...q(e)})}function yg(t,e){return new t({type:"string",format:"cuid2",check:"string_format",abort:!1,...q(e)})}function vg(t,e){return new t({type:"string",format:"ulid",check:"string_format",abort:!1,...q(e)})}function _g(t,e){return new t({type:"string",format:"xid",check:"string_format",abort:!1,...q(e)})}function bg(t,e){return new t({type:"string",format:"ksuid",check:"string_format",abort:!1,...q(e)})}function wg(t,e){return new t({type:"string",format:"ipv4",check:"string_format",abort:!1,...q(e)})}function $g(t,e){return new t({type:"string",format:"ipv6",check:"string_format",abort:!1,...q(e)})}function xg(t,e){return new t({type:"string",format:"cidrv4",check:"string_format",abort:!1,...q(e)})}function kg(t,e){return new t({type:"string",format:"cidrv6",check:"string_format",abort:!1,...q(e)})}function Sg(t,e){return new t({type:"string",format:"base64",check:"string_format",abort:!1,...q(e)})}function Pg(t,e){return new t({type:"string",format:"base64url",check:"string_format",abort:!1,...q(e)})}function Tg(t,e){return new t({type:"string",format:"e164",check:"string_format",abort:!1,...q(e)})}function Eg(t,e){return new t({type:"string",format:"jwt",check:"string_format",abort:!1,...q(e)})}function zg(t,e){return new t({type:"string",format:"datetime",check:"string_format",offset:!1,local:!1,precision:null,...q(e)})}function Cg(t,e){return new t({type:"string",format:"date",check:"string_format",...q(e)})}function Ig(t,e){return new t({type:"string",format:"time",check:"string_format",precision:null,...q(e)})}function Rg(t,e){return new t({type:"string",format:"duration",check:"string_format",...q(e)})}function Og(t,e){return new t({type:"number",checks:[],...q(e)})}function Ng(t,e){return new t({type:"number",check:"number_format",abort:!1,format:"safeint",...q(e)})}function jg(t,e){return new t({type:"boolean",...q(e)})}function Ag(t,e){return new t({type:"null",...q(e)})}function Mg(t){return new t({type:"unknown"})}function qg(t,e){return new t({type:"never",...q(e)})}function Vi(t,e){return new nu({check:"less_than",...q(e),value:t,inclusive:!1})}function Ys(t,e){return new nu({check:"less_than",...q(e),value:t,inclusive:!0})}function Fi(t,e){return new su({check:"greater_than",...q(e),value:t,inclusive:!1})}function Qs(t,e){return new su({check:"greater_than",...q(e),value:t,inclusive:!0})}function Ui(t,e){return new Hm({check:"multiple_of",...q(e),value:t})}function Hi(t,e){return new Bm({check:"max_length",...q(e),maximum:t})}function Qn(t,e){return new Gm({check:"min_length",...q(e),minimum:t})}function Ki(t,e){return new Wm({check:"length_equals",...q(e),length:t})}function lu(t,e){return new Jm({check:"string_format",format:"regex",...q(e),pattern:t})}function du(t){return new Ym({check:"string_format",format:"lowercase",...q(t)})}function pu(t){return new Qm({check:"string_format",format:"uppercase",...q(t)})}function fu(t,e){return new Xm({check:"string_format",format:"includes",...q(e),includes:t})}function mu(t,e){return new eh({check:"string_format",format:"starts_with",...q(e),prefix:t})}function hu(t,e){return new th({check:"string_format",format:"ends_with",...q(e),suffix:t})}function gn(t){return new rh({check:"overwrite",tx:t})}function gu(t){return gn(e=>e.normalize(t))}function yu(){return gn(t=>t.trim())}function vu(){return gn(t=>t.toLowerCase())}function _u(){return gn(t=>t.toUpperCase())}function Dg(t,e,r){return new t({type:"array",element:e,...q(r)})}function Zg(t,e,r){let n=q(r);return n.abort??(n.abort=!0),new t({type:"custom",check:"custom",fn:e,...n})}function Lg(t,e,r){return new t({type:"custom",check:"custom",fn:e,...q(r)})}function Xn(t){return!!t._zod}function Ot(t,e){return Xn(t)?Gs(t,e):t.safeParse(e)}function Bi(t){var e,r;if(!t)return;let n;if(Xn(t)?n=(r=(e=t._zod)===null||e===void 0?void 0:e.def)===null||r===void 0?void 0:r.shape:n=t.shape,!!n){if(typeof n=="function")try{return n()}catch{return}return n}}function Vg(t){var e;if(Xn(t)){let i=(e=t._zod)===null||e===void 0?void 0:e.def;if(i){if(i.value!==void 0)return i.value;if(Array.isArray(i.values)&&i.values.length>0)return i.values[0]}}let n=t._def;if(n){if(n.value!==void 0)return n.value;if(Array.isArray(n.values)&&n.values.length>0)return n.values[0]}let s=t.value;if(s!==void 0)return s}var eo={};gi(eo,{ZodISODate:()=>Ug,ZodISODateTime:()=>Fg,ZodISODuration:()=>Kg,ZodISOTime:()=>Hg,date:()=>wu,datetime:()=>bu,duration:()=>xu,time:()=>$u});var Fg=b("ZodISODateTime",(t,e)=>{Sh.init(t,e),ze.init(t,e)});function bu(t){return zg(Fg,t)}var Ug=b("ZodISODate",(t,e)=>{Ph.init(t,e),ze.init(t,e)});function wu(t){return Cg(Ug,t)}var Hg=b("ZodISOTime",(t,e)=>{Th.init(t,e),ze.init(t,e)});function $u(t){return Ig(Hg,t)}var Kg=b("ZodISODuration",(t,e)=>{Eh.init(t,e),ze.init(t,e)});function xu(t){return Rg(Kg,t)}var Bg=(t,e)=>{Mi.init(t,e),t.name="ZodError",Object.defineProperties(t,{format:{value:r=>pm(t,r)},flatten:{value:r=>dm(t,r)},addIssue:{value:r=>t.issues.push(r)},addIssues:{value:r=>t.issues.push(...r)},isEmpty:{get(){return t.issues.length===0}}})},ED=b("ZodError",Bg),to=b("ZodError",Bg,{Parent:Error});var Gg=fm(to),Wg=mm(to),Jg=Qc(to),Yg=Xc(to);var Ce=b("ZodType",(t,e)=>($e.init(t,e),t.def=e,Object.defineProperty(t,"_def",{value:e}),t.check=(...r)=>t.clone({...e,checks:[...e.checks??[],...r.map(n=>typeof n=="function"?{_zod:{check:n,def:{check:"custom"},onattach:[]}}:n)]}),t.clone=(r,n)=>Gt(t,r,n),t.brand=()=>t,t.register=((r,n)=>(r.add(t,n),t)),t.parse=(r,n)=>Gg(t,r,n,{callee:t.parse}),t.safeParse=(r,n)=>Jg(t,r,n),t.parseAsync=async(r,n)=>Wg(t,r,n,{callee:t.parseAsync}),t.safeParseAsync=async(r,n)=>Yg(t,r,n),t.spa=t.safeParseAsync,t.refine=(r,n)=>t.check(dS(r,n)),t.superRefine=r=>t.check(pS(r)),t.overwrite=r=>t.check(gn(r)),t.optional=()=>R(t),t.nullable=()=>ey(t),t.nullish=()=>R(ey(t)),t.nonoptional=r=>sS(t,r),t.array=()=>re(t),t.or=r=>ke([t,r]),t.and=r=>Wi(t,r),t.transform=r=>Su(t,oy(r)),t.default=r=>tS(t,r),t.prefault=r=>nS(t,r),t.catch=r=>iS(t,r),t.pipe=r=>Su(t,r),t.readonly=()=>uS(t),t.describe=r=>{let n=t.clone();return Js.add(n,{description:r}),n},Object.defineProperty(t,"description",{get(){return Js.get(t)?.description},configurable:!0}),t.meta=(...r)=>{if(r.length===0)return Js.get(t);let n=t.clone();return Js.add(n,r[0]),n},t.isOptional=()=>t.safeParse(void 0).success,t.isNullable=()=>t.safeParse(null).success,t)),ty=b("_ZodString",(t,e)=>{Li.init(t,e),Ce.init(t,e);let r=t._zod.bag;t.format=r.format??null,t.minLength=r.minimum??null,t.maxLength=r.maximum??null,t.regex=(...n)=>t.check(lu(...n)),t.includes=(...n)=>t.check(fu(...n)),t.startsWith=(...n)=>t.check(mu(...n)),t.endsWith=(...n)=>t.check(hu(...n)),t.min=(...n)=>t.check(Qn(...n)),t.max=(...n)=>t.check(Hi(...n)),t.length=(...n)=>t.check(Ki(...n)),t.nonempty=(...n)=>t.check(Qn(1,...n)),t.lowercase=n=>t.check(du(n)),t.uppercase=n=>t.check(pu(n)),t.trim=()=>t.check(yu()),t.normalize=(...n)=>t.check(gu(...n)),t.toLowerCase=()=>t.check(vu()),t.toUpperCase=()=>t.check(_u())}),xk=b("ZodString",(t,e)=>{Li.init(t,e),ty.init(t,e),t.email=r=>t.check(cg(kk,r)),t.url=r=>t.check(fg(Sk,r)),t.jwt=r=>t.check(Eg(Zk,r)),t.emoji=r=>t.check(mg(Pk,r)),t.guid=r=>t.check(uu(Qg,r)),t.uuid=r=>t.check(ug(Gi,r)),t.uuidv4=r=>t.check(lg(Gi,r)),t.uuidv6=r=>t.check(dg(Gi,r)),t.uuidv7=r=>t.check(pg(Gi,r)),t.nanoid=r=>t.check(hg(Tk,r)),t.guid=r=>t.check(uu(Qg,r)),t.cuid=r=>t.check(gg(Ek,r)),t.cuid2=r=>t.check(yg(zk,r)),t.ulid=r=>t.check(vg(Ck,r)),t.base64=r=>t.check(Sg(Mk,r)),t.base64url=r=>t.check(Pg(qk,r)),t.xid=r=>t.check(_g(Ik,r)),t.ksuid=r=>t.check(bg(Rk,r)),t.ipv4=r=>t.check(wg(Ok,r)),t.ipv6=r=>t.check($g(Nk,r)),t.cidrv4=r=>t.check(xg(jk,r)),t.cidrv6=r=>t.check(kg(Ak,r)),t.e164=r=>t.check(Tg(Dk,r)),t.datetime=r=>t.check(bu(r)),t.date=r=>t.check(wu(r)),t.time=r=>t.check($u(r)),t.duration=r=>t.check(xu(r))});function _(t){return ag(xk,t)}var ze=b("ZodStringFormat",(t,e)=>{xe.init(t,e),ty.init(t,e)}),kk=b("ZodEmail",(t,e)=>{gh.init(t,e),ze.init(t,e)});var Qg=b("ZodGUID",(t,e)=>{mh.init(t,e),ze.init(t,e)});var Gi=b("ZodUUID",(t,e)=>{hh.init(t,e),ze.init(t,e)});var Sk=b("ZodURL",(t,e)=>{yh.init(t,e),ze.init(t,e)});var Pk=b("ZodEmoji",(t,e)=>{vh.init(t,e),ze.init(t,e)});var Tk=b("ZodNanoID",(t,e)=>{_h.init(t,e),ze.init(t,e)});var Ek=b("ZodCUID",(t,e)=>{bh.init(t,e),ze.init(t,e)});var zk=b("ZodCUID2",(t,e)=>{wh.init(t,e),ze.init(t,e)});var Ck=b("ZodULID",(t,e)=>{$h.init(t,e),ze.init(t,e)});var Ik=b("ZodXID",(t,e)=>{xh.init(t,e),ze.init(t,e)});var Rk=b("ZodKSUID",(t,e)=>{kh.init(t,e),ze.init(t,e)});var Ok=b("ZodIPv4",(t,e)=>{zh.init(t,e),ze.init(t,e)});var Nk=b("ZodIPv6",(t,e)=>{Ch.init(t,e),ze.init(t,e)});var jk=b("ZodCIDRv4",(t,e)=>{Ih.init(t,e),ze.init(t,e)});var Ak=b("ZodCIDRv6",(t,e)=>{Rh.init(t,e),ze.init(t,e)});var Mk=b("ZodBase64",(t,e)=>{Nh.init(t,e),ze.init(t,e)});var qk=b("ZodBase64URL",(t,e)=>{jh.init(t,e),ze.init(t,e)});var Dk=b("ZodE164",(t,e)=>{Ah.init(t,e),ze.init(t,e)});var Zk=b("ZodJWT",(t,e)=>{Mh.init(t,e),ze.init(t,e)});var ry=b("ZodNumber",(t,e)=>{iu.init(t,e),Ce.init(t,e),t.gt=(n,s)=>t.check(Fi(n,s)),t.gte=(n,s)=>t.check(Qs(n,s)),t.min=(n,s)=>t.check(Qs(n,s)),t.lt=(n,s)=>t.check(Vi(n,s)),t.lte=(n,s)=>t.check(Ys(n,s)),t.max=(n,s)=>t.check(Ys(n,s)),t.int=n=>t.check(Xg(n)),t.safe=n=>t.check(Xg(n)),t.positive=n=>t.check(Fi(0,n)),t.nonnegative=n=>t.check(Qs(0,n)),t.negative=n=>t.check(Vi(0,n)),t.nonpositive=n=>t.check(Ys(0,n)),t.multipleOf=(n,s)=>t.check(Ui(n,s)),t.step=(n,s)=>t.check(Ui(n,s)),t.finite=()=>t;let r=t._zod.bag;t.minValue=Math.max(r.minimum??Number.NEGATIVE_INFINITY,r.exclusiveMinimum??Number.NEGATIVE_INFINITY)??null,t.maxValue=Math.min(r.maximum??Number.POSITIVE_INFINITY,r.exclusiveMaximum??Number.POSITIVE_INFINITY)??null,t.isInt=(r.format??"").includes("int")||Number.isSafeInteger(r.multipleOf??.5),t.isFinite=!0,t.format=r.format??null});function ve(t){return Og(ry,t)}var Lk=b("ZodNumberFormat",(t,e)=>{qh.init(t,e),ry.init(t,e)});function Xg(t){return Ng(Lk,t)}var Vk=b("ZodBoolean",(t,e)=>{Dh.init(t,e),Ce.init(t,e)});function De(t){return jg(Vk,t)}var Fk=b("ZodNull",(t,e)=>{Zh.init(t,e),Ce.init(t,e)});function Pu(t){return Ag(Fk,t)}var Uk=b("ZodUnknown",(t,e)=>{Lh.init(t,e),Ce.init(t,e)});function Ne(){return Mg(Uk)}var Hk=b("ZodNever",(t,e)=>{Vh.init(t,e),Ce.init(t,e)});function Kk(t){return qg(Hk,t)}var Bk=b("ZodArray",(t,e)=>{Fh.init(t,e),Ce.init(t,e),t.element=e.element,t.min=(r,n)=>t.check(Qn(r,n)),t.nonempty=r=>t.check(Qn(1,r)),t.max=(r,n)=>t.check(Hi(r,n)),t.length=(r,n)=>t.check(Ki(r,n)),t.unwrap=()=>t.element});function re(t,e){return Dg(Bk,t,e)}var ny=b("ZodObject",(t,e)=>{Uh.init(t,e),Ce.init(t,e),de.defineLazy(t,"shape",()=>e.shape),t.keyof=()=>Ze(Object.keys(t._zod.def.shape)),t.catchall=r=>t.clone({...t._zod.def,catchall:r}),t.passthrough=()=>t.clone({...t._zod.def,catchall:Ne()}),t.loose=()=>t.clone({...t._zod.def,catchall:Ne()}),t.strict=()=>t.clone({...t._zod.def,catchall:Kk()}),t.strip=()=>t.clone({...t._zod.def,catchall:void 0}),t.extend=r=>de.extend(t,r),t.merge=r=>de.merge(t,r),t.pick=r=>de.pick(t,r),t.omit=r=>de.omit(t,r),t.partial=(...r)=>de.partial(iy,t,r[0]),t.required=(...r)=>de.required(ay,t,r[0])});function P(t,e){let r={type:"object",get shape(){return de.assignProp(this,"shape",{...t}),this.shape},...de.normalizeParams(e)};return new ny(r)}function wt(t,e){return new ny({type:"object",get shape(){return de.assignProp(this,"shape",{...t}),this.shape},catchall:Ne(),...de.normalizeParams(e)})}var sy=b("ZodUnion",(t,e)=>{au.init(t,e),Ce.init(t,e),t.options=e.options});function ke(t,e){return new sy({type:"union",options:t,...de.normalizeParams(e)})}var Gk=b("ZodDiscriminatedUnion",(t,e)=>{sy.init(t,e),Hh.init(t,e)});function Tu(t,e,r){return new Gk({type:"union",options:e,discriminator:t,...de.normalizeParams(r)})}var Wk=b("ZodIntersection",(t,e)=>{Kh.init(t,e),Ce.init(t,e)});function Wi(t,e){return new Wk({type:"intersection",left:t,right:e})}var Jk=b("ZodRecord",(t,e)=>{Bh.init(t,e),Ce.init(t,e),t.keyType=e.keyType,t.valueType=e.valueType});function je(t,e,r){return new Jk({type:"record",keyType:t,valueType:e,...de.normalizeParams(r)})}var ku=b("ZodEnum",(t,e)=>{Gh.init(t,e),Ce.init(t,e),t.enum=e.entries,t.options=Object.values(e.entries);let r=new Set(Object.keys(e.entries));t.extract=(n,s)=>{let o={};for(let i of n)if(r.has(i))o[i]=e.entries[i];else throw new Error(`Key ${i} not found in enum`);return new ku({...e,checks:[],...de.normalizeParams(s),entries:o})},t.exclude=(n,s)=>{let o={...e.entries};for(let i of n)if(r.has(i))delete o[i];else throw new Error(`Key ${i} not found in enum`);return new ku({...e,checks:[],...de.normalizeParams(s),entries:o})}});function Ze(t,e){let r=Array.isArray(t)?Object.fromEntries(t.map(n=>[n,n])):t;return new ku({type:"enum",entries:r,...de.normalizeParams(e)})}var Yk=b("ZodLiteral",(t,e)=>{Wh.init(t,e),Ce.init(t,e),t.values=new Set(e.values),Object.defineProperty(t,"value",{get(){if(e.values.length>1)throw new Error("This schema contains multiple valid literal values. Use `.values` instead.");return e.values[0]}})});function O(t,e){return new Yk({type:"literal",values:Array.isArray(t)?t:[t],...de.normalizeParams(e)})}var Qk=b("ZodTransform",(t,e)=>{Jh.init(t,e),Ce.init(t,e),t._zod.parse=(r,n)=>{r.addIssue=o=>{if(typeof o=="string")r.issues.push(de.issue(o,r.value,e));else{let i=o;i.fatal&&(i.continue=!1),i.code??(i.code="custom"),i.input??(i.input=r.value),i.inst??(i.inst=t),i.continue??(i.continue=!0),r.issues.push(de.issue(i))}};let s=e.transform(r.value,r);return s instanceof Promise?s.then(o=>(r.value=o,r)):(r.value=s,r)}});function oy(t){return new Qk({type:"transform",transform:t})}var iy=b("ZodOptional",(t,e)=>{Yh.init(t,e),Ce.init(t,e),t.unwrap=()=>t._zod.def.innerType});function R(t){return new iy({type:"optional",innerType:t})}var Xk=b("ZodNullable",(t,e)=>{Qh.init(t,e),Ce.init(t,e),t.unwrap=()=>t._zod.def.innerType});function ey(t){return new Xk({type:"nullable",innerType:t})}var eS=b("ZodDefault",(t,e)=>{Xh.init(t,e),Ce.init(t,e),t.unwrap=()=>t._zod.def.innerType,t.removeDefault=t.unwrap});function tS(t,e){return new eS({type:"default",innerType:t,get defaultValue(){return typeof e=="function"?e():e}})}var rS=b("ZodPrefault",(t,e)=>{eg.init(t,e),Ce.init(t,e),t.unwrap=()=>t._zod.def.innerType});function nS(t,e){return new rS({type:"prefault",innerType:t,get defaultValue(){return typeof e=="function"?e():e}})}var ay=b("ZodNonOptional",(t,e)=>{tg.init(t,e),Ce.init(t,e),t.unwrap=()=>t._zod.def.innerType});function sS(t,e){return new ay({type:"nonoptional",innerType:t,...de.normalizeParams(e)})}var oS=b("ZodCatch",(t,e)=>{rg.init(t,e),Ce.init(t,e),t.unwrap=()=>t._zod.def.innerType,t.removeCatch=t.unwrap});function iS(t,e){return new oS({type:"catch",innerType:t,catchValue:typeof e=="function"?e:()=>e})}var aS=b("ZodPipe",(t,e)=>{ng.init(t,e),Ce.init(t,e),t.in=e.in,t.out=e.out});function Su(t,e){return new aS({type:"pipe",in:t,out:e})}var cS=b("ZodReadonly",(t,e)=>{sg.init(t,e),Ce.init(t,e)});function uS(t){return new cS({type:"readonly",innerType:t})}var cy=b("ZodCustom",(t,e)=>{og.init(t,e),Ce.init(t,e)});function lS(t){let e=new Ge({check:"custom"});return e._zod.check=t,e}function uy(t,e){return Zg(cy,t??(()=>!0),e)}function dS(t,e={}){return Lg(cy,t,e)}function pS(t){let e=lS(r=>(r.addIssue=n=>{if(typeof n=="string")r.issues.push(de.issue(n,r.value,e._zod.def));else{let s=n;s.fatal&&(s.continue=!1),s.code??(s.code="custom"),s.input??(s.input=r.value),s.inst??(s.inst=e),s.continue??(s.continue=!e._zod.def.abort),r.issues.push(de.issue(s))}},t(r.value,r)));return e}function Eu(t,e){return Su(oy(t),e)}bt(ig());var Cu="2025-11-25";var ly=[Cu,"2025-06-18","2025-03-26","2024-11-05","2024-10-07"],Yt="io.modelcontextprotocol/related-task",Yi="2.0",Jt=uy(t=>t!==null&&(typeof t=="object"||typeof t=="function")),dy=ke([_(),ve().int()]),py=_(),fS=wt({ttl:ke([ve(),Pu()]).optional(),pollInterval:ve().optional()}),Iu=wt({taskId:_()}),mS=wt({progressToken:dy.optional(),[Yt]:Iu.optional()}),ct=wt({task:fS.optional(),_meta:mS.optional()}),Le=P({method:_(),params:ct.optional()}),yn=wt({_meta:P({[Yt]:R(Iu)}).passthrough().optional()}),$t=P({method:_(),params:yn.optional()}),We=wt({_meta:wt({[Yt]:Iu.optional()}).optional()}),Qi=ke([_(),ve().int()]),fy=P({jsonrpc:O(Yi),id:Qi,...Le.shape}).strict(),Ru=t=>fy.safeParse(t).success,my=P({jsonrpc:O(Yi),...$t.shape}).strict(),hy=t=>my.safeParse(t).success,gy=P({jsonrpc:O(Yi),id:Qi,result:We}).strict(),ro=t=>gy.safeParse(t).success,Z;(function(t){t[t.ConnectionClosed=-32e3]="ConnectionClosed",t[t.RequestTimeout=-32001]="RequestTimeout",t[t.ParseError=-32700]="ParseError",t[t.InvalidRequest=-32600]="InvalidRequest",t[t.MethodNotFound=-32601]="MethodNotFound",t[t.InvalidParams=-32602]="InvalidParams",t[t.InternalError=-32603]="InternalError",t[t.UrlElicitationRequired=-32042]="UrlElicitationRequired"})(Z||(Z={}));var yy=P({jsonrpc:O(Yi),id:Qi,error:P({code:ve().int(),message:_(),data:R(Ne())})}).strict(),vy=t=>yy.safeParse(t).success,_y=ke([fy,my,gy,yy]),vn=We.strict(),hS=yn.extend({requestId:Qi,reason:_().optional()}),Xi=$t.extend({method:O("notifications/cancelled"),params:hS}),gS=P({src:_(),mimeType:_().optional(),sizes:re(_()).optional()}),no=P({icons:re(gS).optional()}),es=P({name:_(),title:_().optional()}),by=es.extend({...es.shape,...no.shape,version:_(),websiteUrl:_().optional()}),yS=Wi(P({applyDefaults:De().optional()}),je(_(),Ne())),vS=Eu(t=>t&&typeof t=="object"&&!Array.isArray(t)&&Object.keys(t).length===0?{form:{}}:t,Wi(P({form:yS.optional(),url:Jt.optional()}),je(_(),Ne()).optional())),_S=P({list:R(P({}).passthrough()),cancel:R(P({}).passthrough()),requests:R(P({sampling:R(P({createMessage:R(P({}).passthrough())}).passthrough()),elicitation:R(P({create:R(P({}).passthrough())}).passthrough())}).passthrough())}).passthrough(),bS=P({list:R(P({}).passthrough()),cancel:R(P({}).passthrough()),requests:R(P({tools:R(P({call:R(P({}).passthrough())}).passthrough())}).passthrough())}).passthrough(),wS=P({experimental:je(_(),Jt).optional(),sampling:P({context:Jt.optional(),tools:Jt.optional()}).optional(),elicitation:vS.optional(),roots:P({listChanged:De().optional()}).optional(),tasks:R(_S)}),$S=ct.extend({protocolVersion:_(),capabilities:wS,clientInfo:by}),xS=Le.extend({method:O("initialize"),params:$S});var kS=P({experimental:je(_(),Jt).optional(),logging:Jt.optional(),completions:Jt.optional(),prompts:R(P({listChanged:R(De())})),resources:P({subscribe:De().optional(),listChanged:De().optional()}).optional(),tools:P({listChanged:De().optional()}).optional(),tasks:R(bS)}).passthrough(),Ou=We.extend({protocolVersion:_(),capabilities:kS,serverInfo:by,instructions:_().optional()}),SS=$t.extend({method:O("notifications/initialized")});var ea=Le.extend({method:O("ping")}),PS=P({progress:ve(),total:R(ve()),message:R(_())}),TS=P({...yn.shape,...PS.shape,progressToken:dy}),ta=$t.extend({method:O("notifications/progress"),params:TS}),ES=ct.extend({cursor:py.optional()}),so=Le.extend({params:ES.optional()}),oo=We.extend({nextCursor:R(py)}),io=P({taskId:_(),status:Ze(["working","input_required","completed","failed","cancelled"]),ttl:ke([ve(),Pu()]),createdAt:_(),lastUpdatedAt:_(),pollInterval:R(ve()),statusMessage:R(_())}),_n=We.extend({task:io}),zS=yn.merge(io),ao=$t.extend({method:O("notifications/tasks/status"),params:zS}),ra=Le.extend({method:O("tasks/get"),params:ct.extend({taskId:_()})}),na=We.merge(io),sa=Le.extend({method:O("tasks/result"),params:ct.extend({taskId:_()})}),oa=so.extend({method:O("tasks/list")}),ia=oo.extend({tasks:re(io)}),wy=Le.extend({method:O("tasks/cancel"),params:ct.extend({taskId:_()})}),$y=We.merge(io),xy=P({uri:_(),mimeType:R(_()),_meta:je(_(),Ne()).optional()}),ky=xy.extend({text:_()}),Nu=_().refine(t=>{try{return atob(t),!0}catch{return!1}},{message:"Invalid Base64 string"}),Sy=xy.extend({blob:Nu}),ts=P({audience:re(Ze(["user","assistant"])).optional(),priority:ve().min(0).max(1).optional(),lastModified:eo.datetime({offset:!0}).optional()}),Py=P({...es.shape,...no.shape,uri:_(),description:R(_()),mimeType:R(_()),annotations:ts.optional(),_meta:R(wt({}))}),CS=P({...es.shape,...no.shape,uriTemplate:_(),description:R(_()),mimeType:R(_()),annotations:ts.optional(),_meta:R(wt({}))}),IS=so.extend({method:O("resources/list")}),ju=oo.extend({resources:re(Py)}),RS=so.extend({method:O("resources/templates/list")}),Au=oo.extend({resourceTemplates:re(CS)}),Mu=ct.extend({uri:_()}),OS=Mu,NS=Le.extend({method:O("resources/read"),params:OS}),qu=We.extend({contents:re(ke([ky,Sy]))}),jS=$t.extend({method:O("notifications/resources/list_changed")}),AS=Mu,MS=Le.extend({method:O("resources/subscribe"),params:AS}),qS=Mu,DS=Le.extend({method:O("resources/unsubscribe"),params:qS}),ZS=yn.extend({uri:_()}),LS=$t.extend({method:O("notifications/resources/updated"),params:ZS}),VS=P({name:_(),description:R(_()),required:R(De())}),FS=P({...es.shape,...no.shape,description:R(_()),arguments:R(re(VS)),_meta:R(wt({}))}),US=so.extend({method:O("prompts/list")}),Du=oo.extend({prompts:re(FS)}),HS=ct.extend({name:_(),arguments:je(_(),_()).optional()}),KS=Le.extend({method:O("prompts/get"),params:HS}),Zu=P({type:O("text"),text:_(),annotations:ts.optional(),_meta:je(_(),Ne()).optional()}),Lu=P({type:O("image"),data:Nu,mimeType:_(),annotations:ts.optional(),_meta:je(_(),Ne()).optional()}),Vu=P({type:O("audio"),data:Nu,mimeType:_(),annotations:ts.optional(),_meta:je(_(),Ne()).optional()}),BS=P({type:O("tool_use"),name:_(),id:_(),input:P({}).passthrough(),_meta:R(P({}).passthrough())}).passthrough(),GS=P({type:O("resource"),resource:ke([ky,Sy]),annotations:ts.optional(),_meta:je(_(),Ne()).optional()}),WS=Py.extend({type:O("resource_link")}),Fu=ke([Zu,Lu,Vu,WS,GS]),JS=P({role:Ze(["user","assistant"]),content:Fu}),Uu=We.extend({description:R(_()),messages:re(JS)}),YS=$t.extend({method:O("notifications/prompts/list_changed")}),QS=P({title:_().optional(),readOnlyHint:De().optional(),destructiveHint:De().optional(),idempotentHint:De().optional(),openWorldHint:De().optional()}),XS=P({taskSupport:Ze(["required","optional","forbidden"]).optional()}),Ty=P({...es.shape,...no.shape,description:_().optional(),inputSchema:P({type:O("object"),properties:je(_(),Jt).optional(),required:re(_()).optional()}).catchall(Ne()),outputSchema:P({type:O("object"),properties:je(_(),Jt).optional(),required:re(_()).optional()}).catchall(Ne()).optional(),annotations:R(QS),execution:R(XS),_meta:je(_(),Ne()).optional()}),eP=so.extend({method:O("tools/list")}),Hu=oo.extend({tools:re(Ty)}),rs=We.extend({content:re(Fu).default([]),structuredContent:je(_(),Ne()).optional(),isError:R(De())}),wZ=rs.or(We.extend({toolResult:Ne()})),tP=ct.extend({name:_(),arguments:R(je(_(),Ne()))}),rP=Le.extend({method:O("tools/call"),params:tP}),nP=$t.extend({method:O("notifications/tools/list_changed")}),Ey=Ze(["debug","info","notice","warning","error","critical","alert","emergency"]),sP=ct.extend({level:Ey}),oP=Le.extend({method:O("logging/setLevel"),params:sP}),iP=yn.extend({level:Ey,logger:_().optional(),data:Ne()}),aP=$t.extend({method:O("notifications/message"),params:iP}),cP=P({name:_().optional()}),uP=P({hints:R(re(cP)),costPriority:R(ve().min(0).max(1)),speedPriority:R(ve().min(0).max(1)),intelligencePriority:R(ve().min(0).max(1))}),lP=P({mode:R(Ze(["auto","required","none"]))}),dP=P({type:O("tool_result"),toolUseId:_().describe("The unique identifier for the corresponding tool call."),content:re(Fu).default([]),structuredContent:P({}).passthrough().optional(),isError:R(De()),_meta:R(P({}).passthrough())}).passthrough(),pP=Tu("type",[Zu,Lu,Vu]),Ji=Tu("type",[Zu,Lu,Vu,BS,dP]),fP=P({role:Ze(["user","assistant"]),content:ke([Ji,re(Ji)]),_meta:R(P({}).passthrough())}).passthrough(),mP=ct.extend({messages:re(fP),modelPreferences:uP.optional(),systemPrompt:_().optional(),includeContext:Ze(["none","thisServer","allServers"]).optional(),temperature:ve().optional(),maxTokens:ve().int(),stopSequences:re(_()).optional(),metadata:Jt.optional(),tools:R(re(Ty)),toolChoice:R(lP)}),Ku=Le.extend({method:O("sampling/createMessage"),params:mP}),Bu=We.extend({model:_(),stopReason:R(Ze(["endTurn","stopSequence","maxTokens"]).or(_())),role:Ze(["user","assistant"]),content:pP}),hP=We.extend({model:_(),stopReason:R(Ze(["endTurn","stopSequence","maxTokens","toolUse"]).or(_())),role:Ze(["user","assistant"]),content:ke([Ji,re(Ji)])}),gP=P({type:O("boolean"),title:_().optional(),description:_().optional(),default:De().optional()}),yP=P({type:O("string"),title:_().optional(),description:_().optional(),minLength:ve().optional(),maxLength:ve().optional(),format:Ze(["email","uri","date","date-time"]).optional(),default:_().optional()}),vP=P({type:Ze(["number","integer"]),title:_().optional(),description:_().optional(),minimum:ve().optional(),maximum:ve().optional(),default:ve().optional()}),_P=P({type:O("string"),title:_().optional(),description:_().optional(),enum:re(_()),default:_().optional()}),bP=P({type:O("string"),title:_().optional(),description:_().optional(),oneOf:re(P({const:_(),title:_()})),default:_().optional()}),wP=P({type:O("string"),title:_().optional(),description:_().optional(),enum:re(_()),enumNames:re(_()).optional(),default:_().optional()}),$P=ke([_P,bP]),xP=P({type:O("array"),title:_().optional(),description:_().optional(),minItems:ve().optional(),maxItems:ve().optional(),items:P({type:O("string"),enum:re(_())}),default:re(_()).optional()}),kP=P({type:O("array"),title:_().optional(),description:_().optional(),minItems:ve().optional(),maxItems:ve().optional(),items:P({anyOf:re(P({const:_(),title:_()}))}),default:re(_()).optional()}),SP=ke([xP,kP]),PP=ke([wP,$P,SP]),TP=ke([PP,gP,yP,vP]),EP=ct.extend({mode:O("form").optional(),message:_(),requestedSchema:P({type:O("object"),properties:je(_(),TP),required:re(_()).optional()})}),zP=ct.extend({mode:O("url"),message:_(),elicitationId:_(),url:_().url()}),CP=ke([EP,zP]),Gu=Le.extend({method:O("elicitation/create"),params:CP}),IP=yn.extend({elicitationId:_()}),RP=$t.extend({method:O("notifications/elicitation/complete"),params:IP}),Wu=We.extend({action:Ze(["accept","decline","cancel"]),content:Eu(t=>t===null?void 0:t,je(_(),ke([_(),ve(),De(),re(_())])).optional())}),OP=P({type:O("ref/resource"),uri:_()});var NP=P({type:O("ref/prompt"),name:_()}),jP=ct.extend({ref:ke([NP,OP]),argument:P({name:_(),value:_()}),context:P({arguments:je(_(),_()).optional()}).optional()}),AP=Le.extend({method:O("completion/complete"),params:jP});var Ju=We.extend({completion:wt({values:re(_()).max(100),total:R(ve().int()),hasMore:R(De())})}),MP=P({uri:_().startsWith("file://"),name:_().optional(),_meta:je(_(),Ne()).optional()}),qP=Le.extend({method:O("roots/list")}),DP=We.extend({roots:re(MP)}),ZP=$t.extend({method:O("notifications/roots/list_changed")}),$Z=ke([ea,xS,AP,oP,KS,US,IS,RS,NS,MS,DS,rP,eP,ra,sa,oa]),xZ=ke([Xi,ta,SS,ZP,ao]),kZ=ke([vn,Bu,hP,Wu,DP,na,ia,_n]),SZ=ke([ea,Ku,Gu,qP,ra,sa,oa]),PZ=ke([Xi,ta,aP,LS,jS,nP,YS,ao,RP]),TZ=ke([vn,Ou,Ju,Uu,Du,ju,Au,qu,rs,Hu,na,ia,_n]),A=class t extends Error{constructor(e,r,n){super(`MCP error ${e}: ${r}`),this.code=e,this.data=n,this.name="McpError"}static fromError(e,r,n){if(e===Z.UrlElicitationRequired&&n){let s=n;if(s.elicitations)return new zu(s.elicitations,r)}return new t(e,r,n)}},zu=class extends A{constructor(e,r=`URL elicitation${e.length>1?"s":""} required`){super(Z.UrlElicitationRequired,r,{elicitations:e})}get elicitations(){var e,r;return(r=(e=this.data)===null||e===void 0?void 0:e.elicitations)!==null&&r!==void 0?r:[]}};function Rr(t){return t==="completed"||t==="failed"||t==="cancelled"}var i9=new Set("ABCDEFGHIJKLMNOPQRSTUVXYZabcdefghijklmnopqrstuvxyz0123456789");function Yu(t){let e=Bi(t),r=e?.method;if(!r)throw new Error("Schema is missing a method literal");let n=Vg(r);if(typeof n!="string")throw new Error("Schema method literal must be a string");return n}function Qu(t,e){let r=Ot(t,e);if(!r.success)throw r.error;return r.data}var KP=6e4,aa=class{constructor(e){this._options=e,this._requestMessageId=0,this._requestHandlers=new Map,this._requestHandlerAbortControllers=new Map,this._notificationHandlers=new Map,this._responseHandlers=new Map,this._progressHandlers=new Map,this._timeoutInfo=new Map,this._pendingDebouncedNotifications=new Set,this._taskProgressTokens=new Map,this._requestResolvers=new Map,this.setNotificationHandler(Xi,r=>{this._oncancel(r)}),this.setNotificationHandler(ta,r=>{this._onprogress(r)}),this.setRequestHandler(ea,r=>({})),this._taskStore=e?.taskStore,this._taskMessageQueue=e?.taskMessageQueue,this._taskStore&&(this.setRequestHandler(ra,async(r,n)=>{let s=await this._taskStore.getTask(r.params.taskId,n.sessionId);if(!s)throw new A(Z.InvalidParams,"Failed to retrieve task: Task not found");return{...s}}),this.setRequestHandler(sa,async(r,n)=>{let s=async()=>{var o;let i=r.params.taskId;if(this._taskMessageQueue){let c;for(;c=await this._taskMessageQueue.dequeue(i,n.sessionId);){if(c.type==="response"||c.type==="error"){let u=c.message,l=u.id,d=this._requestResolvers.get(l);if(d)if(this._requestResolvers.delete(l),c.type==="response")d(u);else{let f=u,p=new A(f.error.code,f.error.message,f.error.data);d(p)}else{let f=c.type==="response"?"Response":"Error";this._onerror(new Error(`${f} handler missing for request ${l}`))}continue}await((o=this._transport)===null||o===void 0?void 0:o.send(c.message,{relatedRequestId:n.requestId}))}}let a=await this._taskStore.getTask(i,n.sessionId);if(!a)throw new A(Z.InvalidParams,`Task not found: ${i}`);if(!Rr(a.status))return await this._waitForTaskUpdate(i,n.signal),await s();if(Rr(a.status)){let c=await this._taskStore.getTaskResult(i,n.sessionId);return this._clearTaskQueue(i),{...c,_meta:{...c._meta,[Yt]:{taskId:i}}}}return await s()};return await s()}),this.setRequestHandler(oa,async(r,n)=>{var s;try{let{tasks:o,nextCursor:i}=await this._taskStore.listTasks((s=r.params)===null||s===void 0?void 0:s.cursor,n.sessionId);return{tasks:o,nextCursor:i,_meta:{}}}catch(o){throw new A(Z.InvalidParams,`Failed to list tasks: ${o instanceof Error?o.message:String(o)}`)}}),this.setRequestHandler(wy,async(r,n)=>{try{let s=await this._taskStore.getTask(r.params.taskId,n.sessionId);if(!s)throw new A(Z.InvalidParams,`Task not found: ${r.params.taskId}`);if(Rr(s.status))throw new A(Z.InvalidParams,`Cannot cancel task in terminal status: ${s.status}`);await this._taskStore.updateTaskStatus(r.params.taskId,"cancelled","Client cancelled task execution.",n.sessionId),this._clearTaskQueue(r.params.taskId);let o=await this._taskStore.getTask(r.params.taskId,n.sessionId);if(!o)throw new A(Z.InvalidParams,`Task not found after cancellation: ${r.params.taskId}`);return{_meta:{},...o}}catch(s){throw s instanceof A?s:new A(Z.InvalidRequest,`Failed to cancel task: ${s instanceof Error?s.message:String(s)}`)}}))}async _oncancel(e){let r=this._requestHandlerAbortControllers.get(e.params.requestId);r?.abort(e.params.reason)}_setupTimeout(e,r,n,s,o=!1){this._timeoutInfo.set(e,{timeoutId:setTimeout(s,r),startTime:Date.now(),timeout:r,maxTotalTimeout:n,resetTimeoutOnProgress:o,onTimeout:s})}_resetTimeout(e){let r=this._timeoutInfo.get(e);if(!r)return!1;let n=Date.now()-r.startTime;if(r.maxTotalTimeout&&n>=r.maxTotalTimeout)throw this._timeoutInfo.delete(e),A.fromError(Z.RequestTimeout,"Maximum total timeout exceeded",{maxTotalTimeout:r.maxTotalTimeout,totalElapsed:n});return clearTimeout(r.timeoutId),r.timeoutId=setTimeout(r.onTimeout,r.timeout),!0}_cleanupTimeout(e){let r=this._timeoutInfo.get(e);r&&(clearTimeout(r.timeoutId),this._timeoutInfo.delete(e))}async connect(e){var r,n,s;this._transport=e;let o=(r=this.transport)===null||r===void 0?void 0:r.onclose;this._transport.onclose=()=>{o?.(),this._onclose()};let i=(n=this.transport)===null||n===void 0?void 0:n.onerror;this._transport.onerror=c=>{i?.(c),this._onerror(c)};let a=(s=this._transport)===null||s===void 0?void 0:s.onmessage;this._transport.onmessage=(c,u)=>{a?.(c,u),ro(c)||vy(c)?this._onresponse(c):Ru(c)?this._onrequest(c,u):hy(c)?this._onnotification(c):this._onerror(new Error(`Unknown message type: ${JSON.stringify(c)}`))},await this._transport.start()}_onclose(){var e;let r=this._responseHandlers;this._responseHandlers=new Map,this._progressHandlers.clear(),this._taskProgressTokens.clear(),this._pendingDebouncedNotifications.clear();let n=A.fromError(Z.ConnectionClosed,"Connection closed");this._transport=void 0,(e=this.onclose)===null||e===void 0||e.call(this);for(let s of r.values())s(n)}_onerror(e){var r;(r=this.onerror)===null||r===void 0||r.call(this,e)}_onnotification(e){var r;let n=(r=this._notificationHandlers.get(e.method))!==null&&r!==void 0?r:this.fallbackNotificationHandler;n!==void 0&&Promise.resolve().then(()=>n(e)).catch(s=>this._onerror(new Error(`Uncaught error in notification handler: ${s}`)))}_onrequest(e,r){var n,s,o,i,a,c;let u=(n=this._requestHandlers.get(e.method))!==null&&n!==void 0?n:this.fallbackRequestHandler,l=this._transport,d=(i=(o=(s=e.params)===null||s===void 0?void 0:s._meta)===null||o===void 0?void 0:o[Yt])===null||i===void 0?void 0:i.taskId;if(u===void 0){let g={jsonrpc:"2.0",id:e.id,error:{code:Z.MethodNotFound,message:"Method not found"}};d&&this._taskMessageQueue?this._enqueueTaskMessage(d,{type:"error",message:g,timestamp:Date.now()},l?.sessionId).catch(y=>this._onerror(new Error(`Failed to enqueue error response: ${y}`))):l?.send(g).catch(y=>this._onerror(new Error(`Failed to send an error response: ${y}`)));return}let f=new AbortController;this._requestHandlerAbortControllers.set(e.id,f);let p=(a=e.params)===null||a===void 0?void 0:a.task,m=this._taskStore?this.requestTaskStore(e,l?.sessionId):void 0,h={signal:f.signal,sessionId:l?.sessionId,_meta:(c=e.params)===null||c===void 0?void 0:c._meta,sendNotification:async g=>{let y={relatedRequestId:e.id};d&&(y.relatedTask={taskId:d}),await this.notification(g,y)},sendRequest:async(g,y,$)=>{var w,S;let x={...$,relatedRequestId:e.id};d&&!x.relatedTask&&(x.relatedTask={taskId:d});let C=(S=(w=x.relatedTask)===null||w===void 0?void 0:w.taskId)!==null&&S!==void 0?S:d;return C&&m&&await m.updateTaskStatus(C,"input_required"),await this.request(g,y,x)},authInfo:r?.authInfo,requestId:e.id,requestInfo:r?.requestInfo,taskId:d,taskStore:m,taskRequestedTtl:p?.ttl,closeSSEStream:r?.closeSSEStream,closeStandaloneSSEStream:r?.closeStandaloneSSEStream};Promise.resolve().then(()=>{p&&this.assertTaskHandlerCapability(e.method)}).then(()=>u(e,h)).then(async g=>{if(f.signal.aborted)return;let y={result:g,jsonrpc:"2.0",id:e.id};d&&this._taskMessageQueue?await this._enqueueTaskMessage(d,{type:"response",message:y,timestamp:Date.now()},l?.sessionId):await l?.send(y)},async g=>{var y;if(f.signal.aborted)return;let $={jsonrpc:"2.0",id:e.id,error:{code:Number.isSafeInteger(g.code)?g.code:Z.InternalError,message:(y=g.message)!==null&&y!==void 0?y:"Internal error",...g.data!==void 0&&{data:g.data}}};d&&this._taskMessageQueue?await this._enqueueTaskMessage(d,{type:"error",message:$,timestamp:Date.now()},l?.sessionId):await l?.send($)}).catch(g=>this._onerror(new Error(`Failed to send response: ${g}`))).finally(()=>{this._requestHandlerAbortControllers.delete(e.id)})}_onprogress(e){let{progressToken:r,...n}=e.params,s=Number(r),o=this._progressHandlers.get(s);if(!o){this._onerror(new Error(`Received a progress notification for an unknown token: ${JSON.stringify(e)}`));return}let i=this._responseHandlers.get(s),a=this._timeoutInfo.get(s);if(a&&i&&a.resetTimeoutOnProgress)try{this._resetTimeout(s)}catch(c){this._responseHandlers.delete(s),this._progressHandlers.delete(s),this._cleanupTimeout(s),i(c);return}o(n)}_onresponse(e){let r=Number(e.id),n=this._requestResolvers.get(r);if(n){if(this._requestResolvers.delete(r),ro(e))n(e);else{let i=new A(e.error.code,e.error.message,e.error.data);n(i)}return}let s=this._responseHandlers.get(r);if(s===void 0){this._onerror(new Error(`Received a response for an unknown message ID: ${JSON.stringify(e)}`));return}this._responseHandlers.delete(r),this._cleanupTimeout(r);let o=!1;if(ro(e)&&e.result&&typeof e.result=="object"){let i=e.result;if(i.task&&typeof i.task=="object"){let a=i.task;typeof a.taskId=="string"&&(o=!0,this._taskProgressTokens.set(a.taskId,r))}}if(o||this._progressHandlers.delete(r),ro(e))s(e);else{let i=A.fromError(e.error.code,e.error.message,e.error.data);s(i)}}get transport(){return this._transport}async close(){var e;await((e=this._transport)===null||e===void 0?void 0:e.close())}async*requestStream(e,r,n){var s,o,i,a;let{task:c}=n??{};if(!c){try{yield{type:"result",result:await this.request(e,r,n)}}catch(l){yield{type:"error",error:l instanceof A?l:new A(Z.InternalError,String(l))}}return}let u;try{let l=await this.request(e,_n,n);if(l.task)u=l.task.taskId,yield{type:"taskCreated",task:l.task};else throw new A(Z.InternalError,"Task creation did not return a task");for(;;){let d=await this.getTask({taskId:u},n);if(yield{type:"taskStatus",task:d},Rr(d.status)){d.status==="completed"?yield{type:"result",result:await this.getTaskResult({taskId:u},r,n)}:d.status==="failed"?yield{type:"error",error:new A(Z.InternalError,`Task ${u} failed`)}:d.status==="cancelled"&&(yield{type:"error",error:new A(Z.InternalError,`Task ${u} was cancelled`)});return}if(d.status==="input_required"){yield{type:"result",result:await this.getTaskResult({taskId:u},r,n)};return}let f=(i=(s=d.pollInterval)!==null&&s!==void 0?s:(o=this._options)===null||o===void 0?void 0:o.defaultTaskPollInterval)!==null&&i!==void 0?i:1e3;await new Promise(p=>setTimeout(p,f)),(a=n?.signal)===null||a===void 0||a.throwIfAborted()}}catch(l){yield{type:"error",error:l instanceof A?l:new A(Z.InternalError,String(l))}}}request(e,r,n){let{relatedRequestId:s,resumptionToken:o,onresumptiontoken:i,task:a,relatedTask:c}=n??{};return new Promise((u,l)=>{var d,f,p,m,h,g,y;let $=F=>{l(F)};if(!this._transport){$(new Error("Not connected"));return}if(((d=this._options)===null||d===void 0?void 0:d.enforceStrictCapabilities)===!0)try{this.assertCapabilityForMethod(e.method),a&&this.assertTaskCapability(e.method)}catch(F){$(F);return}(f=n?.signal)===null||f===void 0||f.throwIfAborted();let w=this._requestMessageId++,S={...e,jsonrpc:"2.0",id:w};n?.onprogress&&(this._progressHandlers.set(w,n.onprogress),S.params={...e.params,_meta:{...((p=e.params)===null||p===void 0?void 0:p._meta)||{},progressToken:w}}),a&&(S.params={...S.params,task:a}),c&&(S.params={...S.params,_meta:{...((m=S.params)===null||m===void 0?void 0:m._meta)||{},[Yt]:c}});let x=F=>{var ge;this._responseHandlers.delete(w),this._progressHandlers.delete(w),this._cleanupTimeout(w),(ge=this._transport)===null||ge===void 0||ge.send({jsonrpc:"2.0",method:"notifications/cancelled",params:{requestId:w,reason:String(F)}},{relatedRequestId:s,resumptionToken:o,onresumptiontoken:i}).catch(Gr=>this._onerror(new Error(`Failed to send cancellation: ${Gr}`)));let Ae=F instanceof A?F:new A(Z.RequestTimeout,String(F));l(Ae)};this._responseHandlers.set(w,F=>{var ge;if(!(!((ge=n?.signal)===null||ge===void 0)&&ge.aborted)){if(F instanceof Error)return l(F);try{let Ae=Ot(r,F.result);Ae.success?u(Ae.data):l(Ae.error)}catch(Ae){l(Ae)}}}),(h=n?.signal)===null||h===void 0||h.addEventListener("abort",()=>{var F;x((F=n?.signal)===null||F===void 0?void 0:F.reason)});let C=(g=n?.timeout)!==null&&g!==void 0?g:KP,ee=()=>x(A.fromError(Z.RequestTimeout,"Request timed out",{timeout:C}));this._setupTimeout(w,C,n?.maxTotalTimeout,ee,(y=n?.resetTimeoutOnProgress)!==null&&y!==void 0?y:!1);let fe=c?.taskId;if(fe){let F=ge=>{let Ae=this._responseHandlers.get(w);Ae?Ae(ge):this._onerror(new Error(`Response handler missing for side-channeled request ${w}`))};this._requestResolvers.set(w,F),this._enqueueTaskMessage(fe,{type:"request",message:S,timestamp:Date.now()}).catch(ge=>{this._cleanupTimeout(w),l(ge)})}else this._transport.send(S,{relatedRequestId:s,resumptionToken:o,onresumptiontoken:i}).catch(F=>{this._cleanupTimeout(w),l(F)})})}async getTask(e,r){return this.request({method:"tasks/get",params:e},na,r)}async getTaskResult(e,r,n){return this.request({method:"tasks/result",params:e},r,n)}async listTasks(e,r){return this.request({method:"tasks/list",params:e},ia,r)}async cancelTask(e,r){return this.request({method:"tasks/cancel",params:e},$y,r)}async notification(e,r){var n,s,o,i,a;if(!this._transport)throw new Error("Not connected");this.assertNotificationCapability(e.method);let c=(n=r?.relatedTask)===null||n===void 0?void 0:n.taskId;if(c){let f={...e,jsonrpc:"2.0",params:{...e.params,_meta:{...((s=e.params)===null||s===void 0?void 0:s._meta)||{},[Yt]:r.relatedTask}}};await this._enqueueTaskMessage(c,{type:"notification",message:f,timestamp:Date.now()});return}if(((i=(o=this._options)===null||o===void 0?void 0:o.debouncedNotificationMethods)!==null&&i!==void 0?i:[]).includes(e.method)&&!e.params&&!r?.relatedRequestId&&!r?.relatedTask){if(this._pendingDebouncedNotifications.has(e.method))return;this._pendingDebouncedNotifications.add(e.method),Promise.resolve().then(()=>{var f,p;if(this._pendingDebouncedNotifications.delete(e.method),!this._transport)return;let m={...e,jsonrpc:"2.0"};r?.relatedTask&&(m={...m,params:{...m.params,_meta:{...((f=m.params)===null||f===void 0?void 0:f._meta)||{},[Yt]:r.relatedTask}}}),(p=this._transport)===null||p===void 0||p.send(m,r).catch(h=>this._onerror(h))});return}let d={...e,jsonrpc:"2.0"};r?.relatedTask&&(d={...d,params:{...d.params,_meta:{...((a=d.params)===null||a===void 0?void 0:a._meta)||{},[Yt]:r.relatedTask}}}),await this._transport.send(d,r)}setRequestHandler(e,r){let n=Yu(e);this.assertRequestHandlerCapability(n),this._requestHandlers.set(n,(s,o)=>{let i=Qu(e,s);return Promise.resolve(r(i,o))})}removeRequestHandler(e){this._requestHandlers.delete(e)}assertCanSetRequestHandler(e){if(this._requestHandlers.has(e))throw new Error(`A request handler for ${e} already exists, which would be overridden`)}setNotificationHandler(e,r){let n=Yu(e);this._notificationHandlers.set(n,s=>{let o=Qu(e,s);return Promise.resolve(r(o))})}removeNotificationHandler(e){this._notificationHandlers.delete(e)}_cleanupTaskProgressHandler(e){let r=this._taskProgressTokens.get(e);r!==void 0&&(this._progressHandlers.delete(r),this._taskProgressTokens.delete(e))}async _enqueueTaskMessage(e,r,n){var s;if(!this._taskStore||!this._taskMessageQueue)throw new Error("Cannot enqueue task message: taskStore and taskMessageQueue are not configured");let o=(s=this._options)===null||s===void 0?void 0:s.maxTaskQueueSize;await this._taskMessageQueue.enqueue(e,r,n,o)}async _clearTaskQueue(e,r){if(this._taskMessageQueue){let n=await this._taskMessageQueue.dequeueAll(e,r);for(let s of n)if(s.type==="request"&&Ru(s.message)){let o=s.message.id,i=this._requestResolvers.get(o);i?(i(new A(Z.InternalError,"Task cancelled or completed")),this._requestResolvers.delete(o)):this._onerror(new Error(`Resolver missing for request ${o} during task ${e} cleanup`))}}}async _waitForTaskUpdate(e,r){var n,s,o;let i=(s=(n=this._options)===null||n===void 0?void 0:n.defaultTaskPollInterval)!==null&&s!==void 0?s:1e3;try{let a=await((o=this._taskStore)===null||o===void 0?void 0:o.getTask(e));a?.pollInterval&&(i=a.pollInterval)}catch{}return new Promise((a,c)=>{if(r.aborted){c(new A(Z.InvalidRequest,"Request cancelled"));return}let u=setTimeout(a,i);r.addEventListener("abort",()=>{clearTimeout(u),c(new A(Z.InvalidRequest,"Request cancelled"))},{once:!0})})}requestTaskStore(e,r){let n=this._taskStore;if(!n)throw new Error("No task store configured");return{createTask:async s=>{if(!e)throw new Error("No request provided");return await n.createTask(s,e.id,{method:e.method,params:e.params},r)},getTask:async s=>{let o=await n.getTask(s,r);if(!o)throw new A(Z.InvalidParams,"Failed to retrieve task: Task not found");return o},storeTaskResult:async(s,o,i)=>{await n.storeTaskResult(s,o,i,r);let a=await n.getTask(s,r);if(a){let c=ao.parse({method:"notifications/tasks/status",params:a});await this.notification(c),Rr(a.status)&&this._cleanupTaskProgressHandler(s)}},getTaskResult:s=>n.getTaskResult(s,r),updateTaskStatus:async(s,o,i)=>{let a=await n.getTask(s,r);if(!a)throw new A(Z.InvalidParams,`Task "${s}" not found - it may have been cleaned up`);if(Rr(a.status))throw new A(Z.InvalidParams,`Cannot update task "${s}" from terminal status "${a.status}" to "${o}". Terminal states (completed, failed, cancelled) cannot transition to other states.`);await n.updateTaskStatus(s,o,i,r);let c=await n.getTask(s,r);if(c){let u=ao.parse({method:"notifications/tasks/status",params:c});await this.notification(u),Rr(c.status)&&this._cleanupTaskProgressHandler(s)}},listTasks:s=>n.listTasks(s,r)}}};function zy(t){return t!==null&&typeof t=="object"&&!Array.isArray(t)}function Cy(t,e){let r={...t};for(let n in e){let s=n,o=e[s];if(o===void 0)continue;let i=r[s];zy(i)&&zy(o)?r[s]={...i,...o}:r[s]=o}return r}var Cw=ye(r0(),1),Iw=ye(zw(),1);function CA(){let t=new Cw.Ajv({strict:!1,validateFormats:!0,validateSchema:!1,allErrors:!0});return(0,Iw.default)(t),t}var wc=class{constructor(e){this._ajv=e??CA()}getValidator(e){var r;let n="$id"in e&&typeof e.$id=="string"?(r=this._ajv.getSchema(e.$id))!==null&&r!==void 0?r:this._ajv.compile(e):this._ajv.compile(e);return s=>n(s)?{valid:!0,data:s,errorMessage:void 0}:{valid:!1,data:void 0,errorMessage:this._ajv.errorsText(n.errors)}}};var $c=class{constructor(e){this._client=e}async*callToolStream(e,r=rs,n){var s;let o=this._client,i={...n,task:(s=n?.task)!==null&&s!==void 0?s:o.isToolTask(e.name)?{}:void 0},a=o.requestStream({method:"tools/call",params:e},r,i),c=o.getToolOutputValidator(e.name);for await(let u of a){if(u.type==="result"&&c){let l=u.result;if(!l.structuredContent&&!l.isError){yield{type:"error",error:new A(Z.InvalidRequest,`Tool ${e.name} has an output schema but did not return structured content`)};return}if(l.structuredContent)try{let d=c(l.structuredContent);if(!d.valid){yield{type:"error",error:new A(Z.InvalidParams,`Structured content does not match the tool's output schema: ${d.errorMessage}`)};return}}catch(d){if(d instanceof A){yield{type:"error",error:d};return}yield{type:"error",error:new A(Z.InvalidParams,`Failed to validate structured content: ${d instanceof Error?d.message:String(d)}`)};return}}yield u}}async getTask(e,r){return this._client.getTask({taskId:e},r)}async getTaskResult(e,r,n){return this._client.getTaskResult({taskId:e},r,n)}async listTasks(e,r){return this._client.listTasks(e?{cursor:e}:void 0,r)}async cancelTask(e,r){return this._client.cancelTask({taskId:e},r)}requestStream(e,r,n){return this._client.requestStream(e,r,n)}};function Rw(t,e,r){var n;if(!t)throw new Error(`${r} does not support task creation (required for ${e})`);switch(e){case"tools/call":if(!(!((n=t.tools)===null||n===void 0)&&n.call))throw new Error(`${r} does not support task creation for tools/call (required for ${e})`);break;default:break}}function Ow(t,e,r){var n,s;if(!t)throw new Error(`${r} does not support task creation (required for ${e})`);switch(e){case"sampling/createMessage":if(!(!((n=t.sampling)===null||n===void 0)&&n.createMessage))throw new Error(`${r} does not support task creation for sampling/createMessage (required for ${e})`);break;case"elicitation/create":if(!(!((s=t.elicitation)===null||s===void 0)&&s.create))throw new Error(`${r} does not support task creation for elicitation/create (required for ${e})`);break;default:break}}function xc(t,e){if(!(!t||e===null||typeof e!="object")){if(t.type==="object"&&t.properties&&typeof t.properties=="object"){let r=e,n=t.properties;for(let s of Object.keys(n)){let o=n[s];r[s]===void 0&&Object.prototype.hasOwnProperty.call(o,"default")&&(r[s]=o.default),r[s]!==void 0&&xc(o,r[s])}}if(Array.isArray(t.anyOf))for(let r of t.anyOf)xc(r,e);if(Array.isArray(t.oneOf))for(let r of t.oneOf)xc(r,e)}}function IA(t){if(!t)return{supportsFormMode:!1,supportsUrlMode:!1};let e=t.form!==void 0,r=t.url!==void 0;return{supportsFormMode:e||!e&&!r,supportsUrlMode:r}}var kc=class extends aa{constructor(e,r){var n,s;super(r),this._clientInfo=e,this._cachedToolOutputValidators=new Map,this._cachedKnownTaskTools=new Set,this._cachedRequiredTaskTools=new Set,this._capabilities=(n=r?.capabilities)!==null&&n!==void 0?n:{},this._jsonSchemaValidator=(s=r?.jsonSchemaValidator)!==null&&s!==void 0?s:new wc}get experimental(){return this._experimental||(this._experimental={tasks:new $c(this)}),this._experimental}registerCapabilities(e){if(this.transport)throw new Error("Cannot register capabilities after connecting to transport");this._capabilities=Cy(this._capabilities,e)}setRequestHandler(e,r){var n,s,o;let i=Bi(e),a=i?.method;if(!a)throw new Error("Schema is missing a method literal");let c;if(Xn(a)){let l=a,d=(n=l._zod)===null||n===void 0?void 0:n.def;c=(s=d?.value)!==null&&s!==void 0?s:l.value}else{let l=a,d=l._def;c=(o=d?.value)!==null&&o!==void 0?o:l.value}if(typeof c!="string")throw new Error("Schema method literal must be a string");let u=c;if(u==="elicitation/create"){let l=async(d,f)=>{var p,m,h;let g=Ot(Gu,d);if(!g.success){let F=g.error instanceof Error?g.error.message:String(g.error);throw new A(Z.InvalidParams,`Invalid elicitation request: ${F}`)}let{params:y}=g.data,$=(p=y.mode)!==null&&p!==void 0?p:"form",{supportsFormMode:w,supportsUrlMode:S}=IA(this._capabilities.elicitation);if($==="form"&&!w)throw new A(Z.InvalidParams,"Client does not support form-mode elicitation requests");if($==="url"&&!S)throw new A(Z.InvalidParams,"Client does not support URL-mode elicitation requests");let x=await Promise.resolve(r(d,f));if(y.task){let F=Ot(_n,x);if(!F.success){let ge=F.error instanceof Error?F.error.message:String(F.error);throw new A(Z.InvalidParams,`Invalid task creation result: ${ge}`)}return F.data}let C=Ot(Wu,x);if(!C.success){let F=C.error instanceof Error?C.error.message:String(C.error);throw new A(Z.InvalidParams,`Invalid elicitation result: ${F}`)}let ee=C.data,fe=$==="form"?y.requestedSchema:void 0;if($==="form"&&ee.action==="accept"&&ee.content&&fe&&!((h=(m=this._capabilities.elicitation)===null||m===void 0?void 0:m.form)===null||h===void 0)&&h.applyDefaults)try{xc(fe,ee.content)}catch{}return ee};return super.setRequestHandler(e,l)}if(u==="sampling/createMessage"){let l=async(d,f)=>{let p=Ot(Ku,d);if(!p.success){let y=p.error instanceof Error?p.error.message:String(p.error);throw new A(Z.InvalidParams,`Invalid sampling request: ${y}`)}let{params:m}=p.data,h=await Promise.resolve(r(d,f));if(m.task){let y=Ot(_n,h);if(!y.success){let $=y.error instanceof Error?y.error.message:String(y.error);throw new A(Z.InvalidParams,`Invalid task creation result: ${$}`)}return y.data}let g=Ot(Bu,h);if(!g.success){let y=g.error instanceof Error?g.error.message:String(g.error);throw new A(Z.InvalidParams,`Invalid sampling result: ${y}`)}return g.data};return super.setRequestHandler(e,l)}return super.setRequestHandler(e,r)}assertCapability(e,r){var n;if(!(!((n=this._serverCapabilities)===null||n===void 0)&&n[e]))throw new Error(`Server does not support ${e} (required for ${r})`)}async connect(e,r){if(await super.connect(e),e.sessionId===void 0)try{let n=await this.request({method:"initialize",params:{protocolVersion:Cu,capabilities:this._capabilities,clientInfo:this._clientInfo}},Ou,r);if(n===void 0)throw new Error(`Server sent invalid initialize result: ${n}`);if(!ly.includes(n.protocolVersion))throw new Error(`Server's protocol version is not supported: ${n.protocolVersion}`);this._serverCapabilities=n.capabilities,this._serverVersion=n.serverInfo,e.setProtocolVersion&&e.setProtocolVersion(n.protocolVersion),this._instructions=n.instructions,await this.notification({method:"notifications/initialized"})}catch(n){throw this.close(),n}}getServerCapabilities(){return this._serverCapabilities}getServerVersion(){return this._serverVersion}getInstructions(){return this._instructions}assertCapabilityForMethod(e){var r,n,s,o,i;switch(e){case"logging/setLevel":if(!(!((r=this._serverCapabilities)===null||r===void 0)&&r.logging))throw new Error(`Server does not support logging (required for ${e})`);break;case"prompts/get":case"prompts/list":if(!(!((n=this._serverCapabilities)===null||n===void 0)&&n.prompts))throw new Error(`Server does not support prompts (required for ${e})`);break;case"resources/list":case"resources/templates/list":case"resources/read":case"resources/subscribe":case"resources/unsubscribe":if(!(!((s=this._serverCapabilities)===null||s===void 0)&&s.resources))throw new Error(`Server does not support resources (required for ${e})`);if(e==="resources/subscribe"&&!this._serverCapabilities.resources.subscribe)throw new Error(`Server does not support resource subscriptions (required for ${e})`);break;case"tools/call":case"tools/list":if(!(!((o=this._serverCapabilities)===null||o===void 0)&&o.tools))throw new Error(`Server does not support tools (required for ${e})`);break;case"completion/complete":if(!(!((i=this._serverCapabilities)===null||i===void 0)&&i.completions))throw new Error(`Server does not support completions (required for ${e})`);break;case"initialize":break;case"ping":break}}assertNotificationCapability(e){var r;switch(e){case"notifications/roots/list_changed":if(!(!((r=this._capabilities.roots)===null||r===void 0)&&r.listChanged))throw new Error(`Client does not support roots list changed notifications (required for ${e})`);break;case"notifications/initialized":break;case"notifications/cancelled":break;case"notifications/progress":break}}assertRequestHandlerCapability(e){if(this._capabilities)switch(e){case"sampling/createMessage":if(!this._capabilities.sampling)throw new Error(`Client does not support sampling capability (required for ${e})`);break;case"elicitation/create":if(!this._capabilities.elicitation)throw new Error(`Client does not support elicitation capability (required for ${e})`);break;case"roots/list":if(!this._capabilities.roots)throw new Error(`Client does not support roots capability (required for ${e})`);break;case"tasks/get":case"tasks/list":case"tasks/result":case"tasks/cancel":if(!this._capabilities.tasks)throw new Error(`Client does not support tasks capability (required for ${e})`);break;case"ping":break}}assertTaskCapability(e){var r,n;Rw((n=(r=this._serverCapabilities)===null||r===void 0?void 0:r.tasks)===null||n===void 0?void 0:n.requests,e,"Server")}assertTaskHandlerCapability(e){var r;this._capabilities&&Ow((r=this._capabilities.tasks)===null||r===void 0?void 0:r.requests,e,"Client")}async ping(e){return this.request({method:"ping"},vn,e)}async complete(e,r){return this.request({method:"completion/complete",params:e},Ju,r)}async setLoggingLevel(e,r){return this.request({method:"logging/setLevel",params:{level:e}},vn,r)}async getPrompt(e,r){return this.request({method:"prompts/get",params:e},Uu,r)}async listPrompts(e,r){return this.request({method:"prompts/list",params:e},Du,r)}async listResources(e,r){return this.request({method:"resources/list",params:e},ju,r)}async listResourceTemplates(e,r){return this.request({method:"resources/templates/list",params:e},Au,r)}async readResource(e,r){return this.request({method:"resources/read",params:e},qu,r)}async subscribeResource(e,r){return this.request({method:"resources/subscribe",params:e},vn,r)}async unsubscribeResource(e,r){return this.request({method:"resources/unsubscribe",params:e},vn,r)}async callTool(e,r=rs,n){if(this.isToolTaskRequired(e.name))throw new A(Z.InvalidRequest,`Tool "${e.name}" requires task-based execution. Use client.experimental.tasks.callToolStream() instead.`);let s=await this.request({method:"tools/call",params:e},r,n),o=this.getToolOutputValidator(e.name);if(o){if(!s.structuredContent&&!s.isError)throw new A(Z.InvalidRequest,`Tool ${e.name} has an output schema but did not return structured content`);if(s.structuredContent)try{let i=o(s.structuredContent);if(!i.valid)throw new A(Z.InvalidParams,`Structured content does not match the tool's output schema: ${i.errorMessage}`)}catch(i){throw i instanceof A?i:new A(Z.InvalidParams,`Failed to validate structured content: ${i instanceof Error?i.message:String(i)}`)}}return s}isToolTask(e){var r,n,s,o;return!((o=(s=(n=(r=this._serverCapabilities)===null||r===void 0?void 0:r.tasks)===null||n===void 0?void 0:n.requests)===null||s===void 0?void 0:s.tools)===null||o===void 0)&&o.call?this._cachedKnownTaskTools.has(e):!1}isToolTaskRequired(e){return this._cachedRequiredTaskTools.has(e)}cacheToolMetadata(e){var r;this._cachedToolOutputValidators.clear(),this._cachedKnownTaskTools.clear(),this._cachedRequiredTaskTools.clear();for(let n of e){if(n.outputSchema){let o=this._jsonSchemaValidator.getValidator(n.outputSchema);this._cachedToolOutputValidators.set(n.name,o)}let s=(r=n.execution)===null||r===void 0?void 0:r.taskSupport;(s==="required"||s==="optional")&&this._cachedKnownTaskTools.add(n.name),s==="required"&&this._cachedRequiredTaskTools.add(n.name)}}getToolOutputValidator(e){return this._cachedToolOutputValidators.get(e)}async listTools(e,r){let n=await this.request({method:"tools/list",params:e},Hu,r);return this.cacheToolMetadata(n.tools),n}async sendRootsListChanged(){return this.notification({method:"notifications/roots/list_changed"})}};var x$=ye(w$(),1),fi=ye(require("node:process"),1),k$=require("node:stream");var Pc=class{append(e){this._buffer=this._buffer?Buffer.concat([this._buffer,e]):e}readMessage(){if(!this._buffer)return null;let e=this._buffer.indexOf(`
`);if(e===-1)return null;let r=this._buffer.toString("utf8",0,e).replace(/\r$/,"");return this._buffer=this._buffer.subarray(e+1),sM(r)}clear(){this._buffer=void 0}};function sM(t){return _y.parse(JSON.parse(t))}function $$(t){return JSON.stringify(t)+`
`}var oM=fi.default.platform==="win32"?["APPDATA","HOMEDRIVE","HOMEPATH","LOCALAPPDATA","PATH","PROCESSOR_ARCHITECTURE","SYSTEMDRIVE","SYSTEMROOT","TEMP","USERNAME","USERPROFILE","PROGRAMFILES"]:["HOME","LOGNAME","PATH","SHELL","TERM","USER"];function iM(){let t={};for(let e of oM){let r=fi.default.env[e];r!==void 0&&(r.startsWith("()")||(t[e]=r))}return t}var Tc=class{constructor(e){this._readBuffer=new Pc,this._stderrStream=null,this._serverParams=e,(e.stderr==="pipe"||e.stderr==="overlapped")&&(this._stderrStream=new k$.PassThrough)}async start(){if(this._process)throw new Error("StdioClientTransport already started! If using Client class, note that connect() calls start() automatically.");return new Promise((e,r)=>{var n,s,o,i,a;this._process=(0,x$.default)(this._serverParams.command,(n=this._serverParams.args)!==null&&n!==void 0?n:[],{env:{...iM(),...this._serverParams.env},stdio:["pipe","pipe",(s=this._serverParams.stderr)!==null&&s!==void 0?s:"inherit"],shell:!1,windowsHide:fi.default.platform==="win32"&&aM(),cwd:this._serverParams.cwd}),this._process.on("error",c=>{var u;r(c),(u=this.onerror)===null||u===void 0||u.call(this,c)}),this._process.on("spawn",()=>{e()}),this._process.on("close",c=>{var u;this._process=void 0,(u=this.onclose)===null||u===void 0||u.call(this)}),(o=this._process.stdin)===null||o===void 0||o.on("error",c=>{var u;(u=this.onerror)===null||u===void 0||u.call(this,c)}),(i=this._process.stdout)===null||i===void 0||i.on("data",c=>{this._readBuffer.append(c),this.processReadBuffer()}),(a=this._process.stdout)===null||a===void 0||a.on("error",c=>{var u;(u=this.onerror)===null||u===void 0||u.call(this,c)}),this._stderrStream&&this._process.stderr&&this._process.stderr.pipe(this._stderrStream)})}get stderr(){var e,r;return this._stderrStream?this._stderrStream:(r=(e=this._process)===null||e===void 0?void 0:e.stderr)!==null&&r!==void 0?r:null}get pid(){var e,r;return(r=(e=this._process)===null||e===void 0?void 0:e.pid)!==null&&r!==void 0?r:null}processReadBuffer(){for(var e,r;;)try{let n=this._readBuffer.readMessage();if(n===null)break;(e=this.onmessage)===null||e===void 0||e.call(this,n)}catch(n){(r=this.onerror)===null||r===void 0||r.call(this,n)}}async close(){var e;if(this._process){let r=this._process;this._process=void 0;let n=new Promise(s=>{r.once("close",()=>{s()})});try{(e=r.stdin)===null||e===void 0||e.end()}catch{}if(await Promise.race([n,new Promise(s=>setTimeout(s,2e3).unref())]),r.exitCode===null){try{r.kill("SIGTERM")}catch{}await Promise.race([n,new Promise(s=>setTimeout(s,2e3).unref())])}if(r.exitCode===null)try{r.kill("SIGKILL")}catch{}}this._readBuffer.clear()}send(e){return new Promise(r=>{var n;if(!(!((n=this._process)===null||n===void 0)&&n.stdin))throw new Error("Not connected");let s=$$(e);this._process.stdin.write(s)?r():this._process.stdin.once("drain",r)})}};function aM(){return"type"in fi.default}function Ec(t){if(!t||typeof t!="object")return E.any();let e=t.type;switch(e){case"string":let r=E.string();return t.enum?E.enum(t.enum):r;case"number":case"integer":let n=E.number();return e==="integer"&&(n=n.int()),n;case"boolean":return E.boolean();case"array":return t.items?E.array(Ec(t.items)):E.array(E.any());case"object":if(t.properties){let s={},o=new Set(t.required||[]);for(let[i,a]of Object.entries(t.properties)){let c=Ec(a);o.has(i)||(c=c.optional()),s[i]=c}return t.additionalProperties!==!1?E.object(s).passthrough():E.object(s)}return E.object({}).passthrough();default:return E.any()}}var zc=class{constructor(e,r){this.gateway=e;this.context=r;this.clients=new Map;this.serverStates=new Map;this.resources=new Map;this.prompts=new Map;this.disposables=[];this.eventListeners=[];this.disposables.push(js.workspace.onDidChangeConfiguration(n=>{n.affectsConfiguration("vibey.mcpServers")&&this.reloadServers()}))}async initialize(){await this.reloadServers()}addEventListener(e){this.eventListeners.push(e)}removeEventListener(e){let r=this.eventListeners.indexOf(e);r>=0&&this.eventListeners.splice(r,1)}emitEvent(e){for(let r of this.eventListeners)try{r(e)}catch(n){console.error("[MCP] Event listener error:",n)}}getServerStates(){return Array.from(this.serverStates.values())}getServerState(e){return this.serverStates.get(e)}getResources(e){return e?this.resources.get(e)||[]:Array.from(this.resources.values()).flat()}getPrompts(e){return e?this.prompts.get(e)||[]:Array.from(this.prompts.values()).flat()}async readResource(e){for(let[r,n]of this.resources.entries())if(n.find(o=>o.uri===e)){let o=this.clients.get(r);if(!o)throw new Error(`Server ${r} not connected`);let i=await o.readResource({uri:e});if(i.contents&&i.contents.length>0){let a=i.contents[0];return"text"in a?a.text:JSON.stringify(a)}return""}throw new Error(`Resource not found: ${e}`)}async getPrompt(e,r){for(let[n,s]of this.prompts.entries())if(s.find(i=>i.name===e)){let i=this.clients.get(n);if(!i)throw new Error(`Server ${n} not connected`);let a=await i.getPrompt({name:e,arguments:r});return a.messages&&a.messages.length>0?a.messages.map(c=>typeof c.content=="string"?c.content:c.content&&"text"in c.content?c.content.text:JSON.stringify(c.content)).join(`
`):""}throw new Error(`Prompt not found: ${e}`)}async dispose(){this.disposables.forEach(e=>e.dispose());for(let[e]of this.clients.entries())await this.disconnectServer(e);this.clients.clear(),this.serverStates.clear(),this.resources.clear(),this.prompts.clear()}async reconnectServer(e){let r=this.serverStates.get(e);if(!r)throw new Error(`Server ${e} not configured`);await this.disconnectServer(e),await this.connectToServer(e,r.config)}async reloadServers(){console.log("[MCP] Reloading servers...");let r=js.workspace.getConfiguration("vibey").get("mcpServers")||{},n=new Set(Object.keys(r));for(let s of this.clients.keys())n.has(s)||await this.disconnectServer(s);for(let[s,o]of Object.entries(r)){let i=this.serverStates.get(s),a=i&&JSON.stringify(i.config)!==JSON.stringify(o);if(!i||a){i&&await this.disconnectServer(s);try{await this.connectToServer(s,o)}catch(c){console.error(`[MCP] Error connecting to ${s}:`,c),this.updateServerState(s,{name:s,config:o,status:"error",error:c.message,toolCount:0,resourceCount:0,promptCount:0,registeredTools:[]})}}}}updateServerState(e,r){this.serverStates.set(e,r)}async disconnectServer(e){let r=this.serverStates.get(e),n=this.clients.get(e);if(r)for(let s of r.registeredTools)this.gateway.unregisterTool(s);if(n){try{await n.close()}catch(s){console.error(`[MCP] Error closing client ${e}:`,s)}this.clients.delete(e)}this.serverStates.delete(e),this.resources.delete(e),this.prompts.delete(e),this.emitEvent({type:"server-disconnected",serverName:e}),console.log(`[MCP] Disconnected from ${e}`)}async connectToServer(e,r){console.log(`[MCP] Connecting to ${e}...`,r),this.updateServerState(e,{name:e,config:r,status:"connecting",toolCount:0,resourceCount:0,promptCount:0,registeredTools:[]});try{let n=new Tc({command:r.command,args:r.args||[],env:r.env}),s=new kc({name:"VibeyClient",version:"0.1.3"},{capabilities:{sampling:{}}});await s.connect(n),this.clients.set(e,s);let o=[],i=0,a=0,c=0;try{let u=await s.listTools();if(u.tools)for(let l of u.tools){let d=this.adaptMcpTool(e,s,l);this.gateway.registerTool(d),o.push(l.name),i++,console.log(`[MCP] Registered tool: ${l.name} from ${e}`)}}catch(u){console.warn(`[MCP] Failed to list tools from ${e}:`,u)}try{let u=await s.listResources();if(u.resources){let l=u.resources.map(d=>({uri:d.uri,name:d.name,description:d.description,mimeType:d.mimeType}));this.resources.set(e,l),a=l.length,console.log(`[MCP] Discovered ${a} resources from ${e}`)}}catch{console.log(`[MCP] Server ${e} does not support resources`)}try{let u=await s.listPrompts();if(u.prompts){let l=u.prompts.map(d=>({name:d.name,description:d.description,arguments:d.arguments?.map(f=>({name:f.name,description:f.description,required:f.required}))}));this.prompts.set(e,l),c=l.length,console.log(`[MCP] Discovered ${c} prompts from ${e}`)}}catch{console.log(`[MCP] Server ${e} does not support prompts`)}this.updateServerState(e,{name:e,config:r,status:"connected",connectedAt:Date.now(),toolCount:i,resourceCount:a,promptCount:c,registeredTools:o}),this.emitEvent({type:"server-connected",serverName:e}),this.emitEvent({type:"tools-updated",serverName:e,data:{count:i}}),js.window.showInformationMessage(`MCP: Connected to ${e} (${i} tools, ${a} resources)`)}catch(n){throw console.error(`[MCP] Failed to connect to ${e}:`,n),this.updateServerState(e,{name:e,config:r,status:"error",error:n.message,toolCount:0,resourceCount:0,promptCount:0,registeredTools:[]}),this.emitEvent({type:"server-error",serverName:e,data:{error:n.message}}),js.window.showErrorMessage(`MCP: Failed to connect to ${e}: ${n.message}`),n}}adaptMcpTool(e,r,n){return{name:n.name,description:n.description||`Tool from MCP server: ${e}`,parameters:Ec(n.inputSchema),execute:async s=>{let o=await r.callTool({name:n.name,arguments:s});if(o.isError){let i=this.extractContent(o.content);throw new Error(i||"Tool execution failed")}return this.extractContent(o.content)}}}extractContent(e){return e?Array.isArray(e)?e.map(r=>typeof r=="string"?r:r.type==="text"?r.text:r.type==="image"?`[Image: ${r.mimeType||"unknown"}]`:r.type==="resource"?`[Resource: ${r.resource?.uri||"unknown"}]`:JSON.stringify(r)).join(`
`):JSON.stringify(e):""}};var Rf=ye(require("crypto"));var S$=[{id:"tool_success_rate",name:"Tool Success Rate",description:"Percentage of tool executions that succeed",category:"performance",unit:"%",aggregation:"rate",higherIsBetter:!0},{id:"task_completion_rate",name:"Task Completion Rate",description:"Percentage of tasks completed successfully",category:"performance",unit:"%",aggregation:"rate",higherIsBetter:!0},{id:"avg_task_duration",name:"Average Task Duration",description:"Average time to complete a task",category:"efficiency",unit:"minutes",aggregation:"avg",higherIsBetter:!1},{id:"turns_per_task",name:"Turns Per Task",description:"Average LLM turns needed to complete a task",category:"efficiency",aggregation:"avg",higherIsBetter:!1},{id:"error_recovery_rate",name:"Error Recovery Rate",description:"Percentage of errors successfully recovered from",category:"quality",unit:"%",aggregation:"rate",higherIsBetter:!0},{id:"security_violations",name:"Security Violations",description:"Number of blocked security violations",category:"security",aggregation:"count",higherIsBetter:!1},{id:"learnings_applied",name:"Learnings Applied",description:"Number of past learnings successfully applied",category:"learning",aggregation:"count",higherIsBetter:!0},{id:"tokens_sent",name:"Tokens Sent",description:"Total tokens sent to LLM in prompts",category:"efficiency",unit:"tokens",aggregation:"sum",higherIsBetter:!1},{id:"tokens_received",name:"Tokens Received",description:"Total tokens received from LLM responses",category:"efficiency",unit:"tokens",aggregation:"sum",higherIsBetter:!1}];var Cc=class t{constructor(e,r=t.DEFAULT_CONFIG){this.context=e;this.config=r;this.dataPoints=[];this.decisions=[];this.learnings=[];this.metrics=new Map;this.snapshots=[];for(let n of S$)this.metrics.set(n.id,n);this.loadState()}static{this.STORAGE_KEY="vibey.metrics.data"}static{this.DEFAULT_CONFIG={retentionDays:30,snapshotInterval:24,enableDetailedLogging:!0}}record(e,r,n,s){if(!this.metrics.get(e)){console.warn(`Unknown metric: ${e}`);return}this.dataPoints.push({metricId:e,value:r,timestamp:Date.now(),context:n,tags:s}),this.pruneOldData(),this.saveState()}recordDecision(e){let r={id:Rf.randomUUID(),timestamp:Date.now(),...e};return this.decisions.push(r),this.saveState(),r.id}updateDecisionOutcome(e,r){let n=this.decisions.find(s=>s.id===e);n&&(n.outcome=r,this.saveState())}addLearning(e){let r={id:Rf.randomUUID(),timestamp:Date.now(),appliedCount:0,...e};return this.learnings.push(r),this.saveState(),r.id}recordLearningApplied(e,r){let n=this.learnings.find(s=>s.id===e);if(n){n.appliedCount++;let s=n.successRate??0,o=n.appliedCount-1;n.successRate=o>0?(s*o+(r?1:0))/n.appliedCount:r?1:0,this.saveState()}}getSummary(e,r=24){let n=this.metrics.get(e);if(!n)return;let s=Date.now(),o=s-r*60*60*1e3,i=o-r*60*60*1e3,a=this.dataPoints.filter(m=>m.metricId===e&&m.timestamp>=o),c=this.dataPoints.filter(m=>m.metricId===e&&m.timestamp>=i&&m.timestamp<o),u=this.aggregate(a,n.aggregation),l=c.length>0?this.aggregate(c,n.aggregation):void 0,d="stable",f,p;return l!==void 0&&l!==0&&(f=u-l,p=f/l*100,Math.abs(p)>5&&(d=f>0?"up":"down")),{metricId:e,name:n.name,category:n.category,currentValue:u,previousValue:l,change:f,changePercent:p,trend:d,dataPoints:a.length,period:{start:o,end:s}}}getAllSummaries(e=24){return Array.from(this.metrics.keys()).map(r=>this.getSummary(r,e)).filter(r=>r!==void 0)}createSnapshot(){let e=this.getAllSummaries(),r=[],n=[],s=[];for(let c of e){let u=this.metrics.get(c.metricId),l=c.trend==="up"&&u.higherIsBetter||c.trend==="down"&&!u.higherIsBetter,d=c.trend==="down"&&u.higherIsBetter||c.trend==="up"&&!u.higherIsBetter;l?r.push(`${u.name} is improving (${c.changePercent?.toFixed(1)}%)`):d&&(n.push(`${u.name} is declining (${c.changePercent?.toFixed(1)}%)`),s.push(`Investigate ${u.name} decline and identify root cause`))}let o=e.filter(c=>c.dataPoints>0),i=o.length>0?o.reduce((c,u)=>{let l=this.metrics.get(u.metricId),d=u.currentValue;return l.aggregation==="rate"&&(d=u.currentValue*100),c+Math.min(100,Math.max(0,d))},0)/o.length:50,a={timestamp:Date.now(),metrics:e,overallScore:Math.round(i),strengths:r,weaknesses:n,recommendations:s};return this.snapshots.push(a),this.saveState(),a}getLatestSnapshot(){return this.snapshots[this.snapshots.length-1]}getLearnings(e){let r=[...this.learnings];return e&&(r=r.filter(n=>n.category===e)),r.sort((n,s)=>s.confidence-n.confidence)}getRecentDecisions(e=20){return this.decisions.slice(-e).sort((r,n)=>n.timestamp-r.timestamp)}aggregate(e,r){if(e.length===0)return 0;let n=e.map(s=>s.value);switch(r){case"sum":return n.reduce((o,i)=>o+i,0);case"avg":return n.reduce((o,i)=>o+i,0)/n.length;case"min":return Math.min(...n);case"max":return Math.max(...n);case"count":return n.length;case"rate":return n.filter(o=>o===1).length/n.length;default:return n[n.length-1]}}pruneOldData(){let e=Date.now()-this.config.retentionDays*24*60*60*1e3;this.dataPoints=this.dataPoints.filter(r=>r.timestamp>=e),this.decisions=this.decisions.filter(r=>r.timestamp>=e),this.snapshots=this.snapshots.filter(r=>r.timestamp>=e)}async saveState(){let e={dataPoints:this.dataPoints,decisions:this.decisions,learnings:this.learnings,snapshots:this.snapshots};await this.context.globalState.update(t.STORAGE_KEY,e)}loadState(){let e=this.context.globalState.get(t.STORAGE_KEY);e&&(this.dataPoints=e.dataPoints||[],this.decisions=e.decisions||[],this.learnings=e.learnings||[],this.snapshots=e.snapshots||[])}clearAllData(){this.dataPoints=[],this.decisions=[],this.learnings=[],this.snapshots=[],this.saveState()}};var kr,mi,Of;function cM(t){console.log("Vibey is now active!");let e=pe.workspace.workspaceFolders?pe.workspace.workspaceFolders[0].uri.fsPath:process.cwd();console.log("Vibey Workspace Root:",e),Of=new Cc(t);let r=new $i(e),n=new wi(r),s=new zi;em(r,e).forEach(C=>n.registerTool(C)),tm(r,e).forEach(C=>n.registerTool(C)),n.registerTool(rm(s));let a=P$.join(t.extensionPath,"src","ui","media","vibey-terminal.svg");mi=new Ls(e,t,a),om(mi).forEach(C=>n.registerTool(C)),im().forEach(C=>n.registerTool(C)),kr=new zc(n,t),kr.initialize().catch(C=>{console.error("[Vibey] Failed to initialize MCP service:",C)});let l=new bi,d=new _i(l,n,e),f=new Ri(t,e),p=pe.extensions.getExtension("vibey.vibey");p&&p.exports&&(p.exports.metricsCollector=Of);let m=new Zs(t.extensionUri,d,s,f);t.subscriptions.push(pe.window.registerWebviewViewProvider(Zs.viewType,m)),t.subscriptions.push(pe.window.registerWebviewViewProvider("vibey.chatViewAux",m));let h=pe.commands.registerCommand("vibey.start",()=>{pe.commands.executeCommand("workbench.view.extension.vibey-sidebar")}),g=pe.commands.registerCommand("vibey.openSettings",()=>{pe.commands.executeCommand("workbench.action.openSettings","vibey")}),y=pe.commands.registerCommand("vibey.selectModel",async()=>{try{let C=await l.listModels();if(C.length===0){pe.window.showErrorMessage("No Ollama models found. Is Ollama running?");return}let ee=await pe.window.showQuickPick(C,{placeHolder:"Select an Ollama model"});ee&&(await pe.workspace.getConfiguration("vibey").update("model",ee,pe.ConfigurationTarget.Global),pe.window.showInformationMessage(`Vibey model set to: ${ee}`))}catch(C){pe.window.showErrorMessage(`Failed to select model: ${C.message}`)}}),$=pe.commands.registerCommand("vibey.voiceInput",()=>{Ci.createOrShow(t.extensionUri,C=>{m.addTranscriptToInput(C)})}),w=pe.commands.registerCommand("vibey.mcpStatus",()=>{if(!kr){pe.window.showErrorMessage("MCP service not initialized");return}let C=kr.getServerStates();if(C.length===0){pe.window.showInformationMessage("No MCP servers configured. Add servers in settings (vibey.mcpServers)");return}let ee=C.map(fe=>`${fe.status==="connected"?"\u2705":fe.status==="error"?"\u274C":"\u23F3"} ${fe.name}: ${fe.toolCount} tools, ${fe.resourceCount} resources${fe.error?` (${fe.error})`:""}`);pe.window.showInformationMessage(`MCP Servers:
${ee.join(`
`)}`)}),S=pe.commands.registerCommand("vibey.mcpReload",async()=>{if(!kr){pe.window.showErrorMessage("MCP service not initialized");return}pe.window.showInformationMessage("Reloading MCP servers..."),await kr.reloadServers()}),x=pe.commands.registerCommand("vibey.mcpListTools",()=>{let C=n.getToolDefinitions(),ee=C.map(fe=>fe.name).sort();pe.window.showQuickPick(ee,{placeHolder:"Available tools (built-in + MCP)",canPickMany:!1}).then(fe=>{if(fe){let F=C.find(ge=>ge.name===fe);F&&pe.window.showInformationMessage(`${F.name}: ${F.description}`)}})});t.subscriptions.push(h),t.subscriptions.push(g),t.subscriptions.push(y),t.subscriptions.push($),t.subscriptions.push(w),t.subscriptions.push(S),t.subscriptions.push(x)}function Zn(){return Of}async function uM(){kr&&(await kr.dispose(),kr=void 0),mi&&(mi.dispose(),mi=void 0)}0&&(module.exports={activate,deactivate,getMetricsCollector});
